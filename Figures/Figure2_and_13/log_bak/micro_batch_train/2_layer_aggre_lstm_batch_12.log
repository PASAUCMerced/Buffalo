main start at this time 1734649690.575583
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#--------------------------------- epoch  0
the output layer 
self.num_batch (get_in_degree_bucketing) 12
get_in_degree_bucketing dst global nid length 196571
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
total indegree bucketing result ,  196571
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.13052797317504883
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0003483295440673828
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009905099868774414
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1310737133026123
self.has_zero_indegree_seeds  False
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.424982786178589
self.buckets_partition() spend  sec:  0.14099597930908203
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.95458984375 GB
    Memory Allocated: 0.4165821075439453  GigaBytes
Max Memory Allocated: 0.4165821075439453  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.44287109375 GB
    Memory Allocated: 20.388577938079834  GigaBytes
Max Memory Allocated: 20.761784553527832  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.44287109375 GB
    Memory Allocated: 20.391907215118408  GigaBytes
Max Memory Allocated: 20.761784553527832  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.45068359375 GB
    Memory Allocated: 0.45097875595092773  GigaBytes
Max Memory Allocated: 20.761784553527832  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.80419921875 GB
    Memory Allocated: 20.78638792037964  GigaBytes
Max Memory Allocated: 21.167571544647217  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.80419921875 GB
    Memory Allocated: 20.789325714111328  GigaBytes
Max Memory Allocated: 21.167571544647217  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.80419921875 GB
    Memory Allocated: 0.46118831634521484  GigaBytes
Max Memory Allocated: 21.167571544647217  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.89990234375 GB
    Memory Allocated: 20.761462211608887  GigaBytes
Max Memory Allocated: 21.167571544647217  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.89990234375 GB
    Memory Allocated: 20.764352321624756  GigaBytes
Max Memory Allocated: 21.167571544647217  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.89990234375 GB
    Memory Allocated: 0.47679567337036133  GigaBytes
Max Memory Allocated: 21.167571544647217  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.85693359375 GB
    Memory Allocated: 20.843617916107178  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.85693359375 GB
    Memory Allocated: 20.846686840057373  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.85693359375 GB
    Memory Allocated: 0.4864211082458496  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.795571327209473  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.799506664276123  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 0.4936642646789551  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.361753463745117  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.365085124969482  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 0.5086331367492676  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.767951011657715  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.77140522003174  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 0.518923282623291  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.63660764694214  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.639690399169922  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 0.5296239852905273  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.614408016204834  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.617297172546387  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 0.5409464836120605  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.578501224517822  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.581397533416748  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 0.5509519577026367  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.560653686523438  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.563708782196045  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 0.5608386993408203  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.458995819091797  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 20.461880207061768  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.95068359375 GB
    Memory Allocated: 0.5931186676025391  GigaBytes
Max Memory Allocated: 21.224058151245117  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.2053422927856445
