main start at this time 1733104352.9122345
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.55029296875 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.477 seconds, peak memory: 17.045 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 17.045 GB
Metis partitioning: 5.029 seconds, peak memory: 17.823 GB
Split the graph: 10.602 seconds
Construct subgraphs: 0.017 seconds
REG metis partition end ----................................
REG construction  time spent:  26.34637999534607
pure dgl.metis_partition the time spent:  17.155073642730713
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7303025722503662

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3493492603302002

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

connection checking time:  1.3116557598114014
block generation total time  2.0796518325805664
average batch blocks generation time:  0.34660863876342773
block dataloader generation time/epoch 47.58796048164368
pseudo mini batch 0 input nodes size: 46381
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.57568359375 GB
    Memory Allocated: 0.055170536041259766  GigaBytes
Max Memory Allocated: 0.055170536041259766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.57568359375 GB
    Memory Allocated: 0.05528545379638672  GigaBytes
Max Memory Allocated: 0.05528545379638672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.57568359375 GB
    Memory Allocated: 0.05528545379638672  GigaBytes
Max Memory Allocated: 0.05528545379638672  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2701, 2: 2343, 3: 1886, 4: 1429, 5: 1170, 6: 901, 7: 694, 8: 639, 25: 616, 9: 484, 10: 441, 11: 332, 12: 297, 13: 230, 14: 201, 15: 195, 16: 144, 17: 134, 18: 115, 19: 103, 21: 83, 20: 77, 22: 69, 23: 65, 24: 57})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.57958984375 GB
    Memory Allocated: 0.05793428421020508  GigaBytes
Max Memory Allocated: 0.05793428421020508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.57958984375 GB
    Memory Allocated: 0.05793428421020508  GigaBytes
Max Memory Allocated: 0.05793428421020508  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.34326171875 GB
    Memory Allocated: 7.267092227935791  GigaBytes
Max Memory Allocated: 7.751800060272217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.34326171875 GB
    Memory Allocated: 7.269443035125732  GigaBytes
Max Memory Allocated: 7.751800060272217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.72021484375 GB
    Memory Allocated: 0.11128950119018555  GigaBytes
Max Memory Allocated: 7.751800060272217  GigaBytes

pseudo mini batch 1 input nodes size: 47147
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.72021484375 GB
    Memory Allocated: 0.10887384414672852  GigaBytes
Max Memory Allocated: 7.751800060272217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.72021484375 GB
    Memory Allocated: 0.10887384414672852  GigaBytes
Max Memory Allocated: 7.751800060272217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.72021484375 GB
    Memory Allocated: 0.13231134414672852  GigaBytes
Max Memory Allocated: 7.751800060272217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.72021484375 GB
    Memory Allocated: 0.13242387771606445  GigaBytes
Max Memory Allocated: 7.751800060272217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.72021484375 GB
    Memory Allocated: 0.11019277572631836  GigaBytes
Max Memory Allocated: 7.751800060272217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2179, 2: 2049, 3: 1660, 4: 1365, 5: 1055, 6: 886, 25: 831, 7: 774, 8: 626, 9: 588, 10: 456, 11: 402, 12: 359, 13: 313, 14: 264, 15: 232, 16: 166, 17: 165, 18: 145, 19: 137, 20: 105, 21: 101, 22: 92, 23: 72, 24: 69})

----------------------------------------after blocks to device 
 Nvidia-smi: 8.72021484375 GB
    Memory Allocated: 0.11305093765258789  GigaBytes
Max Memory Allocated: 7.751800060272217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.72021484375 GB
    Memory Allocated: 0.11305093765258789  GigaBytes
Max Memory Allocated: 7.751800060272217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.25341796875 GB
    Memory Allocated: 8.02681303024292  GigaBytes
Max Memory Allocated: 8.557944774627686  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.25341796875 GB
    Memory Allocated: 8.029159545898438  GigaBytes
Max Memory Allocated: 8.557944774627686  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.66943359375 GB
    Memory Allocated: 0.11528444290161133  GigaBytes
Max Memory Allocated: 8.557944774627686  GigaBytes

pseudo mini batch 2 input nodes size: 36553
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.66943359375 GB
    Memory Allocated: 0.11281967163085938  GigaBytes
Max Memory Allocated: 8.557944774627686  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.66943359375 GB
    Memory Allocated: 0.11281967163085938  GigaBytes
Max Memory Allocated: 8.557944774627686  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.66943359375 GB
    Memory Allocated: 0.13039779663085938  GigaBytes
Max Memory Allocated: 8.557944774627686  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.66943359375 GB
    Memory Allocated: 0.13051319122314453  GigaBytes
Max Memory Allocated: 8.557944774627686  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.66943359375 GB
    Memory Allocated: 0.1069631576538086  GigaBytes
Max Memory Allocated: 8.557944774627686  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1906, 2: 1750, 3: 1542, 25: 1308, 4: 1259, 5: 1091, 6: 925, 7: 791, 8: 657, 9: 561, 10: 536, 11: 471, 12: 357, 13: 339, 14: 309, 15: 248, 17: 238, 16: 229, 20: 184, 18: 176, 21: 151, 19: 145, 23: 104, 24: 101, 22: 98})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.66943359375 GB
    Memory Allocated: 0.11009550094604492  GigaBytes
Max Memory Allocated: 8.557944774627686  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.66943359375 GB
    Memory Allocated: 0.11009550094604492  GigaBytes
Max Memory Allocated: 8.557944774627686  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.48974609375 GB
    Memory Allocated: 9.162662506103516  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.48974609375 GB
    Memory Allocated: 9.165050983428955  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.98388671875 GB
    Memory Allocated: 0.11283731460571289  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

pseudo mini batch 3 input nodes size: 62606
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.98388671875 GB
    Memory Allocated: 0.11045217514038086  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.98388671875 GB
    Memory Allocated: 0.11045217514038086  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.98388671875 GB
    Memory Allocated: 0.1403050422668457  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.98388671875 GB
    Memory Allocated: 0.14041805267333984  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.98388671875 GB
    Memory Allocated: 0.12272453308105469  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2647, 2: 2196, 3: 1688, 4: 1312, 5: 1180, 25: 890, 6: 830, 7: 691, 8: 608, 9: 501, 10: 401, 11: 307, 12: 300, 13: 264, 14: 218, 15: 180, 16: 166, 18: 133, 17: 130, 20: 110, 19: 102, 21: 74, 22: 66, 24: 58, 23: 57})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.98388671875 GB
    Memory Allocated: 0.12579584121704102  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.98388671875 GB
    Memory Allocated: 0.12579584121704102  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.03466796875 GB
    Memory Allocated: 8.000236988067627  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.03466796875 GB
    Memory Allocated: 8.002793312072754  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.03466796875 GB
    Memory Allocated: 0.12778329849243164  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

pseudo mini batch 4 input nodes size: 85121
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.03466796875 GB
    Memory Allocated: 0.12467050552368164  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.03466796875 GB
    Memory Allocated: 0.12467050552368164  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.03466796875 GB
    Memory Allocated: 0.16525936126708984  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.03466796875 GB
    Memory Allocated: 0.16536998748779297  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.03466796875 GB
    Memory Allocated: 0.13540410995483398  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2249, 25: 2182, 2: 1977, 3: 1382, 4: 1065, 5: 966, 6: 693, 7: 586, 8: 514, 9: 415, 10: 366, 11: 341, 12: 294, 13: 217, 15: 209, 14: 202, 16: 178, 18: 166, 17: 155, 19: 149, 20: 132, 21: 121, 24: 101, 22: 99, 23: 75})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.03466796875 GB
    Memory Allocated: 0.14078998565673828  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.03466796875 GB
    Memory Allocated: 0.14078998565673828  GigaBytes
Max Memory Allocated: 9.776255130767822  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.43896484375 GB
    Memory Allocated: 11.123665809631348  GigaBytes
Max Memory Allocated: 11.800629615783691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.43896484375 GB
    Memory Allocated: 11.125985622406006  GigaBytes
Max Memory Allocated: 11.800629615783691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.94677734375 GB
    Memory Allocated: 0.14545059204101562  GigaBytes
Max Memory Allocated: 11.800629615783691  GigaBytes

pseudo mini batch 5 input nodes size: 76153
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.94677734375 GB
    Memory Allocated: 0.1391754150390625  GigaBytes
Max Memory Allocated: 11.800629615783691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.94677734375 GB
    Memory Allocated: 0.1391754150390625  GigaBytes
Max Memory Allocated: 11.800629615783691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.94677734375 GB
    Memory Allocated: 0.1762847900390625  GigaBytes
Max Memory Allocated: 11.800629615783691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.94677734375 GB
    Memory Allocated: 0.17639684677124023  GigaBytes
Max Memory Allocated: 11.800629615783691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.94677734375 GB
    Memory Allocated: 0.1356973648071289  GigaBytes
Max Memory Allocated: 11.800629615783691  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3633, 1: 1746, 2: 1391, 3: 1119, 4: 890, 5: 760, 6: 633, 7: 509, 8: 428, 9: 427, 10: 399, 11: 350, 12: 330, 13: 293, 14: 240, 16: 228, 15: 225, 18: 213, 17: 208, 19: 200, 20: 199, 21: 187, 23: 146, 24: 139, 22: 132})

----------------------------------------after blocks to device 
 Nvidia-smi: 13.94677734375 GB
    Memory Allocated: 0.1412954330444336  GigaBytes
Max Memory Allocated: 11.800629615783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.94677734375 GB
    Memory Allocated: 0.1412954330444336  GigaBytes
Max Memory Allocated: 11.800629615783691  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.51318359375 GB
    Memory Allocated: 13.73871660232544  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.51318359375 GB
    Memory Allocated: 13.741402626037598  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.14566993713378906  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2117786407470703  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1787242889404297  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08929280440012614 |0.005522370338439941 |0.3613327344258626 |0.0023479859034220376 |0.4564613501230876 |0.17014265060424805 |
----------------------------------------------------------pseudo_mini_loss sum 3.776122808456421
Total (block generation + training)time/epoch 53.300256967544556
Training time/epoch 5.7117390632629395
Training time without block to device /epoch 5.6786048412323
Training time without total dataloading part /epoch 5.0909950733184814
load block tensor time/epoch 0.5357568264007568
block to device time/epoch 0.03313422203063965
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  565906
Number of first layer input nodes during this epoch:  353961
Number of first layer output nodes during this epoch:  211945
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.16511058807373047  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.521 seconds, peak memory: 39.420 GB
Construct multi-constraint weights: 0.001 seconds, peak memory: 39.420 GB
Metis partitioning: 5.077 seconds, peak memory: 40.224 GB
Split the graph: 10.069 seconds
Construct subgraphs: 0.105 seconds
REG metis partition end ----................................
REG construction  time spent:  24.13576030731201
pure dgl.metis_partition the time spent:  16.800907850265503
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.738548755645752

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3698375225067139

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.16511058807373047  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

connection checking time:  1.3337407112121582
block generation total time  2.108386278152466
average batch blocks generation time:  0.35139771302541095
block dataloader generation time/epoch 46.310248136520386
pseudo mini batch 0 input nodes size: 65967
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1590719223022461  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1590719223022461  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19052743911743164  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.190643310546875  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.15342187881469727  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2584, 2: 2208, 3: 1728, 4: 1361, 5: 1221, 25: 936, 6: 890, 7: 734, 8: 664, 9: 519, 10: 417, 11: 335, 12: 297, 13: 265, 14: 227, 15: 199, 16: 184, 17: 143, 18: 131, 20: 109, 19: 107, 21: 83, 22: 69, 24: 66, 23: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1566624641418457  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1566624641418457  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 8.432798385620117  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 8.435454368591309  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1878652572631836  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

pseudo mini batch 1 input nodes size: 86459
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1845555305480957  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1845555305480957  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2257823944091797  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2258920669555664  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1943206787109375  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2255, 25: 2167, 2: 1916, 3: 1388, 4: 1042, 5: 944, 6: 705, 7: 564, 8: 489, 9: 432, 10: 386, 11: 325, 12: 297, 13: 236, 14: 206, 15: 193, 16: 168, 17: 159, 18: 159, 19: 155, 20: 129, 21: 125, 22: 104, 24: 98, 23: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19910097122192383  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19910097122192383  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 11.156889915466309  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 11.159209728240967  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20356512069702148  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

pseudo mini batch 2 input nodes size: 76285
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19785737991333008  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19785737991333008  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.23496675491333008  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2350788116455078  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1937422752380371  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3634, 1: 1746, 2: 1416, 3: 1136, 4: 889, 5: 756, 6: 620, 7: 519, 9: 421, 8: 418, 10: 383, 11: 340, 12: 330, 13: 288, 14: 238, 16: 228, 15: 227, 18: 221, 17: 199, 20: 195, 19: 189, 21: 182, 23: 148, 24: 137, 22: 129})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19933366775512695  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19933366775512695  GigaBytes
Max Memory Allocated: 14.726739406585693  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 13.767551898956299  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 13.770220756530762  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2047886848449707  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 3 input nodes size: 43017
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19788789749145508  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19788789749145508  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.21937227249145508  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.21948814392089844  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1822667121887207  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2686, 2: 2373, 3: 1817, 4: 1450, 5: 1185, 6: 932, 7: 757, 8: 659, 25: 546, 9: 515, 10: 439, 11: 336, 12: 303, 13: 244, 14: 225, 15: 204, 16: 144, 17: 135, 18: 119, 19: 98, 21: 76, 20: 72, 22: 65, 23: 61, 24: 55})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18483591079711914  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18483591079711914  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 7.287970066070557  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 7.290640830993652  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18703317642211914  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 4 input nodes size: 47174
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1847705841064453  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1847705841064453  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2082080841064453  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20831775665283203  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18671751022338867  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2241, 2: 2017, 3: 1662, 4: 1298, 5: 1027, 25: 900, 6: 815, 7: 666, 8: 581, 9: 516, 10: 441, 11: 402, 12: 347, 13: 284, 14: 229, 15: 218, 16: 168, 17: 160, 18: 142, 19: 138, 20: 120, 21: 104, 22: 89, 23: 78, 24: 71})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18957805633544922  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18957805633544922  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 8.01542329788208  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 8.017788887023926  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19113922119140625  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 5 input nodes size: 36311
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18860769271850586  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18860769271850586  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20618581771850586  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20630168914794922  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1827545166015625  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1916, 2: 1776, 3: 1546, 4: 1280, 25: 1277, 5: 1089, 6: 906, 7: 805, 8: 661, 9: 573, 10: 533, 11: 465, 12: 363, 13: 339, 14: 309, 15: 248, 17: 234, 16: 219, 20: 182, 18: 176, 19: 149, 21: 147, 22: 100, 23: 100, 24: 98})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18587207794189453  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18587207794189453  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 9.152193546295166  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 9.155028343200684  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18847179412841797  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18847179412841797  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.15541744232177734  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10445861021677653 |0.006552577018737793 |0.19840447107950845 |0.0001417398452758789 |0.43621806303660077 |0.0051403045654296875 |
----------------------------------------------------------pseudo_mini_loss sum 18.27118682861328
Total (block generation + training)time/epoch 51.49840974807739
Training time/epoch 4.663608551025391
Training time without block to device /epoch 4.624293088912964
Training time without total dataloading part /epoch 3.8137259483337402
load block tensor time/epoch 0.6267516613006592
block to device time/epoch 0.03931546211242676
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  568757
Number of first layer input nodes during this epoch:  355213
Number of first layer output nodes during this epoch:  213544
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.14066028594970703  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.489 seconds, peak memory: 40.401 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.401 GB
Metis partitioning: 5.058 seconds, peak memory: 40.401 GB
Split the graph: 9.656 seconds
Construct subgraphs: 0.013 seconds
REG metis partition end ----................................
REG construction  time spent:  23.499179363250732
pure dgl.metis_partition the time spent:  16.24348211288452
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7419474124908447

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.45991849899292

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.14066028594970703  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

connection checking time:  1.406371831893921
block generation total time  2.2018659114837646
average batch blocks generation time:  0.36697765191396076
block dataloader generation time/epoch 45.57010968526205
pseudo mini batch 0 input nodes size: 44232
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.13827848434448242  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.13827848434448242  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.15976285934448242  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.15987825393676758  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.14218425750732422  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2475, 2: 2203, 3: 1744, 4: 1397, 5: 1161, 6: 909, 7: 778, 25: 714, 8: 689, 9: 527, 10: 477, 11: 395, 12: 330, 13: 267, 14: 225, 15: 212, 16: 173, 17: 147, 18: 132, 19: 125, 20: 101, 21: 82, 22: 82, 23: 71, 24: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.14495325088500977  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.14495325088500977  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 7.78567361831665  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 7.788146495819092  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17707204818725586  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 1 input nodes size: 36076
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17464685440063477  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17464685440063477  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19222497940063477  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19234085083007812  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17074108123779297  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1849, 2: 1702, 3: 1517, 25: 1420, 4: 1242, 5: 1076, 6: 914, 7: 789, 8: 662, 9: 561, 10: 529, 11: 468, 12: 380, 13: 340, 14: 309, 15: 258, 17: 249, 16: 220, 20: 188, 18: 186, 21: 160, 19: 156, 23: 113, 24: 109, 22: 103})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1739521026611328  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1739521026611328  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 9.481375694274902  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 9.483848094940186  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17629718780517578  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 2 input nodes size: 56366
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1738734245300293  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1738734245300293  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20075082778930664  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2008662223815918  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18317222595214844  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2293, 2: 2107, 3: 1703, 4: 1398, 5: 1157, 25: 944, 6: 897, 7: 752, 8: 627, 9: 553, 10: 453, 11: 387, 12: 353, 13: 293, 14: 268, 15: 242, 16: 178, 17: 164, 18: 141, 20: 118, 19: 115, 21: 102, 22: 98, 24: 72, 23: 68})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18627691268920898  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18627691268920898  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 8.4974946975708  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 8.499967098236084  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18863630294799805  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 3 input nodes size: 70732
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18576335906982422  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18576335906982422  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.21949100494384766  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.21960210800170898  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19260931015014648  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2887, 2: 2376, 3: 1807, 4: 1346, 5: 1115, 6: 853, 7: 616, 25: 599, 8: 580, 9: 470, 10: 357, 11: 274, 12: 245, 13: 237, 14: 188, 15: 150, 16: 135, 18: 116, 17: 111, 19: 90, 20: 84, 21: 65, 23: 55, 24: 49, 22: 45})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19558429718017578  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19558429718017578  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 7.446613788604736  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 7.449006080627441  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19832324981689453  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 4 input nodes size: 89807
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19501018524169922  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19501018524169922  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.23783349990844727  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.23794317245483398  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20410442352294922  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2245, 1: 2183, 2: 1886, 3: 1379, 4: 1012, 5: 953, 6: 706, 7: 587, 8: 473, 9: 425, 10: 393, 11: 318, 12: 303, 13: 241, 14: 209, 15: 192, 16: 184, 18: 170, 17: 161, 19: 154, 20: 129, 21: 126, 24: 106, 22: 105, 23: 74})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2090764045715332  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2090764045715332  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 11.523984909057617  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 11.526339054107666  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.21312475204467773  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 5 input nodes size: 78990
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20710515975952148  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20710515975952148  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.24477052688598633  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.24488210678100586  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2019491195678711  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3538, 1: 1741, 2: 1432, 3: 1127, 4: 925, 5: 760, 6: 589, 7: 523, 8: 441, 9: 440, 10: 390, 11: 361, 12: 326, 13: 278, 15: 235, 14: 235, 16: 221, 18: 203, 17: 198, 19: 196, 20: 187, 21: 182, 23: 138, 24: 129, 22: 123})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20847082138061523  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20847082138061523  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 13.671496391296387  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 13.673800945281982  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2130579948425293  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2130579948425293  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18000364303588867  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10662353038787842 |0.004881699879964192 |0.19649891058603922 |0.00014110406239827475 |0.4375929832458496 |0.0051462650299072266 |
----------------------------------------------------------pseudo_mini_loss sum 8.55971622467041
Total (block generation + training)time/epoch 50.57851449648539
Training time/epoch 4.648539066314697
Training time without block to device /epoch 4.619248867034912
Training time without total dataloading part /epoch 3.81054425239563
load block tensor time/epoch 0.6397411823272705
block to device time/epoch 0.029290199279785156
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  597684
Number of first layer input nodes during this epoch:  376203
Number of first layer output nodes during this epoch:  221481
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.16627216339111328  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.452 seconds, peak memory: 40.673 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.673 GB
Metis partitioning: 5.050 seconds, peak memory: 40.673 GB
Split the graph: 9.166 seconds
Construct subgraphs: 0.029 seconds
REG metis partition end ----................................
REG construction  time spent:  23.769104719161987
pure dgl.metis_partition the time spent:  15.724478721618652
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7260463237762451

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4809770584106445

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.16627216339111328  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

connection checking time:  1.3626656532287598
block generation total time  2.2070233821868896
average batch blocks generation time:  0.3678372303644816
block dataloader generation time/epoch 45.11013853549957
pseudo mini batch 0 input nodes size: 42370
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.15919733047485352  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.15919733047485352  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17940092086791992  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17951679229736328  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1417398452758789  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2566, 2: 2355, 3: 1854, 4: 1437, 5: 1155, 6: 935, 7: 784, 8: 663, 25: 626, 9: 503, 10: 446, 11: 373, 12: 315, 13: 249, 14: 213, 15: 203, 16: 157, 17: 129, 18: 118, 19: 104, 20: 85, 21: 79, 22: 75, 23: 67, 24: 59})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1443958282470703  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1443958282470703  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 7.4659953117370605  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 7.468525409698486  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17563486099243164  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 1 input nodes size: 55919
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17329740524291992  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17329740524291992  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19996166229248047  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20007658004760742  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17975711822509766  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2296, 2: 2025, 3: 1646, 4: 1331, 25: 1105, 5: 1073, 6: 859, 7: 709, 8: 626, 9: 555, 10: 461, 11: 380, 12: 359, 13: 303, 14: 260, 15: 236, 17: 179, 16: 174, 18: 158, 19: 138, 20: 125, 21: 111, 22: 100, 24: 77, 23: 76})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1829371452331543  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1829371452331543  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 8.747570514678955  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 8.74998950958252  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1853032112121582  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 2 input nodes size: 36725
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1824016571044922  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1824016571044922  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1999797821044922  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20009517669677734  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17331600189208984  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1862, 2: 1693, 3: 1526, 25: 1335, 4: 1230, 5: 1099, 6: 917, 7: 789, 8: 678, 9: 580, 10: 548, 11: 475, 12: 367, 13: 332, 14: 318, 15: 255, 17: 243, 16: 230, 20: 186, 18: 182, 21: 154, 19: 153, 24: 105, 23: 103, 22: 102})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1764836311340332  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1764836311340332  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 9.334269523620605  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 9.33666181564331  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17936468124389648  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 3 input nodes size: 64912
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17695856094360352  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17695856094360352  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20791101455688477  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2080221176147461  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19032859802246094  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2703, 2: 2243, 3: 1745, 4: 1411, 5: 1196, 6: 865, 7: 663, 25: 626, 8: 590, 9: 502, 10: 385, 11: 289, 12: 263, 13: 262, 14: 205, 15: 166, 16: 151, 18: 119, 17: 117, 19: 95, 20: 79, 21: 66, 23: 57, 24: 51, 22: 49})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19323301315307617  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19323301315307617  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 7.540821075439453  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 7.543209552764893  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19493627548217773  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 4 input nodes size: 87691
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19187641143798828  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19187641143798828  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.23369073867797852  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.23380041122436523  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20273685455322266  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2272, 1: 2186, 2: 1929, 3: 1369, 4: 1021, 5: 924, 6: 694, 7: 566, 8: 483, 9: 432, 10: 362, 11: 346, 12: 297, 13: 228, 15: 197, 14: 197, 16: 178, 18: 162, 17: 160, 19: 155, 20: 142, 21: 124, 22: 111, 24: 107, 23: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2084808349609375  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2084808349609375  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 11.482961177825928  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 11.485158920288086  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.21267414093017578  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 5 input nodes size: 76555
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20594215393066406  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20594215393066406  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.24305152893066406  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2431631088256836  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20123910903930664  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3496, 1: 1815, 2: 1461, 3: 1137, 4: 890, 5: 775, 6: 598, 7: 534, 8: 432, 9: 404, 10: 397, 11: 340, 12: 336, 13: 282, 14: 241, 15: 232, 16: 221, 18: 209, 17: 202, 19: 191, 20: 190, 21: 183, 23: 144, 24: 126, 22: 119})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20674610137939453  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20674610137939453  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 13.512661457061768  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 13.515286445617676  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.21169185638427734  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.21169185638427734  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17863750457763672  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10654640197753906 |0.004648645718892415 |0.1966398557027181 |0.00014964739481608072 |0.435613473256429 |0.005125761032104492 |
----------------------------------------------------------pseudo_mini_loss sum 4.738823413848877
Total (block generation + training)time/epoch 50.02401065826416
Training time/epoch 4.629971504211426
Training time without block to device /epoch 4.602079629898071
Training time without total dataloading part /epoch 3.799543619155884
load block tensor time/epoch 0.6392784118652344
block to device time/epoch 0.027891874313354492
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  580672
Number of first layer input nodes during this epoch:  364172
Number of first layer output nodes during this epoch:  216500
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1649036407470703  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.457 seconds, peak memory: 40.673 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.673 GB
Metis partitioning: 5.007 seconds, peak memory: 40.673 GB
Split the graph: 9.890 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  24.883808851242065
pure dgl.metis_partition the time spent:  16.38903284072876
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7325577735900879

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4396946430206299

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1649036407470703  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

connection checking time:  1.3690557479858398
block generation total time  2.1722524166107178
average batch blocks generation time:  0.36204206943511963
block dataloader generation time/epoch 45.182415676116946
pseudo mini batch 0 input nodes size: 43665
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.15890121459960938  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.15890121459960938  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18038558959960938  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18050098419189453  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.143280029296875  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2446, 2: 2248, 3: 1755, 4: 1453, 5: 1167, 6: 929, 7: 761, 8: 686, 25: 645, 9: 549, 10: 468, 11: 376, 12: 306, 13: 272, 14: 230, 15: 217, 16: 175, 17: 137, 18: 123, 19: 111, 20: 96, 21: 82, 22: 80, 23: 73, 24: 54})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.14598894119262695  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.14598894119262695  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 7.638566970825195  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 7.640875816345215  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17680120468139648  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 1 input nodes size: 52912
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17442941665649414  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17442941665649414  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1996598243713379  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19977331161499023  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17817354202270508  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2318, 2: 2092, 3: 1723, 4: 1325, 5: 1066, 25: 1014, 6: 857, 7: 696, 8: 625, 9: 516, 10: 442, 11: 371, 12: 370, 13: 267, 14: 233, 15: 220, 17: 169, 16: 167, 18: 138, 19: 131, 21: 109, 22: 98, 20: 98, 24: 77, 23: 67})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1811847686767578  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1811847686767578  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 8.348726749420166  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 8.351035118103027  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18383026123046875  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 2 input nodes size: 36793
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18111181259155273  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18111181259155273  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19868993759155273  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1988053321838379  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1734614372253418  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1920, 2: 1726, 3: 1537, 25: 1311, 4: 1242, 5: 1081, 6: 918, 7: 796, 8: 664, 9: 574, 10: 532, 11: 471, 12: 369, 13: 336, 14: 310, 15: 251, 17: 241, 16: 228, 20: 188, 18: 182, 19: 151, 21: 150, 23: 105, 24: 103, 22: 98})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.176605224609375  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.176605224609375  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 9.256460189819336  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 9.259581089019775  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.17942237854003906  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 3 input nodes size: 61173
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1770334243774414  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.1770334243774414  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.2063302993774414  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.20644187927246094  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.18874835968017578  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2718, 2: 2263, 3: 1776, 4: 1349, 5: 1182, 6: 821, 7: 676, 25: 670, 8: 572, 9: 475, 10: 384, 11: 296, 12: 267, 13: 252, 14: 210, 15: 179, 16: 151, 17: 133, 18: 128, 20: 103, 19: 92, 21: 60, 23: 56, 24: 52, 22: 50})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19161176681518555  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.18310546875 GB
    Memory Allocated: 0.19161176681518555  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.23974609375 GB
    Memory Allocated: 7.523772239685059  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.23974609375 GB
    Memory Allocated: 7.526351451873779  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.23974609375 GB
    Memory Allocated: 0.19330930709838867  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

pseudo mini batch 4 input nodes size: 76573
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.23974609375 GB
    Memory Allocated: 0.19037818908691406  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.23974609375 GB
    Memory Allocated: 0.19037818908691406  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.23974609375 GB
    Memory Allocated: 0.22748756408691406  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.23974609375 GB
    Memory Allocated: 0.2275996208190918  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.23974609375 GB
    Memory Allocated: 0.19819116592407227  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3653, 1: 1686, 2: 1395, 3: 1117, 4: 887, 5: 774, 6: 625, 7: 521, 9: 445, 8: 435, 10: 394, 11: 353, 12: 335, 13: 289, 14: 248, 15: 228, 16: 226, 18: 212, 17: 198, 19: 196, 20: 194, 21: 190, 23: 146, 24: 137, 22: 128})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.23974609375 GB
    Memory Allocated: 0.2047743797302246  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.23974609375 GB
    Memory Allocated: 0.2047743797302246  GigaBytes
Max Memory Allocated: 14.751777648925781  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.91162109375 GB
    Memory Allocated: 13.932321548461914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.91162109375 GB
    Memory Allocated: 13.934793949127197  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.20951032638549805  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 5 input nodes size: 85830
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.20244932174682617  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.20244932174682617  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.2433762550354004  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.24348735809326172  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.20626592636108398  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2340, 25: 2167, 2: 1982, 3: 1369, 4: 1064, 5: 952, 6: 718, 7: 595, 8: 490, 9: 417, 10: 379, 11: 336, 12: 290, 13: 240, 14: 203, 15: 194, 18: 165, 16: 164, 19: 155, 17: 152, 20: 128, 21: 126, 24: 102, 22: 102, 23: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.21105194091796875  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.21105194091796875  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 11.205031871795654  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 11.207588195800781  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.2160348892211914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.2160348892211914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.18298053741455078  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10707485675811768 |0.004836479822794597 |0.1961198647816976 |0.0001248915990193685 |0.43586277961730957 |0.0017185211181640625 |
----------------------------------------------------------pseudo_mini_loss sum 4.327967166900635
Total (block generation + training)time/epoch 50.037738990783694
Training time/epoch 4.620896816253662
Training time without block to device /epoch 4.5918779373168945
Training time without total dataloading part /epoch 3.7943637371063232
load block tensor time/epoch 0.642449140548706
block to device time/epoch 0.029018878936767578
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  570319
Number of first layer input nodes during this epoch:  356946
Number of first layer output nodes during this epoch:  213373
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.1683955192565918  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.438 seconds, peak memory: 41.035 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 41.035 GB
Metis partitioning: 4.998 seconds, peak memory: 41.755 GB
Split the graph: 9.378 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  26.048792362213135
pure dgl.metis_partition the time spent:  15.865757703781128
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7367608547210693

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4387853145599365

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.1683955192565918  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

connection checking time:  1.4185850620269775
block generation total time  2.175546169281006
average batch blocks generation time:  0.362591028213501
block dataloader generation time/epoch 45.348487893740334
pseudo mini batch 0 input nodes size: 68084
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.16212749481201172  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.16212749481201172  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.19459247589111328  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.1947031021118164  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.15366506576538086  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2740, 2: 2341, 3: 1748, 4: 1396, 5: 1173, 6: 839, 7: 668, 25: 647, 8: 576, 9: 464, 10: 366, 11: 278, 12: 255, 13: 229, 14: 180, 15: 161, 16: 139, 18: 115, 17: 112, 19: 97, 20: 88, 24: 56, 23: 54, 21: 53, 22: 52})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.1566014289855957  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58349609375 GB
    Memory Allocated: 0.1566014289855957  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.430658340454102  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.432913780212402  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18831157684326172  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 1 input nodes size: 90940
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18513774871826172  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18513774871826172  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2285013198852539  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.22861099243164062  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19603538513183594  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2230, 1: 2191, 2: 1889, 3: 1365, 4: 1024, 5: 921, 6: 711, 7: 578, 8: 487, 9: 416, 10: 382, 11: 355, 12: 299, 13: 239, 14: 213, 15: 201, 16: 177, 18: 175, 17: 160, 19: 145, 21: 137, 20: 132, 24: 105, 22: 102, 23: 80})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20102262496948242  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20102262496948242  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 11.496564865112305  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 11.498819828033447  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2052931785583496  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 2 input nodes size: 81406
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19924259185791016  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19924259185791016  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.23805999755859375  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.23817157745361328  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19469833374023438  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3604, 1: 1730, 2: 1413, 3: 1144, 4: 858, 5: 774, 6: 634, 7: 508, 8: 435, 9: 429, 10: 387, 11: 342, 12: 336, 13: 276, 14: 249, 15: 232, 16: 224, 18: 204, 17: 199, 19: 197, 20: 191, 21: 189, 23: 140, 22: 129, 24: 127})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20076799392700195  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20076799392700195  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 13.867598056793213  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 13.870497703552246  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20650911331176758  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 3 input nodes size: 40348
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19898414611816406  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19898414611816406  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21851539611816406  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21863079071044922  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1797018051147461  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2493, 2: 2237, 3: 1843, 4: 1444, 5: 1212, 6: 921, 7: 775, 8: 686, 25: 546, 9: 535, 10: 458, 11: 371, 12: 317, 13: 287, 14: 237, 15: 211, 16: 167, 17: 136, 18: 120, 19: 112, 20: 88, 21: 78, 22: 72, 24: 57, 23: 52})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18230581283569336  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18230581283569336  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.450296878814697  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.4526567459106445  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18456315994262695  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 4 input nodes size: 38471
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18231678009033203  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18231678009033203  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20066118240356445  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2007761001586914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18112945556640625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2067, 2: 1846, 3: 1549, 25: 1377, 4: 1235, 5: 1057, 6: 846, 7: 735, 8: 635, 9: 556, 10: 496, 11: 408, 12: 355, 13: 320, 14: 286, 15: 248, 17: 233, 16: 209, 18: 170, 20: 160, 21: 159, 19: 149, 23: 104, 24: 94, 22: 90})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18428850173950195  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18428850173950195  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.19798231124878  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.200485229492188  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18645429611206055  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 5 input nodes size: 57024
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18394899368286133  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18394899368286133  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21114015579223633  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2112565040588379  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19279718399047852  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2207, 2: 1980, 3: 1628, 4: 1363, 5: 1085, 25: 1056, 6: 917, 7: 781, 8: 653, 9: 576, 10: 510, 11: 449, 12: 375, 13: 305, 14: 269, 15: 236, 16: 195, 17: 190, 18: 164, 20: 148, 19: 136, 22: 111, 21: 101, 23: 89, 24: 86})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19606733322143555  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19606733322143555  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.024800300598145  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.02722692489624  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1985630989074707  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1985630989074707  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.16550874710083008  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10651818911234538 |0.004943648974100749 |0.19694618384043375 |0.00013860066731770834 |0.4353174368540446 |0.0050923824310302734 |
----------------------------------------------------------pseudo_mini_loss sum 4.8175458908081055
Total (block generation + training)time/epoch 50.165730476379395
Training time/epoch 4.626512765884399
Training time without block to device /epoch 4.596850872039795
Training time without total dataloading part /epoch 3.7995057106018066
load block tensor time/epoch 0.6391091346740723
block to device time/epoch 0.029661893844604492
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  598273
Number of first layer input nodes during this epoch:  376273
Number of first layer output nodes during this epoch:  222000
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.15053224563598633  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.466 seconds, peak memory: 41.940 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 41.940 GB
Metis partitioning: 4.973 seconds, peak memory: 41.940 GB
Split the graph: 9.438 seconds
Construct subgraphs: 0.034 seconds
REG metis partition end ----................................
REG construction  time spent:  23.783003568649292
pure dgl.metis_partition the time spent:  15.939288139343262
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7464888095855713

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4842870235443115

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.15053224563598633  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

connection checking time:  1.4437458515167236
block generation total time  2.230775833129883
average batch blocks generation time:  0.3717959721883138
block dataloader generation time/epoch 45.16689607075283
pseudo mini batch 0 input nodes size: 69684
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14753961563110352  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14753961563110352  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18076753616333008  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1808786392211914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.15357112884521484  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2865, 2: 2384, 3: 1797, 4: 1367, 5: 1189, 6: 805, 7: 658, 8: 579, 25: 563, 9: 473, 10: 367, 11: 285, 12: 251, 13: 241, 14: 185, 15: 149, 16: 129, 17: 110, 18: 103, 20: 82, 19: 78, 21: 60, 22: 49, 23: 47, 24: 43})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.15644502639770508  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.15644502639770508  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.262947082519531  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.265313148498535  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18906879425048828  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 1 input nodes size: 87403
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1859288215637207  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1859288215637207  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.22760581970214844  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.22771549224853516  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19437646865844727  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2254, 1: 2202, 2: 1839, 3: 1384, 4: 1017, 5: 942, 6: 739, 7: 599, 8: 512, 9: 403, 10: 364, 11: 358, 12: 286, 13: 220, 15: 209, 14: 204, 16: 170, 18: 161, 19: 159, 17: 153, 21: 131, 20: 126, 24: 105, 22: 99, 23: 78})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20034027099609375  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20034027099609375  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 11.453381538391113  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 11.455716609954834  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2045116424560547  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 2 input nodes size: 79008
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19754934310913086  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19754934310913086  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.23522329330444336  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.23533344268798828  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19354677200317383  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3503, 1: 1737, 2: 1441, 3: 1131, 4: 880, 5: 755, 6: 598, 7: 500, 8: 432, 9: 407, 10: 397, 12: 333, 11: 332, 13: 287, 14: 237, 16: 232, 15: 216, 18: 209, 17: 197, 20: 193, 19: 188, 21: 178, 23: 134, 24: 130, 22: 121})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20003938674926758  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20003938674926758  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 13.543532848358154  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 13.545806884765625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20575809478759766  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 3 input nodes size: 43849
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19775867462158203  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19775867462158203  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21924304962158203  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2193589210510254  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18157482147216797  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2485, 2: 2201, 3: 1762, 4: 1433, 5: 1163, 6: 943, 7: 778, 25: 678, 8: 667, 9: 566, 10: 465, 11: 378, 12: 302, 13: 273, 15: 224, 14: 222, 16: 163, 17: 146, 18: 141, 19: 125, 20: 111, 21: 85, 22: 79, 23: 71, 24: 61})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1843414306640625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1843414306640625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.792524337768555  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.794837951660156  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18700742721557617  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 4 input nodes size: 60994
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18457269668579102  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18457269668579102  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21386957168579102  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21398544311523438  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19238519668579102  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2155, 2: 2083, 3: 1652, 4: 1371, 25: 1158, 5: 1101, 6: 862, 7: 720, 8: 623, 9: 561, 10: 469, 12: 405, 11: 372, 13: 305, 14: 279, 15: 238, 16: 193, 17: 182, 18: 160, 19: 138, 21: 117, 20: 114, 22: 112, 23: 90, 24: 84})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19576215744018555  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19576215744018555  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.119272708892822  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.122004508972168  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1981968879699707  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 5 input nodes size: 36690
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19500064849853516  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19500064849853516  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21257877349853516  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21269464492797852  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18328189849853516  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1984, 2: 1758, 3: 1551, 25: 1304, 4: 1252, 5: 1072, 6: 921, 7: 790, 8: 659, 9: 566, 10: 537, 11: 478, 12: 360, 13: 330, 14: 307, 15: 253, 17: 242, 16: 224, 20: 181, 18: 174, 19: 148, 21: 146, 24: 102, 23: 99, 22: 96})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18641185760498047  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18641185760498047  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.231257915496826  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.233989715576172  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18923187255859375  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18923187255859375  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.15617752075195312  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10811078548431396 |0.005590399106343587 |0.1986027956008911 |0.00014328956604003906 |0.43701159954071045 |0.005160808563232422 |
----------------------------------------------------------pseudo_mini_loss sum 5.328709125518799
Total (block generation + training)time/epoch 49.9615569795881
Training time/epoch 4.658722639083862
Training time without block to device /epoch 4.625180244445801
Training time without total dataloading part /epoch 3.819706916809082
load block tensor time/epoch 0.6486647129058838
block to device time/epoch 0.03354239463806152
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  598410
Number of first layer input nodes during this epoch:  377628
Number of first layer output nodes during this epoch:  220782
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14140796661376953  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.440 seconds, peak memory: 41.940 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 41.940 GB
Metis partitioning: 4.996 seconds, peak memory: 41.940 GB
Split the graph: 9.324 seconds
Construct subgraphs: 0.016 seconds
REG metis partition end ----................................
REG construction  time spent:  23.420466423034668
pure dgl.metis_partition the time spent:  15.803658962249756
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7269454002380371

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4206302165985107

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14140796661376953  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

connection checking time:  1.3584773540496826
block generation total time  2.147575616836548
average batch blocks generation time:  0.357929269472758
block dataloader generation time/epoch 44.94891405105591
pseudo mini batch 0 input nodes size: 60700
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.13901996612548828  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.13901996612548828  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.16831684112548828  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.16842985153198242  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.15073585510253906  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2798, 2: 2389, 3: 1873, 4: 1417, 5: 1254, 6: 876, 7: 653, 8: 582, 25: 570, 9: 486, 10: 383, 11: 299, 13: 246, 12: 238, 14: 184, 15: 163, 16: 132, 18: 116, 17: 110, 19: 86, 20: 78, 21: 63, 24: 49, 23: 46, 22: 44})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.15350866317749023  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.15350866317749023  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.237405300140381  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.240217685699463  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18515300750732422  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 1 input nodes size: 87075
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18228864669799805  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18228864669799805  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.22380924224853516  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.22391891479492188  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19450902938842773  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2257, 1: 2226, 2: 1939, 3: 1395, 4: 1021, 5: 915, 6: 713, 7: 571, 8: 501, 9: 414, 10: 369, 11: 332, 12: 299, 13: 221, 14: 200, 15: 195, 16: 165, 18: 164, 17: 155, 19: 151, 20: 127, 21: 113, 22: 103, 24: 98, 23: 70})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19935989379882812  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19935989379882812  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 11.31637954711914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 11.318691730499268  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20325565338134766  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 2 input nodes size: 76383
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19744634628295898  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19744634628295898  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.23455572128295898  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.23466777801513672  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1930375099182129  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3545, 1: 1761, 2: 1425, 3: 1125, 4: 921, 5: 783, 6: 615, 7: 510, 8: 428, 9: 426, 10: 399, 11: 352, 12: 335, 13: 288, 14: 239, 16: 231, 15: 230, 18: 209, 17: 209, 19: 194, 20: 192, 21: 189, 23: 147, 24: 135, 22: 126})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19858503341674805  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19858503341674805  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 13.64646291732788  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 13.648714065551758  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2030940055847168  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 3 input nodes size: 42537
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19708490371704102  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19708490371704102  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21736812591552734  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2174835205078125  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18026208877563477  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2493, 2: 2232, 3: 1719, 4: 1392, 5: 1157, 6: 901, 7: 789, 25: 713, 8: 673, 9: 534, 10: 464, 11: 367, 12: 322, 13: 267, 14: 241, 15: 213, 16: 168, 17: 139, 18: 125, 19: 122, 20: 98, 21: 84, 22: 83, 23: 74, 24: 63})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18298912048339844  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18298912048339844  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.737053394317627  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.739571571350098  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18531227111816406  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 4 input nodes size: 54447
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1829543113708496  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1829543113708496  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20891666412353516  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2090301513671875  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18863153457641602  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2252, 2: 1995, 3: 1643, 4: 1313, 25: 1055, 5: 1044, 6: 845, 7: 727, 8: 622, 9: 549, 10: 446, 11: 376, 12: 373, 13: 303, 14: 263, 15: 227, 16: 186, 17: 176, 18: 152, 19: 129, 20: 129, 21: 113, 22: 100, 23: 79, 24: 76})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19174957275390625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19174957275390625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 8.590227127075195  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 8.593058109283447  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19408035278320312  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 5 input nodes size: 36819
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19125080108642578  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19125080108642578  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20882892608642578  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20894432067871094  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18286848068237305  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1898, 2: 1726, 3: 1522, 25: 1320, 4: 1256, 5: 1069, 6: 918, 7: 795, 8: 666, 9: 567, 10: 538, 11: 477, 12: 370, 13: 331, 14: 307, 15: 261, 17: 241, 16: 229, 20: 183, 18: 182, 21: 155, 19: 154, 24: 104, 23: 103, 22: 100})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18602561950683594  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18602561950683594  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.298357486724854  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.30073070526123  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18892860412597656  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18892860412597656  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.15587425231933594  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1071612040201823 |0.004666646321614583 |0.19193633397420248 |0.0001266002655029297 |0.436753511428833 |0.004831075668334961 |
----------------------------------------------------------pseudo_mini_loss sum 4.754676818847656
Total (block generation + training)time/epoch 49.71958750486374
Training time/epoch 4.602491617202759
Training time without block to device /epoch 4.574491739273071
Training time without total dataloading part /epoch 3.7777297496795654
load block tensor time/epoch 0.6429672241210938
block to device time/epoch 0.0279998779296875
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  571849
Number of first layer input nodes during this epoch:  357961
Number of first layer output nodes during this epoch:  213888
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1411590576171875  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.625 seconds, peak memory: 42.048 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.048 GB
Metis partitioning: 5.573 seconds, peak memory: 42.048 GB
Split the graph: 9.617 seconds
Construct subgraphs: 0.038 seconds
REG metis partition end ----................................
REG construction  time spent:  24.133222341537476
pure dgl.metis_partition the time spent:  16.902769565582275
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.73128342628479

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4442298412322998

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1411590576171875  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

connection checking time:  1.394606590270996
block generation total time  2.17551326751709
average batch blocks generation time:  0.36258554458618164
block dataloader generation time/epoch 44.991592751608955
pseudo mini batch 0 input nodes size: 44938
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.13875389099121094  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.13875389099121094  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.16023826599121094  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1603541374206543  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14266061782836914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2454, 2: 2306, 3: 1780, 4: 1456, 5: 1194, 6: 932, 7: 790, 8: 682, 25: 623, 9: 537, 10: 431, 11: 354, 12: 318, 13: 265, 14: 244, 15: 220, 16: 165, 17: 146, 18: 129, 19: 104, 20: 90, 21: 86, 23: 77, 22: 73, 24: 56})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1453871726989746  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1453871726989746  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.639045238494873  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.642008304595947  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17685270309448242  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 1 input nodes size: 55118
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17442560195922852  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17442560195922852  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20070791244506836  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20082426071166992  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17922401428222656  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2285, 2: 2038, 3: 1641, 4: 1328, 25: 1187, 5: 1041, 6: 851, 7: 711, 8: 633, 9: 558, 10: 474, 11: 416, 12: 378, 13: 319, 14: 261, 15: 257, 16: 199, 17: 186, 18: 158, 19: 152, 20: 128, 21: 120, 22: 108, 24: 83, 23: 81})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18249988555908203  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18249988555908203  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.03957748413086  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.042442798614502  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1851482391357422  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 2 input nodes size: 36137
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1821913719177246  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1821913719177246  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1997694969177246  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19988536834716797  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17348670959472656  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1917, 2: 1737, 3: 1569, 25: 1295, 4: 1255, 5: 1107, 6: 932, 7: 807, 8: 661, 9: 571, 10: 535, 11: 461, 12: 357, 13: 333, 14: 307, 15: 246, 17: 235, 16: 233, 20: 184, 18: 177, 21: 151, 19: 144, 23: 104, 24: 103, 22: 100})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17661190032958984  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17661190032958984  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.225121974945068  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.227537155151367  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17925453186035156  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 3 input nodes size: 69726
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1768813133239746  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1768813133239746  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2101292610168457  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21023941040039062  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19254541397094727  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2799, 2: 2289, 3: 1747, 4: 1357, 5: 1166, 6: 834, 7: 642, 8: 594, 25: 588, 9: 449, 10: 406, 11: 289, 12: 260, 13: 237, 14: 192, 15: 149, 16: 133, 17: 112, 18: 108, 19: 95, 20: 89, 21: 58, 24: 47, 22: 46, 23: 43})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19544458389282227  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19544458389282227  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.360785961151123  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.363185882568359  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19735193252563477  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 4 input nodes size: 84760
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19419574737548828  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19419574737548828  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.23461246490478516  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.23472213745117188  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20136404037475586  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2290, 25: 2181, 2: 1920, 3: 1380, 4: 1050, 5: 920, 6: 709, 7: 590, 8: 469, 9: 433, 10: 372, 11: 337, 12: 285, 13: 223, 15: 193, 14: 188, 18: 167, 16: 163, 19: 158, 17: 157, 20: 123, 21: 117, 22: 108, 24: 106, 23: 75})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2061309814453125  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2061309814453125  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 11.131783485412598  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 11.134027004241943  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2102375030517578  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 5 input nodes size: 76843
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2045578956604004  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2045578956604004  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2416672706604004  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.24177837371826172  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20125198364257812  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3586, 1: 1683, 2: 1416, 3: 1160, 4: 874, 5: 794, 6: 610, 7: 505, 8: 433, 9: 428, 10: 381, 11: 346, 12: 339, 13: 279, 14: 242, 15: 224, 16: 218, 18: 209, 17: 194, 20: 193, 21: 185, 19: 183, 23: 139, 24: 130, 22: 121})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20778512954711914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20778512954711914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 13.679254055023193  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 13.68150520324707  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21250486373901367  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21250486373901367  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17945051193237305  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10601870218912761 |0.005794922510782878 |0.1930339733759562 |0.00012902418772379556 |0.4377098083496094 |0.0049571990966796875 |
----------------------------------------------------------pseudo_mini_loss sum 5.935856819152832
Total (block generation + training)time/epoch 49.746022674772476
Training time/epoch 4.6241137981414795
Training time without block to device /epoch 4.589344263076782
Training time without total dataloading part /epoch 3.790194034576416
load block tensor time/epoch 0.6361122131347656
block to device time/epoch 0.034769535064697266
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  584129
Number of first layer input nodes during this epoch:  367522
Number of first layer output nodes during this epoch:  216607
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1657567024230957  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.474 seconds, peak memory: 42.048 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.048 GB
Metis partitioning: 4.986 seconds, peak memory: 42.048 GB
Split the graph: 9.009 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  25.59318733215332
pure dgl.metis_partition the time spent:  15.51568078994751
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7386515140533447

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4101402759552002

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1657567024230957  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

connection checking time:  1.394045114517212
block generation total time  2.148791790008545
average batch blocks generation time:  0.35813196500142414
block dataloader generation time/epoch 45.02850329875946
pseudo mini batch 0 input nodes size: 68891
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1587233543395996  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1587233543395996  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1915731430053711  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19168376922607422  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1544632911682129  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2891, 2: 2337, 3: 1774, 4: 1388, 5: 1168, 6: 836, 7: 619, 8: 577, 25: 567, 9: 462, 10: 373, 11: 288, 12: 247, 13: 232, 14: 185, 15: 142, 16: 136, 17: 111, 18: 104, 19: 95, 20: 82, 21: 52, 23: 44, 22: 43, 24: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.15732049942016602  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.15732049942016602  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.207485675811768  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.209859371185303  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18853521347045898  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 1 input nodes size: 79734
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18541765213012695  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18541765213012695  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.22343778610229492  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.22354936599731445  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19058895111083984  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3524, 1: 1743, 2: 1432, 3: 1131, 4: 911, 5: 776, 6: 618, 7: 499, 8: 439, 9: 428, 10: 386, 12: 338, 11: 337, 13: 297, 14: 241, 15: 229, 16: 218, 18: 207, 17: 198, 19: 194, 20: 188, 21: 187, 23: 137, 24: 134, 22: 123})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19710683822631836  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19710683822631836  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 13.670006275177002  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 13.672234535217285  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20271635055541992  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 2 input nodes size: 89815
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19471406936645508  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19471406936645508  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.23754119873046875  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.23765087127685547  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19951915740966797  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2270, 1: 2153, 2: 1893, 3: 1359, 4: 1026, 5: 921, 6: 704, 7: 593, 8: 484, 9: 431, 10: 381, 11: 362, 12: 302, 13: 233, 15: 202, 14: 191, 16: 177, 18: 170, 17: 157, 19: 150, 21: 131, 20: 129, 24: 109, 22: 107, 23: 79})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20549631118774414  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20549631118774414  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 11.567090511322021  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 11.569303512573242  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2097620964050293  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 3 input nodes size: 45570
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20273208618164062  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20273208618164062  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.22446155548095703  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2245769500732422  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1816401481628418  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2555, 2: 2308, 3: 1798, 4: 1426, 5: 1212, 6: 937, 7: 783, 8: 647, 25: 627, 9: 530, 10: 441, 11: 326, 12: 303, 13: 255, 14: 231, 15: 207, 16: 145, 17: 142, 18: 127, 19: 108, 20: 88, 22: 79, 21: 79, 23: 70, 24: 59})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1843414306640625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1843414306640625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.56203556060791  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.564504146575928  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18658828735351562  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 4 input nodes size: 36942
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18416833877563477  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18416833877563477  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2017836570739746  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20189905166625977  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1800541877746582  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1882, 2: 1744, 3: 1552, 25: 1313, 4: 1238, 5: 1085, 6: 927, 7: 810, 8: 661, 9: 569, 10: 528, 11: 470, 12: 358, 13: 333, 14: 312, 15: 251, 17: 239, 16: 234, 20: 190, 18: 183, 21: 150, 19: 148, 23: 104, 24: 102, 22: 97})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1832132339477539  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1832132339477539  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.305168628692627  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.30751895904541  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18549537658691406  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 5 input nodes size: 53689
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18307113647460938  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18307113647460938  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20867204666137695  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20878839492797852  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19105768203735352  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2204, 2: 1992, 3: 1663, 4: 1331, 25: 1159, 5: 1060, 6: 846, 7: 741, 8: 664, 9: 556, 10: 490, 11: 420, 12: 389, 13: 306, 14: 274, 15: 258, 16: 201, 17: 183, 18: 157, 19: 141, 20: 130, 21: 118, 22: 107, 23: 85, 24: 79})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1943058967590332  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1943058967590332  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.031431198120117  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.034082889556885  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19704294204711914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19704294204711914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.16398859024047852  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10666255156199138 |0.004892309506734212 |0.19892009099324545 |0.00013720989227294922 |0.43813594182332355 |0.005046844482421875 |
----------------------------------------------------------pseudo_mini_loss sum 5.338527679443359
Total (block generation + training)time/epoch 49.773228073120116
Training time/epoch 4.656992197036743
Training time without block to device /epoch 4.627638339996338
Training time without total dataloading part /epoch 3.8282063007354736
load block tensor time/epoch 0.6399753093719482
block to device time/epoch 0.029353857040405273
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  594626
Number of first layer input nodes during this epoch:  374641
Number of first layer output nodes during this epoch:  219985
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1490468978881836  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.469 seconds, peak memory: 42.048 GB
Construct multi-constraint weights: 0.001 seconds, peak memory: 42.048 GB
Metis partitioning: 5.256 seconds, peak memory: 42.048 GB
Split the graph: 11.398 seconds
Construct subgraphs: 0.013 seconds
REG metis partition end ----................................
REG construction  time spent:  23.93338704109192
pure dgl.metis_partition the time spent:  18.16651487350464
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.742293119430542

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4679324626922607

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1490468978881836  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

connection checking time:  1.3935506343841553
block generation total time  2.2102255821228027
average batch blocks generation time:  0.3683709303538005
block dataloader generation time/epoch 45.15418488329107
pseudo mini batch 0 input nodes size: 52101
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14614439010620117  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14614439010620117  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1714167594909668  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17153310775756836  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14581584930419922  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2092, 2: 1998, 3: 1584, 4: 1350, 25: 1116, 5: 1114, 6: 874, 7: 802, 8: 683, 9: 572, 10: 498, 11: 409, 12: 370, 13: 324, 14: 296, 15: 268, 16: 218, 17: 178, 18: 155, 20: 147, 19: 146, 21: 117, 22: 113, 23: 87, 24: 78})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14909648895263672  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14909648895263672  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.02878189086914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.031285285949707  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18180465698242188  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 1 input nodes size: 45921
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1788625717163086  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1788625717163086  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2007594108581543  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20087480545043945  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17548608779907227  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2760, 2: 2360, 3: 1856, 4: 1456, 5: 1170, 6: 916, 7: 721, 8: 608, 25: 577, 9: 508, 10: 396, 11: 357, 12: 326, 13: 245, 14: 192, 15: 188, 17: 135, 16: 129, 18: 122, 19: 92, 21: 80, 20: 75, 24: 63, 22: 61, 23: 59})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17805099487304688  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17805099487304688  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.243533611297607  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.2458367347717285  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17986488342285156  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 2 input nodes size: 37319
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17759227752685547  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17759227752685547  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1953873634338379  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19550275802612305  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1734905242919922  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1827, 2: 1693, 3: 1533, 25: 1354, 4: 1239, 5: 1087, 6: 931, 7: 795, 8: 662, 9: 569, 10: 554, 11: 477, 12: 371, 13: 338, 14: 315, 15: 259, 17: 242, 16: 237, 20: 187, 18: 184, 21: 156, 19: 146, 23: 108, 24: 105, 22: 102})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17669916152954102  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17669916152954102  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.399976253509521  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.40229606628418  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17936086654663086  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 3 input nodes size: 64829
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1768941879272461  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1768941879272461  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20780706405639648  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2079176902770996  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19000720977783203  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2894, 2: 2412, 3: 1837, 4: 1387, 5: 1157, 6: 813, 7: 609, 8: 595, 25: 532, 9: 451, 10: 369, 11: 270, 13: 232, 12: 232, 14: 181, 15: 141, 16: 125, 17: 108, 18: 97, 19: 96, 20: 82, 22: 50, 21: 45, 23: 41, 24: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1927642822265625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1927642822265625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.084272861480713  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.086897850036621  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1947193145751953  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 4 input nodes size: 87655
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19175148010253906  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19175148010253906  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.23354864120483398  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2336583137512207  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2026348114013672  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2206, 1: 2173, 2: 1869, 3: 1345, 4: 1031, 5: 927, 6: 719, 7: 604, 8: 509, 9: 448, 10: 390, 11: 335, 12: 303, 13: 221, 14: 211, 15: 211, 18: 173, 16: 171, 17: 162, 19: 162, 21: 129, 20: 124, 24: 108, 22: 108, 23: 75})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2075209617614746  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2075209617614746  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 11.39806079864502  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 11.400331020355225  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21237802505493164  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 5 input nodes size: 78093
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2059178352355957  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2059178352355957  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.24315547943115234  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.24326705932617188  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20136022567749023  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3675, 1: 1682, 2: 1374, 3: 1122, 4: 857, 5: 767, 6: 615, 7: 514, 9: 428, 8: 415, 10: 392, 11: 355, 12: 335, 13: 296, 14: 239, 16: 231, 15: 222, 18: 217, 17: 205, 19: 194, 20: 192, 21: 190, 23: 149, 24: 133, 22: 122})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2075634002685547  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2075634002685547  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 13.928595066070557  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 13.930899620056152  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21227645874023438  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21227645874023438  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17922210693359375  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10601143042246501 |0.005782564481099446 |0.20044716199239096 |0.0001375277837117513 |0.4357045888900757 |0.005242109298706055 |
----------------------------------------------------------pseudo_mini_loss sum 4.544561386108398
Total (block generation + training)time/epoch 49.89162124286998
Training time/epoch 4.664231300354004
Training time without block to device /epoch 4.629535913467407
Training time without total dataloading part /epoch 3.8229777812957764
load block tensor time/epoch 0.63606858253479
block to device time/epoch 0.03469538688659668
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  582665
Number of first layer input nodes during this epoch:  365918
Number of first layer output nodes during this epoch:  216747
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1656022071838379  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.434 seconds, peak memory: 42.048 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.048 GB
Metis partitioning: 5.003 seconds, peak memory: 42.048 GB
Split the graph: 9.784 seconds
Construct subgraphs: 0.024 seconds
REG metis partition end ----................................
REG construction  time spent:  24.782217025756836
pure dgl.metis_partition the time spent:  16.273536205291748
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7251186370849609

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4307124614715576

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1656022071838379  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

connection checking time:  1.393449068069458
block generation total time  2.1558310985565186
average batch blocks generation time:  0.3593051830927531
block dataloader generation time/epoch 45.1682413816452
pseudo mini batch 0 input nodes size: 44619
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.15889883041381836  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.15889883041381836  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18038320541381836  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18049860000610352  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14314937591552734  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2351, 2: 2157, 3: 1728, 4: 1417, 5: 1208, 6: 912, 7: 799, 25: 737, 8: 674, 9: 543, 10: 477, 11: 374, 12: 312, 13: 271, 14: 250, 15: 227, 16: 175, 17: 145, 18: 130, 19: 116, 20: 112, 22: 84, 21: 83, 23: 75, 24: 68})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14596223831176758  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14596223831176758  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.884857654571533  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.887204647064209  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17703866958618164  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 1 input nodes size: 54393
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17456769943237305  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17456769943237305  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20050430297851562  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20061826705932617  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17901849746704102  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2395, 2: 2109, 3: 1675, 4: 1378, 5: 1091, 25: 981, 6: 864, 7: 679, 8: 637, 9: 548, 10: 423, 12: 368, 11: 361, 13: 287, 14: 244, 15: 210, 17: 166, 16: 149, 18: 146, 19: 120, 21: 107, 20: 99, 22: 95, 24: 72, 23: 68})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18203020095825195  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18203020095825195  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 8.33986759185791  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 8.34222936630249  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18431520462036133  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 2 input nodes size: 36390
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18156862258911133  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18156862258911133  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19914674758911133  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19926214218139648  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17321157455444336  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1879, 2: 1738, 3: 1556, 25: 1312, 4: 1249, 5: 1078, 6: 933, 7: 802, 8: 654, 9: 567, 10: 533, 11: 467, 12: 362, 13: 333, 14: 308, 15: 250, 17: 239, 16: 232, 20: 186, 18: 182, 21: 152, 19: 146, 24: 103, 23: 103, 22: 100})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17635154724121094  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17635154724121094  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.250030040740967  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 9.25311279296875  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1793966293334961  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 3 input nodes size: 67102
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17700815200805664  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17700815200805664  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20900487899780273  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20911645889282227  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1914229393005371  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2765, 2: 2333, 3: 1811, 4: 1358, 5: 1107, 6: 823, 7: 665, 25: 646, 8: 614, 9: 478, 10: 374, 11: 311, 12: 283, 13: 238, 14: 189, 15: 160, 16: 148, 18: 114, 17: 111, 19: 106, 20: 97, 21: 65, 23: 56, 22: 54, 24: 51})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19439411163330078  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.19439411163330078  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.567584991455078  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 7.56986665725708  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1961221694946289  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 4 input nodes size: 87369
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1929316520690918  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1929316520690918  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.23459243774414062  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.23470211029052734  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20259380340576172  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2255, 1: 2220, 2: 1891, 3: 1338, 4: 999, 5: 951, 6: 719, 7: 577, 8: 474, 9: 415, 10: 399, 11: 348, 12: 283, 13: 238, 15: 214, 14: 202, 16: 176, 18: 171, 17: 170, 19: 155, 20: 130, 21: 122, 24: 98, 22: 96, 23: 74})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20749616622924805  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20749616622924805  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 11.471159934997559  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 11.47344160079956  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21192407608032227  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 5 input nodes size: 77312
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20582294464111328  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20582294464111328  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.24293231964111328  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.24304533004760742  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.20127487182617188  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3529, 1: 1818, 2: 1478, 3: 1169, 4: 919, 5: 787, 6: 617, 7: 523, 9: 425, 8: 419, 10: 393, 11: 342, 12: 329, 13: 289, 14: 241, 16: 231, 15: 228, 18: 205, 17: 199, 19: 193, 21: 188, 20: 183, 23: 143, 24: 133, 22: 127})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2068190574645996  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.2068190574645996  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 13.608016014099121  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 13.61027479171753  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21150827407836914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.21150827407836914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.17845392227172852  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10659603277842204 |0.005157748858133952 |0.1997671922047933 |0.00012107690175374349 |0.43648771444956463 |0.0039844512939453125 |
----------------------------------------------------------pseudo_mini_loss sum 5.288247108459473
Total (block generation + training)time/epoch 49.89820863803228
Training time/epoch 4.647562742233276
Training time without block to device /epoch 4.616616249084473
Training time without total dataloading part /epoch 3.8222403526306152
load block tensor time/epoch 0.6395761966705322
block to device time/epoch 0.03094649314880371
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  584581
Number of first layer input nodes during this epoch:  367185
Number of first layer output nodes during this epoch:  217396
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.16474676132202148  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.448 seconds, peak memory: 42.048 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.048 GB
Metis partitioning: 4.974 seconds, peak memory: 42.048 GB
Split the graph: 9.578 seconds
Construct subgraphs: 0.029 seconds
REG metis partition end ----................................
REG construction  time spent:  24.402109622955322
pure dgl.metis_partition the time spent:  16.059354782104492
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7416605949401855

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3934400081634521

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.16474676132202148  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

connection checking time:  1.385749101638794
block generation total time  2.1351006031036377
average batch blocks generation time:  0.35585010051727295
block dataloader generation time/epoch 45.12935533890357
pseudo mini batch 0 input nodes size: 43532
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1587204933166504  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1587204933166504  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1802048683166504  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.18031978607177734  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.1430974006652832  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2688, 2: 2437, 3: 1886, 4: 1465, 5: 1192, 6: 938, 7: 765, 8: 593, 25: 529, 9: 496, 10: 420, 11: 330, 12: 278, 13: 242, 14: 199, 15: 191, 16: 132, 17: 124, 18: 112, 19: 96, 20: 73, 21: 62, 22: 61, 23: 57, 24: 57})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14562702178955078  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58740234375 GB
    Memory Allocated: 0.14562702178955078  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.049367904663086  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.051667213439941  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17711448669433594  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 1 input nodes size: 51622
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1748499870300293  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1748499870300293  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19946527481079102  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19958066940307617  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17798137664794922  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2250, 2: 2004, 3: 1630, 4: 1348, 5: 1088, 25: 1073, 6: 862, 7: 748, 8: 700, 9: 546, 10: 481, 11: 404, 12: 382, 13: 298, 14: 273, 15: 230, 16: 189, 17: 175, 18: 147, 19: 130, 21: 125, 20: 119, 22: 118, 23: 83, 24: 77})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18112707138061523  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18112707138061523  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 8.777808666229248  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 8.780220031738281  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18305158615112305  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 2 input nodes size: 36278
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18026113510131836  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18026113510131836  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19783926010131836  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19795465469360352  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17322397232055664  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1906, 2: 1715, 3: 1520, 25: 1317, 4: 1241, 5: 1087, 6: 932, 7: 770, 8: 660, 9: 582, 10: 547, 11: 482, 12: 366, 13: 346, 14: 304, 15: 259, 17: 243, 16: 228, 20: 185, 18: 182, 19: 154, 21: 153, 23: 102, 24: 100, 22: 95})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1763753890991211  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1763753890991211  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 9.311396598815918  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 9.313807964324951  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17936420440673828  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 3 input nodes size: 64291
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17696762084960938  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17696762084960938  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20762395858764648  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2077350616455078  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19004154205322266  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2645, 2: 2234, 3: 1727, 4: 1346, 5: 1155, 6: 839, 25: 744, 7: 661, 8: 595, 9: 495, 10: 387, 11: 297, 12: 285, 13: 244, 14: 202, 15: 183, 16: 161, 17: 130, 18: 130, 19: 106, 20: 105, 21: 68, 23: 56, 24: 54, 22: 44})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19304418563842773  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19304418563842773  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.7519307136535645  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.754433631896973  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1947016716003418  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 4 input nodes size: 77303
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1915583610534668  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1915583610534668  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2286677360534668  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.22877931594848633  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1980118751525879  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3565, 1: 1790, 2: 1423, 3: 1150, 4: 862, 5: 774, 6: 583, 7: 500, 8: 432, 9: 428, 10: 386, 11: 352, 12: 339, 13: 284, 14: 242, 15: 235, 16: 223, 18: 214, 17: 208, 20: 195, 19: 191, 21: 181, 23: 140, 24: 135, 22: 123})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20454883575439453  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20454883575439453  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 13.674962520599365  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 13.677206039428711  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.21008777618408203  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 5 input nodes size: 88951
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2020893096923828  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2020893096923828  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.24450445175170898  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2446141242980957  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20739316940307617  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2232, 1: 2149, 2: 1893, 3: 1364, 4: 1058, 5: 926, 6: 714, 7: 601, 8: 492, 9: 429, 10: 378, 11: 338, 12: 287, 13: 242, 14: 214, 15: 191, 16: 178, 18: 163, 19: 159, 17: 150, 20: 130, 21: 128, 22: 115, 24: 102, 23: 81})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.21335887908935547  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.21335887908935547  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 11.43532943725586  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 11.437832355499268  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2176532745361328  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2176532745361328  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1845989227294922  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10616445541381836 |0.004849473635355632 |0.198906938234965 |0.00011861324310302734 |0.43615372975667316 |0.003323793411254883 |
----------------------------------------------------------pseudo_mini_loss sum 4.528646945953369
Total (block generation + training)time/epoch 49.852526261256294
Training time/epoch 4.641310453414917
Training time without block to device /epoch 4.612213611602783
Training time without total dataloading part /epoch 3.814399480819702
load block tensor time/epoch 0.6369867324829102
block to device time/epoch 0.02909684181213379
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  577905
Number of first layer input nodes during this epoch:  361977
Number of first layer output nodes during this epoch:  215928
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1700606346130371  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.479 seconds, peak memory: 42.048 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.048 GB
Metis partitioning: 4.969 seconds, peak memory: 42.048 GB
Split the graph: 8.897 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  23.699557781219482
pure dgl.metis_partition the time spent:  15.394789218902588
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7284011840820312

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.433828592300415

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1700606346130371  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

connection checking time:  1.3987913131713867
block generation total time  2.1622297763824463
average batch blocks generation time:  0.3603716293970744
block dataloader generation time/epoch 45.001554931913105
pseudo mini batch 0 input nodes size: 39141
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1631026268005371  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1631026268005371  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1826338768005371  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18274927139282227  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.14022445678710938  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2712, 2: 2396, 3: 1858, 4: 1427, 5: 1198, 6: 942, 7: 778, 8: 601, 25: 526, 9: 501, 10: 436, 11: 344, 12: 291, 13: 265, 14: 208, 15: 194, 16: 151, 17: 115, 18: 108, 19: 101, 20: 84, 21: 71, 22: 56, 23: 52, 24: 46})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.14270639419555664  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.14270639419555664  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.046297073364258  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.0492658615112305  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17446470260620117  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 1 input nodes size: 56261
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17232608795166016  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17232608795166016  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19915342330932617  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19926929473876953  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17962265014648438  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2085, 2: 1916, 3: 1555, 4: 1316, 25: 1263, 5: 1048, 6: 862, 7: 730, 8: 695, 9: 562, 10: 471, 11: 419, 12: 404, 13: 317, 14: 300, 15: 250, 16: 200, 17: 200, 18: 179, 19: 150, 20: 135, 21: 129, 22: 127, 23: 102, 24: 91})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18301773071289062  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18301773071289062  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 9.340012550354004  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 9.342343807220459  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18568706512451172  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 2 input nodes size: 37045
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1826319694519043  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1826319694519043  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20029640197753906  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20041227340698242  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17346906661987305  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1937, 2: 1742, 3: 1535, 25: 1334, 4: 1244, 5: 1089, 6: 898, 7: 793, 8: 673, 9: 569, 10: 555, 11: 476, 12: 367, 13: 334, 14: 305, 15: 262, 17: 241, 16: 226, 20: 186, 18: 179, 21: 151, 19: 149, 24: 104, 23: 102, 22: 99})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17664098739624023  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17664098739624023  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 9.32176685333252  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 9.324132442474365  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17914342880249023  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 3 input nodes size: 70286
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17671728134155273  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17671728134155273  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.21023225784301758  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2103428840637207  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19256258010864258  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2793, 2: 2381, 3: 1843, 4: 1389, 5: 1155, 6: 808, 7: 638, 25: 575, 8: 555, 9: 495, 10: 382, 11: 278, 12: 248, 13: 220, 14: 173, 15: 157, 16: 126, 17: 118, 18: 100, 19: 99, 20: 80, 21: 54, 24: 46, 23: 46, 22: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19548368453979492  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19548368453979492  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.318205833435059  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.320746898651123  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1978468894958496  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 4 input nodes size: 88506
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1946096420288086  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1946096420288086  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.23681259155273438  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2369222640991211  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20329666137695312  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2216, 1: 2131, 2: 1810, 3: 1356, 4: 1049, 5: 959, 6: 763, 7: 585, 8: 527, 9: 423, 10: 377, 11: 352, 12: 291, 13: 248, 14: 214, 15: 201, 16: 181, 18: 172, 17: 153, 19: 151, 20: 136, 21: 129, 24: 112, 22: 105, 23: 76})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20823240280151367  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20823240280151367  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 11.471812725067139  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 11.474246978759766  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.21268320083618164  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 5 input nodes size: 79665
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20674991607666016  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20674991607666016  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2447371482849121  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.24484825134277344  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20253562927246094  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3546, 1: 1770, 2: 1461, 3: 1130, 4: 895, 5: 773, 6: 595, 7: 521, 9: 426, 8: 421, 10: 378, 12: 336, 11: 334, 13: 272, 14: 234, 16: 227, 15: 225, 18: 210, 17: 203, 19: 186, 20: 186, 21: 183, 23: 141, 22: 127, 24: 126})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20905160903930664  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20905160903930664  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 13.688565731048584  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 13.69080924987793  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2142338752746582  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2142338752746582  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18117952346801758  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10743399461110432 |0.00590968132019043 |0.20007741451263428 |0.00012135505676269531 |0.43432458241780597 |0.0033135414123535156 |
----------------------------------------------------------pseudo_mini_loss sum 3.790963649749756
Total (block generation + training)time/epoch 49.71912070683071
Training time/epoch 4.644448280334473
Training time without block to device /epoch 4.60899019241333
Training time without total dataloading part /epoch 3.8104536533355713
load block tensor time/epoch 0.644603967666626
block to device time/epoch 0.03545808792114258
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  590542
Number of first layer input nodes during this epoch:  370904
Number of first layer output nodes during this epoch:  219638
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.16745376586914062  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.463 seconds, peak memory: 42.048 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.048 GB
Metis partitioning: 5.028 seconds, peak memory: 42.048 GB
Split the graph: 10.620 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  23.092281579971313
pure dgl.metis_partition the time spent:  17.161442756652832
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7353100776672363

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3896965980529785

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.16745376586914062  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

connection checking time:  1.37807297706604
block generation total time  2.125006675720215
average batch blocks generation time:  0.35416777928670246
block dataloader generation time/epoch 44.96808786392212
pseudo mini batch 0 input nodes size: 43993
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.15945053100585938  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.15945053100585938  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18093490600585938  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18105030059814453  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.14295196533203125  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2520, 2: 2295, 3: 1806, 4: 1455, 5: 1171, 6: 959, 7: 783, 8: 615, 25: 605, 9: 558, 10: 438, 11: 343, 12: 305, 13: 272, 14: 221, 15: 218, 16: 153, 17: 143, 18: 128, 19: 110, 20: 87, 23: 73, 21: 72, 22: 72, 24: 64})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.14562463760375977  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.14562463760375977  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.511081218719482  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.513428211212158  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17674684524536133  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 1 input nodes size: 48642
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17438173294067383  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17438173294067383  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19781923294067383  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19793033599853516  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17633056640625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2459, 2: 2176, 3: 1743, 4: 1375, 5: 1050, 6: 808, 25: 775, 7: 652, 8: 607, 9: 483, 10: 433, 11: 361, 12: 333, 13: 269, 14: 222, 15: 198, 16: 143, 17: 138, 18: 129, 19: 107, 21: 101, 20: 94, 22: 78, 23: 64, 24: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17904233932495117  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17904233932495117  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.573353290557861  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.575661659240723  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18135404586791992  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 2 input nodes size: 36281
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17893218994140625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17893218994140625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19651031494140625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1966257095336914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17307710647583008  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1890, 2: 1705, 3: 1508, 25: 1321, 4: 1249, 5: 1090, 6: 924, 7: 797, 8: 673, 9: 573, 10: 547, 11: 473, 12: 367, 13: 336, 14: 312, 15: 257, 17: 241, 16: 229, 20: 184, 18: 183, 19: 153, 21: 152, 24: 107, 23: 102, 22: 98})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17622852325439453  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17622852325439453  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 9.306407451629639  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 9.308917999267578  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17888832092285156  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 3 input nodes size: 65851
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1764998435974121  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1764998435974121  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2079000473022461  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20801591873168945  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1903223991394043  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2578, 2: 2173, 3: 1714, 4: 1312, 5: 1197, 25: 979, 6: 842, 7: 742, 8: 660, 9: 541, 10: 421, 11: 348, 12: 306, 13: 270, 14: 237, 15: 191, 16: 189, 17: 150, 18: 133, 19: 121, 20: 118, 21: 84, 22: 73, 23: 67, 24: 59})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1936030387878418  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1936030387878418  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 8.608447551727295  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 8.611312866210938  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1962447166442871  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 4 input nodes size: 86288
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1929035186767578  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1929035186767578  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.23404884338378906  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.23415851593017578  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20264244079589844  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2229, 1: 2211, 2: 1923, 3: 1364, 4: 1009, 5: 940, 6: 733, 7: 577, 8: 492, 9: 410, 10: 368, 11: 332, 12: 292, 13: 225, 14: 208, 15: 200, 16: 178, 18: 171, 19: 156, 17: 156, 20: 131, 21: 122, 22: 111, 24: 105, 23: 71})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20749902725219727  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20749902725219727  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 11.349714756011963  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 11.352240562438965  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.21173810958862305  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 5 input nodes size: 75832
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20556974411010742  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20556974411010742  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.24267911911010742  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.24279069900512695  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20153570175170898  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3551, 1: 1770, 2: 1434, 3: 1142, 4: 920, 5: 774, 6: 602, 7: 494, 8: 425, 9: 411, 10: 392, 11: 346, 12: 334, 13: 284, 14: 234, 15: 225, 16: 219, 18: 204, 17: 202, 20: 193, 19: 189, 21: 186, 23: 142, 24: 130, 22: 124})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20704936981201172  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20704936981201172  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 13.575856685638428  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 13.578313827514648  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.21152973175048828  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.21152973175048828  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17847537994384766  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10573454697926839 |0.004761060078938802 |0.19991596539815268 |0.00011924902598063151 |0.43635110060373944 |0.0022535324096679688 |
----------------------------------------------------------pseudo_mini_loss sum 3.810295581817627
Total (block generation + training)time/epoch 49.68120834032695
Training time/epoch 4.650588035583496
Training time without block to device /epoch 4.622021675109863
Training time without total dataloading part /epoch 3.8205714225769043
load block tensor time/epoch 0.6344072818756104
block to device time/epoch 0.028566360473632812
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  570811
Number of first layer input nodes during this epoch:  356887
Number of first layer output nodes during this epoch:  213924
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.16477298736572266  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.423 seconds, peak memory: 42.178 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.178 GB
Metis partitioning: 4.986 seconds, peak memory: 42.178 GB
Split the graph: 9.114 seconds
Construct subgraphs: 0.014 seconds
REG metis partition end ----................................
REG construction  time spent:  23.8433039188385
pure dgl.metis_partition the time spent:  15.56470799446106
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7271137237548828

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3890337944030762

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.16477298736572266  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

connection checking time:  1.3921363353729248
block generation total time  2.116147518157959
average batch blocks generation time:  0.3526912530263265
block dataloader generation time/epoch 44.88169115781784
pseudo mini batch 0 input nodes size: 44430
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.15878820419311523  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.15878820419311523  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18027257919311523  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1803879737854004  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.14316701889038086  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2489, 2: 2255, 3: 1747, 4: 1412, 5: 1167, 6: 954, 7: 788, 25: 688, 8: 631, 9: 548, 10: 464, 11: 369, 12: 302, 13: 277, 14: 225, 15: 218, 16: 171, 17: 140, 18: 132, 19: 118, 20: 108, 22: 77, 21: 77, 23: 69, 24: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1459026336669922  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1459026336669922  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.683574199676514  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.68601655960083  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17694711685180664  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 1 input nodes size: 57054
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17455196380615234  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17455196380615234  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20175743103027344  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2018728256225586  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18027305603027344  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2166, 2: 1986, 3: 1601, 4: 1364, 25: 1160, 5: 1078, 6: 825, 7: 725, 8: 704, 9: 548, 10: 467, 11: 411, 12: 393, 13: 304, 14: 285, 15: 236, 16: 208, 17: 184, 18: 156, 19: 128, 21: 124, 22: 119, 20: 115, 23: 91, 24: 82})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18358755111694336  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18358755111694336  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 9.061692714691162  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 9.06410026550293  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1868577003479004  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 2 input nodes size: 36223
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1838059425354004  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1838059425354004  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2013840675354004  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20149993896484375  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1741790771484375  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1910, 2: 1741, 3: 1582, 25: 1300, 4: 1276, 5: 1084, 6: 937, 7: 783, 8: 646, 9: 572, 10: 524, 11: 460, 12: 363, 13: 335, 14: 306, 15: 250, 17: 234, 16: 216, 20: 189, 18: 187, 19: 151, 21: 150, 24: 102, 23: 98, 22: 95})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17731666564941406  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17731666564941406  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 9.240374088287354  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 9.243327140808105  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1794910430908203  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 3 input nodes size: 66635
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17708444595336914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17708444595336914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20885848999023438  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2089691162109375  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19127511978149414  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2883, 2: 2396, 3: 1835, 4: 1374, 5: 1177, 6: 835, 7: 643, 8: 562, 25: 547, 9: 469, 10: 391, 11: 272, 12: 239, 13: 226, 14: 175, 15: 162, 16: 120, 17: 113, 18: 94, 19: 86, 20: 69, 21: 55, 23: 44, 24: 42, 22: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19406938552856445  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19406938552856445  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.160130500793457  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.16296911239624  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19591283798217773  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 4 input nodes size: 77305
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19289255142211914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19289255142211914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.23000192642211914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.23011350631713867  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1982288360595703  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3516, 1: 1763, 2: 1415, 3: 1155, 4: 877, 5: 768, 6: 596, 7: 518, 8: 442, 9: 425, 10: 391, 11: 359, 12: 346, 13: 292, 14: 241, 15: 231, 16: 225, 18: 213, 17: 205, 20: 194, 19: 192, 21: 181, 23: 141, 24: 132, 22: 125})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20420503616333008  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20420503616333008  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 13.63488483428955  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 13.637338161468506  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20978403091430664  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 5 input nodes size: 88077
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20233488082885742  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20233488082885742  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.24433326721191406  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.24444293975830078  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20722198486328125  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2249, 1: 2217, 2: 1913, 3: 1357, 4: 1017, 5: 948, 6: 721, 7: 588, 8: 487, 9: 414, 10: 362, 11: 332, 12: 294, 13: 222, 14: 202, 15: 192, 16: 171, 18: 166, 19: 161, 17: 154, 20: 132, 21: 130, 24: 107, 22: 102, 23: 76})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.21213865280151367  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.21213865280151367  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 11.444014072418213  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 11.44638729095459  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.21628522872924805  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.21628522872924805  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18323087692260742  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10787844657897949 |0.004841128985087077 |0.1995690663655599 |0.00012775262196858725 |0.43531497319539386 |0.002125263214111328 |
----------------------------------------------------------pseudo_mini_loss sum 3.969557762145996
Total (block generation + training)time/epoch 49.59075830876827
Training time/epoch 4.648064613342285
Training time without block to device /epoch 4.619017839431763
Training time without total dataloading part /epoch 3.8121960163116455
load block tensor time/epoch 0.647270679473877
block to device time/epoch 0.02904677391052246
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  587704
Number of first layer input nodes during this epoch:  369724
Number of first layer output nodes during this epoch:  217980
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.16867589950561523  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.458 seconds, peak memory: 42.178 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.178 GB
Metis partitioning: 4.974 seconds, peak memory: 42.178 GB
Split the graph: 9.769 seconds
Construct subgraphs: 0.015 seconds
REG metis partition end ----................................
REG construction  time spent:  25.752166986465454
pure dgl.metis_partition the time spent:  16.244714975357056
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7310476303100586

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3555595874786377

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.16867589950561523  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

connection checking time:  1.3513681888580322
block generation total time  2.0866072177886963
average batch blocks generation time:  0.3477678696314494
block dataloader generation time/epoch 44.955645995981556
pseudo mini batch 0 input nodes size: 43911
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.16275453567504883  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.16275453567504883  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18423891067504883  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18435335159301758  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.14224529266357422  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2425, 2: 2137, 3: 1673, 4: 1400, 5: 1139, 6: 877, 7: 766, 25: 739, 8: 659, 9: 542, 10: 491, 11: 380, 12: 335, 13: 279, 14: 235, 15: 228, 16: 182, 17: 157, 18: 138, 19: 133, 20: 108, 21: 87, 23: 79, 22: 78, 24: 61})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.14502429962158203  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.14502429962158203  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.8180742263793945  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 7.82044792175293  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17711830139160156  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 1 input nodes size: 47922
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.174713134765625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.174713134765625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.198150634765625  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19826364517211914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1766648292541504  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2226, 2: 2017, 3: 1669, 4: 1329, 25: 1092, 5: 1088, 6: 847, 7: 727, 8: 596, 9: 539, 10: 458, 11: 381, 12: 332, 13: 284, 14: 261, 15: 222, 17: 173, 16: 162, 20: 128, 18: 128, 19: 115, 21: 103, 22: 83, 24: 80, 23: 79})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17969417572021484  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17969417572021484  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 8.438382625579834  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 8.440896987915039  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.18179988861083984  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 2 input nodes size: 39609
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17911195755004883  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17911195755004883  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19864320755004883  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19875621795654297  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17520570755004883  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2128, 2: 1942, 3: 1646, 4: 1280, 5: 1067, 25: 940, 6: 920, 7: 757, 8: 642, 9: 532, 10: 471, 11: 433, 12: 346, 13: 301, 14: 262, 15: 216, 17: 199, 16: 197, 18: 176, 20: 141, 21: 135, 19: 130, 22: 94, 23: 85, 24: 84})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17807388305664062  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17807388305664062  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 8.311731815338135  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 8.314005851745605  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1808328628540039  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 3 input nodes size: 65263
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17851543426513672  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.17851543426513672  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.20963525772094727  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2097487449645996  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19010448455810547  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2638, 2: 2238, 3: 1697, 4: 1335, 5: 1166, 6: 850, 25: 847, 7: 684, 8: 649, 9: 511, 10: 413, 11: 326, 12: 300, 13: 252, 14: 226, 15: 191, 16: 167, 17: 139, 18: 118, 19: 105, 20: 104, 21: 80, 24: 62, 22: 62, 23: 57})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1932234764099121  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1932234764099121  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 8.099953174591064  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 8.102452278137207  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1953721046447754  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

pseudo mini batch 4 input nodes size: 77127
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19216060638427734  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.19216060638427734  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.22926998138427734  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2293834686279297  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.1981501579284668  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3784, 1: 1653, 2: 1368, 3: 1120, 4: 861, 5: 774, 6: 636, 7: 531, 8: 446, 9: 430, 10: 405, 11: 360, 12: 355, 13: 299, 14: 252, 15: 233, 16: 232, 18: 223, 17: 211, 20: 198, 19: 196, 21: 195, 23: 147, 24: 138, 22: 131})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2048044204711914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.58935546875 GB
    Memory Allocated: 0.2048044204711914  GigaBytes
Max Memory Allocated: 14.925999164581299  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.64013671875 GB
    Memory Allocated: 14.191995620727539  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.64013671875 GB
    Memory Allocated: 14.194471836090088  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.2095804214477539  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 5 input nodes size: 82041
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20249223709106445  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20249223709106445  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.24161243438720703  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.24172401428222656  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20450115203857422  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2358, 25: 2058, 2: 2004, 3: 1472, 4: 1115, 5: 988, 6: 738, 7: 580, 8: 480, 9: 422, 10: 361, 11: 323, 12: 269, 13: 241, 15: 199, 14: 198, 16: 171, 18: 165, 19: 157, 17: 151, 20: 128, 21: 117, 22: 108, 24: 100, 23: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.2090897560119629  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.2090897560119629  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 10.896771907806396  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 10.899309158325195  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.21303081512451172  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.21303081512451172  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1799764633178711  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10624237855275472 |0.0047645171483357745 |0.199859619140625 |0.0001188516616821289 |0.4368322292963664 |0.002154827117919922 |
----------------------------------------------------------pseudo_mini_loss sum 3.922884225845337
Total (block generation + training)time/epoch 49.66114470537971
Training time/epoch 4.648180961608887
Training time without block to device /epoch 4.619593858718872
Training time without total dataloading part /epoch 3.823019027709961
load block tensor time/epoch 0.6374542713165283
block to device time/epoch 0.02858710289001465
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  568848
Number of first layer input nodes during this epoch:  355873
Number of first layer output nodes during this epoch:  212975
----------------------------------------before generate dataloader block 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1653308868408203  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.456 seconds, peak memory: 42.747 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.747 GB
Metis partitioning: 4.968 seconds, peak memory: 43.522 GB
Split the graph: 10.223 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
REG construction  time spent:  22.659398555755615
pure dgl.metis_partition the time spent:  16.695895195007324
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7326290607452393

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.395615816116333

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1653308868408203  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

connection checking time:  1.364877462387085
block generation total time  2.1282448768615723
average batch blocks generation time:  0.3547074794769287
block dataloader generation time/epoch 44.8761385679245
pseudo mini batch 0 input nodes size: 46571
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.15994691848754883  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.15994691848754883  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18215370178222656  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18226909637451172  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1430373191833496  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2644, 2: 2372, 3: 1876, 4: 1425, 5: 1207, 6: 919, 7: 748, 8: 644, 25: 581, 9: 506, 10: 417, 11: 325, 12: 285, 13: 239, 14: 223, 15: 204, 17: 139, 16: 137, 18: 117, 19: 96, 20: 76, 21: 76, 22: 72, 23: 63, 24: 53})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.14566612243652344  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.14566612243652344  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 7.301848888397217  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 7.304152488708496  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.17740297317504883  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 1 input nodes size: 36434
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.17502164840698242  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.17502164840698242  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19259977340698242  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19271516799926758  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1703929901123047  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1860, 2: 1724, 3: 1524, 25: 1334, 4: 1259, 5: 1075, 6: 916, 7: 802, 8: 661, 9: 585, 10: 519, 11: 465, 12: 376, 13: 340, 14: 312, 17: 240, 15: 239, 16: 234, 18: 192, 20: 183, 21: 161, 19: 149, 23: 116, 22: 106, 24: 104})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1735825538635254  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1735825538635254  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 9.339094161987305  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 9.34154748916626  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.17594146728515625  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 2 input nodes size: 48359
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1734943389892578  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1734943389892578  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1969318389892578  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19704294204711914  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.17934942245483398  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2531, 2: 2135, 3: 1719, 4: 1348, 5: 1052, 6: 828, 25: 695, 7: 678, 8: 622, 9: 505, 10: 450, 11: 386, 12: 320, 13: 279, 15: 208, 14: 208, 16: 159, 17: 143, 19: 129, 18: 119, 20: 102, 21: 81, 22: 66, 23: 63, 24: 58})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1820507049560547  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1820507049560547  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 7.532984733581543  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 7.535212993621826  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18407249450683594  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 3 input nodes size: 62036
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18163108825683594  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18163108825683594  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.211212158203125  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.21132659912109375  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18777799606323242  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2485, 2: 2094, 3: 1646, 4: 1333, 5: 1156, 25: 1038, 6: 898, 7: 732, 8: 625, 9: 528, 10: 438, 11: 338, 12: 329, 13: 286, 14: 244, 15: 199, 16: 172, 17: 148, 18: 134, 19: 115, 20: 113, 22: 81, 21: 81, 24: 71, 23: 59})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1909489631652832  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1909489631652832  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 8.481112957000732  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 8.483905792236328  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19372129440307617  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 4 input nodes size: 84794
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19064664840698242  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19064664840698242  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.2310795783996582  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.23118972778320312  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.2014942169189453  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2216, 1: 2206, 2: 1906, 3: 1401, 4: 1065, 5: 956, 6: 697, 7: 550, 8: 475, 9: 417, 10: 384, 11: 353, 12: 296, 13: 229, 15: 204, 14: 203, 16: 177, 18: 172, 17: 160, 19: 156, 20: 136, 21: 126, 22: 107, 24: 102, 23: 71})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20629310607910156  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20629310607910156  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 11.291484355926514  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 11.294109344482422  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.21056747436523438  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 5 input nodes size: 76542
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20488643646240234  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20488643646240234  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.24199581146240234  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.24210786819458008  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20156478881835938  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3596, 1: 1702, 2: 1475, 3: 1111, 4: 890, 5: 776, 6: 610, 7: 535, 8: 445, 9: 435, 10: 391, 11: 336, 12: 331, 13: 283, 14: 244, 15: 235, 16: 232, 18: 214, 17: 200, 20: 197, 21: 192, 19: 191, 23: 147, 24: 137, 22: 124})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20812702178955078  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20812702178955078  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 13.7917160987854  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 13.794341087341309  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.21365928649902344  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.21365928649902344  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1806049346923828  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10433073838551839 |0.004962841669718425 |0.2039030392964681 |0.00013760725657145181 |0.43455231189727783 |0.004883527755737305 |
----------------------------------------------------------pseudo_mini_loss sum 4.010378360748291
Total (block generation + training)time/epoch 49.578566935327316
Training time/epoch 4.649990081787109
Training time without block to device /epoch 4.620213031768799
Training time without total dataloading part /epoch 3.8364412784576416
load block tensor time/epoch 0.6259844303131104
block to device time/epoch 0.029777050018310547
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  566631
Number of first layer input nodes during this epoch:  354736
Number of first layer output nodes during this epoch:  211895
----------------------------------------before generate dataloader block 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.16697311401367188  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.452 seconds, peak memory: 43.780 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 43.780 GB
Metis partitioning: 4.988 seconds, peak memory: 43.780 GB
Split the graph: 10.816 seconds
Construct subgraphs: 0.029 seconds
REG metis partition end ----................................
REG construction  time spent:  22.893627643585205
pure dgl.metis_partition the time spent:  17.314590454101562
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7309448719024658

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3909525871276855

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.16697311401367188  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

connection checking time:  1.4030506610870361
block generation total time  2.1218974590301514
average batch blocks generation time:  0.3536495765050252
block dataloader generation time/epoch 44.85225649883873
pseudo mini batch 0 input nodes size: 65751
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.15897417068481445  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.15897417068481445  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19032669067382812  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19043874740600586  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.15321731567382812  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2821, 2: 2341, 3: 1816, 4: 1381, 5: 1175, 6: 871, 7: 659, 25: 610, 8: 579, 9: 481, 10: 379, 11: 303, 12: 278, 13: 226, 14: 184, 15: 156, 16: 131, 18: 117, 17: 110, 19: 92, 20: 78, 21: 70, 23: 58, 22: 49, 24: 49})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1561145782470703  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1561145782470703  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 7.435817241668701  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 7.4383320808410645  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1871929168701172  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 1 input nodes size: 85754
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18410301208496094  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18410301208496094  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.22499370574951172  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.22510337829589844  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19363880157470703  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2297, 25: 2153, 2: 1963, 3: 1396, 4: 1065, 5: 942, 6: 707, 7: 570, 8: 487, 9: 418, 10: 368, 11: 332, 12: 277, 13: 228, 14: 200, 15: 192, 18: 158, 16: 156, 17: 149, 19: 146, 20: 128, 21: 115, 22: 98, 24: 97, 23: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19887590408325195  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19887590408325195  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 11.018579959869385  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 11.02088451385498  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.2029118537902832  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 2 input nodes size: 76303
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19676446914672852  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19676446914672852  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.23387384414672852  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.23398590087890625  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19298553466796875  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3639, 1: 1690, 2: 1430, 3: 1137, 4: 891, 5: 766, 6: 600, 7: 512, 8: 445, 9: 419, 10: 400, 11: 342, 12: 341, 13: 293, 14: 243, 15: 233, 16: 229, 18: 218, 17: 210, 19: 195, 20: 193, 21: 190, 23: 147, 24: 135, 22: 125})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19956493377685547  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19956493377685547  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 13.817081451416016  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 13.819637775421143  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.2041788101196289  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 3 input nodes size: 42925
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19713735580444336  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19713735580444336  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.2176055908203125  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.21772098541259766  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18049955368041992  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2489, 2: 2250, 3: 1785, 4: 1455, 5: 1206, 6: 926, 7: 790, 8: 659, 25: 617, 9: 535, 10: 452, 11: 358, 12: 304, 13: 272, 14: 236, 15: 218, 16: 175, 17: 128, 18: 126, 19: 114, 20: 91, 21: 78, 22: 77, 23: 62, 24: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18317604064941406  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18317604064941406  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 7.582172393798828  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 7.58518648147583  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18531513214111328  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 4 input nodes size: 55744
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1829700469970703  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1829700469970703  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.2095508575439453  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20966482162475586  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18908119201660156  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2221, 2: 1996, 3: 1617, 4: 1297, 25: 1118, 5: 1061, 6: 842, 7: 725, 8: 641, 9: 548, 10: 455, 11: 395, 12: 371, 13: 296, 14: 259, 15: 236, 16: 196, 17: 194, 18: 148, 19: 140, 20: 130, 21: 117, 22: 109, 24: 82, 23: 76})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19227981567382812  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19227981567382812  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 8.773166179656982  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 8.775520324707031  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1947154998779297  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 5 input nodes size: 37225
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19180774688720703  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19180774688720703  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20955801010131836  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20967340469360352  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18297863006591797  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1910, 2: 1726, 3: 1526, 25: 1323, 4: 1231, 5: 1072, 6: 922, 7: 789, 8: 661, 9: 575, 10: 545, 11: 473, 12: 366, 13: 341, 14: 312, 15: 254, 17: 239, 16: 224, 20: 187, 18: 181, 19: 149, 21: 147, 23: 104, 24: 102, 22: 98})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18613100051879883  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18613100051879883  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 9.287671089172363  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 9.290652751922607  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18887758255004883  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18887758255004883  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1558232307434082  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10629117488861084 |0.004834294319152832 |0.19908547401428223 |0.00012322266896565756 |0.43509145577748615 |0.0020813941955566406 |
----------------------------------------------------------pseudo_mini_loss sum 3.9553511142730713
Total (block generation + training)time/epoch 49.55146576228895
Training time/epoch 4.641011953353882
Training time without block to device /epoch 4.612006187438965
Training time without total dataloading part /epoch 3.807882308959961
load block tensor time/epoch 0.637747049331665
block to device time/epoch 0.029005765914916992
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  579012
Number of first layer input nodes during this epoch:  363702
Number of first layer output nodes during this epoch:  215310
----------------------------------------before generate dataloader block 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.14109373092651367  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.431 seconds, peak memory: 44.062 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 44.062 GB
Metis partitioning: 4.992 seconds, peak memory: 44.062 GB
Split the graph: 9.692 seconds
Construct subgraphs: 0.028 seconds
REG metis partition end ----................................
REG construction  time spent:  23.925671577453613
pure dgl.metis_partition the time spent:  16.173617839813232
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7367343902587891

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4088335037231445

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.14109373092651367  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

connection checking time:  1.3731613159179688
block generation total time  2.1455678939819336
average batch blocks generation time:  0.35759464899698895
block dataloader generation time/epoch 44.82398400306702
pseudo mini batch 0 input nodes size: 39073
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1386866569519043  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1386866569519043  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1582179069519043  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.15833330154418945  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.14046764373779297  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2639, 2: 2359, 3: 1877, 4: 1487, 5: 1212, 6: 957, 7: 773, 8: 672, 9: 504, 25: 459, 10: 430, 11: 341, 12: 300, 13: 260, 14: 213, 15: 199, 16: 138, 17: 124, 18: 112, 19: 87, 20: 75, 21: 70, 22: 58, 23: 57, 24: 52})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.14293813705444336  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.14293813705444336  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 6.990374565124512  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 6.992984771728516  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.17462873458862305  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 1 input nodes size: 56110
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.17249107360839844  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.17249107360839844  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19924640655517578  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19936180114746094  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.17971515655517578  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2180, 2: 1978, 3: 1597, 4: 1289, 25: 1230, 5: 1043, 6: 833, 7: 729, 8: 623, 9: 574, 10: 479, 11: 408, 12: 380, 13: 312, 14: 280, 15: 246, 16: 207, 17: 193, 18: 165, 19: 156, 20: 141, 21: 120, 22: 112, 24: 86, 23: 83})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1830153465270996  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1830153465270996  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 9.160524368286133  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 9.16283655166626  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18537282943725586  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 2 input nodes size: 35828
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18241357803344727  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18241357803344727  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19999170303344727  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20010709762573242  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.17323637008666992  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1869, 2: 1718, 3: 1518, 25: 1313, 4: 1246, 5: 1092, 6: 930, 7: 797, 8: 671, 9: 570, 10: 544, 11: 476, 12: 371, 13: 330, 14: 310, 15: 255, 17: 242, 16: 228, 20: 186, 18: 180, 21: 157, 19: 150, 24: 103, 23: 102, 22: 100})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1763744354248047  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1763744354248047  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 9.266695022583008  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 9.269007205963135  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.1796092987060547  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 3 input nodes size: 62843
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.17724037170410156  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.17724037170410156  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20720624923706055  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20731735229492188  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18962383270263672  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2841, 2: 2308, 3: 1762, 4: 1373, 5: 1166, 6: 820, 25: 652, 7: 645, 8: 578, 9: 479, 10: 384, 11: 288, 12: 262, 13: 244, 14: 179, 15: 165, 16: 134, 18: 118, 17: 113, 19: 92, 20: 83, 23: 60, 21: 57, 24: 53, 22: 52})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19249391555786133  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19249391555786133  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 7.475663661956787  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 7.478151321411133  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19408369064331055  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 4 input nodes size: 87496
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19106054306030273  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.19106054306030273  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.23278188705444336  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.23289155960083008  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20281457901000977  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2231, 25: 2195, 2: 1912, 3: 1372, 4: 1064, 5: 934, 6: 708, 7: 585, 8: 506, 9: 413, 10: 374, 11: 346, 12: 287, 13: 216, 14: 205, 15: 204, 16: 172, 19: 160, 17: 158, 18: 155, 20: 130, 21: 119, 22: 107, 24: 91, 23: 73})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20834112167358398  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20834112167358398  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 11.249526977539062  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 11.251987934112549  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.21241521835327148  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

pseudo mini batch 5 input nodes size: 77800
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.2059307098388672  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.2059307098388672  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.2430400848388672  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.24315166473388672  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.20132064819335938  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3611, 1: 1668, 2: 1431, 3: 1151, 4: 861, 5: 775, 6: 620, 7: 516, 9: 436, 8: 422, 10: 388, 11: 344, 12: 337, 13: 294, 14: 247, 16: 232, 15: 220, 18: 218, 17: 200, 21: 194, 20: 192, 19: 191, 23: 144, 24: 140, 22: 127})

----------------------------------------after blocks to device 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.2078843116760254  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.2078843116760254  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 13.835150241851807  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 13.837523460388184  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.21386384963989258  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.21386384963989258  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.32958984375 GB
    Memory Allocated: 0.18080949783325195  GigaBytes
Max Memory Allocated: 15.215813636779785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10574078559875488 |0.004735906918843587 |0.19866506258646646 |0.00012060006459554036 |0.4360063473383586 |0.004795074462890625 |
----------------------------------------------------------pseudo_mini_loss sum 3.8304989337921143
Total (block generation + training)time/epoch 49.52008081674576
Training time/epoch 4.636643409729004
Training time without block to device /epoch 4.608227968215942
Training time without total dataloading part /epoch 3.813547134399414
load block tensor time/epoch 0.6344447135925293
block to device time/epoch 0.028415441513061523
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  574283
Number of first layer input nodes during this epoch:  359150
Number of first layer output nodes during this epoch:  215133
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=1024, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=1024, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(1024, 1024, batch_first=True)
      (fc_self): Linear(in_features=1024, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=1024, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  8872960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([1024, 128])
layers.0.fc_neigh.weight, torch.Size([1024, 128])
layers.1.lstm.weight_ih_l0, torch.Size([4096, 1024])
layers.1.lstm.weight_hh_l0, torch.Size([4096, 1024])
layers.1.lstm.bias_ih_l0, torch.Size([4096])
layers.1.lstm.bias_hh_l0, torch.Size([4096])
layers.1.fc_self.weight, torch.Size([40, 1024])
layers.1.fc_neigh.weight, torch.Size([40, 1024])
----------------------------------------
un-trainable parameters
