main start at this time 1733107170.6793647
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.55029296875 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.553 seconds, peak memory: 17.044 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 17.044 GB
Metis partitioning: 5.730 seconds, peak memory: 17.813 GB
Split the graph: 3.780 seconds
Construct subgraphs: 0.025 seconds
REG metis partition end ----................................
REG construction  time spent:  24.070082426071167
pure dgl.metis_partition the time spent:  11.119779825210571
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8686296939849854

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  4.457590818405151

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

connection checking time:  2.202608346939087
block generation total time  5.326220512390137
average batch blocks generation time:  0.33288878202438354
block dataloader generation time/epoch 43.414663314819336
pseudo mini batch 0 input nodes size: 24521
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.56396484375 GB
    Memory Allocated: 0.044773101806640625  GigaBytes
Max Memory Allocated: 0.044773101806640625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.56396484375 GB
    Memory Allocated: 0.04481649398803711  GigaBytes
Max Memory Allocated: 0.04481649398803711  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.56396484375 GB
    Memory Allocated: 0.04481649398803711  GigaBytes
Max Memory Allocated: 0.04481649398803711  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 689, 2: 629, 3: 577, 4: 469, 25: 458, 5: 393, 6: 345, 7: 280, 8: 266, 11: 207, 9: 207, 10: 195, 12: 152, 13: 136, 14: 113, 15: 108, 16: 91, 17: 82, 20: 76, 18: 69, 19: 61, 21: 59, 22: 45, 24: 34, 23: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.56591796875 GB
    Memory Allocated: 0.04617929458618164  GigaBytes
Max Memory Allocated: 0.04617929458618164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.56591796875 GB
    Memory Allocated: 0.04617929458618164  GigaBytes
Max Memory Allocated: 0.04617929458618164  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.59912109375 GB
    Memory Allocated: 3.6728172302246094  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.59912109375 GB
    Memory Allocated: 3.6736788749694824  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.97802734375 GB
    Memory Allocated: 0.09703540802001953  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

pseudo mini batch 1 input nodes size: 21696
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.97802734375 GB
    Memory Allocated: 0.09575700759887695  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.97802734375 GB
    Memory Allocated: 0.09575700759887695  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.97802734375 GB
    Memory Allocated: 0.10610246658325195  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.97802734375 GB
    Memory Allocated: 0.10614585876464844  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.97802734375 GB
    Memory Allocated: 0.09438371658325195  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 907, 2: 847, 3: 644, 4: 541, 5: 408, 25: 330, 6: 293, 7: 243, 8: 221, 9: 221, 10: 166, 12: 135, 11: 126, 14: 99, 13: 98, 15: 69, 16: 67, 18: 63, 17: 61, 19: 51, 21: 48, 23: 36, 20: 34, 22: 30, 24: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 4.97802734375 GB
    Memory Allocated: 0.0954899787902832  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.97802734375 GB
    Memory Allocated: 0.0954899787902832  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 3.0969066619873047  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 3.097766399383545  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.09635448455810547  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

pseudo mini batch 2 input nodes size: 24159
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.09535646438598633  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.09535646438598633  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.10707521438598633  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.10711669921875  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.09672784805297852  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 735, 2: 689, 3: 584, 4: 466, 25: 414, 5: 385, 6: 360, 7: 287, 8: 223, 9: 192, 10: 191, 11: 158, 12: 127, 13: 113, 17: 95, 14: 94, 16: 72, 15: 68, 19: 56, 18: 55, 20: 51, 21: 44, 23: 35, 24: 34, 22: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.09798860549926758  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.09798860549926758  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 3.4110536575317383  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 3.4118828773498535  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.09896135330200195  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

pseudo mini batch 3 input nodes size: 21800
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.09774160385131836  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.09774160385131836  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.10813665390014648  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.10818052291870117  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.0964202880859375  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 681, 2: 630, 25: 565, 3: 562, 4: 473, 5: 411, 6: 324, 7: 305, 8: 254, 9: 233, 10: 197, 11: 169, 12: 137, 14: 127, 13: 126, 15: 111, 17: 91, 16: 80, 20: 76, 18: 67, 21: 60, 19: 50, 23: 46, 24: 43, 22: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.09783363342285156  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.08154296875 GB
    Memory Allocated: 0.09783363342285156  GigaBytes
Max Memory Allocated: 3.9028677940368652  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.27685546875 GB
    Memory Allocated: 3.8718953132629395  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.27685546875 GB
    Memory Allocated: 3.8727684020996094  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.47216796875 GB
    Memory Allocated: 0.09898185729980469  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

pseudo mini batch 4 input nodes size: 27186
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.47216796875 GB
    Memory Allocated: 0.09767770767211914  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.47216796875 GB
    Memory Allocated: 0.09767770767211914  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.47216796875 GB
    Memory Allocated: 0.1106410026550293  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.47216796875 GB
    Memory Allocated: 0.11068439483642578  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.47216796875 GB
    Memory Allocated: 0.10024547576904297  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 986, 2: 823, 3: 639, 4: 500, 5: 433, 6: 337, 25: 333, 8: 267, 7: 240, 9: 177, 10: 170, 11: 136, 12: 116, 13: 97, 14: 87, 15: 83, 17: 57, 16: 56, 19: 52, 18: 49, 21: 44, 20: 43, 22: 39, 23: 35, 24: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 5.47216796875 GB
    Memory Allocated: 0.10144329071044922  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.47216796875 GB
    Memory Allocated: 0.10144329071044922  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 3.2100658416748047  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 3.2109341621398926  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.10240840911865234  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

pseudo mini batch 5 input nodes size: 18412
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.10121774673461914  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.10121774673461914  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.10999727249145508  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.11004066467285156  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.09703397750854492  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1023, 2: 940, 3: 735, 4: 576, 5: 491, 6: 388, 7: 284, 8: 236, 9: 187, 10: 152, 11: 129, 25: 116, 12: 102, 13: 75, 14: 73, 15: 73, 16: 47, 17: 40, 18: 36, 19: 21, 20: 19, 21: 16, 23: 14, 22: 14, 24: 12})

----------------------------------------after blocks to device 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.09792661666870117  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.09792661666870117  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 2.5116019248962402  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 2.5124669075012207  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.0986318588256836  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

pseudo mini batch 6 input nodes size: 33438
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.0978093147277832  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.0978093147277832  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.1137537956237793  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.11379766464233398  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.10497474670410156  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 788, 2: 736, 3: 571, 25: 538, 4: 472, 5: 399, 6: 311, 7: 310, 8: 247, 9: 215, 10: 201, 12: 141, 11: 138, 14: 119, 13: 119, 15: 98, 17: 77, 16: 75, 18: 59, 19: 47, 22: 47, 20: 43, 21: 39, 24: 35, 23: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.1064291000366211  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.1064291000366211  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 3.79556941986084  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 3.7964425086975098  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.1076197624206543  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

pseudo mini batch 7 input nodes size: 21498
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.10612821578979492  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.10612821578979492  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.1163792610168457  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.11642313003540039  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.10043478012084961  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 893, 2: 763, 3: 635, 4: 516, 5: 422, 6: 324, 25: 312, 7: 305, 8: 263, 9: 221, 10: 182, 11: 159, 12: 137, 13: 124, 14: 88, 15: 84, 16: 80, 19: 60, 18: 55, 20: 53, 17: 52, 21: 34, 22: 32, 24: 26, 23: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.10160112380981445  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.10160112380981445  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 3.2178640365600586  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 3.218735694885254  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.10251998901367188  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

pseudo mini batch 8 input nodes size: 44886
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.10143470764160156  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.10143470764160156  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.12345695495605469  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.12349843978881836  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.11320352554321289  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1016, 2: 780, 3: 567, 25: 457, 4: 439, 5: 383, 6: 302, 7: 250, 8: 221, 9: 174, 10: 140, 11: 127, 12: 101, 14: 72, 13: 72, 16: 65, 15: 61, 17: 55, 18: 47, 19: 40, 21: 35, 24: 33, 22: 32, 20: 29, 23: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.11486101150512695  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.11486101150512695  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 3.6992688179016113  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 3.70009183883667  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.11629629135131836  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

pseudo mini batch 9 input nodes size: 57232
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.11414432525634766  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.11414432525634766  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.1414346694946289  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.14147615432739258  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.11941242218017578  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 995, 1: 795, 2: 750, 3: 504, 4: 374, 5: 309, 6: 234, 7: 186, 8: 177, 9: 160, 10: 132, 11: 129, 12: 99, 13: 77, 15: 74, 19: 70, 18: 68, 16: 66, 20: 60, 14: 59, 17: 49, 21: 45, 22: 38, 24: 34, 23: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.12168502807617188  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.49755859375 GB
    Memory Allocated: 0.12168502807617188  GigaBytes
Max Memory Allocated: 4.1124091148376465  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.21630859375 GB
    Memory Allocated: 4.931394577026367  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.21630859375 GB
    Memory Allocated: 4.932217597961426  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.12372493743896484  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

pseudo mini batch 10 input nodes size: 37310
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.12071609497070312  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.12071609497070312  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.13850688934326172  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.1385483741760254  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.11121654510498047  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 989, 2: 883, 3: 701, 4: 505, 5: 419, 6: 297, 7: 280, 25: 253, 9: 180, 8: 173, 10: 130, 11: 102, 12: 92, 14: 80, 13: 79, 15: 67, 18: 55, 17: 49, 16: 44, 21: 36, 19: 30, 20: 29, 22: 22, 24: 21, 23: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.11247730255126953  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.11247730255126953  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 3.0517501831054688  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 3.0525755882263184  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.11357641220092773  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

pseudo mini batch 11 input nodes size: 31913
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.11207294464111328  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.11207294464111328  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.1272902488708496  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.1273341178894043  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.10950183868408203  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1066, 2: 839, 3: 686, 4: 519, 5: 499, 6: 339, 7: 279, 25: 253, 8: 240, 9: 189, 10: 165, 13: 117, 12: 104, 11: 101, 14: 78, 15: 60, 16: 60, 18: 49, 17: 49, 20: 41, 19: 35, 21: 20, 22: 20, 24: 19, 23: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.1107034683227539  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.1107034683227539  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 3.07265567779541  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 3.0735273361206055  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.11176061630249023  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

pseudo mini batch 12 input nodes size: 66761
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.11044692993164062  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.11044692993164062  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.14228105545043945  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.14232254028320312  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.1270613670349121  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1116, 1: 715, 2: 612, 3: 462, 4: 351, 5: 318, 6: 231, 7: 202, 8: 176, 9: 153, 10: 143, 11: 140, 12: 114, 13: 100, 14: 95, 15: 85, 16: 78, 18: 77, 19: 61, 17: 61, 21: 60, 20: 45, 24: 44, 22: 40, 23: 39})

----------------------------------------after blocks to device 
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.1298222541809082  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.41943359375 GB
    Memory Allocated: 0.1298222541809082  GigaBytes
Max Memory Allocated: 5.217613220214844  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.78076171875 GB
    Memory Allocated: 5.648089408874512  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.78076171875 GB
    Memory Allocated: 5.64891242980957  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.1323094367980957  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

pseudo mini batch 13 input nodes size: 63542
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.12844371795654297  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.12844371795654297  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.15874290466308594  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.1587843894958496  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.1269087791442871  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 883, 2: 784, 3: 611, 25: 531, 4: 481, 5: 379, 6: 307, 7: 212, 8: 202, 9: 146, 10: 140, 12: 118, 11: 113, 13: 99, 15: 72, 19: 62, 14: 62, 16: 59, 17: 50, 20: 48, 18: 38, 23: 33, 22: 32, 21: 30, 24: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.12893342971801758  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.12893342971801758  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 4.207833766937256  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 4.2086567878723145  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.13080167770385742  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

pseudo mini batch 14 input nodes size: 53887
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.12796688079833984  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.12796688079833984  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.15366220474243164  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.1537036895751953  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.12336301803588867  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1261, 1: 653, 2: 513, 3: 440, 4: 356, 5: 307, 6: 251, 7: 200, 9: 159, 10: 151, 8: 151, 11: 124, 12: 123, 13: 103, 17: 87, 15: 83, 14: 81, 16: 80, 18: 77, 20: 67, 19: 62, 21: 61, 23: 43, 22: 43, 24: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.12595415115356445  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.00341796875 GB
    Memory Allocated: 0.12595415115356445  GigaBytes
Max Memory Allocated: 5.9635233879089355  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.24169921875 GB
    Memory Allocated: 5.635711669921875  GigaBytes
Max Memory Allocated: 5.982480525970459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.24169921875 GB
    Memory Allocated: 5.636534690856934  GigaBytes
Max Memory Allocated: 5.982480525970459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.47998046875 GB
    Memory Allocated: 0.12825918197631836  GigaBytes
Max Memory Allocated: 5.982480525970459  GigaBytes

pseudo mini batch 15 input nodes size: 58033
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.47998046875 GB
    Memory Allocated: 0.12487030029296875  GigaBytes
Max Memory Allocated: 5.982480525970459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.47998046875 GB
    Memory Allocated: 0.12487030029296875  GigaBytes
Max Memory Allocated: 5.982480525970459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.47998046875 GB
    Memory Allocated: 0.1525425910949707  GigaBytes
Max Memory Allocated: 5.982480525970459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.47998046875 GB
    Memory Allocated: 0.15258502960205078  GigaBytes
Max Memory Allocated: 5.982480525970459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.47998046875 GB
    Memory Allocated: 0.1268482208251953  GigaBytes
Max Memory Allocated: 5.982480525970459  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1528, 1: 609, 2: 488, 3: 359, 4: 282, 5: 266, 6: 225, 7: 182, 9: 162, 8: 155, 11: 145, 10: 144, 12: 139, 13: 121, 14: 107, 20: 93, 15: 93, 16: 91, 21: 86, 18: 84, 19: 78, 17: 75, 24: 69, 23: 61, 22: 54})

----------------------------------------after blocks to device 
 Nvidia-smi: 7.47998046875 GB
    Memory Allocated: 0.1298203468322754  GigaBytes
Max Memory Allocated: 5.982480525970459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.47998046875 GB
    Memory Allocated: 0.1298203468322754  GigaBytes
Max Memory Allocated: 5.982480525970459  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.39208984375 GB
    Memory Allocated: 6.4326300621032715  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.39208984375 GB
    Memory Allocated: 6.433479309082031  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.13248634338378906  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.1985950469970703  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.1655406951904297  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05474831163883209 |0.003316938877105713 |0.17232787609100342 |0.0010211467742919922 |0.2162691056728363 |0.10837697982788086 |
----------------------------------------------------------pseudo_mini_loss sum 3.776425361633301
Total (block generation + training)time/epoch 50.777881145477295
Training time/epoch 7.362862825393677
Training time without block to device /epoch 7.309791803359985
Training time without total dataloading part /epoch 6.342267036437988
load block tensor time/epoch 0.8759729862213135
block to device time/epoch 0.053071022033691406
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  888279
Number of first layer input nodes during this epoch:  606274
Number of first layer output nodes during this epoch:  282005
----------------------------------------before generate dataloader block 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.14920806884765625  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.588 seconds, peak memory: 27.607 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.607 GB
Metis partitioning: 5.895 seconds, peak memory: 28.296 GB
Split the graph: 4.281 seconds
Construct subgraphs: 0.187 seconds
REG metis partition end ----................................
REG construction  time spent:  26.046995162963867
pure dgl.metis_partition the time spent:  11.980393171310425
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.891366720199585

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.067091226577759

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.14920806884765625  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

connection checking time:  1.941415786743164
block generation total time  2.9584579467773438
average batch blocks generation time:  0.18490362167358398
block dataloader generation time/epoch 43.555957436561584
pseudo mini batch 0 input nodes size: 33980
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.14532756805419922  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.14532756805419922  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.1615304946899414  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.1615738868713379  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.13385915756225586  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1057, 2: 815, 3: 679, 4: 511, 5: 479, 6: 334, 25: 278, 7: 273, 8: 237, 9: 201, 10: 154, 12: 111, 13: 109, 11: 98, 14: 71, 15: 69, 16: 53, 17: 43, 18: 43, 19: 41, 20: 32, 23: 25, 24: 22, 21: 21, 22: 18})

----------------------------------------after blocks to device 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.13510751724243164  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.13510751724243164  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 3.154120445251465  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 3.154982089996338  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.16750717163085938  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

pseudo mini batch 1 input nodes size: 39553
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.16609668731689453  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.16609668731689453  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.18562793731689453  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.1856703758239746  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.16942405700683594  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1091, 2: 936, 3: 685, 4: 525, 5: 455, 6: 338, 7: 233, 25: 221, 8: 206, 9: 191, 10: 153, 11: 110, 13: 79, 12: 78, 14: 64, 15: 63, 16: 59, 18: 48, 17: 41, 19: 34, 20: 25, 21: 19, 24: 15, 22: 11, 23: 9})

----------------------------------------after blocks to device 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.1706376075744629  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.1706376075744629  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 2.9994049072265625  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 3.000253200531006  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.17168045043945312  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

pseudo mini batch 2 input nodes size: 45037
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.17023563385009766  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.17023563385009766  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.19225788116455078  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.19229936599731445  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.17272567749023438  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 975, 2: 779, 3: 566, 25: 486, 4: 436, 5: 404, 6: 325, 7: 239, 8: 220, 9: 160, 10: 148, 11: 124, 12: 99, 13: 68, 14: 63, 16: 60, 15: 55, 19: 49, 18: 49, 17: 46, 20: 42, 21: 36, 22: 35, 24: 29, 23: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.1743936538696289  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.1743936538696289  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 3.79178524017334  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 3.7926082611083984  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.17585515975952148  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

pseudo mini batch 3 input nodes size: 57945
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.1737060546875  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.1737060546875  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.20133638381958008  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.20137786865234375  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.17931413650512695  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 989, 1: 784, 2: 645, 3: 516, 4: 378, 5: 328, 6: 250, 7: 207, 9: 171, 8: 163, 10: 137, 11: 122, 12: 108, 13: 98, 14: 81, 16: 67, 15: 64, 19: 63, 17: 61, 20: 59, 18: 59, 24: 51, 21: 45, 22: 41, 23: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.18160200119018555  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.66552734375 GB
    Memory Allocated: 0.18160200119018555  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.72607421875 GB
    Memory Allocated: 5.048709869384766  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.72607421875 GB
    Memory Allocated: 5.049532890319824  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.72607421875 GB
    Memory Allocated: 0.18365144729614258  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

pseudo mini batch 4 input nodes size: 53621
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.72607421875 GB
    Memory Allocated: 0.1806349754333496  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.72607421875 GB
    Memory Allocated: 0.1806349754333496  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.72607421875 GB
    Memory Allocated: 0.20620346069335938  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.72607421875 GB
    Memory Allocated: 0.20624589920043945  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.72607421875 GB
    Memory Allocated: 0.1785740852355957  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1657, 1: 575, 2: 456, 3: 344, 4: 267, 5: 223, 6: 216, 7: 173, 9: 165, 8: 163, 10: 159, 12: 146, 11: 123, 13: 111, 18: 108, 14: 98, 15: 94, 20: 93, 21: 90, 16: 84, 19: 80, 17: 75, 23: 68, 24: 66, 22: 55})

----------------------------------------after blocks to device 
 Nvidia-smi: 8.72607421875 GB
    Memory Allocated: 0.18155193328857422  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.72607421875 GB
    Memory Allocated: 0.18155193328857422  GigaBytes
Max Memory Allocated: 6.8441925048828125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.19482421875 GB
    Memory Allocated: 6.623263835906982  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.19482421875 GB
    Memory Allocated: 6.624112129211426  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18419218063354492  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 5 input nodes size: 57621
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18039608001708984  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18039608001708984  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.2078719139099121  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.20791339874267578  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18230247497558594  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1146, 1: 709, 2: 571, 3: 489, 4: 385, 5: 308, 6: 221, 7: 206, 8: 172, 9: 149, 12: 125, 10: 124, 11: 123, 13: 105, 17: 89, 16: 86, 15: 86, 14: 78, 20: 62, 18: 60, 19: 60, 21: 55, 24: 39, 22: 35, 23: 34})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1848602294921875  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1848602294921875  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 5.494717597961426  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 5.495540618896484  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18713998794555664  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 6 input nodes size: 66023
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18370437622070312  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18370437622070312  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.21518659591674805  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.21522808074951172  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18771076202392578  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1057, 1: 727, 2: 605, 3: 451, 4: 344, 5: 328, 6: 254, 7: 201, 8: 174, 9: 153, 11: 144, 10: 134, 12: 118, 15: 103, 13: 98, 14: 97, 16: 83, 18: 78, 21: 68, 17: 65, 19: 65, 20: 47, 22: 45, 24: 41, 23: 37})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.19040584564208984  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.19040584564208984  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 5.629604339599609  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 5.630427360534668  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.19287586212158203  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 7 input nodes size: 62232
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18912172317504883  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18912172317504883  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.2187962532043457  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.21883773803710938  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18731403350830078  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 884, 2: 830, 3: 617, 25: 554, 4: 464, 5: 376, 6: 258, 7: 240, 8: 168, 10: 151, 9: 149, 11: 126, 12: 98, 13: 92, 14: 80, 15: 60, 17: 57, 20: 49, 19: 48, 16: 48, 18: 41, 21: 38, 23: 37, 22: 33, 24: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18931961059570312  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18931961059570312  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 4.263664722442627  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 4.2644877433776855  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.19116592407226562  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 8 input nodes size: 29076
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18837404251098633  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18837404251098633  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.2022385597229004  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.20228195190429688  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17256593704223633  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 700, 2: 676, 3: 570, 25: 534, 4: 506, 5: 389, 6: 327, 7: 287, 8: 262, 9: 213, 10: 200, 11: 181, 12: 167, 13: 129, 14: 104, 15: 98, 17: 80, 16: 66, 18: 58, 19: 57, 22: 57, 20: 49, 21: 45, 24: 37, 23: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17396974563598633  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17396974563598633  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.8307948112487793  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.831663131713867  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17512798309326172  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 9 input nodes size: 24399
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17377710342407227  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17377710342407227  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18549585342407227  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18553781509399414  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1716299057006836  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 737, 2: 715, 3: 567, 4: 475, 25: 454, 5: 354, 6: 300, 7: 266, 8: 229, 9: 213, 10: 166, 12: 155, 11: 151, 13: 101, 14: 97, 16: 78, 15: 78, 17: 75, 18: 73, 19: 63, 20: 58, 21: 57, 23: 49, 22: 37, 24: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17290496826171875  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17290496826171875  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.5505456924438477  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.551377773284912  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1738739013671875  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 10 input nodes size: 20045
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17267513275146484  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17267513275146484  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18253421783447266  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18257761001586914  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17081689834594727  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 642, 2: 606, 3: 570, 25: 488, 4: 449, 5: 424, 6: 366, 7: 291, 8: 250, 10: 217, 11: 202, 9: 199, 13: 142, 14: 129, 12: 128, 17: 105, 15: 98, 16: 94, 20: 74, 18: 74, 21: 65, 19: 60, 22: 47, 24: 44, 23: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17216253280639648  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17216253280639648  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.8415112495422363  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.8423757553100586  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17322778701782227  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 11 input nodes size: 21569
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17203760147094727  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17203760147094727  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18232250213623047  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18236637115478516  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17246389389038086  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 726, 2: 635, 3: 569, 25: 544, 4: 460, 5: 409, 6: 335, 7: 303, 8: 254, 9: 226, 10: 195, 11: 171, 12: 146, 13: 128, 14: 127, 15: 108, 17: 90, 16: 74, 20: 69, 18: 65, 21: 57, 19: 54, 24: 38, 23: 38, 22: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1738591194152832  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1738591194152832  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.8987860679626465  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.8996591567993164  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17496347427368164  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 12 input nodes size: 20360
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1736607551574707  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1736607551574707  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18351984024047852  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1835637092590332  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1732349395751953  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 861, 2: 811, 3: 637, 4: 523, 5: 433, 6: 363, 7: 321, 25: 276, 8: 249, 9: 221, 10: 190, 11: 157, 12: 123, 13: 119, 14: 89, 15: 82, 16: 79, 19: 56, 17: 46, 20: 43, 18: 43, 21: 33, 22: 31, 23: 24, 24: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17435073852539062  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17435073852539062  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.1791300773620605  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.179999828338623  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17522573471069336  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 13 input nodes size: 18564
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17419719696044922  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17419719696044922  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18304920196533203  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18309259414672852  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17318964004516602  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1143, 2: 1007, 3: 764, 4: 546, 5: 469, 6: 328, 7: 275, 8: 224, 9: 173, 10: 137, 11: 110, 12: 104, 25: 93, 13: 66, 15: 62, 14: 58, 17: 39, 16: 38, 18: 34, 21: 20, 19: 19, 22: 15, 24: 14, 20: 12, 23: 12})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17403650283813477  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17403650283813477  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 2.4532766342163086  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 2.4541358947753906  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17470693588256836  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 14 input nodes size: 31168
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17390680313110352  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17390680313110352  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1888718605041504  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18891525268554688  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18001985549926758  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1005, 2: 852, 3: 656, 4: 497, 5: 406, 6: 344, 25: 343, 7: 262, 8: 236, 9: 187, 10: 163, 11: 121, 12: 99, 13: 99, 15: 89, 14: 82, 16: 66, 17: 60, 18: 52, 20: 48, 23: 34, 19: 33, 21: 26, 22: 26, 24: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1812901496887207  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1812901496887207  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.323050022125244  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.323915958404541  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18235445022583008  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 15 input nodes size: 26852
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18099117279052734  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18099117279052734  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.19379520416259766  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.19383811950683594  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17882966995239258  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 812, 2: 767, 3: 597, 4: 554, 5: 437, 25: 340, 6: 309, 7: 268, 8: 265, 9: 205, 10: 171, 11: 140, 12: 132, 14: 116, 13: 112, 15: 80, 16: 76, 18: 63, 17: 58, 19: 54, 20: 45, 21: 42, 22: 37, 23: 36, 24: 34})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18005752563476562  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18005752563476562  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.3930201530456543  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.3938775062561035  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1810321807861328  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1810321807861328  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1479778289794922  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05760301649570465 |0.003921717405319214 |0.1113213449716568 |0.00013568997383117676 |0.21134279668331146 |0.008985280990600586 |
----------------------------------------------------------pseudo_mini_loss sum 18.539485931396484
Total (block generation + training)time/epoch 50.39490509033203
Training time/epoch 6.314306735992432
Training time without block to device /epoch 6.251559257507324
Training time without total dataloading part /epoch 5.173782587051392
load block tensor time/epoch 0.9216482639312744
block to device time/epoch 0.06274747848510742
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  888692
Number of first layer input nodes during this epoch:  608045
Number of first layer output nodes during this epoch:  280647
----------------------------------------before generate dataloader block 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.13094758987426758  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.463 seconds, peak memory: 28.666 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 28.666 GB
Metis partitioning: 5.558 seconds, peak memory: 29.405 GB
Split the graph: 4.510 seconds
Construct subgraphs: 0.106 seconds
REG metis partition end ----................................
REG construction  time spent:  26.134995937347412
pure dgl.metis_partition the time spent:  11.663488149642944
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.9215419292449951

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.1507997512817383

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.13094758987426758  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

connection checking time:  2.0055816173553467
block generation total time  3.0723416805267334
average batch blocks generation time:  0.19202135503292084
block dataloader generation time/epoch 43.59588225682577
pseudo mini batch 0 input nodes size: 21596
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.12975406646728516  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.12975406646728516  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.14005184173583984  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.14009571075439453  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.12724876403808594  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 558, 2: 536, 3: 515, 25: 513, 4: 446, 5: 400, 6: 379, 7: 332, 8: 274, 10: 247, 9: 231, 11: 217, 13: 154, 12: 152, 14: 130, 16: 116, 17: 107, 15: 99, 20: 90, 18: 86, 21: 71, 19: 67, 24: 46, 22: 45, 23: 43})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.12865257263183594  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.12865257263183594  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.9802308082580566  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.9811043739318848  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1617727279663086  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 1 input nodes size: 23351
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16056489944458008  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16056489944458008  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17169952392578125  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17174291610717773  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16140127182006836  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 957, 2: 840, 3: 631, 4: 510, 5: 403, 25: 398, 6: 309, 8: 241, 7: 222, 9: 186, 10: 145, 12: 135, 11: 128, 13: 96, 14: 88, 15: 70, 16: 69, 19: 61, 17: 60, 18: 58, 21: 53, 23: 40, 22: 37, 20: 34, 24: 26})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16256952285766602  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16256952285766602  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.2898178100585938  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.290682315826416  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1634821891784668  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 2 input nodes size: 23379
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1624002456665039  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1624002456665039  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1741189956665039  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17416095733642578  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16298294067382812  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 872, 2: 706, 3: 646, 4: 471, 25: 421, 5: 396, 6: 331, 7: 251, 8: 222, 9: 178, 10: 171, 11: 127, 12: 123, 15: 92, 13: 89, 14: 88, 17: 73, 18: 52, 16: 49, 20: 49, 19: 47, 21: 45, 23: 30, 22: 27, 24: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16419029235839844  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16419029235839844  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.3268980979919434  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.327730178833008  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16512489318847656  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 3 input nodes size: 22374
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16394996643066406  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16394996643066406  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17461872100830078  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17466020584106445  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16289949417114258  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 790, 2: 719, 3: 589, 4: 474, 25: 407, 5: 374, 6: 290, 7: 272, 8: 225, 9: 197, 10: 159, 11: 155, 12: 119, 13: 112, 14: 108, 15: 89, 16: 75, 17: 75, 20: 57, 18: 52, 19: 45, 21: 43, 24: 36, 23: 34, 22: 26})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1641545295715332  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1641545295715332  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.427560806274414  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.428384304046631  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16515302658081055  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 4 input nodes size: 18808
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16391324996948242  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16391324996948242  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17377233505249023  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17381620407104492  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16310596466064453  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 843, 2: 785, 3: 638, 4: 537, 5: 437, 6: 353, 7: 324, 25: 274, 8: 262, 9: 223, 10: 197, 11: 154, 12: 128, 13: 125, 14: 92, 15: 86, 16: 76, 19: 58, 20: 50, 18: 50, 17: 46, 22: 35, 21: 29, 23: 27, 24: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16421031951904297  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16421031951904297  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.1956777572631836  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.1965508460998535  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1651172637939453  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 5 input nodes size: 22354
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16413640975952148  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16413640975952148  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17479562759399414  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17483949661254883  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16493654251098633  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1051, 2: 971, 3: 735, 4: 546, 5: 474, 6: 352, 7: 275, 8: 242, 9: 193, 10: 165, 25: 136, 11: 121, 12: 98, 13: 91, 14: 73, 15: 72, 16: 54, 17: 46, 18: 43, 19: 29, 21: 23, 20: 22, 22: 16, 24: 15, 23: 11})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16588640213012695  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16588640213012695  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 2.6905722618103027  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 2.6914453506469727  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16664838790893555  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 6 input nodes size: 31088
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16574335098266602  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16574335098266602  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1807084083557129  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18075227737426758  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17004919052124023  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 660, 2: 646, 25: 594, 3: 565, 4: 474, 5: 403, 6: 326, 7: 301, 8: 276, 9: 221, 10: 211, 11: 177, 12: 159, 13: 135, 14: 117, 15: 106, 17: 73, 16: 65, 22: 60, 19: 57, 18: 57, 21: 51, 20: 51, 24: 40, 23: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1715092658996582  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1715092658996582  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.9759011268615723  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.976774215698242  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17266607284545898  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 7 input nodes size: 25402
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17126226425170898  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17126226425170898  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18337488174438477  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18341827392578125  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1684093475341797  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 877, 2: 841, 3: 648, 4: 533, 5: 456, 6: 346, 7: 309, 8: 235, 25: 231, 9: 213, 10: 172, 11: 136, 12: 129, 13: 113, 14: 95, 15: 80, 17: 76, 16: 65, 18: 53, 19: 45, 20: 44, 21: 38, 22: 27, 23: 27, 24: 26})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16954326629638672  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16954326629638672  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.145576000213623  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.1464433670043945  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17044734954833984  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 8 input nodes size: 34017
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16934585571289062  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.16934585571289062  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18556642532348633  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1856083869934082  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17345237731933594  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 960, 2: 811, 3: 602, 4: 503, 5: 405, 25: 355, 6: 302, 7: 240, 8: 211, 9: 183, 10: 144, 11: 131, 12: 105, 13: 85, 14: 80, 15: 72, 18: 68, 16: 66, 17: 55, 19: 39, 20: 37, 23: 35, 21: 34, 22: 30, 24: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17474842071533203  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17474842071533203  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.3312768936157227  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.332108974456787  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17580604553222656  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 9 input nodes size: 31651
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17436838150024414  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17436838150024414  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18946075439453125  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18950271606445312  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17324018478393555  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 970, 2: 814, 3: 660, 4: 493, 5: 457, 6: 340, 25: 282, 7: 254, 8: 239, 9: 176, 10: 144, 11: 111, 12: 110, 13: 100, 14: 83, 15: 69, 16: 54, 17: 41, 20: 38, 18: 34, 19: 32, 21: 22, 23: 21, 24: 20, 22: 14})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1744236946105957  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1744236946105957  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.0770792961120605  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.077911376953125  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17542123794555664  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 10 input nodes size: 43436
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1741166114807129  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1741166114807129  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.19482851028442383  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1948699951171875  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.17973566055297852  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1166, 2: 987, 3: 711, 4: 502, 5: 425, 6: 293, 7: 235, 25: 205, 8: 185, 9: 149, 10: 116, 11: 98, 12: 85, 13: 56, 14: 52, 15: 44, 18: 37, 17: 34, 16: 34, 19: 29, 20: 28, 23: 16, 22: 15, 24: 13, 21: 13})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18095636367797852  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18095636367797852  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 2.904684066772461  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 2.905508518218994  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18204355239868164  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 11 input nodes size: 47316
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18048763275146484  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18048763275146484  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.20392513275146484  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.20396661758422852  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1832132339477539  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 957, 2: 808, 3: 572, 25: 532, 4: 401, 5: 382, 6: 299, 7: 244, 8: 198, 9: 163, 10: 145, 11: 133, 12: 100, 13: 81, 14: 64, 16: 62, 15: 58, 17: 54, 18: 49, 19: 44, 20: 42, 21: 40, 24: 34, 22: 33, 23: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1849803924560547  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1849803924560547  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.9604101181030273  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 3.961233139038086  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18656492233276367  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

pseudo mini batch 12 input nodes size: 52258
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18424749374389648  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18424749374389648  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.20963811874389648  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.20968198776245117  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.1862030029296875  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1789, 1: 500, 2: 377, 3: 366, 4: 294, 5: 264, 6: 220, 7: 170, 9: 169, 8: 158, 10: 156, 12: 144, 11: 134, 13: 131, 21: 107, 14: 99, 15: 98, 17: 97, 18: 97, 16: 95, 20: 92, 19: 85, 24: 79, 23: 69, 22: 64})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18922996520996094  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.47998046875 GB
    Memory Allocated: 0.18922996520996094  GigaBytes
Max Memory Allocated: 7.059371471405029  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.78466796875 GB
    Memory Allocated: 6.885632038116455  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.78466796875 GB
    Memory Allocated: 6.886505126953125  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19190263748168945  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 13 input nodes size: 54974
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18816328048706055  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18816328048706055  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.21437692642211914  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2144184112548828  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18898391723632812  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 936, 1: 868, 2: 667, 3: 498, 4: 400, 5: 328, 6: 237, 7: 208, 9: 165, 8: 162, 10: 140, 11: 122, 12: 119, 13: 96, 14: 77, 15: 74, 16: 69, 17: 67, 19: 64, 20: 59, 18: 56, 21: 38, 23: 31, 24: 30, 22: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1912975311279297  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1912975311279297  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.977865219116211  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.978691577911377  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1933441162109375  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 14 input nodes size: 59600
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19022035598754883  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19022035598754883  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.21951723098754883  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2195601463317871  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19330501556396484  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1485, 1: 548, 2: 541, 3: 378, 4: 317, 5: 311, 6: 235, 7: 193, 8: 168, 9: 163, 10: 146, 11: 134, 12: 122, 13: 112, 14: 109, 15: 93, 16: 92, 18: 85, 19: 84, 17: 79, 21: 71, 20: 69, 22: 62, 24: 55, 23: 48})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19620656967163086  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19620656967163086  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 6.362369060516357  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 6.363219261169434  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19881010055541992  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 15 input nodes size: 63228
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19501924514770508  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19501924514770508  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.22516870498657227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.22521018981933594  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19587039947509766  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 902, 1: 851, 2: 657, 3: 523, 4: 419, 5: 307, 6: 256, 7: 215, 8: 174, 9: 166, 10: 141, 11: 125, 12: 109, 15: 87, 13: 80, 14: 79, 18: 71, 16: 70, 19: 50, 17: 47, 20: 45, 21: 39, 23: 36, 22: 36, 24: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19830608367919922  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19830608367919922  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.089817047119141  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.090640068054199  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2005162239074707  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2005162239074707  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16746187210083008  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.053401485085487366 |0.0030740052461624146 |0.10832907259464264 |0.0001377016305923462 |0.21424564719200134 |0.0050868988037109375 |
----------------------------------------------------------pseudo_mini_loss sum 8.542718887329102
Total (block generation + training)time/epoch 50.23733123143514
Training time/epoch 6.246041297912598
Training time without block to device /epoch 6.196857213973999
Training time without total dataloading part /epoch 5.168485641479492
load block tensor time/epoch 0.8544237613677979
block to device time/epoch 0.04918408393859863
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  844879
Number of first layer input nodes during this epoch:  574832
Number of first layer output nodes during this epoch:  270047
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.15071916580200195  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.602 seconds, peak memory: 29.448 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 29.448 GB
Metis partitioning: 5.929 seconds, peak memory: 29.915 GB
Split the graph: 3.835 seconds
Construct subgraphs: 0.103 seconds
REG metis partition end ----................................
REG construction  time spent:  25.87112331390381
pure dgl.metis_partition the time spent:  11.498889923095703
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8536262512207031

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.0897867679595947

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.15071916580200195  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

connection checking time:  1.9424612522125244
block generation total time  2.943413019180298
average batch blocks generation time:  0.18396331369876862
block dataloader generation time/epoch 43.447514295578
pseudo mini batch 0 input nodes size: 24827
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.14731645584106445  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.14731645584106445  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.15915489196777344  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.15919828414916992  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.12900733947753906  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 891, 2: 759, 3: 650, 4: 547, 5: 441, 6: 334, 25: 307, 7: 283, 8: 249, 9: 198, 10: 168, 11: 141, 12: 129, 13: 96, 15: 91, 14: 83, 16: 75, 17: 61, 19: 52, 20: 52, 18: 46, 21: 34, 22: 31, 23: 27, 24: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.13019084930419922  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.13019084930419922  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.229246139526367  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.230106830596924  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1629652976989746  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 1 input nodes size: 33296
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16180133819580078  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16180133819580078  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17767810821533203  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17772197723388672  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16584014892578125  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 758, 2: 701, 25: 578, 3: 547, 4: 491, 5: 389, 6: 298, 7: 279, 8: 241, 9: 208, 10: 202, 12: 144, 11: 138, 13: 124, 14: 124, 15: 101, 17: 80, 16: 76, 18: 67, 19: 59, 22: 52, 20: 52, 21: 49, 24: 39, 23: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16732501983642578  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16732501983642578  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.9495468139648438  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.950416088104248  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1685328483581543  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 2 input nodes size: 28009
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16703414916992188  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16703414916992188  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1803898811340332  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1804337501525879  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16451311111450195  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 879, 2: 767, 3: 587, 4: 501, 5: 435, 25: 382, 6: 347, 8: 279, 7: 275, 9: 202, 10: 185, 11: 147, 12: 132, 13: 107, 14: 100, 15: 87, 16: 70, 18: 64, 17: 63, 21: 47, 20: 45, 23: 42, 19: 42, 22: 38, 24: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1658158302307129  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1658158302307129  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.5262537002563477  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.5271267890930176  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16687440872192383  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 3 input nodes size: 20019
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16556739807128906  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16556739807128906  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17542648315429688  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17546987533569336  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16207027435302734  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 924, 2: 914, 3: 711, 4: 571, 5: 462, 6: 364, 7: 292, 8: 250, 9: 213, 10: 177, 11: 137, 25: 129, 12: 107, 13: 105, 14: 89, 15: 76, 16: 52, 17: 40, 18: 39, 19: 35, 20: 27, 22: 24, 24: 21, 21: 17, 23: 13})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16303539276123047  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16303539276123047  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.7521982192993164  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.7530617713928223  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16379451751708984  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 4 input nodes size: 21008
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16288995742797852  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16288995742797852  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17290735244750977  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17295122146606445  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16304874420166016  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 582, 2: 565, 1: 509, 3: 505, 4: 442, 5: 403, 6: 358, 7: 328, 8: 263, 9: 241, 10: 223, 11: 201, 13: 157, 12: 156, 14: 133, 17: 108, 16: 102, 15: 91, 18: 85, 20: 77, 19: 76, 21: 71, 22: 55, 23: 54, 24: 53})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1644906997680664  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1644906997680664  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.11964225769043  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.120512962341309  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16559362411499023  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 5 input nodes size: 21245
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1643509864807129  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1643509864807129  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17448139190673828  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17452383041381836  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16446256637573242  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 960, 2: 816, 3: 648, 4: 495, 5: 411, 6: 325, 7: 265, 8: 242, 25: 237, 9: 180, 10: 165, 11: 160, 12: 129, 13: 105, 14: 82, 15: 72, 16: 58, 18: 51, 17: 50, 20: 42, 19: 39, 21: 35, 22: 29, 23: 26, 24: 21})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16551876068115234  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16551876068115234  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.9705796241760254  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.971421241760254  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16632890701293945  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 6 input nodes size: 21958
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1653285026550293  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1653285026550293  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17579889297485352  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17584228515625  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16566944122314453  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 700, 2: 605, 25: 577, 3: 567, 4: 443, 5: 407, 6: 329, 7: 293, 8: 250, 9: 223, 10: 193, 11: 165, 12: 154, 14: 132, 13: 129, 15: 110, 17: 89, 16: 77, 20: 69, 18: 68, 21: 57, 19: 53, 23: 44, 24: 40, 22: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16709518432617188  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16709518432617188  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.9410152435302734  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.9418811798095703  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16823911666870117  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 7 input nodes size: 26221
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1669020652770996  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1669020652770996  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17940521240234375  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17944669723510742  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16893291473388672  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1025, 2: 808, 3: 648, 4: 493, 5: 388, 6: 312, 25: 297, 7: 242, 8: 206, 9: 172, 10: 150, 11: 132, 12: 96, 13: 73, 15: 72, 16: 67, 14: 63, 17: 62, 18: 47, 21: 45, 19: 37, 20: 37, 22: 22, 23: 19, 24: 18})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17008018493652344  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17008018493652344  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.052417278289795  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.0532422065734863  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.170989990234375  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 8 input nodes size: 28568
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16977643966674805  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16977643966674805  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18339872360229492  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1834421157836914  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1708974838256836  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 938, 2: 815, 3: 694, 4: 528, 5: 470, 6: 358, 7: 287, 25: 273, 8: 243, 9: 204, 10: 150, 11: 116, 12: 114, 13: 110, 14: 96, 15: 67, 16: 58, 18: 51, 17: 49, 19: 45, 20: 37, 23: 27, 22: 24, 24: 21, 21: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1720905303955078  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1720905303955078  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.19606351852417  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.196927070617676  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17311906814575195  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 9 input nodes size: 29412
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17186212539672852  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17186212539672852  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1868271827697754  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18687009811401367  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1732044219970703  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1131, 2: 983, 3: 713, 4: 537, 5: 445, 6: 327, 7: 241, 8: 219, 9: 172, 10: 156, 25: 153, 11: 109, 13: 90, 12: 89, 14: 58, 15: 57, 16: 49, 17: 46, 18: 36, 19: 29, 20: 26, 21: 19, 24: 12, 23: 10, 22: 10})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17421483993530273  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17421483993530273  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.7165069580078125  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.7173595428466797  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17505168914794922  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 10 input nodes size: 46236
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1739654541015625  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1739654541015625  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1960124969482422  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19605398178100586  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1810460090637207  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 997, 2: 773, 3: 556, 25: 492, 4: 390, 5: 387, 6: 315, 7: 241, 8: 211, 9: 165, 10: 152, 11: 147, 12: 106, 13: 74, 14: 68, 15: 63, 19: 58, 16: 56, 17: 54, 20: 52, 21: 44, 18: 44, 24: 37, 22: 29, 23: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1827702522277832  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1827702522277832  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.9288015365600586  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.929626941680908  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18428421020507812  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 11 input nodes size: 56474
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18205022811889648  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18205022811889648  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.20897912979125977  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.20902061462402344  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18693208694458008  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 892, 25: 860, 2: 748, 3: 576, 4: 460, 5: 340, 6: 228, 7: 180, 9: 175, 8: 172, 10: 121, 11: 102, 12: 89, 13: 83, 14: 72, 15: 58, 16: 53, 17: 49, 18: 48, 19: 46, 20: 42, 22: 37, 21: 33, 24: 30, 23: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18906450271606445  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18906450271606445  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.617093086242676  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.617916107177734  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1909952163696289  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 12 input nodes size: 66329
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18811655044555664  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18811655044555664  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.21974468231201172  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2197861671447754  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19281578063964844  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 855, 2: 776, 25: 735, 3: 527, 4: 397, 5: 343, 6: 273, 7: 238, 8: 183, 9: 148, 10: 130, 11: 116, 12: 111, 15: 84, 13: 77, 18: 72, 14: 70, 16: 62, 17: 59, 20: 59, 19: 54, 21: 46, 24: 39, 23: 37, 22: 34})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19512653350830078  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19512653350830078  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.820170879364014  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.820994853973389  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19726181030273438  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 13 input nodes size: 62267
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19401168823242188  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19401168823242188  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.22370290756225586  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.22374486923217773  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19207525253295898  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1064, 1: 705, 2: 648, 3: 493, 4: 373, 5: 352, 6: 253, 7: 210, 8: 168, 9: 157, 10: 148, 11: 138, 12: 114, 13: 101, 15: 86, 14: 85, 16: 80, 18: 77, 17: 63, 21: 62, 19: 59, 20: 44, 22: 42, 23: 40, 24: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19468355178833008  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19468355178833008  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.493090629577637  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.493924617767334  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19707012176513672  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 14 input nodes size: 56723
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19348621368408203  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19348621368408203  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2205338478088379  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.22057533264160156  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1908421516418457  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1493, 1: 629, 2: 482, 3: 421, 4: 329, 5: 256, 6: 207, 7: 194, 9: 145, 8: 141, 12: 132, 11: 120, 10: 120, 13: 105, 16: 86, 15: 82, 17: 79, 14: 74, 18: 73, 21: 66, 20: 63, 19: 61, 24: 59, 23: 52, 22: 48})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19364213943481445  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19364213943481445  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 6.1363301277160645  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 6.137153148651123  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1961212158203125  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 15 input nodes size: 54174
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19245672225952148  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19245672225952148  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.21828889846801758  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.21833133697509766  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19124221801757812  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1301, 1: 635, 2: 546, 3: 434, 4: 323, 5: 293, 6: 240, 7: 197, 9: 173, 10: 159, 8: 155, 12: 135, 11: 134, 13: 120, 14: 105, 15: 92, 19: 91, 16: 90, 20: 83, 18: 80, 17: 78, 21: 75, 24: 51, 23: 49, 22: 49})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19391965866088867  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19391965866088867  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.923323154449463  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.924171447753906  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19631195068359375  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19631195068359375  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16325759887695312  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.051821112632751465 |0.0025162100791931152 |0.11063529551029205 |0.0001236647367477417 |0.21307823061943054 |0.005706787109375 |
----------------------------------------------------------pseudo_mini_loss sum 4.8227949142456055
Total (block generation + training)time/epoch 49.991775929927826
Training time/epoch 6.252317667007446
Training time without block to device /epoch 6.2120583057403564
Training time without total dataloading part /epoch 5.1871018409729
load block tensor time/epoch 0.8291378021240234
block to device time/epoch 0.040259361267089844
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  876770
Number of first layer input nodes during this epoch:  596766
Number of first layer output nodes during this epoch:  280004
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.14679956436157227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.513 seconds, peak memory: 29.915 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 29.915 GB
Metis partitioning: 5.811 seconds, peak memory: 30.097 GB
Split the graph: 4.473 seconds
Construct subgraphs: 0.102 seconds
REG metis partition end ----................................
REG construction  time spent:  26.373767137527466
pure dgl.metis_partition the time spent:  11.928462266921997
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8544998168945312

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.1987483501434326

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.14679956436157227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

connection checking time:  1.9876205921173096
block generation total time  3.053248167037964
average batch blocks generation time:  0.19082801043987274
block dataloader generation time/epoch 43.567189884185794
pseudo mini batch 0 input nodes size: 21424
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.14334392547607422  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.14334392547607422  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.15355968475341797  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.15360355377197266  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.12772893905639648  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 707, 2: 651, 25: 574, 3: 557, 4: 460, 5: 394, 6: 316, 7: 289, 8: 259, 9: 221, 10: 200, 11: 169, 12: 148, 13: 131, 14: 128, 15: 106, 17: 89, 16: 78, 20: 70, 18: 65, 21: 61, 19: 59, 23: 39, 22: 38, 24: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.12914323806762695  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.12914323806762695  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.888401508331299  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.8892741203308105  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16174030303955078  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 1 input nodes size: 25143
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16042661666870117  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16042661666870117  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17241573333740234  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17245721817016602  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16219758987426758  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1011, 2: 775, 3: 661, 4: 501, 5: 406, 25: 324, 6: 314, 7: 254, 8: 201, 9: 168, 10: 153, 11: 118, 12: 95, 13: 94, 15: 73, 14: 72, 17: 56, 16: 51, 19: 44, 20: 43, 18: 41, 21: 37, 24: 24, 23: 18, 22: 18})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16333627700805664  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16333627700805664  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.06105899810791  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.061886787414551  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16422748565673828  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 2 input nodes size: 20215
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16305112838745117  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16305112838745117  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17291021347045898  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17295408248901367  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16092348098754883  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 629, 1: 614, 3: 570, 4: 476, 5: 404, 6: 386, 25: 383, 7: 318, 8: 281, 11: 236, 9: 224, 10: 222, 12: 151, 13: 145, 14: 128, 16: 95, 15: 90, 17: 89, 20: 83, 18: 78, 21: 53, 19: 52, 22: 48, 24: 43, 23: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16220998764038086  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16220998764038086  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.6980953216552734  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.698965549468994  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16323471069335938  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 3 input nodes size: 21673
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16211843490600586  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16211843490600586  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1724529266357422  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17249631881713867  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16259336471557617  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 760, 2: 759, 3: 634, 4: 517, 5: 429, 25: 392, 6: 363, 7: 284, 8: 250, 9: 227, 10: 171, 12: 164, 11: 139, 13: 100, 14: 93, 15: 83, 16: 74, 17: 73, 18: 66, 19: 55, 21: 50, 23: 45, 20: 35, 22: 32, 24: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16378164291381836  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16378164291381836  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.4056081771850586  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.4064764976501465  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16470003128051758  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 4 input nodes size: 29545
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16364526748657227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16364526748657227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17861032485961914  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17865324020385742  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1682753562927246  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 838, 2: 776, 3: 591, 4: 481, 5: 441, 25: 396, 6: 320, 8: 262, 7: 257, 9: 212, 10: 171, 11: 139, 13: 112, 12: 112, 14: 92, 15: 90, 17: 71, 16: 66, 18: 60, 19: 56, 20: 55, 23: 45, 22: 41, 21: 41, 24: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16959476470947266  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16959476470947266  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.544036388397217  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.544894218444824  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17066001892089844  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 5 input nodes size: 23994
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1693134307861328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1693134307861328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1810321807861328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1810755729675293  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16606760025024414  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 849, 2: 780, 3: 615, 4: 520, 5: 411, 25: 359, 6: 316, 7: 297, 8: 236, 9: 215, 10: 188, 11: 148, 12: 124, 13: 119, 14: 106, 15: 84, 16: 81, 17: 64, 19: 58, 20: 56, 18: 55, 21: 39, 22: 30, 23: 27, 24: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16728639602661133  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16728639602661133  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.390233039855957  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.3910984992980957  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16826295852661133  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 6 input nodes size: 31195
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16710138320922852  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16710138320922852  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1820664405822754  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18211030960083008  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1703481674194336  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 810, 2: 767, 3: 627, 4: 494, 25: 447, 5: 421, 6: 309, 7: 275, 8: 258, 9: 207, 10: 194, 12: 148, 11: 144, 13: 103, 15: 98, 14: 95, 17: 72, 16: 66, 18: 57, 19: 51, 22: 49, 20: 45, 21: 44, 24: 34, 23: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17169761657714844  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17169761657714844  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.6478352546691895  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.6487059593200684  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17279386520385742  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 7 input nodes size: 20660
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17143535614013672  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17143535614013672  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18129444122314453  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18133783340454102  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16632890701293945  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 949, 2: 882, 3: 706, 4: 594, 5: 466, 6: 347, 7: 309, 8: 244, 9: 208, 10: 166, 25: 160, 11: 131, 13: 105, 12: 101, 15: 82, 14: 79, 16: 52, 17: 46, 18: 41, 19: 35, 20: 26, 22: 20, 24: 20, 23: 19, 21: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16732454299926758  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16732454299926758  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.817492961883545  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.818358898162842  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16811895370483398  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 8 input nodes size: 44722
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16717004776000977  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16717004776000977  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1891922950744629  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18923377990722656  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17933130264282227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1044, 2: 873, 3: 665, 4: 503, 5: 395, 6: 308, 7: 275, 25: 270, 8: 197, 9: 172, 10: 154, 11: 102, 12: 94, 13: 84, 14: 70, 16: 57, 17: 54, 15: 52, 18: 39, 19: 32, 20: 31, 21: 27, 24: 24, 22: 20, 23: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1806931495666504  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1806931495666504  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.237795352935791  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.2386245727539062  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18186378479003906  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 9 input nodes size: 56570
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18015670776367188  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18015670776367188  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.20713138580322266  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.20717287063598633  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18510913848876953  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 959, 1: 818, 2: 699, 3: 523, 4: 388, 5: 334, 6: 255, 7: 194, 9: 166, 8: 141, 10: 130, 11: 124, 12: 117, 13: 89, 14: 75, 15: 73, 19: 66, 18: 66, 16: 63, 17: 52, 22: 43, 20: 43, 24: 37, 21: 34, 23: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1873607635498047  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1873607635498047  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.9145660400390625  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.915389060974121  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1893782615661621  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 10 input nodes size: 30956
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1863856315612793  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1863856315612793  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.20135068893432617  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.20139265060424805  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1743764877319336  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1107, 2: 884, 3: 714, 4: 510, 5: 464, 6: 331, 7: 249, 8: 231, 25: 191, 9: 160, 10: 121, 12: 107, 11: 97, 13: 84, 14: 70, 15: 51, 16: 49, 18: 37, 17: 37, 19: 25, 20: 24, 23: 20, 21: 19, 22: 16, 24: 15})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17545795440673828  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17545795440673828  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.82291316986084  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.8237504959106445  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1763935089111328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 11 input nodes size: 44999
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17518329620361328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17518329620361328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1972055435180664  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19724750518798828  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18224048614501953  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1005, 2: 772, 3: 553, 25: 480, 4: 434, 5: 386, 6: 309, 7: 255, 8: 230, 9: 168, 10: 160, 11: 143, 12: 96, 13: 80, 14: 69, 15: 63, 17: 55, 16: 54, 19: 53, 20: 50, 18: 44, 21: 40, 24: 32, 22: 32, 23: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1839303970336914  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1839303970336914  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.89454984664917  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.895382881164551  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18543004989624023  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 12 input nodes size: 63777
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18326282501220703  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18326282501220703  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.21367406845092773  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2137155532836914  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1916513442993164  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 880, 2: 812, 25: 700, 3: 558, 4: 447, 5: 365, 6: 265, 7: 224, 8: 188, 9: 155, 11: 130, 10: 126, 12: 102, 13: 89, 14: 79, 15: 72, 16: 69, 18: 59, 19: 50, 20: 42, 17: 41, 21: 31, 24: 24, 23: 20, 22: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19380855560302734  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19380855560302734  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.555807590484619  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.556634426116943  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19578886032104492  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 13 input nodes size: 67303
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19277620315551758  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19277620315551758  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2248687744140625  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.22491025924682617  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1944575309753418  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1082, 1: 722, 2: 606, 3: 463, 4: 346, 5: 338, 6: 270, 7: 201, 8: 165, 9: 145, 10: 145, 11: 139, 12: 116, 13: 98, 15: 93, 14: 92, 18: 81, 16: 80, 17: 67, 21: 64, 19: 59, 22: 48, 20: 47, 24: 41, 23: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19719648361206055  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19719648361206055  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.680194854736328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.681021690368652  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19971323013305664  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 14 input nodes size: 59524
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19587993621826172  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19587993621826172  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.22517681121826172  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2252182960510254  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1930842399597168  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1034, 1: 788, 2: 641, 3: 466, 4: 368, 5: 323, 6: 242, 7: 195, 8: 167, 9: 157, 10: 136, 12: 117, 11: 112, 13: 101, 15: 88, 17: 74, 14: 72, 16: 70, 20: 62, 18: 61, 19: 59, 21: 58, 22: 45, 23: 45, 24: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19558477401733398  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19558477401733398  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.3281779289245605  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.329000949859619  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19785070419311523  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 15 input nodes size: 55565
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19444513320922852  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19444513320922852  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.22094058990478516  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.22098398208618164  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19164562225341797  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1709, 1: 526, 2: 400, 3: 374, 4: 281, 5: 245, 6: 217, 9: 171, 7: 169, 10: 162, 8: 162, 12: 145, 11: 132, 13: 122, 14: 114, 16: 106, 21: 102, 18: 98, 20: 95, 15: 91, 17: 90, 19: 82, 24: 75, 23: 74, 22: 59})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19475173950195312  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19475173950195312  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 6.8971638679504395  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 6.89802885055542  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19752216339111328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19752216339111328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16446781158447266  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.053304895758628845 |0.003196015954017639 |0.1103629618883133 |0.00012257695198059082 |0.21249735355377197 |0.005204916000366211 |
----------------------------------------------------------pseudo_mini_loss sum 4.419491767883301
Total (block generation + training)time/epoch 50.053399896621706
Training time/epoch 6.253559827804565
Training time without block to device /epoch 6.202423572540283
Training time without total dataloading part /epoch 5.17293119430542
load block tensor time/epoch 0.8528783321380615
block to device time/epoch 0.05113625526428223
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  902471
Number of first layer input nodes during this epoch:  617265
Number of first layer output nodes during this epoch:  285206
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1482706069946289  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.563 seconds, peak memory: 30.097 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.097 GB
Metis partitioning: 5.729 seconds, peak memory: 30.097 GB
Split the graph: 3.915 seconds
Construct subgraphs: 0.174 seconds
REG metis partition end ----................................
REG construction  time spent:  27.37559676170349
pure dgl.metis_partition the time spent:  11.414505004882812
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.9192216396331787

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.3508732318878174

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1482706069946289  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

connection checking time:  2.1322832107543945
block generation total time  3.270094871520996
average batch blocks generation time:  0.20438092947006226
block dataloader generation time/epoch 43.795715729395546
pseudo mini batch 0 input nodes size: 21889
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.14430570602416992  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.14430570602416992  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.15474319458007812  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1547870635986328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1282482147216797  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 811, 2: 798, 3: 623, 4: 513, 5: 430, 25: 405, 6: 315, 7: 270, 8: 234, 9: 220, 10: 157, 12: 154, 11: 131, 13: 111, 14: 97, 15: 88, 16: 82, 17: 78, 18: 71, 19: 54, 21: 49, 23: 42, 20: 35, 22: 31, 24: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.12944889068603516  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.12944889068603516  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.3823671340942383  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.3832364082336426  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1615734100341797  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 1 input nodes size: 22357
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1604924201965332  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1604924201965332  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17115306854248047  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17119646072387695  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16071510314941406  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 946, 2: 792, 3: 673, 4: 505, 5: 397, 6: 336, 25: 290, 7: 268, 8: 254, 9: 199, 11: 175, 10: 170, 12: 133, 13: 115, 14: 91, 15: 79, 16: 71, 17: 54, 20: 52, 18: 52, 21: 39, 19: 38, 22: 37, 24: 29, 23: 21})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1618356704711914  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1618356704711914  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.1653709411621094  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.166238307952881  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16271734237670898  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 2 input nodes size: 19505
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16167926788330078  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16167926788330078  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1715383529663086  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17158174514770508  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16087770462036133  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 644, 2: 643, 3: 562, 4: 455, 25: 443, 5: 401, 6: 373, 7: 320, 8: 268, 9: 211, 11: 202, 10: 202, 13: 132, 12: 132, 14: 131, 17: 99, 15: 97, 16: 94, 20: 70, 18: 64, 21: 53, 19: 45, 24: 42, 23: 41, 22: 41})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16219854354858398  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16219854354858398  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.7092318534851074  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.7100915908813477  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16321229934692383  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 3 input nodes size: 22645
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1620182991027832  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1620182991027832  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1737370491027832  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1737804412841797  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1638779640197754  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 782, 2: 662, 3: 592, 25: 538, 4: 453, 5: 411, 6: 336, 7: 275, 8: 231, 9: 224, 10: 196, 11: 157, 12: 142, 13: 114, 14: 104, 15: 98, 17: 87, 16: 69, 19: 65, 20: 64, 21: 61, 18: 60, 22: 36, 24: 35, 23: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16524934768676758  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16524934768676758  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.7937979698181152  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.794666290283203  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16634130477905273  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 4 input nodes size: 26465
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16504383087158203  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16504383087158203  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17766332626342773  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17770671844482422  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16594457626342773  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 899, 2: 773, 3: 607, 4: 529, 5: 430, 25: 363, 6: 331, 7: 265, 8: 249, 10: 188, 9: 172, 11: 147, 12: 126, 13: 99, 14: 95, 15: 73, 16: 62, 18: 60, 17: 59, 19: 55, 20: 47, 21: 42, 22: 41, 23: 39, 24: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1671738624572754  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1671738624572754  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.3614044189453125  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.3622660636901855  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16815519332885742  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 5 input nodes size: 20272
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16695165634155273  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16695165634155273  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17681074142456055  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17685413360595703  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16419124603271484  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 987, 2: 842, 3: 670, 4: 559, 5: 418, 6: 351, 7: 311, 8: 238, 9: 208, 25: 190, 10: 169, 11: 132, 12: 117, 13: 109, 14: 83, 15: 83, 16: 58, 18: 51, 17: 46, 19: 41, 20: 33, 21: 27, 23: 25, 22: 22, 24: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16521167755126953  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16521167755126953  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.8970470428466797  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.8979105949401855  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16602325439453125  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 6 input nodes size: 32341
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16507196426391602  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16507196426391602  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18049335479736328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18053722381591797  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17063474655151367  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 727, 2: 671, 25: 562, 3: 558, 4: 484, 5: 409, 6: 321, 7: 282, 8: 262, 9: 220, 10: 188, 12: 153, 11: 150, 13: 134, 14: 126, 15: 108, 17: 86, 16: 77, 18: 63, 19: 57, 20: 56, 22: 50, 21: 45, 24: 39, 23: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1721196174621582  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1721196174621582  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.977759838104248  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.9786324501037598  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1733245849609375  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 7 input nodes size: 26720
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17183399200439453  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17183399200439453  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18457508087158203  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18461894989013672  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16915369033813477  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 901, 2: 822, 3: 668, 4: 508, 5: 483, 6: 345, 7: 298, 25: 275, 8: 261, 9: 209, 10: 173, 11: 128, 12: 123, 13: 117, 14: 102, 15: 84, 16: 74, 17: 50, 20: 46, 19: 45, 18: 40, 22: 27, 24: 24, 23: 23, 21: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1703486442565918  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1703486442565918  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.2426538467407227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.243525505065918  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1713242530822754  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 8 input nodes size: 69411
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17010784149169922  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17010784149169922  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.20320558547973633  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2032470703125  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1904621124267578  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 942, 1: 788, 2: 637, 3: 504, 4: 383, 5: 312, 6: 267, 7: 204, 8: 183, 9: 171, 10: 146, 11: 138, 12: 104, 13: 93, 14: 82, 15: 74, 17: 74, 16: 71, 20: 66, 18: 59, 19: 55, 22: 47, 21: 47, 23: 43, 24: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19310379028320312  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19310379028320312  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.404438018798828  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.405261039733887  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19550228118896484  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 9 input nodes size: 60973
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1917428970336914  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1917428970336914  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2210397720336914  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.22108125686645508  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1879420280456543  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1341, 1: 609, 2: 550, 3: 428, 4: 323, 5: 300, 6: 225, 7: 210, 8: 157, 10: 155, 9: 152, 11: 143, 12: 115, 13: 98, 14: 98, 18: 90, 15: 89, 19: 80, 16: 74, 17: 69, 24: 61, 20: 58, 21: 50, 23: 47, 22: 46})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19069623947143555  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19069623947143555  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.971721649169922  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.9725518226623535  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19317054748535156  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 10 input nodes size: 61254
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18951940536499023  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18951940536499023  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.21881628036499023  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2188577651977539  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18951940536499023  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1215, 1: 712, 2: 555, 3: 447, 4: 319, 5: 313, 6: 249, 7: 196, 9: 169, 8: 155, 10: 142, 12: 137, 11: 124, 13: 101, 16: 87, 14: 81, 15: 80, 17: 73, 18: 68, 19: 65, 21: 60, 20: 53, 22: 40, 23: 40, 24: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1922001838684082  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1922001838684082  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.717301845550537  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.718124866485596  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19461822509765625  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 11 input nodes size: 55761
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19098472595214844  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19098472595214844  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2175736427307129  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.21761560440063477  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1882772445678711  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1601, 1: 562, 2: 477, 3: 357, 4: 297, 5: 250, 6: 202, 7: 163, 9: 157, 8: 145, 12: 136, 10: 134, 11: 126, 13: 105, 15: 101, 14: 96, 21: 96, 18: 92, 20: 90, 17: 87, 19: 84, 16: 84, 24: 73, 23: 65, 22: 52})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19126081466674805  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19126081466674805  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 6.570196151733398  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 6.571035861968994  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19391441345214844  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 12 input nodes size: 31031
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19005537033081055  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19005537033081055  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.20502042770385742  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2050623893737793  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17843151092529297  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1012, 2: 938, 3: 695, 4: 511, 5: 459, 6: 301, 7: 252, 8: 216, 25: 209, 9: 179, 10: 152, 11: 106, 13: 90, 12: 79, 14: 66, 16: 62, 15: 58, 18: 44, 17: 42, 19: 35, 20: 30, 21: 25, 23: 19, 22: 16, 24: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17953872680664062  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17953872680664062  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.9013333320617676  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.902170181274414  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18047046661376953  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 13 input nodes size: 53307
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17924833297729492  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17924833297729492  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2046670913696289  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.20470857620239258  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18970155715942383  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1029, 2: 839, 3: 644, 4: 488, 5: 403, 25: 365, 6: 268, 7: 246, 8: 199, 9: 166, 10: 165, 11: 103, 12: 92, 13: 81, 14: 71, 15: 57, 16: 49, 18: 49, 17: 41, 20: 40, 19: 34, 21: 31, 22: 21, 23: 19, 24: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19130849838256836  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19130849838256836  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.5909318923950195  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.591754913330078  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19275569915771484  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 14 input nodes size: 47187
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19060420989990234  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19060420989990234  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.21404170989990234  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.21408319473266602  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18862295150756836  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1069, 2: 886, 3: 663, 4: 532, 5: 399, 6: 330, 7: 247, 25: 241, 8: 212, 9: 158, 10: 127, 11: 111, 12: 96, 13: 81, 15: 57, 14: 50, 16: 48, 18: 41, 19: 39, 17: 36, 21: 31, 20: 30, 22: 26, 23: 23, 24: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19000005722045898  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19000005722045898  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.211280345916748  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.212108612060547  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1912393569946289  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 15 input nodes size: 48560
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1894693374633789  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1894693374633789  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2129068374633789  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.21294832229614258  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1894693374633789  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 950, 2: 821, 3: 586, 25: 480, 4: 461, 5: 407, 6: 318, 7: 238, 8: 208, 9: 161, 10: 135, 11: 130, 12: 98, 13: 76, 15: 63, 14: 61, 16: 49, 17: 49, 18: 44, 19: 44, 21: 41, 20: 37, 24: 29, 22: 23, 23: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19118785858154297  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19118785858154297  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.842836380004883  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.843660354614258  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1927332878112793  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1927332878112793  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.15967893600463867  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.054294198751449585 |0.0037860870361328125 |0.11469896137714386 |0.00013169646263122559 |0.21228638291358948 |0.005292177200317383 |
----------------------------------------------------------pseudo_mini_loss sum 4.4827094078063965
Total (block generation + training)time/epoch 50.25950503349304
Training time/epoch 6.350988864898682
Training time without block to device /epoch 6.290411472320557
Training time without total dataloading part /epoch 5.23916482925415
load block tensor time/epoch 0.8687071800231934
block to device time/epoch 0.060577392578125
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  904920
Number of first layer input nodes during this epoch:  619678
Number of first layer output nodes during this epoch:  285242
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.14260339736938477  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.522 seconds, peak memory: 30.097 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.097 GB
Metis partitioning: 5.954 seconds, peak memory: 30.097 GB
Split the graph: 4.354 seconds
Construct subgraphs: 0.103 seconds
REG metis partition end ----................................
REG construction  time spent:  27.468059539794922
pure dgl.metis_partition the time spent:  11.965778350830078
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.9357831478118896

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.9831008911132812

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.14260339736938477  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

connection checking time:  2.1153335571289062
block generation total time  3.918884038925171
average batch blocks generation time:  0.24493025243282318
block dataloader generation time/epoch 44.14389637538365
pseudo mini batch 0 input nodes size: 28861
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.14032983779907227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.14032983779907227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.15409183502197266  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.15413570404052734  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.13065671920776367  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 881, 2: 793, 3: 585, 4: 503, 5: 423, 25: 372, 6: 356, 7: 265, 8: 257, 9: 199, 10: 178, 11: 139, 12: 131, 14: 109, 13: 106, 15: 98, 16: 68, 17: 67, 18: 65, 19: 55, 21: 46, 23: 45, 22: 44, 20: 39, 24: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.13196134567260742  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.13196134567260742  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.4853429794311523  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.4862165451049805  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1651291847229004  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 1 input nodes size: 22586
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1638174057006836  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1638174057006836  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1755361557006836  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17558002471923828  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1617741584777832  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 993, 2: 885, 3: 720, 4: 594, 5: 472, 6: 367, 7: 302, 8: 242, 25: 192, 9: 181, 10: 150, 11: 102, 14: 98, 13: 97, 12: 93, 15: 68, 17: 56, 16: 56, 18: 47, 19: 37, 20: 27, 22: 21, 24: 20, 23: 19, 21: 15})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16278886795043945  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16278886795043945  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.840817451477051  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.8416905403137207  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1636033058166504  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 2 input nodes size: 21843
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16263151168823242  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16263151168823242  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17304706573486328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17309093475341797  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16132831573486328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 843, 2: 747, 3: 635, 4: 518, 5: 407, 6: 352, 7: 319, 25: 313, 8: 258, 9: 246, 10: 200, 11: 168, 12: 138, 13: 115, 14: 89, 16: 85, 15: 85, 19: 61, 18: 59, 20: 52, 17: 47, 21: 34, 22: 30, 23: 27, 24: 26})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16249465942382812  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16249465942382812  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.3150596618652344  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.3159327507019043  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16341018676757812  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 3 input nodes size: 33245
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16234064102172852  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16234064102172852  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1781930923461914  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1782369613647461  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16777753829956055  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 784, 2: 691, 3: 578, 25: 514, 4: 491, 5: 423, 6: 325, 7: 290, 8: 270, 9: 200, 10: 190, 12: 147, 11: 147, 13: 129, 15: 119, 14: 103, 17: 74, 16: 72, 20: 54, 18: 53, 19: 50, 21: 45, 22: 44, 24: 34, 23: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16923093795776367  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16923093795776367  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.8458709716796875  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.8467440605163574  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17041349411010742  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 4 input nodes size: 25369
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16892004013061523  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16892004013061523  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1810169219970703  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18105840682983398  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1651620864868164  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 693, 2: 692, 3: 549, 25: 516, 4: 461, 5: 366, 6: 297, 7: 273, 8: 223, 9: 221, 10: 173, 12: 162, 11: 152, 13: 117, 14: 98, 17: 82, 18: 69, 16: 66, 15: 65, 19: 64, 21: 57, 20: 46, 23: 45, 22: 43, 24: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1664571762084961  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1664571762084961  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.6297502517700195  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.630580425262451  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16742515563964844  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 5 input nodes size: 20695
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16623353958129883  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16623353958129883  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1761016845703125  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1761455535888672  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16400718688964844  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 572, 1: 561, 3: 558, 4: 469, 5: 431, 25: 429, 6: 384, 7: 330, 8: 287, 11: 232, 9: 228, 10: 223, 13: 158, 12: 148, 14: 134, 16: 102, 15: 100, 17: 97, 20: 86, 18: 78, 21: 60, 19: 58, 22: 50, 24: 42, 23: 37})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16533374786376953  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16533374786376953  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.838914394378662  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.839787483215332  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1663837432861328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 6 input nodes size: 22887
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16524839401245117  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16524839401245117  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1761617660522461  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17620325088500977  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1662912368774414  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 968, 2: 797, 3: 648, 4: 496, 5: 377, 25: 367, 6: 307, 7: 229, 8: 189, 9: 168, 10: 152, 11: 109, 12: 107, 13: 84, 14: 82, 15: 74, 17: 58, 16: 50, 19: 48, 20: 47, 18: 47, 21: 42, 22: 26, 23: 25, 24: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16741657257080078  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16741657257080078  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.096068859100342  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.0968918800354004  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1682734489440918  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 7 input nodes size: 23975
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16716480255126953  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.16716480255126953  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17888355255126953  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1789250373840332  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1679701805114746  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 769, 2: 694, 3: 577, 25: 498, 4: 443, 5: 379, 6: 284, 7: 272, 8: 230, 9: 207, 10: 179, 11: 157, 12: 116, 13: 106, 14: 104, 15: 90, 16: 76, 17: 75, 18: 53, 20: 51, 21: 45, 19: 44, 24: 39, 23: 36, 22: 26})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1693100929260254  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1693100929260254  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.6195530891418457  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.6203808784484863  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17039728164672852  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 8 input nodes size: 30965
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1690526008605957  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1690526008605957  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18401765823364258  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18405914306640625  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17229890823364258  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1123, 2: 859, 3: 684, 4: 501, 5: 420, 6: 327, 7: 229, 8: 205, 9: 192, 25: 166, 10: 138, 12: 120, 11: 105, 13: 77, 16: 57, 14: 56, 15: 53, 17: 46, 19: 32, 18: 31, 20: 28, 21: 21, 23: 20, 24: 19, 22: 14})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1733717918395996  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1733717918395996  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.7762985229492188  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.7771220207214355  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17428207397460938  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 9 input nodes size: 26811
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17307472229003906  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17307472229003906  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18585920333862305  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18590164184570312  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17089509963989258  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1036, 2: 969, 3: 747, 4: 553, 5: 469, 6: 307, 7: 272, 8: 216, 9: 177, 25: 160, 10: 150, 11: 104, 12: 89, 13: 81, 14: 63, 15: 57, 16: 47, 17: 41, 18: 39, 20: 27, 19: 26, 21: 24, 24: 18, 22: 11, 23: 8})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17189693450927734  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17189693450927734  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.71572208404541  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 2.7165708541870117  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17275381088256836  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 10 input nodes size: 39950
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17170190811157227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17170190811157227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19123315811157227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19127702713012695  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1784501075744629  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 950, 2: 799, 3: 587, 25: 478, 4: 462, 5: 435, 6: 345, 7: 277, 8: 251, 9: 194, 10: 173, 11: 159, 12: 119, 13: 92, 15: 75, 14: 72, 17: 62, 16: 57, 19: 53, 18: 50, 20: 48, 21: 36, 22: 34, 24: 29, 23: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18007898330688477  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18007898330688477  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.885885715484619  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 3.886758804321289  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1815204620361328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 11 input nodes size: 57403
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17954301834106445  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.17954301834106445  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.20691490173339844  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2069563865661621  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18738126754760742  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 919, 1: 903, 2: 758, 3: 539, 4: 366, 5: 329, 6: 253, 7: 212, 8: 171, 9: 151, 11: 119, 10: 113, 12: 100, 13: 79, 14: 72, 16: 55, 18: 54, 19: 51, 15: 47, 17: 46, 20: 45, 23: 37, 24: 34, 22: 33, 21: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1895737648010254  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1895737648010254  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.748278617858887  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.749101638793945  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19150924682617188  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 12 input nodes size: 59885
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18855762481689453  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18855762481689453  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.21785449981689453  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.2178959846496582  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19048261642456055  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1033, 2: 864, 3: 614, 25: 497, 4: 482, 5: 365, 6: 250, 7: 228, 8: 203, 9: 137, 10: 132, 11: 113, 12: 94, 13: 75, 14: 67, 15: 66, 16: 51, 18: 48, 17: 43, 20: 39, 19: 36, 21: 34, 22: 28, 23: 23, 24: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19236326217651367  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19236326217651367  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.027706146240234  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 4.0285325050354  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19410419464111328  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 13 input nodes size: 60484
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19147729873657227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19147729873657227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.22077417373657227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.22081565856933594  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19147729873657227  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1008, 1: 711, 2: 659, 3: 499, 5: 364, 4: 363, 6: 245, 7: 186, 8: 163, 10: 145, 9: 142, 11: 132, 12: 102, 15: 101, 13: 96, 14: 88, 18: 81, 16: 80, 17: 66, 21: 63, 19: 61, 20: 55, 24: 47, 22: 41, 23: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19400644302368164  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19400644302368164  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.3792290687561035  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 5.380053520202637  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.1963047981262207  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

pseudo mini batch 14 input nodes size: 54476
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19284439086914062  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19284439086914062  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.21882057189941406  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.21886444091796875  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.18952608108520508  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1774, 1: 495, 2: 390, 3: 321, 4: 290, 5: 248, 6: 223, 7: 181, 9: 166, 8: 164, 12: 157, 10: 152, 11: 142, 13: 127, 14: 114, 16: 107, 21: 106, 15: 105, 18: 103, 20: 95, 17: 93, 19: 89, 23: 79, 22: 69, 24: 64})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19266176223754883  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.08935546875 GB
    Memory Allocated: 0.19266176223754883  GigaBytes
Max Memory Allocated: 7.352369785308838  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.39599609375 GB
    Memory Allocated: 7.026514053344727  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.39599609375 GB
    Memory Allocated: 7.0273871421813965  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19544744491577148  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 15 input nodes size: 51156
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.191497802734375  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.191497802734375  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.21589088439941406  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.21593236923217773  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1899123191833496  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1257, 1: 685, 2: 537, 3: 436, 4: 328, 5: 314, 6: 246, 7: 180, 9: 167, 10: 151, 8: 143, 11: 123, 13: 117, 12: 114, 15: 86, 14: 85, 16: 82, 17: 77, 18: 71, 19: 71, 20: 68, 21: 58, 24: 46, 23: 43, 22: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19242143630981445  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19242143630981445  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 5.610658168792725  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 5.611482620239258  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19458818435668945  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19458818435668945  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16153383255004883  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.057664066553115845 |0.0031987279653549194 |0.12187118828296661 |0.00014562904834747314 |0.2107088416814804 |0.003160238265991211 |
----------------------------------------------------------pseudo_mini_loss sum 4.173376083374023
Total (block generation + training)time/epoch 50.606602702822
Training time/epoch 6.455851078033447
Training time without block to device /epoch 6.4046714305877686
Training time without total dataloading part /epoch 5.326770782470703
load block tensor time/epoch 0.9226250648498535
block to device time/epoch 0.05117964744567871
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  852802
Number of first layer input nodes during this epoch:  580591
Number of first layer output nodes during this epoch:  272211
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.14501571655273438  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.517 seconds, peak memory: 30.097 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.097 GB
Metis partitioning: 5.648 seconds, peak memory: 30.503 GB
Split the graph: 5.618 seconds
Construct subgraphs: 0.105 seconds
REG metis partition end ----................................
REG construction  time spent:  27.942978858947754
pure dgl.metis_partition the time spent:  12.918929815292358
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8808152675628662

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.3301587104797363

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.14501571655273438  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

connection checking time:  2.0846424102783203
block generation total time  3.2109739780426025
average batch blocks generation time:  0.20068587362766266
block dataloader generation time/epoch 44.4862174987793
pseudo mini batch 0 input nodes size: 34573
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.14179086685180664  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.14179086685180664  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.15827655792236328  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.15831995010375977  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.13388538360595703  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 728, 2: 682, 3: 570, 25: 559, 4: 459, 5: 382, 6: 309, 7: 290, 8: 253, 9: 217, 10: 198, 11: 150, 12: 149, 13: 128, 14: 120, 15: 108, 16: 78, 17: 76, 18: 60, 22: 55, 20: 55, 19: 51, 21: 48, 24: 40, 23: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.13539505004882812  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.13539505004882812  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.9521498680114746  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.953014850616455  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16821861267089844  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 1 input nodes size: 28683
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16666126251220703  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16666126251220703  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18033838272094727  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18038177490234375  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16385269165039062  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1066, 2: 903, 3: 660, 4: 514, 5: 410, 6: 361, 7: 252, 25: 250, 8: 244, 9: 181, 10: 146, 11: 124, 12: 109, 14: 84, 13: 74, 15: 71, 17: 56, 18: 51, 16: 49, 20: 43, 19: 36, 21: 32, 22: 28, 23: 27, 24: 18})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16498947143554688  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16498947143554688  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.048614025115967  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.0494775772094727  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16592788696289062  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 2 input nodes size: 25341
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16474056243896484  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16474056243896484  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17682409286499023  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17686748504638672  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16314697265625  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 964, 2: 810, 3: 663, 4: 522, 5: 447, 6: 333, 7: 293, 25: 291, 8: 239, 9: 199, 10: 180, 11: 141, 12: 117, 13: 108, 14: 85, 15: 66, 16: 63, 20: 50, 19: 47, 17: 44, 18: 43, 22: 27, 21: 27, 23: 26, 24: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1643056869506836  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1643056869506836  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.1674041748046875  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.1682701110839844  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16524934768676758  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 3 input nodes size: 20681
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1640915870666504  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1640915870666504  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17395305633544922  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1739964485168457  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16186952590942383  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 887, 2: 806, 3: 637, 4: 537, 5: 440, 6: 329, 7: 301, 8: 271, 25: 259, 9: 212, 10: 179, 11: 133, 12: 128, 13: 113, 14: 96, 15: 92, 16: 71, 18: 59, 19: 56, 17: 54, 20: 31, 21: 29, 23: 29, 22: 28, 24: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1629633903503418  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1629633903503418  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.1154141426086426  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.1162796020507812  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16382217407226562  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 4 input nodes size: 18375
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16281938552856445  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16281938552856445  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17158126831054688  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17162466049194336  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16171979904174805  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 895, 2: 842, 3: 683, 4: 520, 5: 453, 6: 331, 7: 297, 25: 265, 8: 237, 9: 191, 10: 155, 12: 145, 11: 143, 13: 90, 14: 81, 15: 75, 16: 64, 17: 60, 18: 55, 21: 51, 19: 44, 23: 31, 22: 31, 24: 28, 20: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1627640724182129  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1627640724182129  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.0333251953125  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.0341882705688477  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1635732650756836  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 5 input nodes size: 20222
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16265201568603516  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16265201568603516  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17229461669921875  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17233848571777344  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16353321075439453  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 573, 1: 573, 3: 515, 4: 485, 25: 428, 5: 420, 6: 392, 7: 339, 8: 272, 9: 243, 10: 237, 11: 221, 13: 158, 12: 155, 14: 128, 15: 102, 16: 102, 17: 95, 20: 84, 18: 81, 21: 57, 19: 51, 22: 49, 24: 41, 23: 39})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16486263275146484  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16486263275146484  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.8212509155273438  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.8221216201782227  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16588211059570312  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 6 input nodes size: 25704
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16473674774169922  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16473674774169922  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17699337005615234  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17703485488891602  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16734838485717773  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 965, 2: 805, 3: 645, 4: 477, 25: 423, 5: 382, 6: 300, 7: 225, 8: 186, 9: 174, 10: 142, 11: 103, 12: 101, 13: 99, 14: 74, 15: 67, 17: 62, 16: 51, 19: 49, 18: 47, 20: 46, 21: 39, 23: 32, 22: 25, 24: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16857385635375977  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16857385635375977  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.2565407752990723  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.25736665725708  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16953706741333008  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 7 input nodes size: 21365
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16826105117797852  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16826105117797852  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17844867706298828  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17849254608154297  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16619443893432617  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 691, 2: 601, 25: 579, 3: 558, 4: 426, 5: 399, 6: 318, 7: 297, 8: 262, 9: 213, 10: 200, 11: 197, 12: 147, 14: 136, 13: 125, 15: 120, 17: 102, 16: 92, 20: 71, 18: 70, 19: 62, 21: 61, 24: 49, 22: 39, 23: 39})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1676468849182129  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1676468849182129  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 4.027127742767334  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 4.028000831604004  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16882896423339844  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 8 input nodes size: 59884
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1674809455871582  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1674809455871582  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1967778205871582  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19681930541992188  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18658781051635742  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1370, 1: 687, 2: 534, 3: 398, 4: 324, 5: 290, 6: 231, 7: 184, 9: 147, 8: 144, 10: 142, 11: 122, 12: 116, 13: 97, 14: 90, 16: 84, 15: 76, 18: 73, 17: 72, 19: 64, 21: 63, 20: 62, 23: 53, 22: 50, 24: 44})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18942022323608398  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18942022323608398  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 6.024819374084473  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 6.025642395019531  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1919260025024414  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 9 input nodes size: 51992
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18809986114501953  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18809986114501953  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.21349048614501953  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.2135329246520996  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18419456481933594  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1444, 1: 553, 2: 489, 3: 410, 4: 330, 5: 267, 6: 228, 7: 189, 8: 164, 9: 162, 10: 154, 12: 145, 11: 131, 13: 110, 14: 94, 21: 90, 15: 90, 17: 90, 16: 88, 18: 87, 20: 87, 19: 70, 24: 56, 23: 54, 22: 51})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1869063377380371  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1869063377380371  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 6.101433277130127  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 6.102273464202881  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18929624557495117  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 10 input nodes size: 67524
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18587350845336914  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18587350845336914  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.21807146072387695  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.21811342239379883  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19268035888671875  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1033, 1: 741, 2: 624, 3: 476, 4: 387, 5: 328, 6: 262, 7: 213, 8: 187, 9: 157, 10: 138, 11: 134, 12: 115, 13: 110, 15: 90, 16: 83, 14: 80, 18: 77, 19: 66, 17: 59, 21: 53, 20: 52, 22: 40, 23: 37, 24: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1953868865966797  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1953868865966797  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 5.596571445465088  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 5.597403526306152  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19787073135375977  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 11 input nodes size: 65664
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19406509399414062  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19406509399414062  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.22537612915039062  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.2254176139831543  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1931777000427246  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 895, 2: 776, 25: 641, 3: 593, 4: 436, 5: 339, 6: 258, 7: 225, 8: 176, 9: 175, 10: 142, 11: 117, 12: 109, 13: 85, 15: 81, 14: 72, 17: 61, 16: 59, 19: 58, 18: 52, 21: 41, 20: 36, 24: 35, 23: 31, 22: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1953415870666504  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1953415870666504  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 4.525902271270752  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 4.5267252922058105  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19733238220214844  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 12 input nodes size: 33556
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1942896842956543  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1942896842956543  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.21029043197631836  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.21033382415771484  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17898130416870117  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 968, 2: 853, 3: 734, 4: 572, 5: 464, 6: 341, 25: 254, 8: 233, 7: 233, 9: 210, 10: 160, 11: 128, 13: 104, 12: 95, 14: 72, 17: 62, 15: 58, 16: 55, 18: 48, 19: 38, 21: 32, 20: 31, 24: 22, 23: 21, 22: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18021249771118164  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18021249771118164  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.1691527366638184  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.1700186729431152  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18129682540893555  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 13 input nodes size: 28862
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17992687225341797  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17992687225341797  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19368934631347656  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19373130798339844  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1776871681213379  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1047, 2: 888, 3: 681, 4: 527, 5: 463, 6: 333, 7: 263, 8: 193, 25: 181, 9: 179, 10: 140, 12: 99, 11: 97, 13: 85, 14: 75, 15: 69, 16: 50, 17: 41, 18: 39, 19: 39, 20: 27, 21: 22, 23: 19, 22: 17, 24: 15})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17875242233276367  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17875242233276367  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 2.820406913757324  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 2.8212404251098633  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17961740493774414  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 14 input nodes size: 43145
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17845678329467773  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17845678329467773  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19902992248535156  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19907140731811523  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18526697158813477  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1035, 2: 834, 3: 589, 4: 440, 5: 406, 25: 395, 6: 329, 8: 248, 7: 235, 9: 161, 10: 152, 11: 137, 12: 102, 13: 71, 15: 62, 14: 55, 16: 51, 18: 43, 17: 42, 19: 42, 20: 38, 21: 32, 22: 28, 24: 24, 23: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18682432174682617  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18682432174682617  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.5853219032287598  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.5861520767211914  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18821048736572266  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 15 input nodes size: 59866
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18620920181274414  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18620920181274414  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.21550607681274414  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.2155475616455078  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1949329376220703  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1088, 1: 733, 2: 686, 3: 465, 4: 364, 5: 332, 6: 213, 7: 209, 8: 163, 9: 155, 10: 134, 11: 125, 12: 105, 13: 99, 14: 92, 20: 74, 16: 71, 19: 63, 18: 63, 15: 62, 17: 54, 24: 50, 22: 44, 21: 40, 23: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19736385345458984  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19736385345458984  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 5.285010814666748  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 5.285833835601807  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19954156875610352  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19954156875610352  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1664872169494629  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.057495489716529846 |0.0033558011054992676 |0.12126602232456207 |0.0001341402530670166 |0.21187356114387512 |0.008755207061767578 |
----------------------------------------------------------pseudo_mini_loss sum 4.330352306365967
Total (block generation + training)time/epoch 50.951491832733154
Training time/epoch 6.48284387588501
Training time without block to device /epoch 6.4291510581970215
Training time without total dataloading part /epoch 5.341134786605835
load block tensor time/epoch 0.9199278354644775
block to device time/epoch 0.05369281768798828
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  888416
Number of first layer input nodes during this epoch:  605437
Number of first layer output nodes during this epoch:  282979
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1498093605041504  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.536 seconds, peak memory: 30.503 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.503 GB
Metis partitioning: 6.009 seconds, peak memory: 30.550 GB
Split the graph: 4.688 seconds
Construct subgraphs: 0.099 seconds
REG metis partition end ----................................
REG construction  time spent:  27.464126586914062
pure dgl.metis_partition the time spent:  12.362967729568481
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8723533153533936

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.1441922187805176

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1498093605041504  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

connection checking time:  1.9446816444396973
block generation total time  3.016545534133911
average batch blocks generation time:  0.18853409588336945
block dataloader generation time/epoch 44.603618966208565
pseudo mini batch 0 input nodes size: 31173
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.14657354354858398  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.14657354354858398  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16153860092163086  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16158246994018555  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.13224411010742188  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 676, 2: 648, 3: 566, 25: 555, 4: 472, 5: 400, 6: 322, 7: 306, 8: 262, 9: 232, 10: 198, 12: 164, 11: 155, 14: 129, 13: 129, 15: 118, 17: 90, 16: 82, 18: 69, 19: 66, 20: 55, 22: 54, 21: 41, 24: 38, 23: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.13371753692626953  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.13371753692626953  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.9473891258239746  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.9482626914978027  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16661930084228516  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 1 input nodes size: 22259
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1651754379272461  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1651754379272461  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17578935623168945  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17583322525024414  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16082429885864258  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1013, 2: 914, 3: 735, 4: 545, 5: 472, 6: 384, 7: 289, 8: 243, 9: 190, 25: 185, 10: 156, 11: 124, 12: 113, 15: 77, 13: 75, 14: 71, 16: 46, 18: 45, 17: 41, 19: 25, 23: 25, 21: 24, 22: 22, 24: 21, 20: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16183042526245117  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16183042526245117  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 2.809114456176758  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 2.8099870681762695  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16263961791992188  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 2 input nodes size: 19590
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1616663932800293  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1616663932800293  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1715254783630371  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1715688705444336  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16091108322143555  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 867, 2: 793, 3: 660, 4: 558, 5: 427, 6: 363, 7: 329, 8: 254, 9: 227, 25: 222, 10: 177, 11: 154, 12: 118, 13: 118, 14: 99, 15: 88, 16: 68, 17: 50, 19: 47, 18: 39, 20: 35, 21: 30, 22: 30, 23: 24, 24: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1619715690612793  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1619715690612793  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.0323100090026855  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.0331740379333496  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1627964973449707  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 3 input nodes size: 26886
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16182661056518555  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16182661056518555  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17464685440063477  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17469072341918945  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16478824615478516  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 839, 2: 748, 3: 606, 4: 506, 5: 463, 25: 387, 6: 322, 8: 273, 7: 271, 10: 186, 9: 186, 11: 152, 12: 134, 13: 120, 14: 110, 15: 93, 16: 79, 18: 66, 17: 65, 19: 59, 20: 48, 21: 40, 23: 40, 24: 31, 22: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16606807708740234  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16606807708740234  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.527620315551758  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.5284934043884277  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1671004295349121  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 4 input nodes size: 22986
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16586017608642578  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16586017608642578  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17757892608642578  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17762041091918945  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16475629806518555  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 719, 2: 707, 3: 602, 4: 496, 5: 374, 25: 337, 6: 327, 7: 265, 8: 236, 9: 203, 11: 186, 10: 171, 12: 145, 13: 126, 14: 93, 16: 82, 15: 76, 20: 65, 17: 61, 18: 59, 21: 49, 19: 45, 22: 36, 24: 31, 23: 26})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16592645645141602  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16592645645141602  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.291109085083008  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.2919321060180664  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1667938232421875  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 5 input nodes size: 18561
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1657094955444336  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1657094955444336  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1745600700378418  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17460298538208008  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1628427505493164  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 631, 2: 603, 3: 535, 4: 471, 25: 446, 5: 411, 6: 385, 7: 324, 8: 253, 9: 222, 10: 215, 11: 183, 12: 151, 13: 133, 14: 120, 17: 102, 16: 89, 15: 80, 18: 78, 21: 67, 19: 62, 20: 59, 23: 44, 22: 44, 24: 43})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16410589218139648  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16410589218139648  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.6785573959350586  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.679415225982666  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16509342193603516  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 6 input nodes size: 21657
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16403627395629883  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16403627395629883  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1743631362915039  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1744070053100586  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1655135154724121  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 642, 2: 605, 25: 603, 3: 557, 4: 452, 5: 403, 6: 323, 7: 317, 8: 270, 9: 238, 10: 204, 11: 181, 12: 144, 14: 132, 13: 123, 15: 111, 17: 93, 16: 79, 20: 78, 18: 66, 21: 60, 19: 51, 23: 44, 24: 41, 22: 37})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16694402694702148  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16694402694702148  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.9989986419677734  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.9998717308044434  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16807031631469727  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 7 input nodes size: 22391
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16677045822143555  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16677045822143555  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17744731903076172  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1774888038635254  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16711807250976562  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1069, 2: 865, 3: 651, 4: 479, 5: 361, 25: 355, 6: 267, 7: 226, 8: 171, 9: 157, 10: 129, 11: 103, 12: 94, 13: 84, 14: 72, 15: 67, 17: 65, 19: 55, 16: 54, 18: 49, 20: 40, 21: 33, 23: 29, 22: 24, 24: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1681814193725586  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1681814193725586  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 2.9925360679626465  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 2.9933595657348633  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16898155212402344  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 8 input nodes size: 55689
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16796112060546875  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.16796112060546875  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19451570510864258  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19455718994140625  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1838388442993164  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 887, 25: 853, 2: 771, 3: 533, 4: 408, 5: 336, 6: 242, 7: 203, 8: 178, 9: 172, 10: 136, 11: 111, 12: 107, 13: 73, 14: 70, 15: 57, 16: 57, 19: 54, 18: 52, 17: 47, 20: 41, 22: 39, 21: 32, 23: 29, 24: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18593692779541016  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18593692779541016  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 4.595182418823242  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 4.596005439758301  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18782663345336914  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 9 input nodes size: 40926
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18503427505493164  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18503427505493164  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.20456552505493164  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.20460891723632812  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17801284790039062  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 962, 2: 788, 3: 575, 25: 501, 4: 443, 5: 421, 6: 333, 7: 273, 8: 220, 9: 181, 10: 170, 11: 148, 12: 106, 13: 91, 15: 71, 14: 70, 18: 63, 16: 62, 17: 58, 19: 55, 20: 52, 21: 45, 24: 39, 22: 36, 23: 21})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17966842651367188  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17966842651367188  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.942260265350342  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.9431228637695312  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18114995956420898  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 10 input nodes size: 31015
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17913007736206055  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17913007736206055  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19409513473510742  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1941380500793457  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17456340789794922  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1064, 2: 865, 3: 678, 4: 511, 5: 477, 6: 359, 25: 284, 7: 234, 8: 225, 9: 174, 10: 138, 12: 107, 11: 102, 13: 85, 14: 74, 15: 62, 16: 54, 17: 40, 18: 36, 19: 33, 20: 31, 23: 24, 21: 21, 24: 20, 22: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17573022842407227  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17573022842407227  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.042591094970703  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 3.043443202972412  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17670392990112305  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 11 input nodes size: 28735
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17542505264282227  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17542505264282227  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18912696838378906  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18916845321655273  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17416048049926758  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1101, 2: 981, 3: 687, 4: 554, 5: 419, 6: 284, 7: 210, 8: 203, 9: 188, 25: 146, 10: 145, 11: 106, 13: 88, 12: 75, 14: 56, 16: 53, 15: 49, 17: 39, 20: 29, 18: 26, 19: 21, 21: 19, 22: 15, 24: 15, 23: 10})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1751399040222168  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1751399040222168  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 2.6090612411499023  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 2.609884262084961  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17593669891357422  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 12 input nodes size: 61537
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17487049102783203  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.17487049102783203  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.20421361923217773  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.2042551040649414  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19051170349121094  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1194, 1: 656, 2: 560, 3: 462, 4: 327, 5: 315, 6: 256, 7: 194, 8: 164, 9: 148, 10: 138, 11: 129, 12: 121, 13: 107, 15: 94, 14: 90, 18: 83, 16: 77, 17: 74, 21: 73, 19: 67, 20: 56, 24: 49, 22: 45, 23: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1932382583618164  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1932382583618164  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 5.816312789916992  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 5.817136287689209  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1957087516784668  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 13 input nodes size: 64792
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1920008659362793  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1920008659362793  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.22289609909057617  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.22293758392333984  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19355297088623047  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1050, 2: 821, 25: 626, 3: 550, 4: 448, 5: 354, 6: 242, 7: 211, 8: 205, 10: 141, 9: 131, 11: 101, 12: 93, 13: 78, 15: 70, 14: 62, 16: 54, 17: 50, 20: 49, 18: 46, 19: 36, 21: 32, 22: 29, 24: 20, 23: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19567584991455078  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19567584991455078  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 4.401033401489258  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 4.401856422424316  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19765329360961914  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

pseudo mini batch 14 input nodes size: 53155
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19461631774902344  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.19461631774902344  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.22000694274902344  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.22005081176757812  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.18911409378051758  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1912, 1: 441, 2: 344, 3: 300, 4: 265, 5: 224, 6: 223, 9: 183, 7: 168, 12: 158, 10: 154, 8: 147, 11: 141, 13: 132, 14: 119, 18: 115, 16: 112, 15: 107, 21: 101, 20: 97, 19: 96, 17: 92, 24: 80, 23: 77, 22: 66})

----------------------------------------after blocks to device 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1922926902770996  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.70263671875 GB
    Memory Allocated: 0.1922926902770996  GigaBytes
Max Memory Allocated: 7.4937520027160645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.02294921875 GB
    Memory Allocated: 7.22590970993042  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.02294921875 GB
    Memory Allocated: 7.22678279876709  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19509315490722656  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 15 input nodes size: 56174
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19116926193237305  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19116926193237305  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2179551124572754  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21799659729003906  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19256210327148438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 854, 1: 811, 2: 693, 3: 580, 4: 385, 5: 365, 6: 236, 7: 225, 8: 168, 9: 144, 10: 141, 11: 127, 12: 107, 13: 94, 15: 69, 14: 67, 19: 64, 16: 63, 17: 63, 18: 56, 20: 56, 21: 50, 23: 37, 22: 33, 24: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1948261260986328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1948261260986328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.850572109222412  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.851395130157471  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19683218002319336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19683218002319336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16377782821655273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0574311763048172 |0.0030883997678756714 |0.11428883671760559 |0.00011552870273590088 |0.21242877840995789 |0.0030252933502197266 |
----------------------------------------------------------pseudo_mini_loss sum 4.375303745269775
Total (block generation + training)time/epoch 51.0557693640391
Training time/epoch 6.346696853637695
Training time without block to device /epoch 6.297282457351685
Training time without total dataloading part /epoch 5.23235559463501
load block tensor time/epoch 0.9188988208770752
block to device time/epoch 0.04941439628601074
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  848583
Number of first layer input nodes during this epoch:  577526
Number of first layer output nodes during this epoch:  271057
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1470026969909668  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.536 seconds, peak memory: 30.604 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 30.604 GB
Metis partitioning: 5.979 seconds, peak memory: 31.298 GB
Split the graph: 4.339 seconds
Construct subgraphs: 0.101 seconds
REG metis partition end ----................................
REG construction  time spent:  26.07303023338318
pure dgl.metis_partition the time spent:  11.98518419265747
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8719122409820557

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.1358609199523926

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1470026969909668  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

connection checking time:  1.859917163848877
block generation total time  3.0077731609344482
average batch blocks generation time:  0.18798582255840302
block dataloader generation time/epoch 44.50766062736511
pseudo mini batch 0 input nodes size: 23413
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14392471313476562  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14392471313476562  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.15564346313476562  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1556849479675293  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12885761260986328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 860, 2: 726, 3: 584, 25: 479, 4: 458, 5: 374, 6: 290, 7: 254, 9: 201, 8: 200, 10: 160, 11: 121, 12: 105, 13: 102, 14: 92, 17: 76, 15: 75, 20: 63, 16: 59, 18: 54, 21: 51, 19: 50, 23: 38, 22: 27, 24: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1301116943359375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1301116943359375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.379049777984619  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.3798742294311523  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16292858123779297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 1 input nodes size: 21296
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16170549392700195  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16170549392700195  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1718602180480957  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17190170288085938  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1601414680480957  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 736, 2: 651, 3: 577, 25: 477, 4: 440, 5: 371, 6: 299, 7: 275, 8: 234, 9: 189, 10: 171, 11: 169, 12: 131, 13: 112, 15: 109, 14: 105, 16: 80, 17: 77, 20: 56, 18: 55, 19: 51, 21: 48, 24: 38, 23: 36, 22: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1614222526550293  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1614222526550293  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.537684917449951  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.5385079383850098  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1624312400817871  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 2 input nodes size: 23254
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16122150421142578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16122150421142578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17294025421142578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17298412322998047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16278791427612305  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 925, 2: 820, 3: 658, 4: 496, 5: 403, 25: 391, 6: 319, 8: 239, 7: 231, 9: 194, 10: 159, 11: 155, 12: 151, 13: 114, 14: 92, 15: 80, 17: 66, 16: 58, 18: 54, 19: 53, 21: 46, 20: 41, 23: 34, 22: 32, 24: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16395998001098633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16395998001098633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.307441234588623  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.308311939239502  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16492795944213867  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 3 input nodes size: 20773
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16385412216186523  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16385412216186523  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17375946044921875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17380332946777344  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16204071044921875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 628, 1: 601, 3: 592, 4: 513, 5: 423, 6: 400, 25: 373, 7: 336, 8: 272, 9: 226, 10: 222, 11: 194, 13: 142, 12: 141, 14: 129, 16: 102, 17: 91, 18: 84, 15: 78, 20: 76, 19: 56, 21: 55, 22: 46, 24: 39, 23: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1633138656616211  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1633138656616211  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.650576114654541  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.651449203491211  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16428899765014648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 4 input nodes size: 30298
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16318416595458984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16318416595458984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17763137817382812  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1776752471923828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1677260398864746  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 701, 2: 671, 25: 574, 3: 554, 4: 489, 5: 397, 7: 298, 6: 295, 8: 240, 9: 227, 10: 204, 12: 161, 11: 149, 14: 133, 13: 129, 15: 110, 17: 84, 16: 80, 18: 66, 19: 62, 20: 58, 22: 55, 21: 47, 24: 38, 23: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16917085647583008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16917085647583008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.948366641998291  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.949239730834961  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17031335830688477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 5 input nodes size: 30230
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16893291473388672  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16893291473388672  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1838979721069336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18394184112548828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1694507598876953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 835, 2: 703, 3: 574, 4: 502, 5: 444, 25: 440, 6: 314, 8: 290, 7: 263, 9: 204, 10: 183, 11: 153, 12: 136, 13: 115, 15: 100, 14: 97, 16: 79, 17: 69, 18: 68, 20: 59, 19: 55, 23: 48, 21: 46, 22: 45, 24: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17083740234375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17083740234375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7248401641845703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7257132530212402  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17196178436279297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 6 input nodes size: 19571
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1705608367919922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1705608367919922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.180419921875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1804637908935547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16545486450195312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 832, 2: 805, 3: 641, 4: 552, 5: 425, 6: 354, 7: 323, 25: 269, 8: 258, 9: 226, 10: 188, 11: 161, 12: 129, 13: 127, 14: 98, 15: 87, 16: 73, 19: 54, 17: 52, 18: 46, 20: 46, 22: 30, 21: 29, 23: 25, 24: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16655731201171875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16655731201171875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1708288192749023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1717019081115723  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1674175262451172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 7 input nodes size: 16661
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1664280891418457  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1664280891418457  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17437267303466797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17441654205322266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16451358795166016  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1023, 2: 970, 3: 774, 4: 578, 5: 513, 6: 386, 7: 298, 8: 238, 9: 179, 10: 148, 11: 120, 12: 104, 25: 94, 13: 71, 15: 64, 14: 63, 17: 46, 16: 44, 18: 42, 19: 19, 24: 19, 21: 18, 22: 15, 23: 14, 20: 13})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1653728485107422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1653728485107422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.5302505493164062  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.531123638153076  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16604900360107422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 8 input nodes size: 30206
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16527938842773438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16527938842773438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18024444580078125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18028593063354492  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17229747772216797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1116, 2: 929, 3: 686, 4: 522, 5: 427, 6: 305, 7: 231, 8: 216, 9: 168, 25: 149, 10: 148, 11: 111, 12: 87, 13: 82, 14: 62, 15: 48, 16: 46, 17: 41, 18: 29, 19: 28, 20: 27, 21: 24, 23: 13, 22: 12, 24: 10})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17329788208007812  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17329788208007812  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.642698287963867  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.643521308898926  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17409372329711914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 9 input nodes size: 30983
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17299604415893555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17299604415893555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18776988983154297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18781375885009766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1728072166442871  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 980, 2: 782, 3: 672, 4: 495, 5: 493, 6: 371, 25: 310, 7: 275, 8: 263, 9: 196, 10: 152, 11: 123, 12: 118, 13: 110, 14: 87, 15: 80, 16: 65, 20: 47, 18: 46, 17: 45, 19: 42, 24: 27, 23: 26, 21: 23, 22: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17405462265014648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17405462265014648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.307501792907715  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.3083744049072266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1751399040222168  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 10 input nodes size: 59685
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17381525039672852  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17381525039672852  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20311212539672852  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2031536102294922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18833589553833008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 873, 25: 867, 2: 785, 3: 524, 4: 425, 5: 316, 6: 270, 7: 232, 9: 171, 8: 151, 10: 114, 11: 107, 12: 92, 14: 79, 13: 73, 18: 63, 15: 60, 16: 59, 19: 55, 17: 41, 20: 38, 22: 33, 24: 33, 21: 33, 23: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19053411483764648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19053411483764648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.711274147033691  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.71209716796875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19248628616333008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 11 input nodes size: 41000
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18949127197265625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18949127197265625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20904159545898438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20908308029174805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17974472045898438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1040, 2: 804, 3: 574, 25: 483, 4: 412, 5: 380, 6: 299, 7: 246, 8: 204, 9: 161, 10: 143, 11: 125, 12: 97, 13: 75, 14: 66, 16: 59, 15: 51, 17: 49, 19: 46, 18: 45, 20: 42, 21: 36, 22: 31, 24: 30, 23: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18133926391601562  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18133926391601562  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7093582153320312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.71018123626709  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18275070190429688  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 12 input nodes size: 56009
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18073272705078125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18073272705078125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20743989944458008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20748376846313477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18789196014404297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1743, 1: 506, 2: 449, 3: 321, 5: 256, 4: 250, 6: 211, 7: 175, 9: 170, 10: 168, 8: 165, 12: 142, 11: 137, 13: 132, 14: 120, 20: 109, 18: 106, 15: 106, 16: 99, 21: 95, 17: 95, 19: 90, 23: 74, 22: 64, 24: 59})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19102954864501953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19102954864501953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.977601051330566  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.9784722328186035  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19382905960083008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 13 input nodes size: 49001
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18983936309814453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18983936309814453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21327686309814453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2133183479309082  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1865673065185547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1180, 1: 725, 2: 591, 3: 481, 4: 374, 5: 322, 6: 233, 7: 194, 9: 155, 8: 152, 10: 127, 12: 124, 11: 124, 13: 97, 15: 75, 17: 72, 16: 68, 14: 68, 19: 62, 21: 59, 18: 57, 24: 50, 20: 45, 23: 41, 22: 41})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18896484375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18896484375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.331800937652588  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.3326239585876465  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1910414695739746  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 14 input nodes size: 60895
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18793964385986328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18793964385986328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21723651885986328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21727800369262695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19379901885986328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 954, 2: 748, 25: 669, 3: 563, 4: 451, 5: 353, 6: 283, 7: 228, 8: 177, 9: 154, 10: 151, 11: 118, 12: 100, 13: 73, 15: 67, 14: 61, 16: 59, 18: 54, 17: 51, 19: 44, 21: 34, 20: 34, 22: 33, 23: 30, 24: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19589614868164062  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19589614868164062  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.439557075500488  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.440380096435547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19782352447509766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 15 input nodes size: 60605
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19490718841552734  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19490718841552734  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.22420406341552734  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.22424554824829102  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19490718841552734  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 962, 1: 721, 2: 644, 3: 502, 4: 363, 5: 325, 6: 239, 7: 186, 8: 173, 10: 161, 9: 155, 11: 136, 12: 119, 13: 102, 15: 99, 14: 82, 16: 81, 18: 79, 17: 75, 21: 73, 19: 69, 20: 53, 24: 47, 22: 40, 23: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1973743438720703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1973743438720703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.283185958862305  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.284008979797363  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19960880279541016  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19960880279541016  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16655445098876953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05636337399482727 |0.0025125741958618164 |0.11929270625114441 |0.0001230388879776001 |0.21138331294059753 |0.004957437515258789 |
----------------------------------------------------------pseudo_mini_loss sum 4.475226402282715
Total (block generation + training)time/epoch 50.95653295516968
Training time/epoch 6.4190661907196045
Training time without block to device /epoch 6.378865003585815
Training time without total dataloading part /epoch 5.2977423667907715
load block tensor time/epoch 0.9018139839172363
block to device time/epoch 0.04020118713378906
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  844639
Number of first layer input nodes during this epoch:  573880
Number of first layer output nodes during this epoch:  270759
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14989519119262695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.554 seconds, peak memory: 31.298 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.298 GB
Metis partitioning: 5.747 seconds, peak memory: 31.298 GB
Split the graph: 3.672 seconds
Construct subgraphs: 0.101 seconds
REG metis partition end ----................................
REG construction  time spent:  30.834163904190063
pure dgl.metis_partition the time spent:  11.105268239974976
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8548474311828613

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.084033966064453

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14989519119262695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

connection checking time:  2.0050249099731445
block generation total time  2.9388813972473145
average batch blocks generation time:  0.18368008732795715
block dataloader generation time/epoch 44.78791286728599
pseudo mini batch 0 input nodes size: 58630
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14655017852783203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14655017852783203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17450714111328125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17454862594604492  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14521026611328125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1507, 1: 625, 2: 498, 3: 401, 4: 294, 5: 245, 6: 213, 7: 169, 8: 150, 9: 148, 10: 139, 11: 125, 12: 115, 13: 107, 21: 86, 14: 84, 16: 83, 15: 83, 18: 77, 17: 70, 19: 68, 20: 68, 23: 65, 24: 54, 22: 43})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14812564849853516  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14812564849853516  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.261844158172607  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.262667655944824  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1824331283569336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 1 input nodes size: 53180
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1785593032836914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1785593032836914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2039499282836914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2039928436279297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1759943962097168  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1344, 1: 652, 2: 525, 3: 408, 5: 340, 4: 338, 6: 245, 7: 196, 9: 179, 8: 155, 10: 149, 12: 148, 11: 132, 13: 116, 14: 98, 15: 95, 17: 89, 16: 88, 20: 81, 18: 78, 19: 68, 21: 68, 22: 54, 24: 52, 23: 45})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17865467071533203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17865467071533203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.934944152832031  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.935800552368164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1810293197631836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 2 input nodes size: 67021
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17763280868530273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17763280868530273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20959091186523438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20963239669799805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18419885635375977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1113, 1: 672, 2: 597, 3: 464, 4: 342, 5: 333, 6: 273, 7: 191, 8: 168, 9: 135, 10: 134, 11: 126, 12: 121, 15: 98, 13: 97, 18: 90, 16: 86, 14: 84, 19: 80, 17: 76, 21: 66, 20: 59, 24: 45, 22: 45, 23: 45})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18697786331176758  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18697786331176758  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.781142234802246  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.781968593597412  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18949222564697266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 3 input nodes size: 67230
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18562841415405273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18562841415405273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21768617630004883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2177276611328125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1857280731201172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 878, 2: 757, 25: 667, 3: 587, 4: 438, 5: 344, 6: 274, 7: 228, 8: 177, 9: 175, 10: 148, 11: 119, 13: 107, 12: 88, 14: 65, 16: 65, 19: 62, 18: 59, 15: 57, 17: 54, 20: 54, 24: 34, 21: 32, 22: 29, 23: 26})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1879596710205078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1879596710205078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.626945495605469  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.627769470214844  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19002580642700195  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 4 input nodes size: 29266
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18686389923095703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18686389923095703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2008190155029297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20086097717285156  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1687617301940918  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1128, 2: 964, 3: 685, 4: 540, 5: 448, 6: 303, 7: 251, 8: 220, 9: 171, 25: 155, 10: 149, 11: 107, 12: 84, 13: 78, 14: 63, 15: 55, 16: 47, 18: 37, 17: 33, 19: 31, 20: 24, 21: 18, 22: 13, 24: 10, 23: 9})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16976690292358398  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16976690292358398  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.6676077842712402  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.6684465408325195  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17063045501708984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 5 input nodes size: 31107
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16953420639038086  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16953420639038086  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18436717987060547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18441009521484375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17041301727294922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1026, 2: 832, 3: 687, 4: 507, 5: 489, 6: 335, 25: 277, 7: 263, 8: 239, 9: 184, 10: 147, 12: 109, 11: 104, 13: 90, 14: 82, 15: 68, 16: 54, 19: 46, 18: 44, 17: 42, 20: 38, 23: 26, 21: 20, 24: 20, 22: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17161226272583008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17161226272583008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1397433280944824  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1406006813049316  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1726398468017578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 6 input nodes size: 44316
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17132997512817383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17132997512817383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19335222244262695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19339370727539062  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17851781845092773  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 997, 2: 809, 3: 589, 25: 448, 4: 445, 5: 413, 6: 289, 7: 253, 8: 231, 9: 156, 11: 144, 10: 140, 12: 96, 13: 75, 14: 68, 15: 64, 16: 59, 17: 49, 18: 44, 19: 42, 21: 39, 20: 37, 24: 29, 22: 29, 23: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1801600456237793  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1801600456237793  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.754922389984131  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7557525634765625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18160057067871094  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 7 input nodes size: 59150
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17947626113891602  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17947626113891602  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20768117904663086  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20772266387939453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18565893173217773  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 870, 1: 843, 2: 752, 3: 538, 4: 413, 5: 328, 6: 262, 7: 215, 9: 172, 8: 161, 10: 144, 11: 121, 12: 113, 14: 77, 13: 77, 15: 64, 17: 61, 16: 54, 19: 53, 18: 49, 20: 43, 21: 41, 22: 38, 24: 37, 23: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18788576126098633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18788576126098633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.795954704284668  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.796782493591309  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18990516662597656  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 8 input nodes size: 31775
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18688726425170898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18688726425170898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20203876495361328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20208215713500977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17383575439453125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 804, 2: 753, 3: 565, 25: 541, 4: 468, 5: 403, 6: 305, 7: 280, 8: 243, 9: 202, 10: 190, 11: 146, 12: 146, 14: 121, 13: 121, 15: 100, 17: 70, 16: 66, 18: 57, 20: 48, 22: 47, 21: 45, 19: 44, 24: 34, 23: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1752471923828125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1752471923828125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8228378295898438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8237061500549316  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17642545700073242  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 9 input nodes size: 24934
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17501068115234375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17501068115234375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18690013885498047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18694353103637695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17174863815307617  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 963, 2: 835, 3: 683, 4: 526, 5: 459, 6: 349, 7: 310, 25: 257, 8: 232, 9: 186, 10: 165, 11: 128, 12: 118, 13: 88, 14: 84, 15: 80, 17: 56, 16: 55, 18: 46, 19: 39, 20: 37, 22: 30, 21: 29, 24: 29, 23: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17286252975463867  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17286252975463867  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.0798826217651367  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.08074951171875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17375946044921875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 10 input nodes size: 20839
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1726670265197754  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1726670265197754  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1826038360595703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1826472282409668  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1707143783569336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 884, 2: 775, 3: 657, 4: 535, 5: 400, 6: 332, 7: 302, 8: 256, 25: 252, 9: 217, 10: 180, 11: 156, 12: 134, 13: 118, 14: 92, 15: 81, 16: 78, 19: 53, 20: 52, 18: 52, 17: 46, 22: 35, 21: 34, 23: 28, 24: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17182064056396484  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17182064056396484  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1397299766540527  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1405906677246094  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17268610000610352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 11 input nodes size: 26218
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1716618537902832  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1716618537902832  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18416357040405273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18420696258544922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1742267608642578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 929, 2: 877, 3: 659, 4: 547, 5: 426, 6: 344, 7: 273, 25: 269, 8: 263, 9: 192, 10: 148, 11: 135, 12: 113, 13: 95, 14: 94, 15: 76, 16: 64, 18: 54, 17: 51, 19: 36, 21: 32, 22: 31, 20: 30, 23: 26, 24: 21})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17536449432373047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17536449432373047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.111575126647949  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1124377250671387  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17629146575927734  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 12 input nodes size: 30236
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17514991760253906  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17514991760253906  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18956756591796875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18960952758789062  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1770644187927246  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1019, 2: 789, 3: 627, 4: 495, 5: 408, 25: 313, 6: 312, 7: 248, 8: 218, 10: 175, 9: 166, 11: 114, 12: 106, 13: 92, 15: 78, 14: 74, 17: 68, 16: 55, 18: 49, 19: 39, 20: 39, 21: 32, 23: 24, 24: 22, 22: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17827653884887695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17827653884887695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1853623390197754  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.186194896697998  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1792612075805664  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 13 input nodes size: 21280
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17794513702392578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17794513702392578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18809223175048828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18813562393188477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1736760139465332  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 713, 2: 659, 3: 582, 25: 554, 4: 452, 5: 401, 6: 330, 7: 294, 8: 247, 9: 222, 10: 183, 11: 166, 12: 142, 14: 125, 13: 123, 15: 105, 17: 83, 20: 74, 16: 73, 18: 59, 21: 58, 19: 52, 23: 41, 24: 39, 22: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17505502700805664  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17505502700805664  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8667120933532715  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8675789833068848  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17616796493530273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 14 input nodes size: 20449
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17489147186279297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17489147186279297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18475055694580078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18479394912719727  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17460346221923828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 577, 1: 569, 25: 562, 3: 516, 4: 454, 5: 389, 6: 357, 7: 310, 8: 259, 9: 225, 10: 214, 11: 190, 12: 160, 13: 139, 14: 123, 17: 103, 16: 96, 15: 89, 18: 84, 21: 69, 19: 66, 20: 65, 23: 54, 22: 50, 24: 45})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17596435546875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17596435546875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.9555916786193848  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.956451416015625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1769852638244629  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 15 input nodes size: 23357
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17583799362182617  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17583799362182617  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18755674362182617  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18760013580322266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17769765853881836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 726, 2: 707, 3: 629, 4: 526, 5: 396, 6: 345, 25: 331, 7: 262, 8: 253, 9: 246, 10: 194, 11: 190, 12: 144, 13: 133, 14: 100, 15: 96, 16: 88, 17: 79, 18: 69, 20: 58, 19: 57, 21: 48, 22: 38, 23: 33, 24: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17893552780151367  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17893552780151367  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.4888038635253906  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.489665985107422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17990970611572266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17990970611572266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14685535430908203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.057487815618515015 |0.0031136274337768555 |0.1153448224067688 |0.00011518597602844238 |0.21110689640045166 |0.004915475845336914 |
----------------------------------------------------------pseudo_mini_loss sum 3.8316330909729004
Total (block generation + training)time/epoch 51.22780791195956
Training time/epoch 6.349698543548584
Training time without block to device /epoch 6.299880504608154
Training time without total dataloading part /epoch 5.229985952377319
load block tensor time/epoch 0.9198050498962402
block to device time/epoch 0.04981803894042969
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  891365
Number of first layer input nodes during this epoch:  608988
Number of first layer output nodes during this epoch:  282377
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1298661231994629  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.484 seconds, peak memory: 31.298 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.298 GB
Metis partitioning: 5.604 seconds, peak memory: 31.298 GB
Split the graph: 6.119 seconds
Construct subgraphs: 0.075 seconds
REG metis partition end ----................................
REG construction  time spent:  26.971572399139404
pure dgl.metis_partition the time spent:  13.311988830566406
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.840479850769043

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  3.3558549880981445

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1298661231994629  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

connection checking time:  2.519408702850342
block generation total time  4.1963348388671875
average batch blocks generation time:  0.2622709274291992
block dataloader generation time/epoch 45.02984050909678
pseudo mini batch 0 input nodes size: 55612
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12871742248535156  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12871742248535156  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.15523529052734375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.15527868270874023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14351654052734375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1612, 1: 528, 2: 421, 3: 342, 4: 290, 5: 265, 6: 231, 9: 181, 7: 179, 10: 174, 8: 163, 11: 145, 12: 144, 13: 134, 14: 115, 17: 105, 19: 98, 15: 97, 20: 96, 16: 94, 18: 94, 21: 89, 23: 71, 24: 65, 22: 63})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1465301513671875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1465301513671875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.684837341308594  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.685702323913574  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1811690330505371  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 1 input nodes size: 55465
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1773395538330078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1773395538330078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20378732681274414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2038288116455078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17726755142211914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1258, 1: 696, 2: 557, 3: 455, 4: 334, 5: 289, 6: 229, 7: 213, 8: 152, 9: 146, 10: 137, 12: 130, 11: 127, 13: 91, 16: 90, 15: 87, 14: 76, 17: 73, 20: 65, 18: 65, 21: 61, 19: 59, 24: 54, 23: 38, 22: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17984628677368164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17984628677368164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.658377647399902  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.659200668334961  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18210601806640625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 2 input nodes size: 60226
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17871427536010742  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17871427536010742  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20801115036010742  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2080526351928711  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1815633773803711  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 945, 2: 817, 25: 611, 3: 528, 4: 423, 5: 341, 6: 262, 7: 228, 8: 183, 9: 160, 10: 143, 11: 126, 12: 122, 13: 87, 15: 76, 14: 75, 16: 62, 19: 58, 17: 53, 18: 52, 21: 44, 20: 39, 23: 31, 22: 31, 24: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18359661102294922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18359661102294922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.382245063781738  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.383068084716797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18545818328857422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 3 input nodes size: 63957
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18266057968139648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18266057968139648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21315765380859375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21319913864135742  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18386077880859375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1156, 1: 669, 2: 556, 3: 480, 4: 352, 5: 350, 6: 255, 8: 175, 7: 170, 9: 156, 10: 146, 11: 128, 13: 106, 12: 95, 15: 92, 14: 88, 18: 80, 17: 74, 16: 74, 19: 69, 21: 61, 20: 59, 23: 45, 22: 42, 24: 39})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18660545349121094  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18660545349121094  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.7548956871032715  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.75571870803833  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18910884857177734  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 4 input nodes size: 37625
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18532037734985352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18532037734985352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2032613754272461  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20330286026000977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17276430130004883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1049, 2: 972, 3: 736, 4: 518, 5: 405, 6: 316, 7: 261, 8: 200, 25: 158, 9: 158, 10: 126, 11: 96, 12: 83, 13: 71, 14: 66, 16: 54, 15: 49, 18: 38, 17: 36, 19: 30, 21: 24, 20: 22, 24: 18, 23: 17, 22: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1739029884338379  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1739029884338379  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.8137731552124023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.814596176147461  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17489862442016602  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 5 input nodes size: 32795
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17352867126464844  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17352867126464844  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18916654586791992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1892080307006836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17122554779052734  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1121, 2: 878, 3: 666, 4: 477, 5: 423, 6: 321, 7: 247, 25: 222, 8: 210, 9: 173, 10: 124, 12: 99, 11: 94, 13: 82, 14: 77, 16: 52, 15: 52, 17: 38, 18: 32, 19: 30, 20: 28, 23: 21, 24: 19, 22: 16, 21: 15})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17235183715820312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17235183715820312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.870413303375244  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.8712363243103027  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17331886291503906  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 6 input nodes size: 39230
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1720285415649414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1720285415649414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1915597915649414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19160223007202148  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17592287063598633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 983, 2: 830, 3: 586, 25: 460, 4: 451, 5: 428, 6: 311, 7: 267, 8: 222, 9: 171, 10: 153, 11: 144, 12: 104, 13: 77, 15: 73, 14: 64, 16: 61, 18: 53, 17: 50, 19: 43, 20: 41, 24: 36, 22: 32, 21: 30, 23: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17749786376953125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17749786376953125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.723177909851074  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7240262031555176  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17890214920043945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 7 input nodes size: 56471
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17696046829223633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17696046829223633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.203887939453125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20392942428588867  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1843557357788086  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 882, 25: 838, 2: 737, 3: 548, 4: 426, 5: 332, 6: 234, 7: 205, 8: 180, 9: 164, 10: 133, 11: 120, 12: 116, 13: 90, 14: 78, 18: 70, 15: 55, 16: 50, 19: 48, 20: 48, 21: 41, 17: 41, 22: 35, 24: 28, 23: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18647384643554688  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18647384643554688  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.634067535400391  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.634891986846924  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18836021423339844  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 8 input nodes size: 26503
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18553447723388672  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18553447723388672  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19817209243774414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19821500778198242  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17124605178833008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 655, 2: 597, 25: 578, 3: 545, 4: 424, 5: 399, 6: 293, 7: 281, 8: 257, 9: 205, 10: 194, 11: 185, 12: 149, 14: 125, 13: 117, 15: 114, 16: 101, 17: 84, 18: 71, 20: 68, 21: 63, 19: 62, 24: 45, 23: 44, 22: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17274856567382812  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17274856567382812  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.040597438812256  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.041447162628174  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17397546768188477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 9 input nodes size: 25411
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17248821258544922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17248821258544922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18460512161254883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1846480369567871  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1719675064086914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 888, 2: 750, 3: 642, 4: 491, 25: 474, 5: 407, 6: 321, 7: 253, 8: 215, 9: 206, 10: 155, 12: 121, 11: 116, 13: 103, 17: 84, 14: 83, 15: 76, 20: 58, 18: 56, 16: 54, 19: 52, 21: 48, 23: 35, 22: 29, 24: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17327356338500977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17327356338500977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.536269187927246  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.537125587463379  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17433691024780273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 10 input nodes size: 19923
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17302656173706055  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17302656173706055  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18288564682006836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18292951583862305  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17076969146728516  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 571, 1: 558, 3: 532, 4: 471, 25: 423, 5: 414, 6: 390, 7: 325, 8: 301, 9: 237, 11: 233, 10: 233, 13: 164, 12: 159, 14: 132, 16: 97, 17: 93, 15: 91, 18: 81, 20: 81, 21: 60, 19: 56, 22: 49, 24: 45, 23: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17209720611572266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17209720611572266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8233585357666016  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.824228286743164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17312049865722656  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 11 input nodes size: 20452
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17197895050048828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17197895050048828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1817312240600586  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18177461624145508  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17187166213989258  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 818, 1: 803, 3: 607, 4: 561, 5: 420, 25: 362, 6: 339, 7: 281, 9: 226, 8: 226, 10: 173, 11: 137, 12: 126, 13: 112, 14: 108, 15: 86, 16: 70, 17: 65, 18: 63, 19: 58, 21: 42, 23: 38, 20: 36, 22: 32, 24: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1730179786682129  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1730179786682129  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.302031993865967  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.3028998374938965  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1739029884338379  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 12 input nodes size: 25986
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17289447784423828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17289447784423828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1852855682373047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18532896041870117  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17553329467773438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 911, 2: 746, 3: 627, 4: 503, 25: 429, 5: 420, 6: 290, 7: 268, 8: 256, 10: 183, 9: 182, 11: 145, 13: 118, 12: 116, 14: 93, 15: 92, 16: 79, 17: 64, 19: 62, 20: 58, 18: 47, 21: 43, 22: 37, 23: 31, 24: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17681884765625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17681884765625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.514251232147217  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.5151195526123047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17785215377807617  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 13 input nodes size: 20649
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1765885353088379  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1765885353088379  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1864476203918457  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1864910125732422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1740565299987793  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 873, 2: 801, 3: 662, 4: 556, 5: 478, 6: 377, 7: 314, 8: 269, 9: 225, 10: 176, 25: 165, 11: 153, 12: 139, 13: 110, 14: 91, 15: 80, 16: 57, 17: 55, 18: 47, 20: 39, 19: 32, 21: 27, 22: 27, 24: 25, 23: 21})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17509889602661133  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17509889602661133  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.9682469367980957  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.969111919403076  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17592144012451172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 14 input nodes size: 32140
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17494916915893555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17494916915893555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19027471542358398  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19031858444213867  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18041610717773438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 802, 2: 747, 3: 592, 4: 509, 25: 509, 5: 404, 6: 329, 7: 278, 8: 233, 9: 215, 10: 188, 12: 143, 11: 140, 13: 117, 14: 101, 15: 89, 16: 71, 17: 67, 18: 53, 19: 50, 22: 48, 20: 47, 21: 44, 24: 31, 23: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18181133270263672  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18181133270263672  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.730363368988037  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7312331199645996  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18294620513916016  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 15 input nodes size: 25904
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1815328598022461  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1815328598022461  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19388484954833984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19392824172973633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1785588264465332  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1065, 2: 908, 3: 729, 4: 534, 5: 447, 6: 370, 7: 275, 8: 230, 25: 205, 9: 171, 10: 161, 11: 114, 12: 91, 15: 80, 13: 77, 14: 62, 17: 48, 18: 46, 16: 45, 19: 29, 21: 25, 23: 23, 20: 22, 22: 22, 24: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17960214614868164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17960214614868164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.8748059272766113  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.8756704330444336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1804513931274414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1804513931274414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14739704132080078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05688449740409851 |0.002575024962425232 |0.11907219886779785 |0.0001154094934463501 |0.21232113242149353 |0.005064249038696289 |
----------------------------------------------------------pseudo_mini_loss sum 3.7871694564819336
Total (block generation + training)time/epoch 51.46878516674042
Training time/epoch 6.428175926208496
Training time without block to device /epoch 6.386975526809692
Training time without total dataloading part /epoch 5.3092041015625
load block tensor time/epoch 0.9101519584655762
block to device time/epoch 0.04120039939880371
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  876435
Number of first layer input nodes during this epoch:  598349
Number of first layer output nodes during this epoch:  278086
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1301898956298828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.521 seconds, peak memory: 31.298 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.298 GB
Metis partitioning: 5.622 seconds, peak memory: 31.298 GB
Split the graph: 3.713 seconds
Construct subgraphs: 0.070 seconds
REG metis partition end ----................................
REG construction  time spent:  26.508130311965942
pure dgl.metis_partition the time spent:  10.956370830535889
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8506989479064941

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.013256311416626

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1301898956298828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

connection checking time:  1.9735209941864014
block generation total time  2.86395525932312
average batch blocks generation time:  0.178997203707695
block dataloader generation time/epoch 44.871395056064316
pseudo mini batch 0 input nodes size: 20446
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12913131713867188  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12913131713867188  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1389904022216797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13903379440307617  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12663841247558594  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 862, 2: 767, 3: 617, 4: 519, 5: 420, 25: 324, 6: 322, 7: 314, 8: 255, 9: 211, 10: 194, 11: 148, 12: 133, 13: 118, 14: 90, 15: 86, 16: 82, 19: 57, 17: 50, 20: 49, 18: 49, 22: 33, 21: 30, 23: 28, 24: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12778282165527344  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12778282165527344  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1941184997558594  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.194981098175049  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16089344024658203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 1 input nodes size: 34080
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.15984582901000977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.15984582901000977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17609643936157227  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17614030838012695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16623783111572266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 763, 2: 698, 3: 570, 25: 556, 4: 474, 5: 397, 6: 310, 7: 292, 8: 249, 9: 206, 10: 194, 12: 150, 11: 148, 13: 119, 14: 119, 15: 109, 17: 85, 16: 72, 18: 58, 20: 55, 22: 52, 19: 48, 21: 48, 24: 40, 23: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1677265167236328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1677265167236328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.94698429107666  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.947854995727539  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1689434051513672  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 2 input nodes size: 25927
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1674175262451172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1674175262451172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1797804832458496  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1798238754272461  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1635293960571289  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 833, 2: 801, 3: 586, 4: 507, 5: 434, 6: 353, 25: 346, 7: 287, 8: 268, 9: 207, 10: 182, 11: 163, 12: 120, 13: 105, 14: 101, 15: 95, 16: 69, 17: 59, 18: 54, 19: 51, 20: 48, 23: 39, 22: 39, 21: 38, 24: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16477203369140625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16477203369140625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.410762310028076  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.4116291999816895  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16576576232910156  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 3 input nodes size: 16395
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16455078125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16455078125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17236852645874023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17241191864013672  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1600055694580078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1097, 2: 975, 3: 773, 4: 596, 5: 467, 6: 368, 7: 284, 8: 249, 9: 164, 10: 140, 11: 102, 12: 97, 13: 83, 25: 73, 14: 65, 15: 64, 17: 37, 16: 32, 18: 31, 21: 17, 19: 17, 24: 12, 20: 12, 23: 10, 22: 9})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16082477569580078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16082477569580078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.3971405029296875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.3980016708374023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1614694595336914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 4 input nodes size: 25222
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1607193946838379  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1607193946838379  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1727461814880371  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17278814315795898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16492700576782227  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 787, 2: 695, 3: 582, 25: 573, 4: 461, 5: 377, 6: 280, 7: 254, 8: 201, 9: 188, 10: 166, 11: 155, 12: 134, 13: 96, 15: 94, 14: 81, 17: 80, 16: 69, 18: 67, 19: 64, 21: 60, 20: 50, 23: 45, 22: 35, 24: 34})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1662907600402832  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1662907600402832  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7160754203796387  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.716914653778076  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16735601425170898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 5 input nodes size: 21862
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16603326797485352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16603326797485352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17645788192749023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17650175094604492  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16443300247192383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 744, 2: 626, 25: 573, 3: 553, 4: 438, 5: 391, 6: 345, 7: 280, 8: 250, 9: 226, 10: 186, 11: 167, 12: 146, 14: 128, 13: 122, 15: 103, 17: 92, 16: 81, 20: 75, 18: 67, 21: 66, 19: 53, 23: 44, 24: 38, 22: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16585683822631836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16585683822631836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.931934356689453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.9328036308288574  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1670064926147461  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 6 input nodes size: 20279
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16566896438598633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16566896438598633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17552804946899414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17557191848754883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16510343551635742  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 631, 1: 614, 3: 597, 4: 488, 5: 429, 6: 391, 25: 348, 7: 326, 8: 272, 9: 228, 10: 227, 11: 205, 13: 153, 12: 140, 14: 134, 16: 100, 17: 94, 15: 86, 18: 79, 20: 70, 19: 54, 21: 53, 22: 46, 24: 40, 23: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16637945175170898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16637945175170898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.6598048210144043  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.660675525665283  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16736316680908203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 7 input nodes size: 22871
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16623258590698242  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16623258590698242  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17795133590698242  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1779947280883789  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1680917739868164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 990, 2: 855, 3: 672, 4: 550, 5: 404, 6: 312, 25: 263, 7: 246, 8: 226, 9: 204, 10: 158, 11: 138, 12: 127, 13: 111, 14: 87, 15: 72, 16: 59, 19: 50, 17: 49, 18: 49, 20: 41, 21: 30, 22: 26, 24: 25, 23: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16916751861572266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16916751861572266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.04343318939209  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.0442934036254883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1700143814086914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 8 input nodes size: 33272
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1689929962158203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1689929962158203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1848583221435547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18490028381347656  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17313814163208008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 999, 2: 885, 3: 682, 4: 514, 5: 446, 6: 323, 7: 238, 25: 232, 8: 217, 9: 195, 10: 146, 11: 104, 12: 100, 13: 83, 16: 68, 14: 67, 15: 61, 17: 47, 18: 47, 19: 42, 20: 30, 21: 28, 22: 19, 23: 17, 24: 15})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17430925369262695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17430925369262695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.997847080230713  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.998682975769043  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17528057098388672  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 9 input nodes size: 29541
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17396211624145508  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17396211624145508  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18892717361450195  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18896913528442383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17306184768676758  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1055, 2: 834, 3: 698, 4: 511, 5: 466, 6: 349, 7: 245, 25: 222, 8: 222, 9: 184, 10: 141, 12: 109, 11: 105, 13: 87, 14: 67, 15: 54, 16: 49, 17: 41, 19: 40, 18: 37, 20: 36, 23: 21, 21: 18, 22: 17, 24: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17417001724243164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17417001724243164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.909327983856201  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.9101667404174805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17510557174682617  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 10 input nodes size: 45161
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17389631271362305  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17389631271362305  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19591856002807617  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19596052169799805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1809535026550293  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1005, 2: 825, 3: 563, 25: 492, 4: 441, 5: 373, 6: 309, 7: 241, 8: 220, 9: 170, 10: 152, 11: 137, 12: 95, 13: 77, 14: 64, 17: 63, 16: 60, 15: 56, 18: 50, 19: 45, 20: 41, 22: 35, 21: 35, 23: 28, 24: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18263006210327148  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18263006210327148  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8554859161376953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8563218116760254  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18411874771118164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 11 input nodes size: 57412
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18197107315063477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18197107315063477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20934724807739258  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20938873291015625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18732452392578125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 908, 25: 770, 2: 756, 3: 565, 4: 413, 5: 366, 6: 233, 7: 221, 8: 161, 9: 153, 10: 139, 11: 125, 12: 113, 14: 78, 13: 78, 15: 62, 16: 57, 18: 57, 19: 51, 20: 48, 17: 44, 22: 37, 24: 33, 21: 31, 23: 26})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18940258026123047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18940258026123047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.517383575439453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.518207550048828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19127416610717773  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 12 input nodes size: 66908
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1884751319885254  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1884751319885254  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.22037935256958008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.22042083740234375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19300317764282227  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1218, 1: 584, 2: 549, 3: 424, 5: 324, 4: 323, 6: 241, 7: 190, 8: 183, 10: 156, 9: 149, 11: 134, 13: 113, 12: 112, 15: 105, 14: 102, 18: 85, 16: 81, 21: 78, 19: 73, 17: 69, 20: 67, 22: 58, 24: 52, 23: 47})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19667863845825195  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19667863845825195  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.140392780303955  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.141215801239014  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2003035545349121  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 13 input nodes size: 67828
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19454240798950195  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19454240798950195  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.22688531875610352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2269268035888672  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19498109817504883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 923, 1: 825, 2: 706, 3: 509, 4: 416, 5: 336, 6: 262, 7: 205, 8: 189, 9: 145, 10: 130, 11: 111, 13: 106, 12: 89, 15: 80, 14: 79, 16: 70, 18: 61, 17: 57, 20: 55, 19: 53, 21: 45, 24: 35, 23: 33, 22: 26})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1974787712097168  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1974787712097168  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.1778106689453125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.178637981414795  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19978809356689453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 14 input nodes size: 55302
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19626903533935547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19626903533935547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2226390838623047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.22268199920654297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19029760360717773  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1533, 1: 615, 2: 467, 3: 364, 5: 279, 4: 265, 6: 211, 7: 175, 10: 165, 8: 158, 9: 157, 12: 152, 11: 141, 13: 116, 18: 101, 16: 99, 19: 96, 14: 95, 21: 93, 15: 93, 17: 90, 20: 80, 24: 64, 23: 63, 22: 57})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19322681427001953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19322681427001953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.4822211265563965  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.4830756187438965  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19583559036254883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 15 input nodes size: 55572
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19207239151000977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19207239151000977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21857118606567383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2186126708984375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19219970703125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1014, 1: 747, 2: 636, 3: 522, 4: 404, 5: 313, 6: 259, 7: 247, 9: 189, 8: 152, 10: 123, 11: 120, 12: 120, 13: 89, 14: 77, 17: 73, 15: 69, 16: 63, 18: 56, 20: 50, 21: 47, 19: 42, 24: 41, 23: 33, 22: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19455528259277344  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19455528259277344  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.114399433135986  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.115222454071045  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19664573669433594  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19664573669433594  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1635913848876953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05722874402999878 |0.00257951021194458 |0.1156827062368393 |0.00011351704597473145 |0.21168479323387146 |0.005028724670410156 |
----------------------------------------------------------pseudo_mini_loss sum 3.7964470386505127
Total (block generation + training)time/epoch 51.30341971837557
Training time/epoch 6.3486738204956055
Training time without block to device /epoch 6.307401657104492
Training time without total dataloading part /epoch 5.244724988937378
load block tensor time/epoch 0.9156599044799805
block to device time/epoch 0.04127216339111328
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  879196
Number of first layer input nodes during this epoch:  598078
Number of first layer output nodes during this epoch:  281118
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14687299728393555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.517 seconds, peak memory: 31.298 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.298 GB
Metis partitioning: 5.902 seconds, peak memory: 31.298 GB
Split the graph: 4.666 seconds
Construct subgraphs: 0.104 seconds
REG metis partition end ----................................
REG construction  time spent:  24.500949144363403
pure dgl.metis_partition the time spent:  12.220404386520386
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8432116508483887

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.97666335105896

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14687299728393555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

connection checking time:  1.9880716800689697
block generation total time  2.8198750019073486
average batch blocks generation time:  0.1762421876192093
block dataloader generation time/epoch 44.68276955400194
pseudo mini batch 0 input nodes size: 20110
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1437215805053711  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1437215805053711  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1535806655883789  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1536240577697754  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12708377838134766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 586, 25: 516, 1: 513, 3: 512, 4: 467, 5: 408, 6: 376, 7: 320, 8: 269, 10: 231, 9: 227, 11: 209, 12: 155, 13: 146, 14: 130, 15: 100, 17: 100, 16: 98, 18: 87, 20: 74, 21: 74, 19: 64, 24: 49, 22: 48, 23: 43})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12845230102539062  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12845230102539062  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.905457019805908  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.906322956085205  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16125917434692383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 1 input nodes size: 23319
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1600966453552246  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1600966453552246  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1718153953552246  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17185688018798828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16195440292358398  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 851, 2: 724, 3: 635, 4: 489, 5: 397, 25: 317, 6: 314, 7: 263, 8: 227, 9: 205, 11: 162, 10: 155, 12: 139, 13: 125, 14: 95, 16: 69, 15: 67, 18: 55, 17: 53, 19: 46, 20: 44, 22: 41, 21: 35, 24: 27, 23: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16310453414916992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16310453414916992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1844825744628906  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.185311794281006  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16398382186889648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 2 input nodes size: 23294
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16287708282470703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16287708282470703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17398452758789062  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1740274429321289  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16226720809936523  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 855, 2: 694, 3: 607, 25: 530, 4: 473, 5: 401, 6: 330, 7: 249, 8: 216, 9: 193, 10: 163, 11: 144, 12: 118, 13: 103, 14: 89, 15: 85, 17: 78, 20: 65, 18: 62, 16: 58, 19: 57, 21: 55, 23: 40, 22: 32, 24: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16357803344726562  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16357803344726562  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.6007919311523438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.6016459465026855  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1646404266357422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 3 input nodes size: 24485
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1633925437927246  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1633925437927246  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1751112937927246  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1751546859741211  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16400432586669922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 939, 2: 787, 3: 655, 4: 472, 25: 408, 5: 375, 6: 300, 7: 269, 8: 232, 9: 202, 10: 172, 11: 150, 12: 122, 13: 104, 14: 97, 15: 85, 17: 81, 16: 79, 20: 50, 18: 44, 21: 42, 19: 41, 23: 33, 24: 31, 22: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16528034210205078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16528034210205078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.4592514038085938  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.460115909576416  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16632366180419922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 4 input nodes size: 26092
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16504430770874023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16504430770874023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17748594284057617  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17752885818481445  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16576671600341797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 931, 2: 794, 3: 602, 4: 459, 5: 404, 25: 354, 6: 327, 8: 274, 7: 255, 9: 184, 10: 178, 11: 152, 12: 132, 13: 98, 15: 95, 14: 89, 17: 64, 18: 61, 16: 59, 19: 54, 20: 51, 21: 41, 22: 38, 23: 37, 24: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1669917106628418  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1669917106628418  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.36506986618042  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.3659286499023438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16797113418579102  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 5 input nodes size: 17315
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16676807403564453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16676807403564453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17502450942993164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17506790161132812  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1625833511352539  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1059, 2: 959, 3: 755, 4: 561, 5: 489, 6: 384, 7: 310, 8: 230, 9: 170, 10: 135, 11: 105, 12: 100, 25: 91, 13: 85, 14: 73, 15: 63, 16: 44, 18: 33, 17: 30, 19: 18, 21: 17, 24: 15, 22: 13, 20: 13, 23: 11})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1634359359741211  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1634359359741211  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.4735708236694336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.4744300842285156  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16411542892456055  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 6 input nodes size: 33097
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16332769393920898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16332769393920898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1791095733642578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1791529655456543  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1708531379699707  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 753, 2: 719, 3: 569, 25: 506, 4: 486, 5: 400, 6: 318, 7: 292, 8: 266, 9: 210, 10: 205, 11: 144, 12: 139, 14: 118, 13: 113, 15: 100, 16: 75, 17: 74, 19: 50, 18: 49, 20: 47, 21: 44, 22: 42, 24: 32, 23: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1722884178161621  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1722884178161621  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8120369911193848  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.812899112701416  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1734604835510254  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 7 input nodes size: 20434
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1719808578491211  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1719808578491211  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1818399429321289  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1818838119506836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16605854034423828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 832, 2: 753, 3: 608, 4: 531, 5: 414, 6: 328, 25: 325, 7: 314, 8: 245, 9: 229, 10: 195, 11: 150, 12: 149, 13: 115, 14: 106, 15: 93, 16: 87, 19: 65, 17: 57, 18: 57, 20: 51, 22: 37, 21: 33, 23: 28, 24: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16722774505615234  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16722774505615234  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.348344326019287  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.3492136001586914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16814661026000977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 8 input nodes size: 64562
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16709136962890625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16709136962890625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1978769302368164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19791841506958008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18801546096801758  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 843, 25: 785, 2: 709, 3: 481, 4: 414, 5: 349, 6: 278, 7: 210, 8: 177, 9: 149, 10: 133, 11: 130, 13: 108, 12: 108, 15: 92, 16: 81, 14: 79, 19: 65, 20: 61, 17: 58, 18: 53, 21: 48, 23: 41, 24: 37, 22: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19040536880493164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19040536880493164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.96771764755249  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.968540668487549  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19256114959716797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 9 input nodes size: 63928
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18920516967773438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18920516967773438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21968841552734375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21972990036010742  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1889028549194336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1186, 1: 662, 2: 601, 3: 446, 4: 368, 5: 323, 6: 247, 7: 216, 8: 177, 9: 170, 10: 135, 11: 122, 12: 117, 13: 90, 18: 84, 14: 78, 16: 77, 15: 77, 19: 67, 17: 62, 21: 54, 20: 48, 24: 42, 23: 41, 22: 40})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19160842895507812  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19160842895507812  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.721533298492432  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.722358226776123  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19407081604003906  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 10 input nodes size: 56350
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19036245346069336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19036245346069336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21723222732543945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21727371215820312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18674898147583008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1227, 1: 718, 2: 587, 3: 462, 4: 347, 5: 301, 6: 256, 7: 188, 9: 164, 8: 146, 10: 138, 12: 130, 11: 128, 13: 88, 15: 75, 14: 74, 17: 66, 16: 63, 19: 62, 18: 62, 21: 56, 20: 52, 22: 48, 24: 43, 23: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18931150436401367  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18931150436401367  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.605554580688477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.606377601623535  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19160795211791992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 11 input nodes size: 56370
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.188201904296875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.188201904296875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21508121490478516  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21512460708618164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18821334838867188  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1642, 1: 571, 2: 443, 3: 381, 4: 282, 5: 243, 7: 190, 6: 176, 9: 173, 8: 170, 10: 159, 12: 134, 11: 128, 13: 118, 14: 114, 18: 111, 16: 100, 15: 98, 17: 96, 21: 94, 20: 91, 19: 83, 23: 75, 22: 70, 24: 62})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19126510620117188  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19126510620117188  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.769143104553223  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.770008563995361  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19399213790893555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 12 input nodes size: 32674
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19008445739746094  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19008445739746094  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20566463470458984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20570659637451172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17878389358520508  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1032, 2: 836, 3: 690, 4: 492, 5: 455, 6: 338, 7: 242, 25: 235, 8: 212, 9: 169, 10: 148, 11: 109, 12: 101, 13: 91, 14: 77, 15: 58, 16: 54, 17: 43, 18: 42, 19: 35, 20: 33, 23: 21, 24: 20, 21: 20, 22: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17995214462280273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17995214462280273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.998204231262207  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.999034881591797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18091678619384766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 13 input nodes size: 32553
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17959070205688477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17959070205688477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1951131820678711  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19515705108642578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.179534912109375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 968, 2: 939, 3: 690, 4: 548, 5: 453, 6: 322, 7: 265, 25: 241, 8: 232, 9: 205, 10: 172, 11: 120, 12: 104, 13: 101, 14: 80, 15: 68, 16: 64, 17: 54, 18: 52, 19: 36, 20: 33, 21: 32, 23: 20, 22: 20, 24: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18074321746826172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18074321746826172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1501121520996094  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.15098237991333  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18179845809936523  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 14 input nodes size: 58452
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18047237396240234  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18047237396240234  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2083444595336914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20838594436645508  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19281959533691406  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 878, 2: 799, 25: 666, 3: 616, 4: 452, 5: 393, 6: 269, 7: 200, 8: 174, 9: 155, 10: 123, 11: 112, 12: 95, 13: 88, 14: 76, 15: 66, 17: 60, 20: 49, 16: 48, 19: 46, 18: 44, 24: 37, 21: 34, 22: 25, 23: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19484996795654297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19484996795654297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.377319812774658  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.378144264221191  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19666099548339844  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 15 input nodes size: 39213
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1938800811767578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1938800811767578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2134113311767578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2134532928466797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18553972244262695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1023, 2: 776, 3: 568, 4: 479, 25: 431, 5: 417, 6: 305, 7: 262, 8: 225, 9: 171, 10: 157, 11: 138, 12: 94, 13: 83, 15: 67, 14: 59, 16: 55, 17: 54, 18: 52, 19: 47, 20: 45, 21: 38, 24: 31, 22: 30, 23: 15})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18707036972045898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18707036972045898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.637037754058838  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.637876033782959  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18842411041259766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18842411041259766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.15536975860595703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05843131244182587 |0.003302857279777527 |0.12467673420906067 |0.00010958313941955566 |0.21236620843410492 |0.0018084049224853516 |
----------------------------------------------------------pseudo_mini_loss sum 3.6186599731445312
Total (block generation + training)time/epoch 51.12098327704838
Training time/epoch 6.518358945846558
Training time without block to device /epoch 6.465513229370117
Training time without total dataloading part /epoch 5.396248817443848
load block tensor time/epoch 0.9349009990692139
block to device time/epoch 0.05284571647644043
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  871102
Number of first layer input nodes during this epoch:  592248
Number of first layer output nodes during this epoch:  278854
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13831424713134766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.522 seconds, peak memory: 31.298 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.298 GB
Metis partitioning: 5.594 seconds, peak memory: 31.298 GB
Split the graph: 4.525 seconds
Construct subgraphs: 0.139 seconds
REG metis partition end ----................................
REG construction  time spent:  25.78700017929077
pure dgl.metis_partition the time spent:  11.815034627914429
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8391330242156982

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.031064748764038

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13831424713134766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

connection checking time:  1.8719220161437988
block generation total time  2.8701977729797363
average batch blocks generation time:  0.17938736081123352
block dataloader generation time/epoch 44.57879823048909
pseudo mini batch 0 input nodes size: 19994
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1364307403564453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1364307403564453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14628982543945312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1463327407836914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12675952911376953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 769, 1: 761, 3: 627, 4: 523, 5: 387, 25: 373, 6: 327, 7: 250, 8: 236, 9: 221, 10: 174, 11: 169, 12: 164, 13: 119, 14: 98, 15: 85, 16: 68, 18: 63, 17: 63, 19: 59, 21: 50, 20: 43, 23: 39, 22: 38, 24: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12790441513061523  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12790441513061523  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.2837471961975098  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.2846031188964844  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16086578369140625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 1 input nodes size: 19908
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1598806381225586  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1598806381225586  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1693735122680664  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1694164276123047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1595144271850586  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 599, 2: 566, 3: 530, 4: 460, 5: 419, 25: 410, 6: 395, 7: 322, 8: 267, 10: 226, 9: 220, 11: 215, 12: 148, 13: 145, 14: 127, 16: 102, 17: 98, 15: 91, 20: 78, 18: 75, 21: 66, 19: 55, 22: 45, 24: 42, 23: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16080141067504883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16080141067504883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.722813606262207  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7236685752868652  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16177940368652344  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 2 input nodes size: 23833
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1606736183166504  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1606736183166504  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17203807830810547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17207956314086914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16254377365112305  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 765, 2: 661, 3: 566, 25: 471, 4: 441, 5: 367, 6: 285, 7: 282, 8: 224, 9: 206, 10: 172, 11: 160, 12: 126, 14: 115, 13: 113, 15: 88, 17: 85, 16: 75, 20: 57, 18: 53, 19: 48, 21: 45, 24: 42, 23: 36, 22: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16387033462524414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16387033462524414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.5734949111938477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.5743179321289062  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1649026870727539  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 3 input nodes size: 25423
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1635904312133789  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1635904312133789  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17571306228637695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17575454711914062  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16434860229492188  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 902, 2: 710, 3: 595, 25: 511, 4: 442, 5: 377, 6: 288, 7: 237, 8: 206, 9: 173, 10: 160, 11: 117, 12: 106, 13: 91, 14: 87, 15: 84, 17: 66, 18: 61, 16: 58, 20: 57, 19: 53, 21: 44, 23: 36, 22: 29, 24: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16562557220458984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16562557220458984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.4480972290039062  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.448920249938965  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1666545867919922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 4 input nodes size: 24064
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16538763046264648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16538763046264648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17710638046264648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17715024948120117  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16498613357543945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 837, 2: 770, 3: 614, 4: 511, 5: 452, 25: 352, 6: 326, 7: 312, 8: 254, 9: 228, 10: 187, 11: 146, 13: 136, 12: 127, 14: 108, 15: 76, 16: 74, 19: 57, 17: 55, 18: 54, 20: 53, 22: 35, 21: 33, 24: 29, 23: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16620302200317383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16620302200317383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.414236545562744  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.415109634399414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1672210693359375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 5 input nodes size: 18596
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16606616973876953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16606616973876953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17493343353271484  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17497730255126953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16321468353271484  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1027, 2: 884, 3: 708, 4: 576, 5: 452, 6: 369, 7: 311, 8: 247, 9: 203, 10: 162, 25: 154, 11: 119, 12: 113, 13: 92, 14: 74, 15: 72, 16: 57, 18: 47, 17: 46, 19: 30, 21: 24, 20: 24, 22: 21, 24: 20, 23: 18})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16415882110595703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16415882110595703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.7472920417785645  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.748164653778076  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1649022102355957  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 6 input nodes size: 26380
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16405153274536133  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16405153274536133  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17663049697875977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17667436599731445  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16776323318481445  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 777, 2: 773, 3: 607, 4: 503, 5: 430, 6: 370, 25: 357, 7: 288, 8: 281, 9: 200, 10: 189, 11: 161, 12: 143, 13: 110, 15: 108, 14: 96, 16: 75, 17: 70, 18: 60, 20: 54, 19: 49, 22: 44, 21: 41, 23: 39, 24: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16903257369995117  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16903257369995117  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.504460334777832  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.505333423614502  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1700458526611328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 7 input nodes size: 34333
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1688232421875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1688232421875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1851944923400879  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18523836135864258  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17261552810668945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 742, 2: 676, 3: 586, 25: 517, 4: 502, 5: 403, 6: 331, 7: 286, 8: 258, 9: 221, 10: 210, 12: 155, 11: 145, 13: 121, 14: 116, 15: 113, 16: 79, 17: 76, 18: 59, 19: 53, 20: 49, 21: 44, 22: 42, 24: 38, 23: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17409086227416992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17409086227416992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8974013328552246  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8982744216918945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17529058456420898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 8 input nodes size: 39012
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17377567291259766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17377567291259766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19330692291259766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19335079193115234  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17693567276000977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 978, 2: 798, 3: 569, 25: 483, 4: 461, 5: 417, 6: 366, 7: 275, 8: 241, 9: 182, 10: 165, 11: 150, 12: 112, 13: 91, 15: 73, 14: 69, 16: 60, 17: 59, 19: 57, 18: 56, 20: 46, 21: 44, 22: 33, 24: 30, 23: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17854833602905273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17854833602905273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.869767189025879  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.870637893676758  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17994403839111328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 9 input nodes size: 54195
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17800045013427734  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17800045013427734  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2038426399230957  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20388412475585938  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1843090057373047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 972, 2: 827, 25: 742, 3: 589, 4: 407, 5: 347, 6: 256, 7: 197, 8: 176, 9: 156, 10: 124, 11: 117, 12: 87, 13: 71, 14: 68, 15: 49, 19: 48, 18: 47, 17: 45, 16: 44, 20: 42, 22: 34, 24: 25, 23: 24, 21: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18626117706298828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18626117706298828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.285151958465576  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.285974979400635  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18798065185546875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 10 input nodes size: 33628
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1853652000427246  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1853652000427246  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2014002799987793  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20144176483154297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17555809020996094  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1128, 2: 890, 3: 682, 4: 487, 5: 425, 6: 271, 25: 259, 7: 235, 8: 207, 9: 156, 10: 120, 12: 99, 11: 99, 13: 75, 14: 64, 16: 54, 15: 50, 17: 41, 18: 40, 21: 30, 19: 26, 20: 26, 23: 22, 22: 16, 24: 15})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1767120361328125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1767120361328125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.938035011291504  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.9388580322265625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1777057647705078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 11 input nodes size: 25755
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17637395858764648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17637395858764648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18865489959716797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18869781494140625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1726212501525879  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1138, 2: 966, 3: 747, 4: 552, 5: 486, 6: 311, 7: 259, 8: 214, 9: 186, 10: 143, 25: 138, 11: 100, 13: 90, 12: 67, 14: 66, 15: 56, 16: 47, 17: 37, 18: 35, 19: 27, 20: 22, 21: 20, 24: 13, 22: 11, 23: 10})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17357540130615234  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17357540130615234  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.626554489135742  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.627410888671875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17439842224121094  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 12 input nodes size: 60509
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17341232299804688  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17341232299804688  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20270919799804688  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20275068283081055  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19042682647705078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 939, 2: 828, 3: 590, 25: 538, 4: 444, 5: 378, 6: 297, 7: 235, 8: 199, 10: 150, 9: 146, 11: 128, 12: 93, 14: 69, 15: 65, 13: 64, 17: 60, 19: 54, 18: 46, 16: 45, 20: 43, 21: 36, 24: 25, 23: 24, 22: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19237995147705078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19237995147705078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.161210536956787  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.162033557891846  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19414424896240234  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 13 input nodes size: 61419
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19143199920654297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19143199920654297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.22072887420654297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.22077035903930664  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19143199920654297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1125, 1: 668, 2: 609, 3: 463, 4: 360, 5: 320, 6: 243, 7: 184, 8: 173, 9: 145, 10: 135, 11: 120, 12: 116, 13: 107, 15: 99, 14: 90, 16: 85, 18: 83, 17: 71, 21: 67, 19: 65, 20: 63, 22: 45, 24: 44, 23: 40})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19409656524658203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19409656524658203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.648214817047119  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.649037837982178  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19651508331298828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 14 input nodes size: 47596
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19287919998168945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19287919998168945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21631669998168945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21635818481445312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18701982498168945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1286, 1: 645, 2: 550, 3: 434, 4: 363, 5: 299, 6: 230, 7: 212, 9: 169, 8: 142, 10: 135, 12: 126, 11: 125, 13: 99, 16: 84, 15: 79, 17: 76, 18: 75, 14: 72, 21: 65, 19: 62, 20: 58, 24: 49, 23: 42, 22: 40})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18947744369506836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18947744369506836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.533536911010742  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.534359931945801  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19163274765014648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 15 input nodes size: 55346
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1885223388671875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1885223388671875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21491336822509766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21495723724365234  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19147825241088867  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1744, 1: 550, 2: 429, 3: 370, 4: 288, 5: 263, 6: 203, 9: 164, 7: 160, 12: 155, 8: 147, 10: 147, 13: 132, 11: 132, 14: 115, 16: 104, 15: 101, 18: 94, 19: 93, 20: 92, 21: 85, 17: 82, 23: 72, 24: 68, 22: 64})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19455194473266602  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19455194473266602  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.883328914642334  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.884202003479004  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19729137420654297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19729137420654297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16423702239990234  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05620267987251282 |0.003873661160469055 |0.11995607614517212 |0.00012950599193572998 |0.21085232496261597 |0.0051882266998291016 |
----------------------------------------------------------pseudo_mini_loss sum 3.6059398651123047
Total (block generation + training)time/epoch 51.01653483708699
Training time/epoch 6.43071722984314
Training time without block to device /epoch 6.368738651275635
Training time without total dataloading part /epoch 5.30019474029541
load block tensor time/epoch 0.8992428779602051
block to device time/epoch 0.06197857856750488
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  839260
Number of first layer input nodes during this epoch:  569991
Number of first layer output nodes during this epoch:  269269
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1481032371520996  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.662 seconds, peak memory: 31.298 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.298 GB
Metis partitioning: 5.697 seconds, peak memory: 31.309 GB
Split the graph: 3.904 seconds
Construct subgraphs: 0.098 seconds
REG metis partition end ----................................
REG construction  time spent:  25.969963550567627
pure dgl.metis_partition the time spent:  11.399001359939575
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.9436283111572266

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.3844716548919678

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1481032371520996  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

connection checking time:  2.4811007976531982
block generation total time  3.3280999660491943
average batch blocks generation time:  0.20800624787807465
block dataloader generation time/epoch 44.538116589188576
pseudo mini batch 0 input nodes size: 56987
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14421653747558594  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14421653747558594  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17139005661010742  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1714315414428711  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14499664306640625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1022, 1: 794, 2: 730, 3: 511, 4: 385, 5: 302, 6: 231, 7: 202, 9: 159, 8: 146, 10: 127, 11: 127, 12: 106, 14: 80, 15: 78, 13: 78, 19: 64, 16: 62, 18: 60, 17: 53, 20: 50, 22: 41, 21: 39, 24: 38, 23: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14728832244873047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14728832244873047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.970968723297119  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.971792221069336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18047475814819336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 1 input nodes size: 47167
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17743825912475586  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17743825912475586  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20087575912475586  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20091724395751953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17370223999023438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1005, 2: 807, 3: 600, 25: 447, 4: 432, 5: 385, 6: 325, 7: 229, 8: 218, 9: 164, 10: 148, 11: 122, 12: 106, 13: 74, 14: 63, 16: 53, 15: 48, 17: 47, 18: 44, 19: 44, 21: 41, 20: 37, 24: 28, 22: 27, 23: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17536449432373047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17536449432373047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7694578170776367  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7702808380126953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17685890197753906  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 2 input nodes size: 24283
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17467784881591797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17467784881591797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18639659881591797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18643999099731445  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16296100616455078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1118, 2: 966, 3: 747, 4: 583, 5: 456, 6: 351, 7: 260, 8: 228, 9: 177, 10: 158, 25: 131, 11: 110, 13: 88, 12: 87, 15: 63, 14: 58, 17: 51, 16: 40, 18: 39, 20: 22, 19: 22, 21: 21, 22: 13, 23: 12, 24: 10})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16392135620117188  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16392135620117188  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.6397666931152344  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.6406331062316895  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16475534439086914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 3 input nodes size: 34788
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16377687454223633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16377687454223633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18036508560180664  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1804065704345703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16864442825317383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1108, 2: 822, 3: 667, 4: 502, 5: 433, 6: 321, 7: 274, 25: 234, 8: 199, 9: 159, 10: 134, 11: 105, 12: 100, 13: 87, 14: 63, 15: 61, 16: 53, 18: 40, 19: 37, 20: 33, 17: 32, 21: 24, 24: 20, 22: 18, 23: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16983747482299805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16983747482299805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.9732398986816406  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.9740662574768066  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17082834243774414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 4 input nodes size: 57705
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16942930221557617  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16942930221557617  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1969451904296875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19698667526245117  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1803569793701172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1469, 1: 640, 2: 520, 3: 405, 4: 295, 5: 294, 6: 219, 7: 170, 8: 156, 9: 143, 10: 138, 12: 119, 11: 119, 13: 99, 14: 92, 16: 78, 20: 77, 15: 74, 21: 72, 18: 71, 17: 55, 19: 55, 23: 54, 22: 52, 24: 51})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18319416046142578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18319416046142578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.123143196105957  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.123966217041016  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1857295036315918  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 5 input nodes size: 52524
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18196487426757812  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18196487426757812  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20735549926757812  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2073979377746582  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1798405647277832  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1400, 1: 615, 2: 470, 3: 395, 4: 312, 5: 274, 6: 225, 7: 198, 9: 174, 8: 154, 10: 152, 11: 142, 12: 131, 13: 119, 16: 107, 15: 98, 17: 97, 19: 95, 18: 93, 14: 88, 21: 78, 20: 74, 24: 55, 23: 54, 22: 48})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18254661560058594  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18254661560058594  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.06443977355957  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.065281867980957  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1849374771118164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 6 input nodes size: 64620
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18151044845581055  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18151044845581055  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21232366561889648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21236562728881836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18693256378173828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 938, 1: 765, 2: 655, 3: 513, 4: 372, 5: 360, 6: 252, 7: 219, 8: 183, 9: 156, 10: 140, 11: 130, 12: 117, 13: 97, 15: 96, 14: 84, 18: 79, 17: 73, 16: 71, 21: 63, 19: 59, 20: 52, 22: 41, 24: 39, 23: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1894521713256836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1894521713256836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.295619964599609  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.296452522277832  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19174766540527344  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 7 input nodes size: 65683
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1882624626159668  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1882624626159668  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21958255767822266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21962404251098633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18876886367797852  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 860, 2: 756, 25: 683, 3: 523, 4: 447, 5: 370, 6: 251, 8: 209, 7: 208, 9: 157, 10: 143, 11: 133, 12: 108, 13: 93, 14: 74, 15: 72, 17: 62, 19: 59, 16: 58, 18: 54, 20: 50, 21: 40, 24: 39, 23: 35, 22: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19101476669311523  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19101476669311523  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.6890692710876465  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.689892292022705  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19307947158813477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 8 input nodes size: 28735
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18992328643798828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18992328643798828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20362520217895508  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20366907119750977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17230749130249023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 731, 2: 726, 3: 611, 4: 494, 5: 456, 25: 425, 6: 355, 8: 289, 7: 285, 9: 213, 10: 182, 11: 161, 12: 122, 13: 116, 15: 106, 14: 103, 17: 72, 16: 71, 18: 64, 20: 55, 19: 53, 23: 44, 22: 44, 21: 41, 24: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17368268966674805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17368268966674805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.697248935699463  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.6981210708618164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17484569549560547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 9 input nodes size: 20206
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1734604835510254  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1734604835510254  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1833195686340332  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1833629608154297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1696171760559082  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 988, 2: 905, 3: 704, 4: 565, 5: 469, 6: 350, 7: 297, 8: 245, 9: 205, 10: 163, 25: 139, 12: 121, 11: 117, 13: 95, 14: 85, 15: 73, 16: 66, 17: 45, 19: 35, 18: 33, 21: 25, 20: 24, 24: 22, 22: 20, 23: 18})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17058610916137695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17058610916137695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.775721549987793  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.776587963104248  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17135286331176758  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 10 input nodes size: 27045
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17044401168823242  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17044401168823242  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18334007263183594  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18338394165039062  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17348146438598633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 911, 2: 818, 3: 634, 4: 511, 5: 429, 25: 338, 6: 318, 7: 295, 8: 228, 9: 214, 10: 179, 11: 135, 12: 134, 13: 122, 14: 104, 15: 75, 16: 75, 18: 58, 17: 58, 19: 55, 20: 51, 22: 32, 23: 28, 21: 27, 24: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17472028732299805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17472028732299805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.3671107292175293  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.367983818054199  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17573213577270508  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 11 input nodes size: 32947
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17449235916137695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17449235916137695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1902027130126953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1902461051940918  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1773061752319336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 789, 2: 692, 3: 583, 25: 516, 4: 498, 5: 389, 6: 321, 7: 303, 8: 244, 9: 219, 10: 195, 12: 147, 11: 140, 13: 119, 14: 115, 15: 105, 16: 73, 17: 69, 18: 53, 19: 51, 22: 47, 20: 46, 21: 41, 24: 36, 23: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17874813079833984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17874813079833984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.829232692718506  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8301005363464355  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1799168586730957  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 12 input nodes size: 21721
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1784348487854004  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1784348487854004  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18879222869873047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18883562088012695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1730818748474121  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 697, 1: 634, 3: 582, 4: 495, 25: 430, 5: 392, 6: 342, 7: 289, 8: 262, 9: 235, 11: 193, 10: 189, 12: 170, 13: 132, 14: 117, 16: 94, 15: 91, 18: 77, 17: 74, 19: 56, 20: 56, 21: 55, 22: 48, 23: 45, 24: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1743636131286621  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1743636131286621  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.6583166122436523  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.659180164337158  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17534542083740234  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 13 input nodes size: 21245
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17421436309814453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17421436309814453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18434476852416992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1843881607055664  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17398738861083984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 676, 2: 586, 3: 570, 25: 465, 4: 462, 5: 430, 6: 384, 7: 302, 8: 264, 10: 226, 9: 211, 11: 191, 13: 132, 12: 132, 14: 120, 15: 98, 17: 97, 16: 83, 18: 73, 20: 71, 19: 61, 21: 58, 22: 41, 24: 39, 23: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17531394958496094  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17531394958496094  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7565646171569824  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.757429599761963  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17633962631225586  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 14 input nodes size: 25625
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17514896392822266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17514896392822266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18736791610717773  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18741130828857422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17723751068115234  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 727, 2: 699, 3: 574, 25: 482, 4: 470, 5: 411, 6: 336, 7: 292, 8: 252, 9: 227, 10: 186, 11: 173, 12: 137, 14: 119, 13: 118, 15: 102, 17: 90, 16: 82, 18: 63, 20: 63, 21: 52, 19: 49, 24: 42, 23: 35, 22: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1786670684814453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1786670684814453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.826058864593506  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.826925277709961  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17982244491577148  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 15 input nodes size: 24920
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17838239669799805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17838239669799805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19026517868041992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1903066635131836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17804431915283203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1067, 2: 857, 3: 658, 4: 497, 5: 372, 25: 341, 6: 287, 7: 222, 8: 195, 9: 163, 10: 139, 11: 105, 12: 100, 13: 87, 14: 69, 17: 55, 15: 49, 18: 47, 20: 46, 16: 45, 19: 41, 21: 40, 23: 35, 22: 22, 24: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1791553497314453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1791553497314453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.0235023498535156  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.0243306159973145  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18002605438232422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18002605438232422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1469717025756836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05948011577129364 |0.0028375089168548584 |0.12174178659915924 |0.0001401752233505249 |0.21128568053245544 |0.005686521530151367 |
----------------------------------------------------------pseudo_mini_loss sum 3.404693126678467
Total (block generation + training)time/epoch 50.97964860498905
Training time/epoch 6.498107433319092
Training time without block to device /epoch 6.452707290649414
Training time without total dataloading part /epoch 5.336368799209595
load block tensor time/epoch 0.9516818523406982
block to device time/epoch 0.045400142669677734
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  888133
Number of first layer input nodes during this epoch:  606201
Number of first layer output nodes during this epoch:  281932
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1298046112060547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.532 seconds, peak memory: 31.309 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.309 GB
Metis partitioning: 5.676 seconds, peak memory: 31.369 GB
Split the graph: 4.116 seconds
Construct subgraphs: 0.110 seconds
REG metis partition end ----................................
REG construction  time spent:  25.55100107192993
pure dgl.metis_partition the time spent:  11.464701414108276
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.9193003177642822

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.4903130531311035

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1298046112060547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

connection checking time:  1.9341273307800293
block generation total time  3.4096133708953857
average batch blocks generation time:  0.2131008356809616
block dataloader generation time/epoch 44.453483413247504
pseudo mini batch 0 input nodes size: 19283
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12867259979248047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12867259979248047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13853168487548828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13857507705688477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12665081024169922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 918, 2: 798, 3: 631, 4: 537, 5: 444, 6: 334, 7: 324, 8: 252, 25: 249, 9: 211, 10: 178, 11: 161, 12: 127, 13: 116, 14: 92, 15: 87, 16: 65, 19: 54, 17: 47, 18: 44, 20: 42, 22: 32, 21: 29, 23: 24, 24: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12772655487060547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12772655487060547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.0431103706359863  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.043978691101074  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16077613830566406  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 1 input nodes size: 26291
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.15979862213134766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.15979862213134766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17233514785766602  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1723785400390625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1624760627746582  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 817, 2: 782, 3: 602, 4: 522, 5: 438, 25: 345, 6: 318, 7: 276, 8: 259, 9: 226, 10: 185, 12: 128, 11: 125, 13: 109, 14: 109, 15: 89, 16: 82, 17: 65, 18: 65, 19: 63, 20: 44, 23: 41, 22: 35, 21: 35, 24: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1637110710144043  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1637110710144043  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.4050445556640625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.405907154083252  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16469287872314453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 2 input nodes size: 33349
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1634979248046875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1634979248046875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17939996719360352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.179443359375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16686344146728516  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 753, 2: 667, 3: 583, 25: 571, 4: 481, 5: 407, 6: 296, 7: 272, 8: 247, 9: 207, 10: 203, 12: 153, 11: 146, 13: 122, 14: 105, 15: 102, 16: 78, 17: 78, 18: 61, 19: 55, 20: 55, 22: 53, 21: 45, 24: 35, 23: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1683483123779297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1683483123779297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.9429445266723633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.9438095092773438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1695551872253418  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 3 input nodes size: 23713
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16803693771362305  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16803693771362305  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17975568771362305  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17979907989501953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16385364532470703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 990, 2: 880, 3: 711, 4: 487, 5: 469, 6: 378, 7: 281, 8: 248, 25: 227, 9: 174, 10: 172, 11: 127, 12: 114, 13: 81, 14: 70, 15: 64, 17: 51, 16: 49, 18: 38, 24: 28, 21: 27, 23: 27, 19: 25, 20: 25, 22: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16490936279296875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16490936279296875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.9131131172180176  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.913973331451416  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16576004028320312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 4 input nodes size: 22511
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16471624374389648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16471624374389648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17545032501220703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1754918098449707  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16372966766357422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 925, 2: 723, 3: 572, 25: 497, 4: 459, 5: 365, 6: 277, 7: 238, 8: 202, 9: 167, 10: 160, 11: 127, 12: 110, 13: 97, 14: 83, 15: 80, 17: 72, 18: 57, 19: 55, 20: 53, 21: 51, 16: 50, 23: 36, 22: 34, 24: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16495609283447266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16495609283447266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.3925557136535645  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.393378734588623  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1658916473388672  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 5 input nodes size: 25322
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16472196578979492  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16472196578979492  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17679643630981445  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17683887481689453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1660633087158203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 812, 2: 717, 3: 599, 4: 464, 25: 433, 5: 396, 6: 305, 7: 270, 8: 231, 9: 208, 10: 176, 11: 162, 12: 119, 14: 106, 13: 103, 15: 93, 16: 83, 17: 78, 20: 60, 18: 55, 19: 44, 21: 42, 24: 36, 23: 34, 22: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16740083694458008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16740083694458008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.567403793334961  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.568246364593506  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16850852966308594  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 6 input nodes size: 20225
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16714191436767578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16714191436767578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1770009994506836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17704439163208008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16492748260498047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 795, 2: 790, 3: 615, 4: 531, 25: 395, 5: 384, 6: 324, 7: 279, 8: 240, 9: 220, 12: 159, 10: 155, 11: 150, 13: 121, 14: 90, 15: 83, 18: 70, 17: 68, 16: 58, 19: 55, 21: 49, 20: 44, 23: 36, 22: 35, 24: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16608142852783203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16608142852783203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.3315610885620117  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.3324222564697266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16698503494262695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 7 input nodes size: 20819
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1659860610961914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1659860610961914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17591333389282227  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17595672607421875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16605424880981445  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 635, 2: 631, 3: 617, 4: 477, 5: 426, 6: 400, 25: 362, 7: 320, 8: 265, 9: 206, 10: 205, 11: 203, 13: 132, 14: 128, 12: 121, 16: 101, 17: 91, 20: 80, 15: 76, 18: 72, 21: 62, 19: 52, 22: 43, 24: 39, 23: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1672959327697754  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1672959327697754  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.5645108222961426  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.5653719902038574  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16824674606323242  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 8 input nodes size: 28339
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16716337203979492  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16716337203979492  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18067646026611328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18071937561035156  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17074871063232422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1078, 2: 946, 3: 692, 4: 567, 5: 414, 6: 325, 7: 245, 8: 240, 9: 193, 10: 166, 25: 142, 11: 131, 12: 101, 13: 82, 15: 64, 14: 63, 16: 62, 17: 47, 18: 38, 19: 30, 21: 27, 20: 20, 22: 12, 24: 11, 23: 10})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1717686653137207  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1717686653137207  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.7438011169433594  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.744652271270752  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1726083755493164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 9 input nodes size: 32516
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17152690887451172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17152690887451172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18703174591064453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1870746612548828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17351865768432617  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1037, 2: 843, 3: 699, 4: 511, 5: 472, 6: 350, 7: 265, 25: 248, 8: 235, 9: 182, 10: 149, 12: 114, 11: 109, 13: 97, 14: 80, 15: 64, 16: 56, 17: 44, 18: 35, 20: 34, 19: 32, 21: 23, 24: 23, 23: 20, 22: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17472076416015625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17472076416015625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.0980024337768555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.09885835647583  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17574691772460938  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 10 input nodes size: 38355
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17439985275268555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17439985275268555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1926889419555664  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1927318572998047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1771841049194336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1000, 2: 817, 3: 602, 4: 471, 5: 419, 25: 409, 6: 319, 7: 272, 8: 232, 9: 174, 10: 154, 11: 146, 12: 97, 13: 88, 14: 70, 15: 65, 17: 59, 16: 53, 19: 50, 18: 47, 20: 41, 21: 37, 22: 35, 24: 34, 23: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1786961555480957  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1786961555480957  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.6567234992980957  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.6575746536254883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1800084114074707  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 11 input nodes size: 54689
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17817211151123047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17817211151123047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20424985885620117  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20429134368896484  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1859593391418457  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 942, 1: 835, 2: 767, 3: 517, 4: 372, 5: 344, 6: 252, 7: 193, 8: 169, 9: 167, 10: 124, 11: 110, 12: 107, 14: 82, 13: 77, 15: 72, 16: 59, 19: 58, 18: 55, 17: 46, 20: 45, 21: 34, 22: 32, 23: 31, 24: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18812894821166992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18812894821166992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.774791717529297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.7756147384643555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1900472640991211  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 12 input nodes size: 55406
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1871795654296875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1871795654296875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21359920501708984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21364259719848633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18752336502075195  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1746, 1: 524, 2: 430, 3: 341, 4: 282, 5: 248, 6: 205, 7: 168, 9: 156, 10: 147, 8: 146, 12: 139, 11: 138, 13: 126, 18: 112, 14: 103, 15: 102, 16: 99, 20: 94, 21: 92, 19: 91, 17: 90, 22: 70, 24: 69, 23: 62})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19065141677856445  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19065141677856445  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.940732002258301  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.941594123840332  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19343900680541992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 13 input nodes size: 56533
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18944168090820312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18944168090820312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2163987159729004  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21644020080566406  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18997716903686523  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1191, 1: 687, 2: 559, 3: 436, 4: 360, 5: 315, 6: 241, 7: 220, 9: 158, 8: 152, 10: 146, 11: 135, 12: 121, 13: 101, 14: 83, 16: 82, 15: 82, 17: 75, 21: 64, 20: 64, 18: 61, 19: 60, 23: 47, 24: 39, 22: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19255304336547852  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19255304336547852  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.589116096496582  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.589939117431641  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1948227882385254  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 14 input nodes size: 64474
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19140148162841797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19140148162841797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.22214508056640625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.22218656539916992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19518804550170898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 917, 2: 732, 25: 654, 3: 579, 4: 418, 5: 345, 6: 283, 7: 225, 8: 184, 9: 155, 10: 136, 12: 118, 11: 105, 13: 96, 15: 83, 14: 82, 16: 61, 18: 59, 19: 58, 17: 55, 20: 52, 24: 43, 21: 43, 23: 42, 22: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19737863540649414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19737863540649414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.621315002441406  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.622143268585205  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1993999481201172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 15 input nodes size: 65369
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19634580612182617  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19634580612182617  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.22751617431640625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.22755765914916992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19677257537841797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1049, 1: 705, 2: 624, 3: 481, 4: 381, 5: 336, 6: 261, 7: 197, 9: 172, 8: 170, 10: 143, 11: 128, 12: 109, 13: 108, 14: 88, 15: 83, 18: 79, 16: 73, 17: 64, 21: 57, 20: 54, 19: 54, 22: 43, 24: 39, 23: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19942474365234375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19942474365234375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.540990352630615  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.541815757751465  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20185184478759766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20185184478759766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16879749298095703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05686570703983307 |0.0026211440563201904 |0.11380161345005035 |0.00011394917964935303 |0.21156129240989685 |0.005060911178588867 |
----------------------------------------------------------pseudo_mini_loss sum 3.299633264541626
Total (block generation + training)time/epoch 50.88814492786632
Training time/epoch 6.324545383453369
Training time without block to device /epoch 6.282607078552246
Training time without total dataloading part /epoch 5.212690591812134
load block tensor time/epoch 0.9098513126373291
block to device time/epoch 0.04193830490112305
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  863166
Number of first layer input nodes during this epoch:  587194
Number of first layer output nodes during this epoch:  275972
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.15215158462524414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.450 seconds, peak memory: 31.369 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.369 GB
Metis partitioning: 5.406 seconds, peak memory: 31.369 GB
Split the graph: 3.901 seconds
Construct subgraphs: 0.099 seconds
REG metis partition end ----................................
REG construction  time spent:  23.603455543518066
pure dgl.metis_partition the time spent:  10.884466409683228
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.7683792114257812

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.2612578868865967

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.15215158462524414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

connection checking time:  2.049894094467163
block generation total time  4.029637098312378
average batch blocks generation time:  0.2518523186445236
block dataloader generation time/epoch 44.2772685819202
pseudo mini batch 0 input nodes size: 26049
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14846134185791016  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14846134185791016  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16088247299194336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16092395782470703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.12971210479736328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 883, 2: 723, 3: 638, 4: 461, 25: 450, 5: 370, 6: 309, 7: 235, 8: 198, 9: 176, 10: 164, 11: 122, 12: 105, 13: 100, 14: 81, 15: 80, 17: 76, 16: 68, 18: 51, 19: 51, 20: 46, 21: 45, 23: 31, 24: 28, 22: 26})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1309795379638672  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1309795379638672  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.361659526824951  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.362483024597168  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16367387771606445  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 1 input nodes size: 21450
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16237878799438477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16237878799438477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1726069450378418  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17265081405639648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1601881980895996  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 720, 2: 661, 3: 574, 25: 555, 4: 459, 5: 397, 6: 320, 7: 302, 8: 249, 9: 227, 10: 192, 11: 168, 12: 145, 14: 132, 13: 122, 15: 104, 17: 85, 16: 81, 20: 72, 18: 65, 21: 60, 19: 49, 23: 42, 24: 39, 22: 34})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16157293319702148  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16157293319702148  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8764467239379883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.877319812774658  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1627044677734375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 2 input nodes size: 19855
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16143131256103516  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16143131256103516  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17129039764404297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17133378982543945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16106176376342773  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 593, 1: 574, 3: 516, 25: 488, 4: 465, 5: 419, 6: 372, 7: 329, 8: 260, 9: 229, 10: 216, 11: 200, 12: 154, 13: 143, 14: 128, 16: 97, 17: 97, 18: 87, 15: 86, 20: 70, 21: 64, 19: 62, 23: 48, 22: 47, 24: 44})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1623845100402832  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1623845100402832  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.852649211883545  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8535122871398926  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1633739471435547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 3 input nodes size: 21780
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16225814819335938  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16225814819335938  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17264366149902344  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17268610000610352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16278362274169922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 919, 2: 801, 3: 658, 4: 511, 5: 422, 6: 326, 7: 250, 25: 244, 8: 241, 9: 189, 11: 170, 10: 166, 12: 135, 13: 109, 14: 85, 15: 74, 16: 59, 17: 52, 19: 44, 18: 41, 20: 35, 21: 32, 22: 32, 23: 24, 24: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16382265090942383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16382265090942383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.9710559844970703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.9718971252441406  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16461706161499023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 4 input nodes size: 27812
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1636638641357422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1636638641357422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1769256591796875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17696857452392578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16654062271118164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 820, 2: 712, 3: 574, 25: 465, 4: 459, 5: 405, 6: 304, 7: 269, 8: 244, 9: 205, 10: 186, 11: 170, 12: 120, 13: 112, 14: 105, 15: 103, 16: 89, 17: 72, 18: 71, 19: 66, 20: 59, 22: 39, 21: 36, 23: 34, 24: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16788768768310547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16788768768310547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.6751580238342285  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.6760153770446777  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16898345947265625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 5 input nodes size: 32066
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16766023635864258  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16766023635864258  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18295049667358398  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18299436569213867  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16968965530395508  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 769, 2: 686, 3: 577, 25: 546, 4: 493, 5: 397, 6: 332, 7: 283, 8: 245, 10: 206, 9: 205, 12: 153, 11: 141, 13: 124, 14: 122, 15: 103, 16: 71, 17: 69, 18: 58, 22: 54, 19: 51, 20: 51, 21: 46, 24: 37, 23: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17111921310424805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17111921310424805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8785033226013184  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.879375457763672  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17228031158447266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 6 input nodes size: 15832
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17086410522460938  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17086410522460938  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17841339111328125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17845726013183594  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16312313079833984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1031, 2: 960, 3: 763, 4: 566, 5: 513, 6: 365, 7: 298, 8: 239, 9: 179, 10: 143, 11: 118, 12: 110, 25: 104, 15: 81, 13: 78, 14: 73, 17: 44, 16: 44, 18: 41, 21: 21, 19: 20, 20: 19, 24: 17, 22: 14, 23: 13})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1639881134033203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1639881134033203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.5476536750793457  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.5485267639160156  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16466522216796875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 7 input nodes size: 20431
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16390371322631836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16390371322631836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1736459732055664  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1736898422241211  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16609668731689453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 798, 2: 735, 3: 618, 4: 539, 5: 433, 6: 355, 7: 311, 8: 292, 25: 268, 9: 237, 10: 195, 12: 151, 11: 151, 13: 128, 14: 101, 15: 89, 16: 72, 17: 64, 18: 61, 19: 59, 20: 51, 21: 45, 22: 38, 23: 34, 24: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1672534942626953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1672534942626953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.299769878387451  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.300642967224121  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16815662384033203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 8 input nodes size: 49589
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16711091995239258  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16711091995239258  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19075679779052734  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19080066680908203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1810145378112793  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1636, 1: 543, 2: 465, 3: 366, 4: 296, 5: 271, 6: 221, 7: 189, 9: 166, 10: 165, 8: 146, 11: 144, 12: 139, 13: 120, 16: 111, 14: 104, 17: 103, 18: 101, 15: 98, 21: 95, 19: 87, 20: 83, 24: 72, 23: 67, 22: 66})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1838536262512207  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1838536262512207  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.549479961395264  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.550353050231934  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18630075454711914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 9 input nodes size: 58850
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18283748626708984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18283748626708984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21089935302734375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21094083786010742  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18725109100341797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1294, 1: 736, 2: 591, 3: 429, 4: 358, 5: 262, 6: 224, 7: 186, 9: 155, 8: 147, 10: 129, 12: 120, 11: 118, 13: 90, 15: 84, 14: 82, 20: 77, 16: 71, 19: 66, 21: 62, 17: 57, 18: 56, 24: 45, 23: 44, 22: 34})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19000720977783203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19000720977783203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.842334270477295  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.8431572914123535  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19245576858520508  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 10 input nodes size: 63034
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18869924545288086  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18869924545288086  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21875619888305664  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2187976837158203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19069433212280273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 870, 2: 760, 25: 756, 3: 534, 4: 436, 5: 347, 6: 260, 7: 224, 8: 197, 9: 155, 10: 144, 11: 110, 12: 95, 13: 79, 14: 77, 15: 72, 19: 66, 18: 58, 16: 55, 17: 54, 21: 41, 20: 41, 23: 32, 22: 27, 24: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19295263290405273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19295263290405273  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.724923133850098  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.725746154785156  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19503259658813477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 11 input nodes size: 58460
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19186830520629883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19186830520629883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21974420547485352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2197856903076172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18968725204467773  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1419, 1: 553, 2: 525, 3: 407, 5: 316, 4: 300, 6: 226, 7: 185, 8: 170, 9: 163, 10: 149, 11: 136, 12: 116, 13: 109, 14: 97, 15: 92, 16: 88, 18: 88, 17: 76, 20: 69, 19: 66, 21: 66, 22: 55, 24: 54, 23: 39})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1924891471862793  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1924891471862793  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.12215518951416  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.122984886169434  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1949915885925293  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 12 input nodes size: 49019
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.191314697265625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.191314697265625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.214752197265625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21479368209838867  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1868762969970703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1118, 2: 901, 3: 654, 4: 505, 5: 420, 25: 280, 6: 278, 7: 235, 8: 209, 9: 166, 10: 127, 11: 95, 12: 92, 13: 86, 15: 51, 16: 48, 14: 44, 17: 44, 18: 37, 20: 36, 19: 32, 22: 25, 21: 22, 24: 19, 23: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1883087158203125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1883087158203125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.2771453857421875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.2779722213745117  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18959999084472656  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 13 input nodes size: 46381
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18772029876708984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18772029876708984  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20983648300170898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20987796783447266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18639898300170898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 970, 2: 831, 3: 572, 25: 514, 4: 403, 5: 358, 6: 307, 7: 233, 8: 209, 9: 150, 10: 146, 11: 138, 12: 114, 13: 69, 14: 62, 16: 60, 15: 58, 18: 56, 17: 53, 19: 49, 20: 42, 21: 34, 22: 32, 24: 32, 23: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1881394386291504  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1881394386291504  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.9239463806152344  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.924769401550293  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1896958351135254  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 14 input nodes size: 33595
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18742132186889648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18742132186889648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20344066619873047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20348405838012695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18132638931274414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 995, 2: 864, 3: 683, 4: 550, 5: 445, 6: 334, 7: 267, 25: 250, 8: 224, 9: 213, 10: 156, 11: 127, 13: 106, 12: 103, 14: 75, 15: 65, 16: 58, 17: 55, 18: 50, 19: 38, 21: 36, 20: 32, 22: 21, 23: 18, 24: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18254613876342773  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18254613876342773  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.174551010131836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.175413131713867  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18361520767211914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 15 input nodes size: 29082
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1822648048400879  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1822648048400879  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19613218307495117  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19617366790771484  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18011093139648438  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1129, 2: 898, 3: 714, 4: 519, 5: 447, 6: 335, 7: 249, 8: 202, 25: 191, 9: 161, 10: 115, 11: 95, 12: 85, 13: 81, 14: 66, 15: 49, 16: 39, 19: 30, 17: 29, 18: 27, 20: 24, 23: 21, 24: 12, 21: 12, 22: 12})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18113136291503906  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18113136291503906  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.6996893882751465  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.7005157470703125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18196344375610352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18196344375610352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1489090919494629  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05843992531299591 |0.002733469009399414 |0.11322805285453796 |0.00011172890663146973 |0.21183042228221893 |0.0024995803833007812 |
----------------------------------------------------------pseudo_mini_loss sum 3.2704074382781982
Total (block generation + training)time/epoch 50.70600247383118
Training time/epoch 6.327653646469116
Training time without block to device /epoch 6.283918142318726
Training time without total dataloading part /epoch 5.205222845077515
load block tensor time/epoch 0.9350388050079346
block to device time/epoch 0.043735504150390625
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  844023
Number of first layer input nodes during this epoch:  573285
Number of first layer output nodes during this epoch:  270738
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13165569305419922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.511 seconds, peak memory: 31.369 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.369 GB
Metis partitioning: 5.815 seconds, peak memory: 31.451 GB
Split the graph: 5.448 seconds
Construct subgraphs: 0.106 seconds
REG metis partition end ----................................
REG construction  time spent:  26.484111785888672
pure dgl.metis_partition the time spent:  12.911497354507446
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8514080047607422

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.167041301727295

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13165569305419922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

connection checking time:  1.8048095703125
block generation total time  3.018449306488037
average batch blocks generation time:  0.18865308165550232
block dataloader generation time/epoch 44.3108409454948
pseudo mini batch 0 input nodes size: 31596
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13052654266357422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13052654266357422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14559268951416016  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14563465118408203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13172578811645508  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1017, 2: 941, 3: 688, 4: 538, 5: 428, 6: 315, 7: 256, 8: 212, 9: 179, 25: 172, 10: 147, 11: 123, 12: 87, 13: 83, 14: 68, 15: 56, 16: 55, 17: 48, 18: 35, 20: 34, 19: 30, 21: 29, 24: 16, 22: 12, 23: 11})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13279199600219727  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13279199600219727  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.7533583641052246  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.7541909217834473  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16599464416503906  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 1 input nodes size: 31424
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16482067108154297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16482067108154297  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17980480194091797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17984628677368164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16473817825317383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1075, 2: 838, 3: 678, 4: 498, 5: 458, 6: 326, 7: 250, 8: 216, 25: 196, 9: 185, 10: 139, 11: 107, 12: 99, 13: 83, 14: 72, 15: 51, 17: 47, 16: 46, 20: 32, 19: 32, 18: 28, 23: 18, 24: 17, 22: 15, 21: 11})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16583681106567383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16583681106567383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.83538818359375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.8362112045288086  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16676616668701172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 2 input nodes size: 44102
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16552495956420898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16552495956420898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1865544319152832  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18659591674804688  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1715703010559082  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 994, 2: 789, 3: 561, 25: 477, 4: 433, 5: 376, 6: 319, 7: 243, 8: 220, 9: 169, 10: 145, 11: 137, 12: 99, 13: 76, 14: 60, 15: 58, 16: 57, 18: 52, 17: 49, 20: 45, 19: 43, 21: 36, 24: 32, 22: 31, 23: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17322874069213867  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17322874069213867  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.77816104888916  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7789840698242188  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17470884323120117  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 3 input nodes size: 44802
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17257070541381836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17257070541381836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19393396377563477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19397544860839844  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17290449142456055  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1137, 2: 887, 3: 680, 4: 528, 5: 406, 6: 302, 25: 233, 7: 219, 8: 198, 9: 154, 10: 138, 11: 99, 12: 93, 13: 75, 15: 52, 16: 50, 14: 49, 18: 43, 19: 35, 17: 26, 20: 26, 21: 26, 24: 23, 23: 22, 22: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17420721054077148  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17420721054077148  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.073049545288086  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.0738725662231445  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1753706932067871  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 4 input nodes size: 61414
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17371416091918945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17371416091918945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20301103591918945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20305252075195312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18164777755737305  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1062, 1: 727, 2: 620, 3: 490, 4: 347, 5: 326, 6: 257, 7: 214, 8: 167, 9: 143, 10: 140, 11: 129, 12: 122, 13: 101, 15: 100, 14: 91, 18: 88, 16: 76, 17: 69, 19: 63, 21: 58, 20: 51, 22: 42, 24: 40, 23: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18422365188598633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18422365188598633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.475519180297852  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.476347923278809  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1865677833557129  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 5 input nodes size: 60115
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1830582618713379  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1830582618713379  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2123551368713379  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21239662170410156  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1830582618713379  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1017, 1: 760, 2: 718, 3: 492, 4: 381, 5: 324, 6: 229, 7: 222, 8: 175, 9: 159, 10: 140, 11: 124, 12: 100, 13: 86, 14: 79, 15: 70, 16: 63, 19: 62, 17: 59, 18: 56, 20: 52, 21: 42, 22: 38, 24: 36, 23: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18545103073120117  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18545103073120117  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.13300895690918  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.133831977844238  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18761110305786133  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 6 input nodes size: 49060
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18437576293945312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18437576293945312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20781326293945312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2078557014465332  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17851734161376953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1308, 1: 648, 2: 548, 3: 456, 4: 386, 5: 326, 6: 239, 7: 193, 9: 178, 8: 153, 10: 139, 11: 136, 12: 126, 13: 108, 15: 88, 14: 84, 16: 80, 17: 78, 19: 73, 18: 70, 21: 65, 20: 62, 24: 51, 22: 47, 23: 46})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18105268478393555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18105268478393555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.703609943389893  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.704458236694336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1833019256591797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 7 input nodes size: 56673
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18009138107299805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18009138107299805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20711517333984375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20715904235839844  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18367910385131836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1800, 1: 445, 2: 425, 3: 331, 5: 260, 4: 257, 6: 204, 8: 174, 9: 171, 10: 170, 7: 170, 12: 154, 11: 142, 13: 126, 14: 114, 20: 105, 15: 105, 18: 104, 16: 101, 21: 97, 17: 96, 19: 95, 23: 79, 24: 65, 22: 64})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18762683868408203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18762683868408203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 7.117718696594238  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 7.118591785430908  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19075345993041992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 8 input nodes size: 22382
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18564462661743164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18564462661743164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19631719589233398  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19635868072509766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16929101943969727  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 942, 2: 779, 3: 598, 4: 447, 25: 384, 5: 360, 6: 288, 7: 261, 8: 222, 9: 185, 10: 153, 11: 142, 12: 113, 14: 96, 13: 91, 15: 82, 16: 74, 17: 73, 20: 49, 18: 44, 21: 37, 19: 35, 23: 32, 24: 31, 22: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17048883438110352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17048883438110352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.270834445953369  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.2716612815856934  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17140960693359375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 9 input nodes size: 24617
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17021560668945312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17021560668945312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18195390701293945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18199682235717773  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17128276824951172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 837, 2: 685, 3: 592, 25: 580, 4: 436, 5: 402, 6: 304, 7: 231, 8: 215, 9: 190, 10: 171, 11: 141, 12: 123, 13: 113, 15: 95, 14: 95, 17: 85, 18: 65, 19: 63, 16: 61, 20: 60, 21: 52, 23: 40, 22: 33, 24: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1726546287536621  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1726546287536621  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7508320808410645  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7516822814941406  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17377376556396484  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 10 input nodes size: 23436
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17244195938110352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17244195938110352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18416070938110352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1842045783996582  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1724233627319336  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 750, 2: 714, 3: 658, 4: 524, 5: 428, 6: 359, 25: 334, 7: 274, 8: 260, 9: 222, 11: 184, 10: 183, 12: 146, 13: 135, 14: 107, 16: 90, 15: 89, 18: 66, 20: 62, 17: 59, 21: 56, 19: 54, 22: 39, 24: 33, 23: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1736431121826172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1736431121826172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.4552345275878906  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.4561071395874023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17461824417114258  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 11 input nodes size: 18659
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17350339889526367  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17350339889526367  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18336248397827148  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18340539932250977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17164278030395508  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 643, 2: 635, 3: 545, 4: 480, 25: 433, 5: 404, 6: 375, 7: 307, 8: 251, 10: 220, 9: 214, 11: 177, 12: 149, 13: 127, 14: 120, 17: 91, 16: 81, 15: 80, 18: 74, 21: 60, 20: 56, 19: 55, 23: 44, 22: 41, 24: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17287254333496094  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17287254333496094  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.573699951171875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.574550151824951  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1737809181213379  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 12 input nodes size: 29908
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1727447509765625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1727447509765625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18770980834960938  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18775367736816406  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17785167694091797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 844, 2: 754, 3: 611, 4: 519, 5: 437, 25: 393, 6: 370, 7: 303, 8: 252, 9: 210, 10: 178, 11: 136, 12: 119, 14: 113, 13: 105, 15: 82, 18: 62, 17: 60, 16: 60, 19: 51, 23: 48, 22: 40, 21: 39, 20: 38, 24: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17916584014892578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17916584014892578  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.5428404808044434  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.5437135696411133  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18025779724121094  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 13 input nodes size: 16980
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1789264678955078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1789264678955078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18702316284179688  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18706703186035156  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17205810546875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1006, 2: 916, 3: 709, 4: 556, 5: 476, 6: 339, 7: 304, 8: 232, 9: 196, 25: 157, 10: 149, 11: 129, 12: 113, 13: 92, 14: 87, 15: 79, 16: 58, 17: 51, 18: 48, 20: 29, 19: 28, 21: 26, 22: 21, 24: 19, 23: 18})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17298030853271484  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17298030853271484  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.7317757606506348  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.7326464653015137  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17369318008422852  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 14 input nodes size: 21750
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17289304733276367  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17289304733276367  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18326425552368164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18330812454223633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17516756057739258  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 883, 2: 794, 3: 644, 4: 529, 5: 418, 6: 338, 25: 311, 7: 301, 8: 266, 9: 202, 10: 185, 11: 149, 12: 138, 13: 127, 15: 84, 14: 83, 16: 77, 19: 62, 17: 55, 18: 45, 20: 43, 21: 35, 22: 33, 23: 28, 24: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17632150650024414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17632150650024414  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.2654266357421875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.2662997245788574  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17723464965820312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 15 input nodes size: 32593
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1761627197265625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1761627197265625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19170427322387695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19174814224243164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18133306503295898  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 720, 2: 663, 25: 603, 3: 544, 4: 461, 5: 393, 6: 304, 7: 297, 8: 259, 9: 219, 10: 202, 12: 156, 11: 148, 13: 128, 15: 118, 14: 116, 17: 84, 16: 82, 18: 68, 20: 63, 22: 59, 19: 55, 21: 48, 24: 39, 23: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18283796310424805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18283796310424805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.057093143463135  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.057966232299805  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18404340744018555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18404340744018555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.15098905563354492  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05690343677997589 |0.002841964364051819 |0.11521555483341217 |0.00010985136032104492 |0.2116127610206604 |0.004873514175415039 |
----------------------------------------------------------pseudo_mini_loss sum 3.2536725997924805
Total (block generation + training)time/epoch 50.73614670100965
Training time/epoch 6.3632776737213135
Training time without block to device /epoch 6.317806243896484
Training time without total dataloading part /epoch 5.235884189605713
load block tensor time/epoch 0.9104549884796143
block to device time/epoch 0.0454714298248291
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  838198
Number of first layer input nodes during this epoch:  569511
Number of first layer output nodes during this epoch:  268687
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1342010498046875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.451 seconds, peak memory: 31.451 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 31.451 GB
Metis partitioning: 5.496 seconds, peak memory: 31.451 GB
Split the graph: 3.859 seconds
Construct subgraphs: 0.110 seconds
REG metis partition end ----................................
REG construction  time spent:  22.662989616394043
pure dgl.metis_partition the time spent:  10.945265293121338
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8460438251495361

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.0421550273895264

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1342010498046875  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

connection checking time:  1.919189691543579
block generation total time  2.8881988525390625
average batch blocks generation time:  0.1805124282836914
block dataloader generation time/epoch 44.051495826244356
pseudo mini batch 0 input nodes size: 27259
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13270854949951172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13270854949951172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1457066535949707  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1457505226135254  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.13016510009765625  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 874, 2: 789, 3: 599, 4: 496, 5: 430, 25: 378, 6: 349, 7: 270, 8: 261, 9: 206, 10: 183, 11: 151, 12: 116, 13: 115, 15: 94, 14: 90, 16: 68, 17: 65, 18: 57, 19: 54, 20: 52, 23: 42, 22: 41, 21: 40, 24: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1314258575439453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1314258575439453  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.4509057998657227  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.4517784118652344  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16427183151245117  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 1 input nodes size: 33864
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16304349899291992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16304349899291992  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17919111251831055  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17923498153686523  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16619300842285156  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 772, 2: 689, 25: 557, 3: 553, 4: 486, 5: 409, 7: 305, 6: 299, 8: 242, 9: 219, 10: 191, 12: 155, 11: 144, 13: 127, 14: 114, 15: 106, 17: 84, 16: 73, 18: 60, 19: 53, 20: 51, 22: 48, 21: 42, 24: 41, 23: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1676654815673828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1676654815673828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.940126419067383  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.9409995079040527  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16885662078857422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 2 input nodes size: 18496
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16736745834350586  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16736745834350586  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17618703842163086  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17623090744018555  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16003942489624023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 928, 2: 856, 3: 682, 4: 549, 5: 467, 6: 366, 7: 322, 8: 277, 9: 222, 10: 173, 25: 154, 11: 143, 12: 131, 13: 106, 15: 90, 14: 80, 16: 60, 17: 54, 18: 44, 19: 34, 20: 31, 22: 25, 21: 23, 24: 18, 23: 18})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16102838516235352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16102838516235352  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.861691474914551  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.8625645637512207  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1618037223815918  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 3 input nodes size: 22088
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16091346740722656  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16091346740722656  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1714458465576172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17148971557617188  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1626262664794922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 859, 2: 810, 3: 668, 4: 524, 5: 427, 6: 361, 25: 296, 7: 290, 8: 259, 9: 200, 10: 190, 11: 164, 12: 131, 13: 116, 14: 95, 15: 87, 16: 76, 19: 55, 18: 50, 17: 50, 20: 42, 21: 30, 22: 25, 23: 23, 24: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16376209259033203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16376209259033203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.209263801574707  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.2101364135742188  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1646590232849121  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 4 input nodes size: 20811
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16360092163085938  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16360092163085938  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1735243797302246  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1735682487487793  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16299200057983398  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 653, 2: 616, 25: 596, 3: 543, 4: 451, 5: 413, 6: 331, 7: 304, 8: 267, 9: 232, 10: 204, 11: 175, 12: 145, 14: 136, 13: 120, 15: 109, 17: 94, 16: 82, 20: 76, 18: 67, 21: 64, 19: 51, 23: 44, 24: 41, 22: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16441106796264648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16441106796264648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.9936017990112305  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.994474411010742  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1655106544494629  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 5 input nodes size: 26489
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16422700881958008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16422700881958008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17685794830322266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17689943313598633  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1669321060180664  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 937, 2: 752, 3: 653, 4: 472, 25: 417, 5: 368, 6: 302, 7: 213, 8: 186, 9: 170, 10: 154, 11: 124, 12: 108, 13: 100, 15: 84, 14: 69, 17: 68, 16: 65, 19: 54, 18: 52, 21: 46, 20: 44, 24: 29, 23: 25, 22: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1681680679321289  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1681680679321289  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.3177566528320312  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.31857967376709  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16913127899169922  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 6 input nodes size: 19772
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16785717010498047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16785717010498047  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17771625518798828  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17775964736938477  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16508722305297852  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 604, 2: 600, 3: 553, 4: 487, 25: 455, 5: 411, 6: 390, 7: 331, 8: 262, 9: 232, 10: 211, 11: 188, 12: 161, 13: 131, 14: 127, 17: 94, 16: 87, 15: 82, 18: 79, 20: 62, 19: 61, 21: 59, 23: 48, 22: 46, 24: 41})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16638708114624023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16638708114624023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7647933959960938  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7656588554382324  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1674175262451172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 7 input nodes size: 22591
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16630172729492188  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16630172729492188  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17802047729492188  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17806291580200195  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16816043853759766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1018, 2: 865, 3: 653, 4: 521, 5: 406, 6: 311, 8: 234, 7: 232, 25: 227, 9: 178, 11: 155, 10: 150, 12: 115, 13: 101, 14: 83, 15: 63, 16: 62, 17: 51, 18: 46, 20: 42, 19: 38, 21: 37, 22: 28, 23: 22, 24: 21})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16918420791625977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16918420791625977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.8889904022216797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.889834403991699  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16997814178466797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 8 input nodes size: 38671
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16901159286499023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16901159286499023  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18745136260986328  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18749284744262695  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17573165893554688  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1032, 2: 841, 3: 575, 4: 444, 25: 406, 5: 384, 6: 328, 7: 245, 8: 222, 9: 156, 10: 142, 11: 136, 12: 102, 15: 62, 14: 58, 13: 56, 16: 53, 17: 49, 18: 44, 19: 41, 20: 36, 21: 36, 24: 27, 22: 26, 23: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17722415924072266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17722415924072266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.521193027496338  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.5220165252685547  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17851972579956055  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 9 input nodes size: 27621
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1766524314880371  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1766524314880371  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18982315063476562  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1898670196533203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1713857650756836  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 998, 2: 828, 3: 656, 4: 529, 5: 482, 6: 331, 25: 300, 7: 285, 8: 221, 9: 197, 10: 165, 12: 117, 11: 110, 13: 110, 14: 95, 15: 62, 16: 61, 18: 56, 17: 54, 19: 47, 20: 41, 24: 28, 22: 27, 23: 25, 21: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1725625991821289  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1725625991821289  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1896562576293945  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.19052791595459  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17357206344604492  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 10 input nodes size: 54245
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1723771095275879  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1723771095275879  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1982431411743164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19828462600708008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18507003784179688  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 919, 2: 846, 25: 760, 3: 600, 4: 427, 5: 371, 6: 253, 7: 179, 8: 155, 9: 149, 10: 135, 12: 103, 11: 100, 13: 72, 14: 66, 18: 54, 15: 53, 19: 48, 16: 46, 20: 41, 17: 40, 22: 32, 21: 29, 24: 25, 23: 14})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18701648712158203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18701648712158203  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.295345783233643  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.296168804168701  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18872451782226562  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 11 input nodes size: 32557
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18613290786743164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18613290786743164  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20165729522705078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20169878005981445  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17579126358032227  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1007, 2: 897, 3: 691, 4: 494, 5: 427, 6: 283, 7: 262, 25: 223, 8: 215, 9: 196, 10: 151, 11: 110, 13: 89, 12: 88, 14: 65, 16: 55, 15: 54, 17: 48, 18: 45, 19: 37, 21: 28, 20: 25, 23: 17, 22: 16, 24: 12})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17692041397094727  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17692041397094727  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.9218459129333496  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.922671318054199  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17788028717041016  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 12 input nodes size: 63430
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17661714553833008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.17661714553833008  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2068629264831543  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20690441131591797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19133853912353516  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1288, 1: 627, 2: 550, 3: 399, 4: 318, 5: 279, 6: 231, 7: 194, 8: 169, 9: 150, 10: 137, 11: 122, 12: 118, 15: 107, 16: 103, 13: 103, 14: 100, 21: 87, 18: 87, 17: 74, 19: 70, 20: 68, 24: 50, 22: 48, 23: 47})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19423198699951172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19423198699951172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.121461391448975  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.12228536605835  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1968541145324707  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 13 input nodes size: 64793
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19290590286254883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19290590286254883  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2238016128540039  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.22384309768676758  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1935558319091797  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 920, 2: 731, 3: 602, 25: 593, 4: 467, 5: 386, 6: 271, 7: 255, 8: 202, 9: 156, 10: 131, 11: 120, 12: 98, 13: 86, 14: 76, 15: 67, 17: 52, 18: 50, 16: 46, 20: 44, 19: 42, 21: 34, 23: 31, 22: 29, 24: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1956653594970703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1956653594970703  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.401402473449707  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.402225494384766  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19762134552001953  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 14 input nodes size: 49612
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19463825225830078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19463825225830078  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21829509735107422  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2183380126953125  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18740081787109375  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1561, 1: 512, 2: 470, 3: 382, 4: 310, 5: 273, 6: 231, 7: 188, 9: 174, 8: 152, 12: 151, 10: 141, 11: 135, 13: 134, 16: 99, 17: 95, 14: 95, 15: 93, 20: 89, 21: 88, 18: 87, 19: 80, 24: 71, 23: 59, 22: 58})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19016504287719727  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19016504287719727  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.338730812072754  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 6.339584827423096  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19258785247802734  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

pseudo mini batch 15 input nodes size: 62089
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18918704986572266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18918704986572266  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21879339218139648  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.21883487701416016  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19513511657714844  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1249, 1: 768, 2: 566, 3: 468, 4: 345, 5: 289, 6: 231, 7: 170, 8: 148, 10: 141, 9: 139, 11: 126, 12: 98, 13: 90, 14: 85, 15: 76, 16: 75, 19: 71, 18: 70, 20: 63, 17: 58, 21: 54, 23: 51, 22: 44, 24: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19789409637451172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19789409637451172  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.833626747131348  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 5.834449768066406  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20037317276000977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20037317276000977  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.16731882095336914  GigaBytes
Max Memory Allocated: 7.722456932067871  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.059108540415763855 |0.0033825039863586426 |0.11370305716991425 |0.00011207163333892822 |0.21217000484466553 |0.0033655166625976562 |
----------------------------------------------------------pseudo_mini_loss sum 3.0971968173980713
Total (block generation + training)time/epoch 50.473547792434694
Training time/epoch 6.359957695007324
Training time without block to device /epoch 6.305837631225586
Training time without total dataloading part /epoch 5.219127655029297
load block tensor time/epoch 0.9457366466522217
block to device time/epoch 0.05412006378173828
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  858845
Number of first layer input nodes during this epoch:  584388
Number of first layer output nodes during this epoch:  274457
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=1024, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=1024, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(1024, 1024, batch_first=True)
      (fc_self): Linear(in_features=1024, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=1024, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  8872960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([1024, 128])
layers.0.fc_neigh.weight, torch.Size([1024, 128])
layers.1.lstm.weight_ih_l0, torch.Size([4096, 1024])
layers.1.lstm.weight_hh_l0, torch.Size([4096, 1024])
layers.1.lstm.bias_ih_l0, torch.Size([4096])
layers.1.lstm.bias_hh_l0, torch.Size([4096])
layers.1.fc_self.weight, torch.Size([40, 1024])
layers.1.fc_neigh.weight, torch.Size([40, 1024])
----------------------------------------
un-trainable parameters
