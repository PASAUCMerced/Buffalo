main start at this time 1733105359.2702696
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.55029296875 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.433 seconds, peak memory: 17.053 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 17.053 GB
Metis partitioning: 5.083 seconds, peak memory: 17.655 GB
Split the graph: 7.026 seconds
Construct subgraphs: 0.010 seconds
REG metis partition end ----................................
REG construction  time spent:  25.494795322418213
pure dgl.metis_partition the time spent:  13.581103324890137
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7405738830566406

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4762165546417236

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

connection checking time:  1.4618110656738281
block generation total time  2.2167904376983643
average batch blocks generation time:  0.27709880471229553
block dataloader generation time/epoch 43.405460357666016
pseudo mini batch 0 input nodes size: 29904
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.56787109375 GB
    Memory Allocated: 0.047313690185546875  GigaBytes
Max Memory Allocated: 0.047313690185546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.56787109375 GB
    Memory Allocated: 0.047400474548339844  GigaBytes
Max Memory Allocated: 0.047400474548339844  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.56787109375 GB
    Memory Allocated: 0.047400474548339844  GigaBytes
Max Memory Allocated: 0.047400474548339844  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2135, 2: 1907, 3: 1508, 4: 1120, 5: 936, 6: 701, 7: 553, 8: 438, 9: 371, 10: 309, 25: 281, 11: 233, 12: 184, 13: 157, 14: 145, 15: 135, 16: 92, 17: 87, 18: 77, 19: 55, 21: 46, 20: 42, 24: 32, 23: 31, 22: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.56982421875 GB
    Memory Allocated: 0.049123287200927734  GigaBytes
Max Memory Allocated: 0.049123287200927734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.56982421875 GB
    Memory Allocated: 0.049123287200927734  GigaBytes
Max Memory Allocated: 0.049123287200927734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.82177734375 GB
    Memory Allocated: 4.856645584106445  GigaBytes
Max Memory Allocated: 5.1913533210754395  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.82177734375 GB
    Memory Allocated: 4.858375072479248  GigaBytes
Max Memory Allocated: 5.1913533210754395  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.07763671875 GB
    Memory Allocated: 0.1014404296875  GigaBytes
Max Memory Allocated: 5.1913533210754395  GigaBytes

pseudo mini batch 1 input nodes size: 41699
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.07763671875 GB
    Memory Allocated: 0.09993982315063477  GigaBytes
Max Memory Allocated: 5.1913533210754395  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.07763671875 GB
    Memory Allocated: 0.09993982315063477  GigaBytes
Max Memory Allocated: 5.1913533210754395  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.07763671875 GB
    Memory Allocated: 0.11982345581054688  GigaBytes
Max Memory Allocated: 5.1913533210754395  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.07763671875 GB
    Memory Allocated: 0.11991024017333984  GigaBytes
Max Memory Allocated: 5.1913533210754395  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.07763671875 GB
    Memory Allocated: 0.10556411743164062  GigaBytes
Max Memory Allocated: 5.1913533210754395  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1699, 2: 1509, 3: 1256, 4: 1003, 5: 823, 25: 723, 6: 662, 7: 565, 8: 529, 9: 412, 10: 371, 11: 312, 12: 265, 13: 234, 14: 192, 15: 191, 16: 147, 17: 122, 19: 111, 18: 109, 20: 98, 21: 83, 22: 74, 23: 61, 24: 51})

----------------------------------------after blocks to device 
 Nvidia-smi: 6.07763671875 GB
    Memory Allocated: 0.1079554557800293  GigaBytes
Max Memory Allocated: 5.1913533210754395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.07763671875 GB
    Memory Allocated: 0.1079554557800293  GigaBytes
Max Memory Allocated: 5.1913533210754395  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.63623046875 GB
    Memory Allocated: 6.546445369720459  GigaBytes
Max Memory Allocated: 6.965359687805176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.63623046875 GB
    Memory Allocated: 6.548287868499756  GigaBytes
Max Memory Allocated: 6.965359687805176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.96435546875 GB
    Memory Allocated: 0.11001300811767578  GigaBytes
Max Memory Allocated: 6.965359687805176  GigaBytes

pseudo mini batch 2 input nodes size: 33722
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.96435546875 GB
    Memory Allocated: 0.10779333114624023  GigaBytes
Max Memory Allocated: 6.965359687805176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.96435546875 GB
    Memory Allocated: 0.10779333114624023  GigaBytes
Max Memory Allocated: 6.965359687805176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.96435546875 GB
    Memory Allocated: 0.12387323379516602  GigaBytes
Max Memory Allocated: 6.965359687805176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.96435546875 GB
    Memory Allocated: 0.12395763397216797  GigaBytes
Max Memory Allocated: 6.965359687805176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.96435546875 GB
    Memory Allocated: 0.10398721694946289  GigaBytes
Max Memory Allocated: 6.965359687805176  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1533, 2: 1367, 3: 1145, 25: 1050, 4: 903, 5: 785, 6: 586, 7: 541, 8: 467, 9: 402, 10: 354, 11: 311, 12: 256, 13: 227, 14: 215, 15: 186, 17: 159, 16: 140, 20: 123, 18: 111, 19: 110, 21: 105, 23: 76, 24: 72, 22: 71})

----------------------------------------after blocks to device 
 Nvidia-smi: 7.96435546875 GB
    Memory Allocated: 0.10641002655029297  GigaBytes
Max Memory Allocated: 6.965359687805176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.96435546875 GB
    Memory Allocated: 0.10641002655029297  GigaBytes
Max Memory Allocated: 6.965359687805176  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.32177734375 GB
    Memory Allocated: 6.844062805175781  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.32177734375 GB
    Memory Allocated: 6.845993518829346  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.10801219940185547  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

pseudo mini batch 3 input nodes size: 32209
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.10596561431884766  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.10596561431884766  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.12159061431884766  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.12167501449584961  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.10551071166992188  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1393, 2: 1344, 3: 1139, 4: 967, 5: 777, 25: 766, 6: 705, 7: 578, 8: 479, 9: 441, 10: 371, 11: 356, 12: 297, 13: 249, 14: 222, 16: 168, 15: 164, 17: 163, 18: 144, 20: 118, 19: 113, 21: 103, 22: 88, 23: 72, 24: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.1077876091003418  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.1077876091003418  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 6.554316520690918  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 6.556098461151123  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.10958337783813477  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

pseudo mini batch 4 input nodes size: 86267
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.10774469375610352  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.10774469375610352  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.1488800048828125  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.14896249771118164  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.1332530975341797  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1713, 25: 1692, 2: 1441, 3: 995, 4: 804, 5: 698, 6: 507, 7: 431, 8: 363, 9: 307, 10: 278, 11: 233, 12: 219, 13: 184, 14: 152, 15: 149, 16: 137, 18: 131, 17: 109, 19: 107, 21: 99, 20: 89, 22: 75, 23: 63, 24: 59})

----------------------------------------after blocks to device 
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.1379551887512207  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.67919921875 GB
    Memory Allocated: 0.1379551887512207  GigaBytes
Max Memory Allocated: 7.290529727935791  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.21240234375 GB
    Memory Allocated: 9.087823867797852  GigaBytes
Max Memory Allocated: 9.603742122650146  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.21240234375 GB
    Memory Allocated: 9.089701175689697  GigaBytes
Max Memory Allocated: 9.603742122650146  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.59521484375 GB
    Memory Allocated: 0.14255952835083008  GigaBytes
Max Memory Allocated: 9.603742122650146  GigaBytes

pseudo mini batch 5 input nodes size: 68799
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.59521484375 GB
    Memory Allocated: 0.1359729766845703  GigaBytes
Max Memory Allocated: 9.603742122650146  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.59521484375 GB
    Memory Allocated: 0.1359729766845703  GigaBytes
Max Memory Allocated: 9.603742122650146  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.59521484375 GB
    Memory Allocated: 0.1691761016845703  GigaBytes
Max Memory Allocated: 9.603742122650146  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.59521484375 GB
    Memory Allocated: 0.16926145553588867  GigaBytes
Max Memory Allocated: 9.603742122650146  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.59521484375 GB
    Memory Allocated: 0.12804365158081055  GigaBytes
Max Memory Allocated: 9.603742122650146  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2952, 1: 1265, 2: 1016, 3: 828, 4: 653, 5: 549, 6: 451, 7: 369, 9: 323, 8: 317, 10: 301, 11: 262, 12: 258, 13: 232, 14: 195, 15: 180, 16: 177, 18: 164, 20: 161, 17: 161, 19: 151, 21: 149, 23: 119, 24: 118, 22: 101})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.59521484375 GB
    Memory Allocated: 0.13327932357788086  GigaBytes
Max Memory Allocated: 9.603742122650146  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.59521484375 GB
    Memory Allocated: 0.13327932357788086  GigaBytes
Max Memory Allocated: 9.603742122650146  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.84521484375 GB
    Memory Allocated: 11.164270877838135  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.84521484375 GB
    Memory Allocated: 11.166102409362793  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.37451171875 GB
    Memory Allocated: 0.13750982284545898  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 6 input nodes size: 57282
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.37451171875 GB
    Memory Allocated: 0.13098382949829102  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.37451171875 GB
    Memory Allocated: 0.13098382949829102  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.37451171875 GB
    Memory Allocated: 0.15832757949829102  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.37451171875 GB
    Memory Allocated: 0.15841341018676758  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.37451171875 GB
    Memory Allocated: 0.12512493133544922  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1844, 2: 1577, 3: 1250, 4: 1023, 5: 883, 25: 707, 6: 678, 7: 555, 8: 472, 9: 402, 10: 344, 12: 240, 11: 240, 13: 217, 14: 179, 15: 142, 16: 136, 17: 118, 18: 102, 19: 86, 20: 78, 21: 63, 22: 59, 24: 52, 23: 50})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.37451171875 GB
    Memory Allocated: 0.12769126892089844  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.37451171875 GB
    Memory Allocated: 0.12769126892089844  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.5478668212890625  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.549652576446533  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1298360824584961  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 7 input nodes size: 66346
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.12709903717041016  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.12709903717041016  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1587352752685547  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.15881872177124023  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.13138914108276367  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1846, 2: 1545, 25: 1289, 3: 1156, 4: 847, 5: 771, 6: 578, 7: 453, 8: 407, 9: 318, 10: 271, 11: 256, 12: 218, 13: 156, 15: 142, 14: 134, 16: 114, 17: 111, 18: 110, 19: 103, 20: 98, 21: 69, 24: 69, 22: 63, 23: 47})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.13463544845581055  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.13463544845581055  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.630801200866699  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.632602214813232  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.13735437393188477  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20346307754516602  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1704087257385254  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07955828309059143 |0.004274100065231323 |0.28605061769485474 |0.0018103718757629395 |0.3604108989238739 |0.14576935768127441 |
----------------------------------------------------------pseudo_mini_loss sum 3.7764077186584473
Total (block generation + training)time/epoch 49.45563578605652
Training time/epoch 6.049870014190674
Training time without block to device /epoch 6.015677213668823
Training time without total dataloading part /epoch 5.331944465637207
load block tensor time/epoch 0.6364662647247314
block to device time/epoch 0.034192800521850586
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  650166
Number of first layer input nodes during this epoch:  416228
Number of first layer output nodes during this epoch:  233938
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.15472793579101562  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.451 seconds, peak memory: 35.062 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 35.062 GB
Metis partitioning: 5.133 seconds, peak memory: 35.699 GB
Split the graph: 6.796 seconds
Construct subgraphs: 0.097 seconds
REG metis partition end ----................................
REG construction  time spent:  24.670884132385254
pure dgl.metis_partition the time spent:  13.506208419799805
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7354943752288818

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.6207342147827148

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.15472793579101562  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

connection checking time:  1.537672996520996
block generation total time  2.3562285900115967
average batch blocks generation time:  0.2945285737514496
block dataloader generation time/epoch 43.065950870513916
pseudo mini batch 0 input nodes size: 36371
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.15087509155273438  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.15087509155273438  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.16845321655273438  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.16854047775268555  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.13682079315185547  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1934, 2: 1688, 3: 1343, 4: 1040, 5: 886, 6: 693, 7: 587, 25: 510, 8: 483, 9: 399, 10: 343, 11: 275, 12: 232, 13: 216, 15: 172, 14: 169, 16: 137, 17: 101, 19: 91, 20: 84, 18: 83, 21: 56, 22: 49, 23: 44, 24: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.13889312744140625  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.13889312744140625  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 5.802969455718994  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 5.804992198944092  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1714949607849121  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 1 input nodes size: 35771
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.16963624954223633  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.16963624954223633  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18721437454223633  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1873016357421875  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.16963624954223633  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2046, 2: 1821, 3: 1409, 4: 1088, 5: 923, 6: 687, 7: 555, 8: 491, 25: 397, 9: 368, 10: 320, 11: 254, 12: 220, 13: 177, 14: 154, 15: 145, 16: 107, 17: 97, 18: 97, 19: 66, 21: 57, 20: 56, 22: 51, 23: 46, 24: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1715836524963379  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1715836524963379  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 5.496518135070801  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 5.498361110687256  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17328786849975586  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 2 input nodes size: 42536
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17152738571166992  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17152738571166992  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19181013107299805  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1918964385986328  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17423105239868164  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1420, 2: 1397, 3: 1153, 4: 1008, 25: 922, 5: 744, 6: 664, 7: 563, 8: 501, 9: 454, 10: 388, 11: 357, 12: 324, 13: 247, 14: 215, 15: 185, 16: 158, 17: 157, 18: 140, 19: 123, 20: 104, 21: 102, 22: 93, 24: 71, 23: 71})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1768035888671875  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1768035888671875  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.149825572967529  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.1517333984375  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1786050796508789  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 3 input nodes size: 29642
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17628860473632812  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17628860473632812  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19042301177978516  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19051027297973633  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17014122009277344  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1391, 2: 1261, 3: 1119, 25: 1097, 4: 906, 5: 829, 6: 691, 7: 594, 8: 503, 9: 430, 10: 401, 11: 366, 12: 277, 13: 262, 14: 247, 15: 206, 17: 191, 16: 165, 20: 149, 18: 134, 21: 123, 19: 119, 23: 81, 22: 80, 24: 78})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17264938354492188  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17264938354492188  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.305307865142822  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.307135581970215  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1749124526977539  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 4 input nodes size: 67828
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17293882369995117  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17293882369995117  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20614194869995117  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2062244415283203  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1920027732849121  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1831, 2: 1550, 25: 1303, 3: 1082, 4: 847, 5: 742, 6: 561, 7: 439, 8: 404, 9: 325, 10: 281, 11: 242, 12: 197, 13: 174, 14: 129, 15: 128, 18: 113, 16: 110, 19: 109, 17: 106, 20: 99, 21: 73, 24: 72, 22: 67, 23: 51})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19526290893554688  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19526290893554688  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.6982831954956055  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.700423717498779  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19751453399658203  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 5 input nodes size: 70349
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19362354278564453  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19362354278564453  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.22716856002807617  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.22725152969360352  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19396591186523438  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1935, 2: 1560, 3: 1326, 4: 987, 5: 825, 25: 693, 6: 614, 7: 510, 8: 429, 9: 374, 10: 284, 11: 213, 12: 212, 13: 188, 14: 173, 16: 132, 15: 120, 17: 94, 18: 91, 19: 76, 21: 66, 20: 63, 23: 52, 22: 51, 24: 50})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19668817520141602  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19668817520141602  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.571455955505371  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.573131084442139  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1994481086730957  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 6 input nodes size: 88256
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19623041152954102  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19623041152954102  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.23831415176391602  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.23839664459228516  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20476865768432617  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1669, 1: 1657, 2: 1436, 3: 1034, 4: 805, 5: 709, 6: 504, 7: 407, 8: 344, 9: 311, 10: 294, 11: 244, 12: 222, 13: 174, 15: 162, 14: 159, 16: 138, 18: 130, 17: 123, 19: 107, 21: 97, 20: 94, 22: 75, 24: 74, 23: 66})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20949649810791016  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20949649810791016  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 9.244855880737305  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 9.24673318862915  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2132272720336914  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 7 input nodes size: 67814
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20702266693115234  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20702266693115234  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.24022579193115234  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2403092384338379  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19814300537109375  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2869, 1: 1214, 2: 993, 3: 811, 4: 639, 5: 564, 6: 454, 7: 390, 8: 317, 9: 315, 10: 288, 12: 253, 11: 252, 13: 218, 14: 188, 15: 171, 16: 164, 17: 161, 18: 160, 20: 158, 19: 145, 21: 143, 23: 108, 24: 102, 22: 90})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20328283309936523  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20328283309936523  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 10.94426155090332  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 10.94637155532837  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20792818069458008  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20792818069458008  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17487382888793945  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09106406569480896 |0.005792945623397827 |0.16038307547569275 |0.00012230873107910156 |0.34785035252571106 |0.004830360412597656 |
----------------------------------------------------------pseudo_mini_loss sum 18.398035049438477
Total (block generation + training)time/epoch 48.58924174308777
Training time/epoch 4.9960103034973145
Training time without block to device /epoch 4.949666738510132
Training time without total dataloading part /epoch 4.071676254272461
load block tensor time/epoch 0.7285125255584717
block to device time/epoch 0.04634356498718262
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  678714
Number of first layer input nodes during this epoch:  438567
Number of first layer output nodes during this epoch:  240147
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.16019105911254883  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.459 seconds, peak memory: 35.953 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 35.953 GB
Metis partitioning: 5.120 seconds, peak memory: 35.953 GB
Split the graph: 7.455 seconds
Construct subgraphs: 0.010 seconds
REG metis partition end ----................................
REG construction  time spent:  25.698262691497803
pure dgl.metis_partition the time spent:  14.071846723556519
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.752800703048706

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.6166369915008545

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.16019105911254883  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

connection checking time:  1.5247342586517334
block generation total time  2.3694376945495605
average batch blocks generation time:  0.29617971181869507
block dataloader generation time/epoch 43.51237948735555
pseudo mini batch 0 input nodes size: 31246
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.15369796752929688  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.15369796752929688  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.16932296752929688  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.16940736770629883  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.13612079620361328  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1302, 2: 1262, 3: 1090, 25: 970, 4: 888, 5: 788, 6: 676, 7: 577, 8: 490, 9: 412, 10: 387, 11: 360, 12: 290, 13: 260, 14: 228, 15: 193, 17: 183, 16: 181, 18: 155, 20: 132, 19: 121, 21: 120, 22: 85, 23: 80, 24: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.13854169845581055  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.13854169845581055  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.986177444458008  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.988146781921387  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17009544372558594  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 1 input nodes size: 41625
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.16816186904907227  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.16816186904907227  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18801021575927734  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1880970001220703  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17238759994506836  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1512, 2: 1387, 3: 1183, 4: 996, 25: 963, 5: 801, 6: 661, 7: 572, 8: 488, 9: 436, 10: 383, 11: 320, 12: 294, 13: 248, 14: 224, 15: 192, 17: 155, 16: 127, 18: 113, 20: 112, 19: 104, 21: 103, 22: 79, 24: 77, 23: 64})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17494678497314453  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17494678497314453  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.103778839111328  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.105648517608643  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1770648956298828  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 2 input nodes size: 43933
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17475032806396484  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17475032806396484  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19569921493530273  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1957859992980957  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17585086822509766  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1762, 2: 1568, 3: 1265, 4: 1036, 5: 862, 25: 719, 6: 644, 7: 534, 8: 519, 9: 401, 10: 362, 11: 299, 12: 256, 13: 209, 14: 180, 15: 161, 16: 155, 17: 124, 19: 113, 18: 98, 20: 87, 21: 74, 22: 71, 23: 67, 24: 52})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17824411392211914  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17824411392211914  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.512755393981934  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.5146098136901855  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17988920211791992  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 3 input nodes size: 30894
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1776137351989746  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1776137351989746  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1932387351989746  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19332551956176758  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17228984832763672  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2105, 2: 1886, 3: 1424, 4: 1084, 5: 899, 6: 689, 7: 564, 8: 468, 9: 398, 10: 317, 25: 291, 11: 234, 12: 203, 13: 186, 14: 150, 15: 141, 16: 115, 17: 93, 18: 87, 19: 64, 20: 54, 21: 46, 22: 35, 24: 32, 23: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17406988143920898  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17406988143920898  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 5.128507614135742  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 5.130293369293213  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17547941207885742  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 4 input nodes size: 67051
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17393207550048828  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17393207550048828  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20590448379516602  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20599031448364258  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1902785301208496  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2863, 1: 1277, 2: 1035, 3: 838, 4: 689, 5: 576, 6: 449, 7: 378, 9: 329, 8: 324, 10: 302, 11: 271, 12: 269, 13: 238, 15: 186, 14: 185, 16: 171, 20: 158, 18: 158, 17: 158, 19: 155, 21: 141, 24: 109, 23: 107, 22: 96})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19542646408081055  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19542646408081055  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 10.982861042022705  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 10.984631538391113  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19993257522583008  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 5 input nodes size: 84816
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19346141815185547  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19346141815185547  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.23390483856201172  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.23398733139038086  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20192909240722656  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2192, 1: 1392, 2: 1263, 3: 913, 4: 713, 5: 653, 6: 503, 7: 429, 8: 351, 9: 316, 10: 289, 11: 251, 12: 217, 13: 188, 14: 184, 15: 164, 16: 144, 18: 142, 17: 133, 19: 124, 21: 113, 20: 103, 22: 90, 23: 88, 24: 80})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2069406509399414  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2069406509399414  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 10.198370933532715  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 10.200084209442139  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2115774154663086  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 6 input nodes size: 62793
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2048959732055664  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2048959732055664  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.23483800888061523  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.23492193222045898  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1943960189819336  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2008, 2: 1611, 3: 1293, 4: 1006, 5: 845, 6: 647, 25: 611, 7: 510, 8: 437, 9: 353, 10: 290, 11: 240, 12: 221, 13: 186, 14: 164, 15: 135, 16: 119, 18: 103, 17: 96, 20: 80, 19: 70, 21: 56, 23: 50, 24: 46, 22: 45})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19694995880126953  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19694995880126953  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.349721908569336  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.351614475250244  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19908428192138672  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 7 input nodes size: 69743
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1961688995361328  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1961688995361328  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.22942495346069336  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2295079231262207  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19948196411132812  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2070, 2: 1694, 3: 1271, 4: 908, 25: 851, 5: 798, 6: 599, 7: 481, 8: 395, 9: 331, 10: 269, 11: 228, 12: 187, 13: 141, 14: 119, 15: 117, 16: 99, 18: 92, 17: 88, 19: 85, 20: 81, 21: 64, 24: 57, 22: 55, 23: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2024216651916504  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2024216651916504  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.808724403381348  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.8105597496032715  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20499181747436523  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20499181747436523  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1719374656677246  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0907975435256958 |0.0044561028480529785 |0.16432347893714905 |0.00014659762382507324 |0.34737351536750793 |0.0022382736206054688 |
----------------------------------------------------------pseudo_mini_loss sum 8.426255226135254
Total (block generation + training)time/epoch 48.8624811967214
Training time/epoch 5.003411531448364
Training time without block to device /epoch 4.96776270866394
Training time without total dataloading part /epoch 4.096987009048462
load block tensor time/epoch 0.7263803482055664
block to device time/epoch 0.03564882278442383
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  671455
Number of first layer input nodes during this epoch:  432101
Number of first layer output nodes during this epoch:  239354
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.15593767166137695  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.452 seconds, peak memory: 36.223 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.223 GB
Metis partitioning: 5.074 seconds, peak memory: 36.223 GB
Split the graph: 8.546 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  23.831689596176147
pure dgl.metis_partition the time spent:  15.118305206298828
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7366986274719238

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.547945499420166

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.15593767166137695  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

connection checking time:  1.4820342063903809
block generation total time  2.28464412689209
average batch blocks generation time:  0.28558051586151123
block dataloader generation time/epoch 43.494077265262604
pseudo mini batch 0 input nodes size: 31338
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1522979736328125  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1522979736328125  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1679229736328125  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.16800880432128906  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.13466978073120117  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1516, 2: 1362, 3: 1204, 4: 999, 5: 841, 25: 717, 6: 713, 7: 568, 8: 507, 9: 425, 10: 395, 11: 370, 12: 274, 13: 254, 14: 217, 15: 177, 16: 164, 17: 158, 18: 127, 20: 122, 19: 103, 21: 103, 22: 77, 24: 62, 23: 59})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1369309425354004  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1369309425354004  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.501439094543457  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.503273963928223  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1698932647705078  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 1 input nodes size: 36018
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1680436134338379  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1680436134338379  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1856217384338379  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18570566177368164  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.16999483108520508  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1587, 2: 1391, 3: 1136, 25: 1015, 4: 890, 5: 755, 6: 614, 7: 532, 8: 462, 9: 408, 10: 339, 11: 301, 12: 265, 13: 214, 14: 198, 15: 180, 17: 157, 16: 139, 18: 123, 19: 111, 20: 111, 21: 100, 23: 83, 24: 73, 22: 62})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1724228858947754  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1724228858947754  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.858363151550293  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.860290050506592  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17412137985229492  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 2 input nodes size: 47232
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1720108985900879  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1720108985900879  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1954483985900879  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19553518295288086  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1778731346130371  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1540, 2: 1404, 3: 1139, 4: 1004, 25: 946, 5: 797, 6: 639, 7: 576, 8: 513, 9: 435, 10: 393, 11: 293, 12: 277, 13: 246, 14: 234, 15: 199, 16: 161, 17: 156, 18: 128, 19: 108, 20: 107, 21: 95, 22: 94, 23: 75, 24: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18050384521484375  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18050384521484375  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.2009806632995605  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.202934265136719  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18268489837646484  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 3 input nodes size: 32636
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1802382469177246  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1802382469177246  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1958632469177246  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19594955444335938  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1724252700805664  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1958, 2: 1757, 3: 1413, 4: 1079, 5: 906, 6: 696, 7: 602, 8: 484, 9: 380, 25: 365, 10: 321, 11: 273, 12: 228, 13: 193, 14: 161, 15: 147, 16: 115, 17: 89, 18: 72, 19: 70, 20: 66, 21: 53, 22: 48, 24: 39, 23: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17432546615600586  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17432546615600586  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 5.398193836212158  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 5.400040626525879  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17572832107543945  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 4 input nodes size: 67598
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17404508590698242  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17404508590698242  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20724821090698242  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20733356475830078  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19162225723266602  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2926, 1: 1234, 2: 998, 3: 837, 4: 648, 5: 579, 6: 451, 7: 391, 9: 316, 10: 302, 8: 301, 12: 271, 11: 262, 13: 239, 14: 191, 15: 176, 16: 172, 18: 169, 19: 159, 17: 159, 20: 155, 21: 147, 23: 115, 24: 103, 22: 96})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19680547714233398  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19680547714233398  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 11.107631206512451  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 11.109823226928711  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20196914672851562  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 5 input nodes size: 83324
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19509315490722656  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19509315490722656  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.23482513427734375  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2349076271057129  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20161914825439453  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1890, 1: 1544, 2: 1420, 3: 1012, 4: 737, 5: 663, 6: 520, 7: 408, 8: 349, 9: 299, 10: 269, 11: 232, 12: 211, 13: 179, 15: 170, 14: 152, 16: 150, 18: 143, 17: 133, 19: 118, 21: 107, 20: 95, 22: 87, 24: 81, 23: 66})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20662164688110352  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20662164688110352  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 9.548027992248535  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 9.549691677093506  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.21066713333129883  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 6 input nodes size: 50896
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2038731575012207  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2038731575012207  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.22814226150512695  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2282266616821289  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18841218948364258  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2077, 2: 1767, 3: 1387, 4: 1077, 5: 905, 6: 657, 7: 482, 25: 468, 8: 449, 9: 377, 10: 311, 11: 208, 12: 196, 13: 167, 14: 141, 15: 121, 16: 106, 18: 87, 17: 83, 19: 64, 20: 50, 21: 40, 23: 32, 22: 30, 24: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1905651092529297  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1905651092529297  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 5.604650020599365  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 5.606344223022461  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19238758087158203  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 7 input nodes size: 66778
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19010496139526367  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19010496139526367  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.22194719314575195  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2220311164855957  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1976776123046875  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1972, 2: 1607, 3: 1149, 25: 1133, 4: 886, 5: 776, 6: 578, 7: 486, 8: 407, 9: 336, 10: 269, 11: 264, 12: 215, 13: 164, 14: 140, 15: 119, 16: 104, 19: 103, 20: 101, 18: 99, 17: 95, 21: 72, 24: 67, 22: 62, 23: 51})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2008066177368164  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2008066177368164  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.422012805938721  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.423707008361816  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20363712310791016  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20363712310791016  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17058277130126953  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09022128582000732 |0.0039247870445251465 |0.1600821614265442 |0.00012853741645812988 |0.34848442673683167 |0.0016613006591796875 |
----------------------------------------------------------pseudo_mini_loss sum 4.664383888244629
Total (block generation + training)time/epoch 48.74641901254654
Training time/epoch 4.958859443664551
Training time without block to device /epoch 4.92746114730835
Training time without total dataloading part /epoch 4.071222305297852
load block tensor time/epoch 0.7217702865600586
block to device time/epoch 0.03139829635620117
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  648575
Number of first layer input nodes during this epoch:  415820
Number of first layer output nodes during this epoch:  232755
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.15482187271118164  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.449 seconds, peak memory: 36.223 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.223 GB
Metis partitioning: 5.095 seconds, peak memory: 36.223 GB
Split the graph: 7.415 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  22.853719234466553
pure dgl.metis_partition the time spent:  13.995176553726196
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7523870468139648

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.5852196216583252

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.15482187271118164  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

connection checking time:  1.5085604190826416
block generation total time  2.33760666847229
average batch blocks generation time:  0.29220083355903625
block dataloader generation time/epoch 43.07502641677856
pseudo mini batch 0 input nodes size: 85114
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.15109539031982422  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.15109539031982422  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.191680908203125  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19176340103149414  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1598372459411621  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1853, 1: 1616, 2: 1366, 3: 956, 4: 771, 5: 670, 6: 517, 7: 432, 8: 350, 9: 308, 10: 271, 11: 246, 12: 215, 13: 191, 14: 166, 15: 157, 16: 140, 18: 136, 17: 126, 19: 115, 21: 111, 20: 102, 22: 82, 24: 70, 23: 68})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1646561622619629  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1646561622619629  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 9.505489349365234  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 9.507317543029785  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20077800750732422  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 1 input nodes size: 68142
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1932225227355957  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1932225227355957  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2264256477355957  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.22651100158691406  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18584299087524414  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2902, 1: 1214, 2: 993, 3: 859, 4: 641, 5: 570, 6: 463, 7: 394, 9: 338, 8: 314, 10: 308, 12: 266, 11: 263, 13: 232, 14: 189, 15: 184, 16: 183, 18: 167, 20: 162, 17: 157, 19: 156, 21: 146, 23: 116, 24: 110, 22: 100})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1910533905029297  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1910533905029297  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 11.155694961547852  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 11.157633304595947  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19552993774414062  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 2 input nodes size: 58588
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1892843246459961  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1892843246459961  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2175588607788086  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.21764230728149414  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18435382843017578  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2081, 2: 1736, 3: 1310, 4: 1047, 5: 922, 6: 617, 7: 519, 25: 455, 8: 432, 9: 368, 10: 310, 11: 222, 12: 195, 13: 177, 14: 147, 15: 120, 16: 103, 17: 90, 18: 79, 19: 61, 20: 52, 21: 41, 22: 37, 23: 35, 24: 34})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18663311004638672  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18663311004638672  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 5.745978832244873  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 5.747714996337891  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1884021759033203  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 3 input nodes size: 67535
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18585205078125  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18585205078125  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.21805524826049805  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2181386947631836  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18978071212768555  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1931, 2: 1591, 25: 1236, 3: 1123, 4: 856, 5: 753, 6: 592, 7: 457, 8: 399, 9: 309, 10: 268, 11: 252, 12: 211, 13: 163, 14: 144, 15: 131, 16: 111, 18: 109, 17: 103, 19: 102, 20: 89, 21: 75, 24: 70, 22: 64, 23: 48})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19299554824829102  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19299554824829102  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.639064788818359  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 7.640732288360596  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1958155632019043  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 4 input nodes size: 32657
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19197607040405273  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19197607040405273  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.20760107040405273  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.2076854705810547  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1753988265991211  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1442, 2: 1359, 3: 1187, 4: 959, 5: 802, 25: 744, 6: 717, 7: 565, 8: 488, 9: 436, 10: 381, 11: 361, 12: 294, 13: 244, 14: 208, 15: 163, 16: 154, 17: 152, 18: 133, 20: 114, 19: 102, 21: 101, 22: 80, 23: 69, 24: 63})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17765188217163086  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17765188217163086  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.527597904205322  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.529327392578125  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17936182022094727  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 5 input nodes size: 34240
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17751646041870117  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17751646041870117  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19384336471557617  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19392967224121094  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.17822027206420898  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1676, 2: 1419, 3: 1199, 25: 982, 4: 948, 5: 807, 6: 623, 7: 546, 8: 477, 9: 389, 10: 349, 11: 296, 12: 257, 13: 218, 14: 208, 15: 182, 17: 156, 16: 141, 20: 119, 18: 118, 19: 106, 21: 104, 24: 73, 23: 73, 22: 62})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18061161041259766  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18061161041259766  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.829202175140381  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 6.830949783325195  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18240928649902344  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 6 input nodes size: 39720
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18038034439086914  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18038034439086914  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.19991159439086914  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.1999983787536621  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18358516693115234  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1844, 2: 1760, 3: 1375, 4: 1065, 5: 878, 6: 689, 7: 539, 25: 523, 8: 494, 9: 391, 10: 331, 11: 250, 12: 237, 13: 185, 14: 168, 15: 158, 16: 117, 17: 114, 18: 93, 19: 86, 21: 64, 20: 62, 22: 58, 23: 58, 24: 50})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18572092056274414  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.46240234375 GB
    Memory Allocated: 0.18572092056274414  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 5.906109809875488  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 5.9081130027771  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.1875758171081543  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 7 input nodes size: 41660
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.1855759620666504  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.1855759620666504  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.20544099807739258  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.20552825927734375  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.18591022491455078  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1624, 2: 1482, 3: 1268, 4: 1033, 5: 820, 25: 765, 6: 650, 7: 593, 8: 518, 9: 437, 10: 381, 11: 313, 12: 262, 13: 246, 14: 204, 15: 194, 16: 162, 17: 132, 18: 113, 19: 108, 20: 107, 21: 75, 22: 73, 24: 55, 23: 52})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.18831920623779297  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.18831920623779297  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 6.718555450439453  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 6.72044038772583  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.19011592864990234  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.19011592864990234  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.15706157684326172  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09188777208328247 |0.003866225481033325 |0.1607716977596283 |0.00012701749801635742 |0.34777554869651794 |0.0034232139587402344 |
----------------------------------------------------------pseudo_mini_loss sum 4.292490482330322
Total (block generation + training)time/epoch 48.27194218635559
Training time/epoch 4.9749391078948975
Training time without block to device /epoch 4.944009304046631
Training time without total dataloading part /epoch 4.072817325592041
load block tensor time/epoch 0.7351021766662598
block to device time/epoch 0.0309298038482666
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  664472
Number of first layer input nodes during this epoch:  427656
Number of first layer output nodes during this epoch:  236816
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.14128494262695312  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.445 seconds, peak memory: 36.223 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.223 GB
Metis partitioning: 5.013 seconds, peak memory: 36.223 GB
Split the graph: 7.292 seconds
Construct subgraphs: 0.022 seconds
REG metis partition end ----................................
REG construction  time spent:  24.808241605758667
pure dgl.metis_partition the time spent:  13.80087161064148
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7540156841278076

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.651266098022461

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.14128494262695312  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

connection checking time:  1.542888879776001
block generation total time  2.4052817821502686
average batch blocks generation time:  0.30066022276878357
block dataloader generation time/epoch 43.104644536972046
pseudo mini batch 0 input nodes size: 66199
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.13909292221069336  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.13909292221069336  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.17065906524658203  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.17074155807495117  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.1507892608642578  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2054, 2: 1710, 3: 1202, 4: 932, 5: 847, 25: 706, 6: 613, 7: 480, 8: 431, 9: 329, 10: 282, 11: 219, 12: 214, 13: 167, 14: 119, 15: 112, 16: 93, 18: 87, 17: 87, 19: 79, 20: 69, 21: 63, 24: 51, 22: 51, 23: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.15351533889770508  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.15351533889770508  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 6.4390549659729  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 6.440856456756592  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.18687677383422852  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 1 input nodes size: 65717
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.1835789680480957  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.1835789680480957  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.21491527557373047  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.2149982452392578  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.183349609375  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2045, 2: 1772, 3: 1354, 4: 1043, 5: 832, 6: 599, 25: 513, 7: 497, 8: 415, 9: 362, 10: 288, 11: 221, 13: 179, 12: 172, 14: 130, 15: 122, 16: 95, 17: 88, 18: 88, 19: 68, 21: 59, 20: 58, 23: 41, 22: 37, 24: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.18580865859985352  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.18580865859985352  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 5.9701151847839355  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 5.971946716308594  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.18796396255493164  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 2 input nodes size: 86030
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.18506765365600586  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.18506765365600586  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.2260899543762207  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.22617244720458984  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.19475317001342773  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2141, 1: 1438, 2: 1252, 3: 923, 4: 702, 5: 644, 6: 498, 7: 413, 8: 335, 9: 311, 10: 303, 11: 274, 12: 234, 14: 179, 13: 173, 15: 163, 18: 154, 16: 146, 19: 133, 17: 124, 20: 119, 21: 109, 24: 93, 22: 89, 23: 85})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.19974899291992188  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.19974899291992188  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 10.140421390533447  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 10.14228343963623  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.20403337478637695  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

pseudo mini batch 3 input nodes size: 67452
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.19736146926879883  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.19736146926879883  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.22952508926391602  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.22960948944091797  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.18850469589233398  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3033, 1: 1211, 2: 970, 3: 797, 4: 620, 5: 532, 6: 442, 7: 373, 9: 322, 8: 321, 10: 281, 11: 258, 12: 255, 13: 226, 14: 190, 15: 188, 16: 181, 17: 173, 18: 164, 19: 159, 20: 156, 21: 145, 24: 110, 23: 109, 22: 98})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.1937408447265625  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.53466796875 GB
    Memory Allocated: 0.1937408447265625  GigaBytes
Max Memory Allocated: 11.95592975616455  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.06787109375 GB
    Memory Allocated: 11.293941020965576  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.06787109375 GB
    Memory Allocated: 11.295636653900146  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19832658767700195  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

pseudo mini batch 4 input nodes size: 32413
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19181537628173828  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19181537628173828  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.20744037628173828  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.20752716064453125  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1752791404724121  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1747, 2: 1434, 3: 1232, 25: 996, 4: 919, 5: 783, 6: 618, 7: 544, 8: 457, 9: 398, 10: 345, 11: 310, 12: 254, 13: 222, 14: 202, 15: 190, 17: 163, 16: 150, 20: 119, 18: 115, 21: 112, 19: 102, 23: 74, 24: 67, 22: 65})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17766666412353516  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17766666412353516  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 6.851639747619629  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 6.853929042816162  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17989158630371094  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

pseudo mini batch 5 input nodes size: 37108
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17789077758789062  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17789077758789062  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1955852508544922  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19567155838012695  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17995977401733398  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 1334, 1: 1271, 3: 1132, 4: 998, 25: 918, 5: 820, 6: 689, 7: 586, 8: 521, 9: 458, 10: 412, 11: 369, 12: 305, 13: 282, 14: 240, 15: 181, 17: 168, 16: 167, 18: 148, 20: 125, 19: 112, 21: 104, 22: 94, 24: 76, 23: 73})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1824798583984375  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1824798583984375  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 7.160887241363525  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 7.162875175476074  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1840362548828125  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

pseudo mini batch 6 input nodes size: 38546
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1818990707397461  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1818990707397461  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.20027923583984375  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.20036554336547852  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1825847625732422  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1954, 2: 1708, 3: 1349, 4: 1066, 5: 887, 6: 706, 7: 533, 8: 486, 25: 482, 9: 366, 10: 342, 11: 281, 12: 240, 13: 192, 14: 178, 15: 150, 16: 112, 17: 102, 18: 88, 19: 78, 21: 65, 20: 61, 23: 57, 22: 56, 24: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1846776008605957  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1846776008605957  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 5.788437843322754  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 5.790185451507568  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.18642759323120117  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

pseudo mini batch 7 input nodes size: 45109
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.18447351455688477  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.18447351455688477  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.20598316192626953  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.2060704231262207  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.18760395050048828  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1708, 2: 1526, 3: 1288, 4: 1040, 5: 877, 6: 703, 25: 671, 7: 619, 8: 506, 9: 430, 10: 346, 11: 271, 12: 263, 13: 215, 14: 196, 15: 183, 16: 167, 17: 125, 19: 105, 18: 104, 20: 100, 22: 66, 21: 60, 24: 51, 23: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19001197814941406  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19001197814941406  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 6.516628265380859  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 6.518375873565674  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19184112548828125  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19184112548828125  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.15878677368164062  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09124162793159485 |0.004074364900588989 |0.159294992685318 |0.00012257695198059082 |0.34673842787742615 |0.002077817916870117 |
----------------------------------------------------------pseudo_mini_loss sum 4.92145299911499
Total (block generation + training)time/epoch 48.261173923810325
Training time/epoch 4.954319715499878
Training time without block to device /epoch 4.921724796295166
Training time without total dataloading part /epoch 4.051325798034668
load block tensor time/epoch 0.7299330234527588
block to device time/epoch 0.032594919204711914
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  678064
Number of first layer input nodes during this epoch:  438574
Number of first layer output nodes during this epoch:  239490
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1429152488708496  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.471 seconds, peak memory: 36.391 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.391 GB
Metis partitioning: 5.183 seconds, peak memory: 37.033 GB
Split the graph: 7.303 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  23.818540811538696
pure dgl.metis_partition the time spent:  14.007991075515747
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7705135345458984

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.6020441055297852

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1429152488708496  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

connection checking time:  1.5479047298431396
block generation total time  2.3725576400756836
average batch blocks generation time:  0.29656970500946045
block dataloader generation time/epoch 43.01468004499163
pseudo mini batch 0 input nodes size: 35146
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.14059782028198242  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.14059782028198242  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.15817594528198242  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.15826034545898438  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.13666343688964844  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1378, 2: 1333, 3: 1160, 4: 966, 25: 798, 5: 775, 6: 708, 7: 576, 8: 491, 9: 432, 10: 390, 11: 350, 12: 291, 13: 259, 14: 222, 15: 163, 16: 157, 17: 151, 18: 137, 20: 117, 19: 111, 21: 104, 22: 80, 24: 74, 23: 73})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.13901185989379883  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.13901185989379883  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 6.685274600982666  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 6.687022686004639  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1719188690185547  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

pseudo mini batch 1 input nodes size: 33766
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.16993999481201172  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.16993999481201172  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.18604087829589844  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1861262321472168  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.16846370697021484  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1714, 2: 1457, 3: 1212, 25: 970, 4: 940, 5: 780, 6: 623, 7: 517, 8: 445, 9: 391, 10: 335, 11: 290, 12: 242, 13: 205, 14: 192, 15: 177, 17: 155, 16: 141, 20: 111, 18: 107, 19: 103, 21: 97, 23: 69, 24: 66, 22: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17079734802246094  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17079734802246094  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 6.66138219833374  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 6.663213729858398  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.172576904296875  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

pseudo mini batch 2 input nodes size: 48457
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17058753967285156  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17058753967285156  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19402503967285156  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19411230087280273  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17792606353759766  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1695, 2: 1518, 3: 1196, 4: 995, 25: 868, 5: 843, 6: 632, 7: 568, 8: 512, 9: 383, 10: 378, 11: 280, 12: 264, 13: 239, 14: 213, 15: 205, 17: 137, 16: 133, 18: 119, 19: 100, 22: 93, 20: 91, 21: 82, 24: 68, 23: 66})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.18047618865966797  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.18047618865966797  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 6.973165035247803  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 6.974996566772461  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.18262004852294922  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

pseudo mini batch 3 input nodes size: 32156
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.18019628524780273  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.18019628524780273  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19582128524780273  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1959075927734375  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17238283157348633  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1933, 2: 1752, 3: 1372, 4: 1105, 5: 908, 6: 690, 7: 608, 8: 475, 9: 415, 25: 376, 10: 312, 11: 272, 12: 224, 13: 195, 14: 154, 15: 141, 16: 127, 17: 92, 18: 88, 19: 79, 20: 61, 21: 52, 22: 43, 23: 38, 24: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17429447174072266  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17429447174072266  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 5.474130153656006  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 5.475942611694336  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17560195922851562  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

pseudo mini batch 4 input nodes size: 54295
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17390680313110352  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.17390680313110352  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1997966766357422  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19988155364990234  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.18417024612426758  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2004, 2: 1692, 3: 1339, 4: 1060, 5: 910, 6: 617, 25: 522, 7: 496, 8: 468, 9: 389, 10: 303, 11: 235, 12: 226, 13: 194, 14: 162, 15: 127, 16: 123, 17: 99, 18: 89, 20: 73, 19: 70, 21: 47, 24: 43, 23: 42, 22: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1864938735961914  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1864938735961914  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 5.967265605926514  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 5.969036102294922  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.18844985961914062  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

pseudo mini batch 5 input nodes size: 67375
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.18595027923583984  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.18595027923583984  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.2180771827697754  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.21816110610961914  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1921863555908203  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1919, 2: 1597, 25: 1234, 3: 1148, 4: 851, 5: 749, 6: 615, 7: 460, 8: 391, 9: 323, 10: 266, 11: 262, 12: 202, 13: 148, 14: 143, 15: 130, 16: 110, 18: 109, 17: 107, 19: 101, 20: 88, 21: 73, 22: 65, 24: 63, 23: 47})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.195404052734375  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.195404052734375  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 7.6307878494262695  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 7.63257360458374  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.1981830596923828  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

pseudo mini batch 6 input nodes size: 84654
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19432973861694336  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19432973861694336  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.2346959114074707  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.23477840423583984  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.20256757736206055  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1686, 1: 1639, 2: 1388, 3: 1045, 4: 766, 5: 692, 6: 515, 7: 424, 8: 378, 9: 315, 10: 298, 11: 255, 12: 218, 13: 177, 15: 162, 14: 159, 18: 134, 17: 128, 16: 128, 21: 111, 19: 110, 20: 97, 22: 79, 23: 69, 24: 63})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.20728778839111328  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.20728778839111328  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 9.220572471618652  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 9.222358226776123  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.21179962158203125  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

pseudo mini batch 7 input nodes size: 67877
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.2049112319946289  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.2049112319946289  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.2381143569946289  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.23819971084594727  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.19775104522705078  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3006, 1: 1146, 2: 969, 3: 805, 4: 637, 5: 565, 6: 468, 7: 396, 9: 328, 10: 317, 8: 312, 12: 270, 11: 259, 13: 239, 16: 192, 14: 189, 15: 184, 20: 169, 18: 165, 19: 162, 17: 161, 21: 151, 24: 119, 23: 115, 22: 100})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.20351791381835938  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60107421875 GB
    Memory Allocated: 0.20351791381835938  GigaBytes
Max Memory Allocated: 12.099049091339111  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.14013671875 GB
    Memory Allocated: 11.355642795562744  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.14013671875 GB
    Memory Allocated: 11.357619285583496  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2082505226135254  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2082505226135254  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17519617080688477  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08860030770301819 |0.005263209342956543 |0.16065123677253723 |0.0001246631145477295 |0.34838488698005676 |0.004843711853027344 |
----------------------------------------------------------pseudo_mini_loss sum 5.009925842285156
Total (block generation + training)time/epoch 48.147073132651194
Training time/epoch 4.987158298492432
Training time without block to device /epoch 4.945052623748779
Training time without total dataloading part /epoch 4.078130006790161
load block tensor time/epoch 0.7088024616241455
block to device time/epoch 0.042105674743652344
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  659724
Number of first layer input nodes during this epoch:  423726
Number of first layer output nodes during this epoch:  235998
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16067981719970703  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.584 seconds, peak memory: 37.425 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 37.425 GB
Metis partitioning: 5.584 seconds, peak memory: 38.057 GB
Split the graph: 6.999 seconds
Construct subgraphs: 0.022 seconds
REG metis partition end ----................................
REG construction  time spent:  24.54900884628296
pure dgl.metis_partition the time spent:  14.23141074180603
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.813880205154419

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.6111047267913818

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16067981719970703  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

connection checking time:  1.597083568572998
block generation total time  2.424984931945801
average batch blocks generation time:  0.3031231164932251
block dataloader generation time/epoch 43.093912184238434
pseudo mini batch 0 input nodes size: 35187
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.15382814407348633  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.15382814407348633  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17140626907348633  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1714925765991211  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.13820409774780273  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 1249, 1: 1241, 3: 1106, 25: 965, 4: 959, 5: 792, 6: 702, 7: 614, 8: 516, 9: 456, 10: 422, 11: 387, 12: 313, 13: 277, 14: 232, 15: 189, 16: 176, 17: 171, 18: 154, 20: 127, 21: 113, 19: 110, 22: 104, 24: 78, 23: 73})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14072227478027344  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14072227478027344  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.199573516845703  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.201397895812988  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17300701141357422  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 1 input nodes size: 32878
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17093467712402344  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17093467712402344  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1873302459716797  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18741559982299805  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16975116729736328  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1703, 2: 1405, 3: 1216, 25: 988, 4: 932, 5: 781, 6: 623, 7: 524, 8: 452, 9: 385, 10: 340, 11: 297, 12: 247, 13: 226, 14: 206, 15: 191, 17: 156, 16: 137, 20: 118, 18: 117, 19: 107, 21: 103, 23: 71, 24: 69, 22: 61})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17211151123046875  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17211151123046875  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.781803131103516  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.783543109893799  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1742382049560547  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 2 input nodes size: 33594
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17225313186645508  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17225313186645508  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18877840042114258  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18886470794677734  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17238378524780273  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1811, 2: 1663, 3: 1298, 4: 1119, 5: 895, 6: 671, 7: 615, 8: 473, 25: 471, 9: 408, 10: 352, 11: 286, 12: 233, 13: 214, 14: 187, 15: 159, 16: 134, 18: 102, 17: 98, 19: 90, 20: 84, 21: 60, 22: 52, 23: 51, 24: 41})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17440414428710938  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17440414428710938  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.782287120819092  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.784200668334961  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17568492889404297  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 3 input nodes size: 44608
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17393255233764648  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17393255233764648  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19520330429077148  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19529008865356445  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1786785125732422  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1938, 2: 1691, 3: 1337, 4: 989, 5: 860, 6: 689, 25: 596, 7: 551, 8: 495, 9: 375, 10: 347, 11: 266, 12: 252, 13: 181, 14: 181, 15: 165, 17: 124, 16: 124, 18: 81, 19: 79, 21: 74, 20: 68, 23: 58, 22: 57, 24: 49})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18094110488891602  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18094110488891602  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.1421709060668945  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.143968105316162  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1828465461730957  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 4 input nodes size: 61030
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18065357208251953  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18065357208251953  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20995044708251953  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21003341674804688  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1886758804321289  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2008, 2: 1688, 3: 1358, 4: 1023, 5: 915, 6: 640, 25: 484, 7: 463, 8: 450, 9: 387, 10: 271, 11: 205, 12: 191, 13: 186, 14: 146, 15: 115, 16: 112, 17: 93, 18: 83, 19: 70, 20: 66, 21: 53, 22: 43, 24: 40, 23: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19102716445922852  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19102716445922852  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.857583045959473  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.859349727630615  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19285917282104492  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 5 input nodes size: 66759
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19019842147827148  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19019842147827148  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2220315933227539  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.22211456298828125  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1927347183227539  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1880, 2: 1586, 25: 1224, 3: 1120, 4: 858, 5: 740, 6: 568, 7: 454, 8: 420, 9: 331, 10: 278, 11: 257, 12: 209, 13: 164, 14: 138, 15: 131, 16: 110, 18: 108, 19: 104, 17: 100, 20: 92, 21: 68, 22: 66, 24: 61, 23: 44})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1959223747253418  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1959223747253418  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.604936122894287  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.606653213500977  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1988997459411621  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 6 input nodes size: 86135
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19509601593017578  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19509601593017578  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23616838455200195  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2362508773803711  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20433473587036133  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1835, 1: 1603, 2: 1392, 3: 1017, 4: 759, 5: 658, 6: 495, 7: 421, 8: 338, 9: 301, 10: 287, 11: 239, 12: 229, 13: 180, 15: 160, 14: 153, 18: 141, 16: 140, 19: 129, 17: 118, 21: 102, 20: 99, 24: 86, 22: 78, 23: 75})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20914459228515625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20914459228515625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 9.510119438171387  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 9.512065410614014  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21358966827392578  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 7 input nodes size: 67196
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20696687698364258  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20696687698364258  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23900842666625977  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23909425735473633  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19793939590454102  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2897, 1: 1244, 2: 1032, 3: 825, 4: 681, 5: 581, 6: 480, 7: 403, 9: 333, 8: 328, 10: 302, 11: 266, 12: 263, 13: 228, 14: 191, 15: 179, 16: 178, 17: 170, 18: 162, 20: 153, 19: 147, 21: 144, 23: 109, 24: 101, 22: 95})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20311594009399414  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20311594009399414  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 11.083892345428467  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 11.08587646484375  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20799493789672852  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20799493789672852  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1740403175354004  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08979353308677673 |0.004854470491409302 |0.16127610206604004 |0.0001271367073059082 |0.34905877709388733 |0.005737781524658203 |
----------------------------------------------------------pseudo_mini_loss sum 5.755606651306152
Total (block generation + training)time/epoch 48.20794486999512
Training time/epoch 4.9852454662323
Training time without block to device /epoch 4.946409702301025
Training time without total dataloading part /epoch 4.089433908462524
load block tensor time/epoch 0.7183482646942139
block to device time/epoch 0.038835763931274414
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  663394
Number of first layer input nodes during this epoch:  427387
Number of first layer output nodes during this epoch:  236007
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1594395637512207  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.500 seconds, peak memory: 38.309 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.309 GB
Metis partitioning: 5.520 seconds, peak memory: 38.309 GB
Split the graph: 7.895 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  25.240663051605225
pure dgl.metis_partition the time spent:  14.964807748794556
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8944292068481445

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.7950029373168945

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1594395637512207  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

connection checking time:  1.945906162261963
block generation total time  2.689432144165039
average batch blocks generation time:  0.3361790180206299
block dataloader generation time/epoch 43.38138633304172
pseudo mini batch 0 input nodes size: 55150
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1524648666381836  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1524648666381836  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17876243591308594  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1788482666015625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14672088623046875  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2076, 2: 1774, 3: 1323, 4: 1028, 5: 874, 6: 677, 25: 578, 7: 513, 8: 451, 9: 362, 10: 322, 11: 227, 12: 197, 13: 180, 14: 150, 15: 142, 16: 114, 17: 92, 18: 90, 19: 80, 20: 75, 21: 51, 23: 48, 24: 44, 22: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14907455444335938  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14907455444335938  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.003056049346924  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.00494909286499  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1808910369873047  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 1 input nodes size: 65580
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17836856842041016  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17836856842041016  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2096395492553711  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20972299575805664  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18333959579467773  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1904, 2: 1564, 25: 1278, 3: 1138, 4: 833, 5: 764, 6: 589, 7: 453, 8: 391, 9: 342, 10: 287, 11: 247, 12: 214, 13: 167, 14: 140, 15: 123, 18: 107, 19: 101, 16: 101, 17: 99, 20: 86, 21: 76, 22: 72, 24: 67, 23: 45})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18654394149780273  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18654394149780273  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.603586673736572  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.605834007263184  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18942880630493164  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 2 input nodes size: 68245
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1856393814086914  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1856393814086914  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21818113327026367  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21826744079589844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18691301345825195  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2925, 1: 1177, 2: 1026, 3: 841, 4: 674, 5: 603, 6: 467, 7: 384, 8: 346, 9: 324, 10: 315, 11: 273, 12: 269, 13: 226, 14: 194, 15: 180, 16: 180, 18: 174, 17: 172, 19: 159, 20: 157, 21: 153, 23: 113, 24: 106, 22: 90})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1921405792236328  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1921405792236328  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 11.231958389282227  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 11.233984470367432  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19666004180908203  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 3 input nodes size: 84374
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19014787673950195  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19014787673950195  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23038053512573242  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23046302795410156  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19783496856689453  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1746, 1: 1656, 2: 1376, 3: 1017, 4: 788, 5: 687, 6: 488, 7: 433, 8: 365, 9: 306, 10: 271, 11: 244, 12: 222, 13: 193, 14: 160, 15: 155, 16: 147, 18: 130, 17: 116, 19: 110, 20: 102, 21: 96, 22: 82, 24: 75, 23: 70})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20258140563964844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20258140563964844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 9.350617408752441  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 9.3525710105896  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2079315185546875  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 4 input nodes size: 31006
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20052242279052734  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20052242279052734  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21614742279052734  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2162308692932129  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17591571807861328  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1326, 2: 1299, 3: 1112, 4: 950, 25: 779, 5: 772, 6: 686, 7: 587, 8: 488, 9: 436, 10: 388, 11: 360, 12: 291, 13: 255, 14: 231, 16: 170, 17: 164, 15: 162, 18: 139, 20: 119, 19: 109, 21: 107, 22: 87, 24: 75, 23: 73})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1781930923461914  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1781930923461914  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.644852638244629  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.646714687347412  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17943477630615234  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 5 input nodes size: 32322
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17760276794433594  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17760276794433594  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19322776794433594  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1933121681213379  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17760372161865234  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1746, 2: 1460, 3: 1226, 25: 938, 4: 927, 5: 779, 6: 597, 7: 522, 8: 431, 9: 380, 10: 329, 11: 280, 12: 229, 13: 205, 14: 188, 15: 173, 17: 155, 16: 140, 20: 114, 18: 106, 19: 100, 21: 98, 23: 68, 24: 65, 22: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17988061904907227  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17988061904907227  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.534715175628662  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.536470413208008  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1816878318786621  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 6 input nodes size: 48446
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17976713180541992  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17976713180541992  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20320463180541992  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2032918930053711  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18758249282836914  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1654, 2: 1547, 3: 1248, 4: 1013, 25: 857, 5: 849, 6: 644, 7: 559, 8: 516, 9: 409, 10: 351, 11: 282, 12: 276, 14: 212, 13: 210, 15: 199, 16: 142, 17: 138, 18: 125, 19: 96, 20: 88, 21: 85, 22: 79, 23: 62, 24: 55})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19012784957885742  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19012784957885742  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.910681247711182  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.912436485290527  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19228887557983398  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 7 input nodes size: 32613
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1898512840270996  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1898512840270996  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2054762840270996  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20556211471557617  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.182037353515625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1889, 2: 1660, 3: 1372, 4: 1107, 5: 894, 6: 720, 7: 594, 8: 484, 9: 417, 25: 359, 10: 336, 11: 290, 12: 239, 13: 220, 14: 159, 15: 155, 16: 117, 17: 94, 19: 81, 18: 77, 20: 66, 21: 51, 22: 48, 23: 40, 24: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18396568298339844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18396568298339844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.504006862640381  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.505735397338867  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1853036880493164  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1853036880493164  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.15224933624267578  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0905049741268158 |0.0049845874309539795 |0.16937291622161865 |0.00013464689254760742 |0.3482832908630371 |0.0023550987243652344 |
----------------------------------------------------------pseudo_mini_loss sum 4.573921203613281
Total (block generation + training)time/epoch 48.48970217174954
Training time/epoch 5.062213659286499
Training time without block to device /epoch 5.022336959838867
Training time without total dataloading part /epoch 4.144681930541992
load block tensor time/epoch 0.7240397930145264
block to device time/epoch 0.039876699447631836
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  652006
Number of first layer input nodes during this epoch:  417736
Number of first layer output nodes during this epoch:  234270
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.13611173629760742  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.573 seconds, peak memory: 38.464 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.464 GB
Metis partitioning: 5.380 seconds, peak memory: 38.464 GB
Split the graph: 7.300 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  26.19842839241028
pure dgl.metis_partition the time spent:  14.3069326877594
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8152086734771729

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.7947759628295898

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.13611173629760742  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

connection checking time:  1.610888957977295
block generation total time  2.6099846363067627
average batch blocks generation time:  0.32624807953834534
block dataloader generation time/epoch 43.59315111637115
pseudo mini batch 0 input nodes size: 52397
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.13440465927124023  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.13440465927124023  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.15938949584960938  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.15947294235229492  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14376211166381836  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1878, 2: 1520, 3: 1256, 4: 950, 5: 884, 25: 674, 6: 614, 7: 517, 8: 470, 9: 375, 10: 319, 11: 253, 12: 234, 13: 196, 14: 188, 15: 138, 16: 134, 17: 110, 18: 87, 19: 84, 20: 79, 21: 53, 24: 50, 23: 47, 22: 47})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1461329460144043  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1461329460144043  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.160645008087158  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.162374019622803  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1794719696044922  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 1 input nodes size: 71845
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17702674865722656  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17702674865722656  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21128511428833008  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21136951446533203  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18630123138427734  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1950, 2: 1614, 25: 1183, 3: 1173, 4: 889, 5: 772, 6: 585, 7: 470, 8: 415, 9: 329, 10: 280, 11: 241, 12: 200, 13: 170, 14: 134, 15: 125, 16: 117, 18: 105, 19: 103, 17: 97, 20: 84, 21: 82, 24: 70, 22: 64, 23: 47})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18957948684692383  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18957948684692383  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.639737606048584  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.641530990600586  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19236278533935547  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 2 input nodes size: 82969
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18836498260498047  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18836498260498047  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.22792768478393555  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2280101776123047  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19366741180419922  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1819, 1: 1616, 2: 1370, 3: 989, 4: 804, 5: 646, 6: 491, 7: 401, 8: 327, 9: 321, 10: 296, 11: 265, 12: 220, 13: 184, 15: 164, 14: 157, 18: 144, 16: 144, 17: 138, 19: 121, 20: 104, 21: 96, 22: 84, 24: 71, 23: 63})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19843816757202148  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19843816757202148  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 9.401639461517334  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 9.403361797332764  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2029428482055664  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 3 input nodes size: 66936
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19636249542236328  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19636249542236328  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.22828006744384766  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2283644676208496  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1887192726135254  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2945, 1: 1186, 2: 989, 3: 784, 4: 629, 5: 571, 6: 480, 7: 374, 9: 329, 8: 326, 10: 298, 12: 269, 11: 250, 13: 229, 14: 188, 16: 180, 15: 175, 18: 162, 20: 160, 17: 156, 21: 152, 19: 150, 23: 118, 24: 110, 22: 99})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19394207000732422  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19394207000732422  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 11.142868041992188  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 11.144649982452393  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19776296615600586  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 4 input nodes size: 32664
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1918654441833496  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1918654441833496  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2074904441833496  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20757675170898438  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17557477951049805  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1614, 2: 1414, 3: 1202, 25: 987, 4: 927, 5: 804, 6: 621, 7: 562, 8: 480, 9: 411, 10: 366, 11: 313, 12: 254, 13: 227, 14: 209, 15: 192, 17: 161, 16: 148, 20: 117, 18: 114, 21: 110, 19: 107, 23: 75, 24: 67, 22: 62})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17795944213867188  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17795944213867188  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.85250186920166  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.854226589202881  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17978382110595703  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 5 input nodes size: 37387
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17780113220214844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17780113220214844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19562864303588867  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19571495056152344  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18000364303588867  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 1383, 1: 1379, 3: 1196, 4: 1016, 25: 848, 5: 822, 6: 715, 7: 575, 8: 475, 9: 418, 10: 396, 11: 331, 12: 291, 13: 251, 14: 228, 15: 173, 16: 162, 17: 159, 18: 148, 20: 118, 19: 107, 21: 107, 22: 90, 24: 75, 23: 67})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18242931365966797  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18242931365966797  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.911988258361816  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.913735866546631  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1842975616455078  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 6 input nodes size: 40707
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18222808837890625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18222808837890625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20175933837890625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20184564590454102  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18393182754516602  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1915, 2: 1726, 3: 1352, 4: 1036, 5: 876, 6: 682, 7: 559, 25: 546, 8: 496, 9: 379, 10: 310, 11: 242, 12: 239, 13: 181, 14: 175, 15: 158, 17: 117, 16: 113, 18: 93, 19: 80, 21: 66, 20: 63, 23: 60, 22: 58, 24: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1860790252685547  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1860790252685547  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.9391679763793945  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.940938472747803  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18814754486083984  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 7 input nodes size: 34854
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1861248016357422  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1861248016357422  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2037029266357422  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20378875732421875  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18417119979858398  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1890, 2: 1690, 3: 1325, 4: 1069, 5: 847, 6: 680, 7: 587, 8: 483, 25: 458, 9: 414, 10: 334, 11: 308, 12: 230, 13: 218, 15: 164, 14: 155, 16: 113, 18: 95, 17: 92, 19: 84, 20: 82, 22: 52, 21: 51, 23: 42, 24: 40})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18616247177124023  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18616247177124023  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.678126335144043  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.679870128631592  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1873183250427246  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1873183250427246  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.15426397323608398  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09146007895469666 |0.006622016429901123 |0.17135486006736755 |0.00014039874076843262 |0.34789544343948364 |0.005055427551269531 |
----------------------------------------------------------pseudo_mini_loss sum 3.8711228370666504
Total (block generation + training)time/epoch 48.69994587898255
Training time/epoch 5.0927581787109375
Training time without block to device /epoch 5.0397820472717285
Training time without total dataloading part /epoch 4.160181045532227
load block tensor time/epoch 0.7316806316375732
block to device time/epoch 0.052976131439208984
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  653064
Number of first layer input nodes during this epoch:  419759
Number of first layer output nodes during this epoch:  233305
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.13818597793579102  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.465 seconds, peak memory: 38.464 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.464 GB
Metis partitioning: 5.044 seconds, peak memory: 38.464 GB
Split the graph: 7.066 seconds
Construct subgraphs: 0.022 seconds
REG metis partition end ----................................
REG construction  time spent:  23.494717121124268
pure dgl.metis_partition the time spent:  13.626522541046143
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7733185291290283

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.57633638381958

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.13818597793579102  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

connection checking time:  1.5130057334899902
block generation total time  2.3496549129486084
average batch blocks generation time:  0.29370686411857605
block dataloader generation time/epoch 43.427540670741685
pseudo mini batch 0 input nodes size: 34421
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.13643312454223633  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.13643312454223633  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1528463363647461  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.15293169021606445  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1352677345275879  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 1391, 1: 1385, 3: 1150, 4: 1003, 5: 820, 25: 743, 6: 702, 7: 578, 8: 500, 9: 456, 10: 393, 11: 365, 12: 304, 13: 256, 14: 223, 15: 170, 16: 162, 17: 158, 18: 139, 19: 113, 20: 111, 21: 99, 22: 86, 23: 74, 24: 68})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.13759088516235352  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.13759088516235352  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.621514320373535  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.623258590698242  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17061233520507812  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 1 input nodes size: 32573
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16868162155151367  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16868162155151367  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18430662155151367  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18439197540283203  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1678934097290039  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1604, 2: 1353, 3: 1178, 25: 1032, 4: 911, 5: 768, 6: 627, 7: 538, 8: 471, 9: 399, 10: 362, 11: 309, 12: 250, 13: 237, 14: 206, 15: 191, 17: 163, 16: 150, 20: 130, 18: 120, 21: 109, 19: 108, 23: 73, 24: 70, 22: 64})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1703023910522461  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1703023910522461  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.870034217834473  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.871774196624756  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17209339141845703  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 2 input nodes size: 47608
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17008352279663086  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17008352279663086  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19352102279663086  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19360780715942383  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17789745330810547  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1608, 2: 1422, 3: 1153, 4: 987, 25: 972, 5: 815, 6: 626, 7: 552, 8: 540, 9: 408, 10: 371, 11: 294, 12: 275, 13: 228, 14: 210, 15: 198, 16: 154, 17: 149, 18: 113, 19: 111, 20: 108, 21: 89, 22: 86, 24: 65, 23: 64})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1805253028869629  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1805253028869629  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.155847549438477  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.15774393081665  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1827244758605957  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 3 input nodes size: 30775
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18023920059204102  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18023920059204102  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19586420059204102  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19595098495483398  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17242670059204102  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2069, 2: 1787, 3: 1416, 4: 1083, 5: 894, 6: 718, 7: 592, 8: 444, 9: 389, 25: 329, 10: 319, 11: 265, 12: 212, 13: 191, 14: 159, 15: 156, 16: 104, 17: 89, 18: 88, 19: 61, 20: 58, 21: 49, 23: 42, 22: 41, 24: 37})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17426395416259766  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17426395416259766  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.256481647491455  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.2584428787231445  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1756906509399414  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 4 input nodes size: 66769
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1740856170654297  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1740856170654297  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20592355728149414  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2060093879699707  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19029760360717773  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2981, 1: 1239, 2: 1013, 3: 854, 4: 670, 5: 588, 6: 456, 7: 367, 9: 328, 8: 309, 10: 290, 12: 266, 11: 264, 13: 223, 15: 196, 14: 188, 16: 173, 17: 172, 18: 167, 20: 159, 19: 148, 21: 145, 23: 122, 24: 108, 22: 94})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19562005996704102  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19562005996704102  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 11.21295976638794  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 11.214974403381348  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1996469497680664  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 5 input nodes size: 83900
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19351959228515625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19351959228515625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23352622985839844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23360872268676758  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20168495178222656  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2200, 1: 1455, 2: 1208, 3: 940, 4: 710, 5: 643, 6: 511, 7: 403, 8: 338, 9: 301, 10: 290, 11: 259, 12: 224, 13: 187, 14: 164, 16: 155, 18: 152, 15: 151, 19: 141, 17: 125, 21: 117, 20: 109, 24: 94, 22: 90, 23: 68})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20667743682861328  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20667743682861328  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 10.178926944732666  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 10.18066692352295  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21122217178344727  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 6 input nodes size: 70050
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20456409454345703  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20456409454345703  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23796653747558594  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23804950714111328  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19796037673950195  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1962, 2: 1672, 3: 1207, 4: 903, 5: 841, 25: 762, 6: 624, 7: 517, 8: 439, 9: 343, 10: 289, 11: 237, 12: 203, 13: 165, 14: 142, 15: 115, 16: 111, 18: 95, 19: 88, 17: 86, 20: 77, 21: 62, 22: 57, 24: 50, 23: 41})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20086002349853516  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20086002349853516  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.772614479064941  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.774445533752441  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2034287452697754  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 7 input nodes size: 57818
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19986438751220703  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19986438751220703  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2274341583251953  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.22751808166503906  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1940326690673828  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2106, 2: 1860, 3: 1379, 4: 1053, 5: 853, 6: 604, 7: 498, 25: 441, 8: 431, 9: 352, 10: 285, 11: 210, 12: 203, 13: 169, 14: 142, 15: 112, 16: 102, 17: 88, 18: 74, 19: 66, 20: 55, 21: 47, 22: 38, 23: 35, 24: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19628047943115234  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19628047943115234  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.667897701263428  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.669717788696289  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1980123519897461  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1980123519897461  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16495800018310547  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08955803513526917 |0.004119575023651123 |0.1676991879940033 |0.0001315772533416748 |0.34822794795036316 |0.002102375030517578 |
----------------------------------------------------------pseudo_mini_loss sum 3.837811231613159
Total (block generation + training)time/epoch 48.528134476054795
Training time/epoch 5.038316965103149
Training time without block to device /epoch 5.00536036491394
Training time without total dataloading part /epoch 4.130572080612183
load block tensor time/epoch 0.7164642810821533
block to device time/epoch 0.032956600189208984
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  658943
Number of first layer input nodes during this epoch:  423914
Number of first layer output nodes during this epoch:  235029
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14873552322387695  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.454 seconds, peak memory: 38.477 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.477 GB
Metis partitioning: 5.037 seconds, peak memory: 38.477 GB
Split the graph: 6.935 seconds
Construct subgraphs: 0.017 seconds
REG metis partition end ----................................
REG construction  time spent:  23.713065147399902
pure dgl.metis_partition the time spent:  13.471961498260498
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7613766193389893

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.5729975700378418

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14873552322387695  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

connection checking time:  1.529071569442749
block generation total time  2.334374189376831
average batch blocks generation time:  0.2917967736721039
block dataloader generation time/epoch 43.29009431600571
pseudo mini batch 0 input nodes size: 31677
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14621734619140625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14621734619140625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16184234619140625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16192913055419922  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1342754364013672  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1910, 2: 1758, 3: 1404, 4: 1094, 5: 926, 6: 721, 7: 610, 8: 489, 9: 399, 25: 348, 10: 333, 11: 269, 12: 240, 13: 197, 14: 160, 15: 157, 16: 107, 17: 94, 18: 86, 19: 72, 20: 64, 22: 46, 21: 44, 24: 43, 23: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1361832618713379  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1361832618713379  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.420584678649902  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.422859191894531  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16914987564086914  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 1 input nodes size: 48028
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1674661636352539  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1674661636352539  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1909036636352539  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19099044799804688  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1752786636352539  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1732, 2: 1512, 3: 1210, 4: 978, 25: 892, 5: 802, 6: 631, 7: 555, 8: 515, 9: 399, 10: 356, 11: 286, 12: 264, 13: 222, 14: 211, 15: 181, 16: 140, 17: 131, 18: 110, 20: 97, 19: 90, 22: 84, 21: 79, 23: 69, 24: 57})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17780828475952148  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17780828475952148  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.864017486572266  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.86576509475708  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17994451522827148  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 2 input nodes size: 32248
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1775350570678711  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1775350570678711  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1931600570678711  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19324398040771484  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16971969604492188  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1565, 2: 1325, 3: 1169, 25: 1008, 4: 897, 5: 776, 6: 621, 7: 536, 8: 460, 9: 390, 10: 349, 11: 307, 12: 260, 13: 222, 14: 201, 15: 192, 17: 161, 16: 145, 20: 123, 18: 117, 21: 107, 19: 104, 23: 72, 24: 70, 22: 63})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17209434509277344  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17209434509277344  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.803058624267578  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.804844379425049  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17374038696289062  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 3 input nodes size: 33137
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17174863815307617  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17174863815307617  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18754959106445312  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1876368522644043  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17192792892456055  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 1414, 1: 1388, 3: 1169, 4: 1037, 5: 822, 25: 781, 6: 725, 7: 580, 8: 505, 9: 466, 10: 416, 11: 354, 12: 293, 13: 259, 14: 232, 15: 170, 16: 170, 17: 168, 18: 146, 19: 119, 20: 117, 21: 108, 22: 84, 23: 79, 24: 69})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17427492141723633  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17427492141723633  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.852780818939209  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.854665756225586  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17616796493530273  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 4 input nodes size: 57964
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1742687225341797  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1742687225341797  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20190811157226562  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20199155807495117  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18610334396362305  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2107, 2: 1728, 3: 1365, 4: 1021, 5: 849, 6: 624, 25: 520, 7: 481, 8: 431, 9: 346, 10: 279, 11: 218, 12: 190, 13: 173, 14: 143, 16: 127, 15: 117, 17: 87, 19: 83, 18: 78, 20: 56, 21: 51, 22: 36, 23: 34, 24: 34})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18839693069458008  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18839693069458008  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.795200347900391  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.796879291534424  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19015073776245117  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 5 input nodes size: 65906
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18761062622070312  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18761062622070312  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21903705596923828  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21912097930908203  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19139814376831055  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1936, 2: 1579, 25: 1186, 3: 1164, 4: 875, 5: 771, 6: 576, 7: 483, 8: 424, 9: 326, 10: 275, 11: 261, 12: 202, 13: 161, 14: 132, 15: 119, 16: 115, 18: 110, 19: 101, 17: 101, 20: 99, 24: 66, 21: 62, 22: 58, 23: 41})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1945500373840332  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1945500373840332  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.462889194488525  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.464568138122559  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19742918014526367  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 6 input nodes size: 68494
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1936798095703125  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1936798095703125  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.22634029388427734  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2264251708984375  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1949148178100586  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2937, 1: 1222, 2: 995, 3: 800, 4: 647, 5: 559, 6: 459, 7: 395, 9: 334, 8: 332, 10: 313, 12: 271, 11: 270, 13: 224, 14: 197, 15: 177, 16: 174, 17: 162, 18: 156, 19: 148, 21: 144, 20: 143, 24: 114, 23: 107, 22: 102})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20064592361450195  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20064592361450195  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 11.170081615447998  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 11.171924591064453  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20466136932373047  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 7 input nodes size: 83803
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19823694229125977  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19823694229125977  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23819732666015625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2382798194885254  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2055344581604004  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1788, 1: 1568, 2: 1395, 3: 996, 4: 771, 5: 717, 6: 511, 7: 405, 9: 316, 8: 316, 10: 278, 11: 238, 12: 217, 13: 198, 15: 176, 14: 158, 18: 145, 16: 133, 17: 126, 21: 122, 19: 119, 20: 108, 22: 83, 23: 79, 24: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2102971076965332  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2102971076965332  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 9.421265125274658  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 9.423279762268066  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21479082107543945  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21479082107543945  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18173646926879883  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08975803852081299 |0.0042791664600372314 |0.1674519181251526 |0.00012293457984924316 |0.3488078713417053 |0.0017504692077636719 |
----------------------------------------------------------pseudo_mini_loss sum 3.60932993888855
Total (block generation + training)time/epoch 48.38474331299464
Training time/epoch 5.0290045738220215
Training time without block to device /epoch 4.994771242141724
Training time without total dataloading part /epoch 4.132812261581421
load block tensor time/epoch 0.7180643081665039
block to device time/epoch 0.03423333168029785
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  655151
Number of first layer input nodes during this epoch:  421257
Number of first layer output nodes during this epoch:  233894
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1664261817932129  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.447 seconds, peak memory: 38.477 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.477 GB
Metis partitioning: 5.004 seconds, peak memory: 38.477 GB
Split the graph: 6.901 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
REG construction  time spent:  23.648665189743042
pure dgl.metis_partition the time spent:  13.400232791900635
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7590134143829346

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.564457654953003

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1664261817932129  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

connection checking time:  1.5221989154815674
block generation total time  2.3234710693359375
average batch blocks generation time:  0.2904338836669922
block dataloader generation time/epoch 43.158468796656685
pseudo mini batch 0 input nodes size: 30765
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1598515510559082  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1598515510559082  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1754765510559082  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17556333541870117  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.13552045822143555  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1497, 2: 1318, 3: 1135, 25: 997, 4: 916, 5: 816, 6: 700, 7: 593, 8: 496, 9: 421, 10: 403, 11: 338, 12: 266, 13: 254, 14: 225, 17: 183, 15: 178, 16: 157, 20: 134, 18: 123, 21: 112, 19: 104, 23: 77, 24: 74, 22: 69})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.13794517517089844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.13794517517089844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.994338512420654  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.996353626251221  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17013883590698242  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 1 input nodes size: 38840
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16817378997802734  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16817378997802734  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18669414520263672  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18677949905395508  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1710677146911621  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1533, 2: 1406, 3: 1196, 4: 946, 25: 926, 5: 770, 6: 596, 7: 507, 8: 475, 9: 419, 10: 374, 11: 344, 12: 287, 13: 240, 14: 202, 15: 193, 17: 147, 16: 142, 18: 138, 20: 114, 21: 110, 19: 110, 22: 90, 24: 70, 23: 65})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1735234260559082  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1735234260559082  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.871847629547119  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.873740196228027  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1756739616394043  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 2 input nodes size: 33980
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1735210418701172  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1735210418701172  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18972396850585938  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18981027603149414  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1712045669555664  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2154, 2: 1909, 3: 1489, 4: 1107, 5: 898, 6: 684, 7: 577, 8: 424, 9: 375, 25: 313, 10: 277, 11: 223, 12: 198, 13: 148, 14: 141, 15: 126, 16: 98, 17: 90, 18: 81, 19: 52, 21: 44, 22: 41, 20: 39, 23: 39, 24: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17298364639282227  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17298364639282227  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.0604071617126465  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.062562942504883  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1739640235900879  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 3 input nodes size: 34684
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17236804962158203  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17236804962158203  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18890666961669922  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18899297714233398  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17270374298095703  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1654, 2: 1601, 3: 1293, 4: 1082, 5: 847, 6: 692, 7: 576, 25: 534, 8: 534, 9: 410, 10: 378, 11: 298, 12: 258, 13: 247, 14: 193, 15: 182, 16: 131, 19: 113, 17: 109, 18: 94, 20: 87, 21: 68, 22: 58, 23: 57, 24: 47})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17484617233276367  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17484617233276367  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.080854415893555  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.082594394683838  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17680120468139648  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 4 input nodes size: 57001
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17492008209228516  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17492008209228516  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20226383209228516  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20234918594360352  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18572425842285156  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1874, 2: 1536, 3: 1255, 4: 998, 5: 899, 25: 741, 6: 668, 7: 542, 8: 480, 9: 380, 10: 320, 12: 248, 11: 240, 13: 191, 14: 183, 16: 158, 15: 136, 17: 118, 18: 101, 19: 91, 20: 81, 21: 63, 22: 52, 23: 48, 24: 45})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18830108642578125  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18830108642578125  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.611104965209961  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.612936496734619  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19019317626953125  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 5 input nodes size: 70243
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1874384880065918  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1874384880065918  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2209329605102539  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.22101593017578125  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1935868263244629  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2062, 2: 1700, 3: 1198, 4: 929, 25: 805, 5: 794, 6: 594, 7: 471, 8: 417, 9: 325, 10: 270, 11: 238, 12: 188, 13: 169, 15: 127, 14: 119, 17: 101, 16: 100, 19: 89, 18: 89, 20: 82, 21: 58, 24: 52, 23: 51, 22: 48})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19649791717529297  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19649791717529297  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.76575231552124  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.767541885375977  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19893264770507812  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 6 input nodes size: 84255
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1953411102294922  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1953411102294922  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23551702499389648  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23559951782226562  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20202207565307617  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2286, 1: 1340, 2: 1232, 3: 892, 4: 687, 5: 641, 6: 494, 7: 412, 8: 329, 9: 317, 10: 287, 11: 259, 12: 221, 13: 198, 14: 190, 15: 177, 16: 154, 18: 153, 19: 136, 17: 131, 21: 125, 20: 119, 22: 97, 24: 91, 23: 68})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20708751678466797  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20708751678466797  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 10.404365539550781  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 10.406036853790283  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21164703369140625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 7 input nodes size: 66751
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20496177673339844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20496177673339844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23679113388061523  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2368755340576172  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19661712646484375  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2858, 1: 1314, 2: 1004, 3: 819, 4: 655, 5: 557, 6: 440, 7: 367, 9: 329, 8: 317, 10: 290, 12: 271, 11: 263, 13: 209, 14: 181, 16: 171, 15: 170, 18: 169, 20: 151, 17: 151, 19: 141, 21: 137, 23: 114, 24: 111, 22: 101})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20187664031982422  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20187664031982422  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 10.88884162902832  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 10.890577793121338  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20640850067138672  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20640850067138672  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1733541488647461  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0877453088760376 |0.004451960325241089 |0.1735585629940033 |0.00013902783393859863 |0.34590667486190796 |0.0050923824310302734 |
----------------------------------------------------------pseudo_mini_loss sum 3.767008066177368
Total (block generation + training)time/epoch 48.249459945238556
Training time/epoch 5.046784162521362
Training time without block to device /epoch 5.011168479919434
Training time without total dataloading part /epoch 4.161926507949829
load block tensor time/epoch 0.7019624710083008
block to device time/epoch 0.03561568260192871
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  649810
Number of first layer input nodes during this epoch:  416519
Number of first layer output nodes during this epoch:  233291
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.15869665145874023  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.413 seconds, peak memory: 38.477 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.477 GB
Metis partitioning: 4.927 seconds, peak memory: 38.477 GB
Split the graph: 7.112 seconds
Construct subgraphs: 0.010 seconds
REG metis partition end ----................................
REG construction  time spent:  24.140655040740967
pure dgl.metis_partition the time spent:  13.49159860610962
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7457275390625

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.5495812892913818

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.15869665145874023  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

connection checking time:  1.5049498081207275
block generation total time  2.295308828353882
average batch blocks generation time:  0.28691360354423523
block dataloader generation time/epoch 43.084879466465544
pseudo mini batch 0 input nodes size: 67783
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.15209150314331055  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.15209150314331055  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18441295623779297  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18449974060058594  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1525859832763672  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2852, 1: 1322, 2: 1092, 3: 878, 4: 688, 5: 598, 6: 467, 7: 407, 9: 341, 8: 315, 10: 298, 11: 266, 12: 257, 13: 216, 14: 193, 15: 188, 16: 168, 17: 167, 18: 165, 20: 153, 21: 149, 19: 137, 23: 121, 24: 108, 22: 99})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1577587127685547  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1577587127685547  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 11.020845890045166  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 11.023440837860107  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19399261474609375  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 1 input nodes size: 83609
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18741989135742188  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18741989135742188  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.22728776931762695  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2273702621459961  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1949620246887207  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2241, 1: 1406, 2: 1225, 3: 922, 4: 720, 5: 634, 6: 484, 7: 411, 8: 359, 9: 306, 10: 272, 12: 242, 11: 242, 13: 200, 14: 164, 16: 161, 15: 156, 18: 154, 19: 145, 17: 119, 20: 114, 21: 104, 22: 95, 24: 90, 23: 69})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19997119903564453  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19997119903564453  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 10.233009815216064  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 10.23479175567627  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20440244674682617  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 2 input nodes size: 58654
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19774532318115234  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19774532318115234  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.22571372985839844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2257976531982422  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18584728240966797  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2009, 2: 1736, 3: 1357, 4: 1031, 5: 877, 6: 642, 7: 502, 25: 500, 8: 447, 9: 380, 10: 303, 11: 229, 12: 192, 13: 187, 14: 148, 15: 121, 16: 105, 17: 93, 18: 75, 19: 74, 20: 65, 21: 47, 24: 37, 23: 34, 22: 34})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1881856918334961  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1881856918334961  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.872631072998047  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.874382972717285  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1901717185974121  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 3 input nodes size: 70782
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1875591278076172  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1875591278076172  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.22131061553955078  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.22139310836791992  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19334077835083008  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2021, 2: 1664, 3: 1225, 4: 929, 5: 835, 25: 797, 6: 613, 7: 474, 8: 404, 9: 322, 10: 270, 11: 243, 12: 193, 13: 156, 15: 123, 14: 120, 16: 104, 17: 94, 19: 86, 18: 83, 20: 77, 21: 69, 24: 56, 22: 53, 23: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19627952575683594  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19627952575683594  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.787907600402832  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.7896647453308105  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1989154815673828  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 4 input nodes size: 47516
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19526338577270508  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19526338577270508  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21870088577270508  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21878767013549805  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1849536895751953  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1527, 2: 1398, 3: 1108, 25: 987, 4: 962, 5: 783, 6: 642, 7: 565, 8: 546, 9: 419, 10: 403, 11: 308, 12: 283, 13: 246, 14: 241, 15: 206, 17: 157, 16: 153, 18: 140, 19: 116, 20: 114, 21: 96, 22: 91, 23: 78, 24: 67})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18761873245239258  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18761873245239258  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.321517467498779  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.323326110839844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18971014022827148  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 5 input nodes size: 30650
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1872396469116211  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1872396469116211  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20185470581054688  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20194101333618164  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17841672897338867  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1938, 2: 1755, 3: 1353, 4: 1080, 5: 901, 6: 708, 7: 613, 8: 472, 9: 398, 25: 372, 10: 343, 11: 279, 12: 247, 13: 191, 14: 164, 15: 162, 16: 119, 17: 94, 18: 84, 19: 73, 20: 58, 22: 49, 21: 45, 23: 38, 24: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18032360076904297  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18032360076904297  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.462554454803467  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.464365005493164  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18233203887939453  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 6 input nodes size: 32795
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1806626319885254  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1806626319885254  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19630050659179688  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19638395309448242  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18168258666992188  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1425, 2: 1349, 3: 1157, 4: 947, 25: 824, 5: 795, 6: 670, 7: 535, 8: 470, 9: 418, 10: 374, 11: 340, 12: 270, 13: 238, 14: 207, 16: 168, 17: 156, 15: 155, 18: 140, 20: 108, 19: 107, 21: 104, 22: 80, 23: 74, 24: 70})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18396759033203125  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18396759033203125  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.588385581970215  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.5905375480651855  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18514347076416016  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 7 input nodes size: 33345
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.183258056640625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.183258056640625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1991581916809082  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19924497604370117  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18352365493774414  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1780, 2: 1487, 3: 1277, 4: 963, 25: 887, 5: 799, 6: 642, 7: 538, 8: 459, 9: 392, 10: 336, 11: 296, 12: 253, 13: 222, 14: 197, 15: 178, 17: 150, 16: 133, 20: 118, 18: 107, 21: 103, 19: 98, 23: 63, 24: 61, 22: 55})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18582439422607422  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18582439422607422  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.573648452758789  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.575441837310791  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18770790100097656  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18770790100097656  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.15297508239746094  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09058642387390137 |0.004376620054244995 |0.1663435399532318 |0.00011670589447021484 |0.3474394977092743 |0.0020589828491210938 |
----------------------------------------------------------pseudo_mini_loss sum 3.6029975414276123
Total (block generation + training)time/epoch 48.170756697654724
Training time/epoch 5.019185304641724
Training time without block to device /epoch 4.984172344207764
Training time without total dataloading part /epoch 4.113256931304932
load block tensor time/epoch 0.7246913909912109
block to device time/epoch 0.03501296043395996
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  661090
Number of first layer input nodes during this epoch:  425134
Number of first layer output nodes during this epoch:  235956
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1372065544128418  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.462 seconds, peak memory: 38.477 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.477 GB
Metis partitioning: 5.085 seconds, peak memory: 38.477 GB
Split the graph: 8.422 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  24.000978708267212
pure dgl.metis_partition the time spent:  15.02222204208374
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.764859676361084

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.5714166164398193

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1372065544128418  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

connection checking time:  1.5981812477111816
block generation total time  2.3362762928009033
average batch blocks generation time:  0.2920345366001129
block dataloader generation time/epoch 43.122840372721356
pseudo mini batch 0 input nodes size: 54581
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1352529525756836  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1352529525756836  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16127920150756836  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1613631248474121  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14537620544433594  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2070, 2: 1696, 3: 1365, 4: 1038, 5: 889, 6: 648, 7: 511, 25: 469, 8: 445, 9: 374, 10: 295, 11: 234, 12: 207, 13: 188, 14: 154, 16: 110, 15: 109, 17: 84, 19: 77, 18: 75, 20: 62, 21: 53, 23: 41, 24: 37, 22: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14763736724853516  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14763736724853516  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.7128753662109375  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.714722633361816  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1803574562072754  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 1 input nodes size: 64257
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17789125442504883  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17789125442504883  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20853137969970703  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20861482620239258  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18250465393066406  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1979, 2: 1613, 3: 1156, 25: 1135, 4: 887, 5: 778, 6: 582, 7: 458, 8: 432, 9: 307, 10: 274, 11: 239, 12: 201, 13: 144, 14: 134, 15: 123, 16: 108, 17: 103, 18: 101, 19: 98, 20: 81, 21: 72, 22: 63, 24: 59, 23: 43})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18555736541748047  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18555736541748047  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.2585344314575195  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.260324001312256  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1881856918334961  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 2 input nodes size: 67107
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1845684051513672  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1845684051513672  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2165675163269043  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21665287017822266  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1859292984008789  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2938, 1: 1198, 2: 1019, 3: 811, 4: 648, 5: 550, 6: 450, 7: 386, 9: 325, 8: 323, 12: 288, 10: 284, 11: 264, 13: 235, 14: 190, 16: 183, 18: 178, 15: 177, 17: 162, 20: 161, 19: 153, 21: 145, 23: 114, 24: 111, 22: 107})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19112682342529297  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19112682342529297  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 11.167866706848145  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 11.16963529586792  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1958451271057129  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 3 input nodes size: 85454
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18920612335205078  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18920612335205078  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.22995376586914062  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23003625869750977  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1979517936706543  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1893, 1: 1538, 2: 1369, 3: 991, 4: 755, 5: 699, 6: 526, 7: 407, 9: 332, 8: 325, 10: 293, 11: 242, 12: 197, 13: 187, 15: 170, 14: 153, 16: 141, 18: 139, 17: 127, 19: 119, 21: 112, 20: 100, 22: 75, 24: 73, 23: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20277833938598633  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20277833938598633  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 9.586970806121826  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 9.588739395141602  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2067723274230957  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 4 input nodes size: 33615
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2004251480102539  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2004251480102539  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21645402908325195  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21654081344604492  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17571067810058594  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1731, 2: 1430, 3: 1233, 25: 976, 4: 961, 5: 807, 6: 624, 7: 535, 8: 463, 9: 390, 10: 358, 11: 296, 12: 248, 13: 224, 14: 211, 15: 187, 17: 160, 16: 142, 20: 117, 18: 116, 19: 108, 21: 103, 24: 71, 23: 70, 22: 59})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17808771133422852  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17808771133422852  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.800543785095215  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.802371501922607  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18007230758666992  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 5 input nodes size: 32456
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1780691146850586  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1780691146850586  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1936941146850586  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19377803802490234  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17766237258911133  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1311, 2: 1296, 3: 1117, 4: 952, 25: 823, 5: 779, 6: 709, 7: 576, 8: 495, 9: 452, 10: 396, 11: 375, 12: 299, 13: 251, 14: 218, 16: 165, 15: 164, 17: 158, 18: 142, 20: 116, 21: 105, 19: 104, 22: 85, 23: 74, 24: 69})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17998170852661133  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17998170852661133  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.7096147537231445  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.711442470550537  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18161249160766602  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 6 input nodes size: 35999
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17972946166992188  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17972946166992188  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19730758666992188  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19739437103271484  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1816854476928711  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1945, 2: 1772, 3: 1393, 4: 1069, 5: 889, 6: 691, 7: 568, 8: 512, 25: 415, 9: 374, 10: 329, 11: 253, 12: 243, 13: 196, 14: 165, 15: 159, 16: 107, 17: 102, 18: 83, 19: 70, 20: 63, 22: 57, 21: 54, 23: 50, 24: 49})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18368959426879883  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18368959426879883  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.625851154327393  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.628018379211426  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18549776077270508  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 7 input nodes size: 45580
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18366622924804688  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18366622924804688  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2054004669189453  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20548725128173828  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1878223419189453  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1656, 2: 1511, 3: 1211, 4: 1010, 5: 831, 25: 811, 6: 638, 7: 604, 8: 477, 9: 422, 10: 370, 11: 300, 12: 254, 13: 231, 14: 209, 15: 200, 16: 155, 17: 134, 18: 114, 20: 107, 19: 107, 22: 78, 21: 73, 24: 56, 23: 55})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19028997421264648  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19028997421264648  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.766230583190918  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.768092632293701  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1920628547668457  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1920628547668457  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.15900850296020508  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08820712566375732 |0.004707843065261841 |0.17245659232139587 |0.00014007091522216797 |0.3481859564781189 |0.005034446716308594 |
----------------------------------------------------------pseudo_mini_loss sum 3.5487098693847656
Total (block generation + training)time/epoch 48.20721532503764
Training time/epoch 5.063007116317749
Training time without block to device /epoch 5.025344371795654
Training time without total dataloading part /epoch 4.171295404434204
load block tensor time/epoch 0.7056570053100586
block to device time/epoch 0.03766274452209473
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  652549
Number of first layer input nodes during this epoch:  419049
Number of first layer output nodes during this epoch:  233500
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14325714111328125  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.453 seconds, peak memory: 38.477 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.477 GB
Metis partitioning: 5.084 seconds, peak memory: 38.477 GB
Split the graph: 7.184 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  23.035661458969116
pure dgl.metis_partition the time spent:  13.771472930908203
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7673628330230713

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.61124849319458

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14325714111328125  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

connection checking time:  1.5156519412994385
block generation total time  2.3786113262176514
average batch blocks generation time:  0.2973264157772064
block dataloader generation time/epoch 43.019528076052666
pseudo mini batch 0 input nodes size: 49969
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14095115661621094  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14095115661621094  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1647782325744629  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16486501693725586  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14304399490356445  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1545, 2: 1370, 3: 1180, 25: 1004, 4: 949, 5: 807, 6: 671, 7: 554, 8: 533, 9: 424, 10: 387, 11: 304, 12: 276, 13: 232, 14: 217, 15: 210, 17: 156, 16: 154, 18: 120, 19: 108, 20: 104, 21: 94, 22: 94, 23: 72, 24: 70})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14576435089111328  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.14576435089111328  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.3160786628723145  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.317861080169678  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1795177459716797  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 1 input nodes size: 30985
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1769089698791504  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1769089698791504  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1925339698791504  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19262075424194336  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.16870689392089844  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1888, 2: 1743, 3: 1377, 4: 1115, 5: 887, 6: 694, 7: 637, 8: 471, 9: 402, 25: 375, 10: 331, 11: 256, 12: 235, 13: 206, 14: 177, 15: 157, 16: 128, 17: 100, 18: 86, 19: 81, 20: 57, 21: 57, 22: 49, 23: 40, 24: 39})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1706252098083496  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1706252098083496  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.523472785949707  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.525289058685303  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17265939712524414  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 2 input nodes size: 33560
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17099380493164062  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17099380493164062  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1869964599609375  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18708229064941406  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1713705062866211  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1772, 2: 1488, 3: 1254, 4: 967, 25: 861, 5: 805, 6: 620, 7: 537, 8: 454, 9: 388, 10: 340, 11: 284, 12: 242, 13: 205, 14: 199, 15: 172, 17: 142, 16: 135, 20: 116, 18: 111, 21: 95, 19: 92, 24: 62, 23: 60, 22: 56})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17364120483398438  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17364120483398438  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.450718402862549  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.452740669250488  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1748056411743164  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 3 input nodes size: 33053
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17285871505737305  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17285871505737305  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18861961364746094  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1887044906616211  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17261600494384766  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1311, 2: 1311, 3: 1126, 4: 964, 25: 886, 5: 780, 6: 710, 7: 556, 8: 502, 9: 442, 10: 394, 11: 369, 12: 294, 13: 266, 14: 218, 16: 176, 15: 173, 17: 170, 18: 147, 20: 120, 19: 119, 21: 113, 23: 85, 22: 85, 24: 73})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17501115798950195  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17501115798950195  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.947790622711182  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 6.949584007263184  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.1771245002746582  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 4 input nodes size: 56951
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17517566680908203  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.17517566680908203  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20251941680908203  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20260286331176758  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18675708770751953  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2142, 2: 1790, 3: 1370, 4: 1041, 5: 886, 6: 615, 7: 484, 8: 424, 25: 423, 9: 355, 10: 270, 11: 217, 12: 192, 13: 169, 14: 148, 15: 119, 16: 94, 17: 79, 18: 75, 20: 65, 19: 60, 24: 38, 21: 38, 23: 35, 22: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18895912170410156  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18895912170410156  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.568201541900635  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 5.5700483322143555  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19049453735351562  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 5 input nodes size: 65295
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18804311752319336  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.18804311752319336  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.21929311752319336  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2193760871887207  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19194889068603516  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1867, 2: 1554, 25: 1303, 3: 1109, 4: 829, 5: 751, 6: 570, 7: 455, 8: 401, 9: 321, 10: 286, 11: 260, 12: 216, 13: 157, 14: 127, 15: 126, 16: 116, 18: 108, 19: 102, 17: 92, 20: 86, 21: 72, 24: 67, 22: 66, 23: 48})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19515562057495117  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19515562057495117  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.621911525726318  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 7.623693466186523  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19786310195922852  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 6 input nodes size: 86259
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19407176971435547  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19407176971435547  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23520326614379883  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23528575897216797  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20395278930664062  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1675, 25: 1571, 2: 1444, 3: 1026, 4: 794, 5: 752, 6: 529, 7: 427, 8: 354, 9: 320, 10: 294, 11: 245, 12: 219, 13: 188, 14: 158, 15: 141, 16: 133, 18: 131, 17: 121, 19: 116, 21: 103, 20: 100, 24: 70, 23: 63, 22: 63})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20879888534545898  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20879888534545898  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 9.040973663330078  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 9.042763233184814  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.213104248046875  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

pseudo mini batch 7 input nodes size: 68196
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20634984970092773  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20634984970092773  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.23955297470092773  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.2396392822265625  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.19842529296875  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3037, 1: 1228, 2: 1006, 3: 835, 4: 661, 5: 554, 6: 459, 7: 395, 8: 333, 9: 324, 10: 297, 11: 268, 12: 263, 13: 233, 15: 191, 14: 190, 16: 175, 17: 170, 18: 170, 20: 159, 19: 158, 21: 145, 23: 116, 22: 110, 24: 106})

----------------------------------------after blocks to device 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20369482040405273  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.67919921875 GB
    Memory Allocated: 0.20369482040405273  GigaBytes
Max Memory Allocated: 12.160711288452148  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.22021484375 GB
    Memory Allocated: 11.418664932250977  GigaBytes
Max Memory Allocated: 12.228260517120361  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.22021484375 GB
    Memory Allocated: 11.42101526260376  GigaBytes
Max Memory Allocated: 12.228260517120361  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.76123046875 GB
    Memory Allocated: 0.20861339569091797  GigaBytes
Max Memory Allocated: 12.228260517120361  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.76123046875 GB
    Memory Allocated: 0.20861339569091797  GigaBytes
Max Memory Allocated: 12.228260517120361  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.76123046875 GB
    Memory Allocated: 0.17494869232177734  GigaBytes
Max Memory Allocated: 12.228260517120361  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09009873867034912 |0.004464626312255859 |0.173079252243042 |0.00014469027519226074 |0.3481626510620117 |0.0052182674407958984 |
----------------------------------------------------------pseudo_mini_loss sum 3.5984952449798584
Total (block generation + training)time/epoch 48.104340836405754
Training time/epoch 5.091146230697632
Training time without block to device /epoch 5.055429220199585
Training time without total dataloading part /epoch 4.176311016082764
load block tensor time/epoch 0.720789909362793
block to device time/epoch 0.035717010498046875
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  659822
Number of first layer input nodes during this epoch:  424268
Number of first layer output nodes during this epoch:  235554
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.76123046875 GB
    Memory Allocated: 0.16044187545776367  GigaBytes
Max Memory Allocated: 12.228260517120361  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.456 seconds, peak memory: 38.613 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.613 GB
Metis partitioning: 5.082 seconds, peak memory: 39.127 GB
Split the graph: 7.212 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
REG construction  time spent:  25.04567837715149
pure dgl.metis_partition the time spent:  13.799566745758057
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7822034358978271

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.583911418914795

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.76123046875 GB
    Memory Allocated: 0.16044187545776367  GigaBytes
Max Memory Allocated: 12.228260517120361  GigaBytes

connection checking time:  1.512596607208252
block generation total time  2.366114854812622
average batch blocks generation time:  0.29576435685157776
block dataloader generation time/epoch 43.04352593421936
pseudo mini batch 0 input nodes size: 67879
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.76123046875 GB
    Memory Allocated: 0.15392303466796875  GigaBytes
Max Memory Allocated: 12.228260517120361  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.76123046875 GB
    Memory Allocated: 0.15392303466796875  GigaBytes
Max Memory Allocated: 12.228260517120361  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.76123046875 GB
    Memory Allocated: 0.18629026412963867  GigaBytes
Max Memory Allocated: 12.228260517120361  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.76123046875 GB
    Memory Allocated: 0.18637704849243164  GigaBytes
Max Memory Allocated: 12.228260517120361  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.76123046875 GB
    Memory Allocated: 0.15308761596679688  GigaBytes
Max Memory Allocated: 12.228260517120361  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3034, 1: 1216, 2: 996, 3: 825, 4: 662, 5: 569, 6: 476, 7: 393, 8: 331, 9: 318, 10: 317, 12: 281, 11: 273, 13: 232, 14: 197, 16: 179, 15: 176, 18: 173, 17: 164, 20: 162, 19: 158, 21: 157, 23: 120, 24: 111, 22: 101})

----------------------------------------after blocks to device 
 Nvidia-smi: 18.76123046875 GB
    Memory Allocated: 0.15836858749389648  GigaBytes
Max Memory Allocated: 12.228260517120361  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.76123046875 GB
    Memory Allocated: 0.15836858749389648  GigaBytes
Max Memory Allocated: 12.228260517120361  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30419921875 GB
    Memory Allocated: 11.422744750976562  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30419921875 GB
    Memory Allocated: 11.424775123596191  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1927652359008789  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 1 input nodes size: 82732
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18624496459960938  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18624496459960938  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2256946563720703  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.22577714920043945  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19332313537597656  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2147, 1: 1455, 2: 1250, 3: 919, 4: 711, 5: 662, 6: 507, 7: 424, 8: 338, 9: 320, 10: 265, 11: 246, 12: 224, 13: 194, 14: 174, 15: 160, 16: 151, 18: 148, 17: 137, 19: 131, 20: 115, 21: 111, 22: 94, 24: 81, 23: 71})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19827890396118164  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19827890396118164  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 10.034329414367676  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 10.036157131195068  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2028822898864746  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 2 input nodes size: 66369
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19624662399291992  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19624662399291992  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.22789382934570312  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.22797679901123047  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1884446144104004  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2011, 2: 1663, 3: 1236, 4: 951, 25: 828, 5: 817, 6: 612, 7: 459, 8: 423, 9: 331, 10: 283, 11: 244, 12: 192, 13: 154, 14: 128, 15: 126, 16: 100, 17: 94, 18: 93, 19: 84, 20: 71, 21: 55, 24: 54, 22: 49, 23: 43})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1913013458251953  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1913013458251953  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.725887775421143  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.727879524230957  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19352436065673828  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 3 input nodes size: 54285
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1900615692138672  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1900615692138672  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.21594667434692383  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.21603059768676758  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18430042266845703  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2142, 2: 1871, 3: 1386, 4: 1047, 5: 891, 6: 617, 7: 475, 8: 427, 25: 364, 9: 354, 10: 307, 11: 215, 12: 187, 13: 176, 14: 139, 15: 113, 16: 96, 17: 79, 18: 71, 19: 70, 20: 58, 21: 49, 24: 38, 22: 26, 23: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18642044067382812  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18642044067382812  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 5.4396281242370605  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 5.441357612609863  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18859291076660156  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 4 input nodes size: 48989
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18627071380615234  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18627071380615234  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20970821380615234  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2097949981689453  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18382596969604492  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1589, 2: 1443, 3: 1169, 4: 984, 25: 907, 5: 828, 6: 641, 7: 564, 8: 543, 9: 406, 10: 382, 11: 304, 12: 270, 13: 229, 15: 213, 14: 205, 16: 163, 17: 135, 18: 120, 19: 110, 20: 101, 22: 95, 21: 93, 23: 78, 24: 61})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1864795684814453  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1864795684814453  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 7.146082401275635  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 7.1480207443237305  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1882638931274414  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 5 input nodes size: 31809
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18570566177368164  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18570566177368164  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20133066177368164  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2014174461364746  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17789316177368164  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2003, 2: 1737, 3: 1379, 4: 1084, 5: 884, 6: 692, 7: 622, 8: 470, 9: 388, 25: 375, 10: 323, 11: 262, 12: 245, 13: 200, 14: 166, 15: 154, 16: 121, 17: 106, 18: 85, 19: 76, 20: 58, 22: 47, 21: 44, 24: 42, 23: 41})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17980384826660156  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17980384826660156  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 5.5042219161987305  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 5.506007671356201  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1813039779663086  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 6 input nodes size: 36345
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17962980270385742  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17962980270385742  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19720792770385742  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1972942352294922  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18158245086669922  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1415, 2: 1386, 3: 1180, 4: 980, 25: 849, 5: 792, 6: 708, 7: 585, 8: 484, 9: 460, 10: 379, 11: 354, 12: 299, 13: 255, 14: 221, 16: 164, 15: 162, 17: 161, 18: 147, 20: 122, 19: 103, 21: 102, 22: 84, 23: 72, 24: 67})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18400335311889648  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18400335311889648  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.898676872253418  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.900477886199951  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18579912185668945  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 7 input nodes size: 32466
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18373870849609375  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18373870849609375  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19936370849609375  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1994471549987793  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18178272247314453  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1597, 2: 1360, 3: 1183, 25: 956, 4: 901, 5: 779, 6: 615, 7: 523, 8: 456, 9: 399, 10: 343, 11: 305, 12: 239, 13: 216, 14: 204, 15: 185, 17: 154, 16: 137, 20: 120, 18: 111, 21: 106, 19: 104, 24: 71, 23: 70, 22: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18410205841064453  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18410205841064453  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.673890113830566  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.675645351409912  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18584442138671875  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18584442138671875  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.15250015258789062  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08962899446487427 |0.0047491490840911865 |0.17216163873672485 |0.0001342296600341797 |0.3460380733013153 |0.004912376403808594 |
----------------------------------------------------------pseudo_mini_loss sum 3.468858003616333
Total (block generation + training)time/epoch 48.12629785257227
Training time/epoch 5.049848556518555
Training time without block to device /epoch 5.011855363845825
Training time without total dataloading part /epoch 4.151583909988403
load block tensor time/epoch 0.7170319557189941
block to device time/epoch 0.03799319267272949
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  655232
Number of first layer input nodes during this epoch:  420874
Number of first layer output nodes during this epoch:  234358
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.13676738739013672  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.445 seconds, peak memory: 39.675 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 39.675 GB
Metis partitioning: 5.108 seconds, peak memory: 40.308 GB
Split the graph: 7.197 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  24.999951362609863
pure dgl.metis_partition the time spent:  13.800135135650635
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7591407299041748

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.573538064956665

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.13676738739013672  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

connection checking time:  1.5336713790893555
block generation total time  2.33267879486084
average batch blocks generation time:  0.291584849357605
block dataloader generation time/epoch 43.06259277131822
pseudo mini batch 0 input nodes size: 34625
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.13482189178466797  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.13482189178466797  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.15154170989990234  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1516280174255371  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.13591957092285156  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1387, 2: 1355, 3: 1177, 4: 983, 5: 823, 25: 812, 6: 720, 7: 577, 8: 505, 9: 444, 10: 410, 11: 362, 12: 312, 13: 267, 14: 213, 15: 173, 16: 169, 17: 158, 18: 148, 20: 120, 19: 113, 21: 104, 22: 81, 23: 70, 24: 66})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.13829374313354492  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.13829374313354492  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.800468921661377  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.802209377288818  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1711740493774414  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 1 input nodes size: 33436
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.16920995712280273  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.16920995712280273  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18515348434448242  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18523836135864258  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.16843223571777344  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1696, 2: 1410, 3: 1208, 25: 986, 4: 922, 5: 769, 6: 602, 7: 534, 8: 452, 9: 383, 10: 350, 11: 294, 12: 243, 13: 213, 14: 203, 15: 180, 17: 158, 16: 142, 20: 115, 18: 108, 21: 102, 19: 102, 23: 76, 24: 66, 22: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17078542709350586  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17078542709350586  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.735641002655029  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.737548828125  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1725907325744629  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 2 input nodes size: 41464
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17059612274169922  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17059612274169922  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1903676986694336  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19045495986938477  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17442655563354492  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1586, 2: 1497, 3: 1214, 4: 1039, 5: 826, 25: 775, 6: 645, 7: 621, 8: 504, 9: 453, 10: 381, 11: 313, 12: 267, 13: 254, 14: 221, 15: 192, 16: 154, 17: 129, 19: 115, 18: 110, 20: 108, 22: 78, 21: 75, 24: 64, 23: 62})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1768488883972168  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1768488883972168  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.780703067779541  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.782496452331543  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1785721778869629  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 3 input nodes size: 37221
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17638921737670898  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17638921737670898  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19415807723999023  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.194244384765625  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17438554763793945  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2021, 2: 1762, 3: 1418, 4: 1012, 5: 913, 6: 705, 7: 532, 8: 490, 25: 445, 9: 354, 10: 317, 11: 242, 12: 226, 13: 174, 14: 153, 15: 152, 17: 108, 16: 99, 18: 86, 19: 69, 21: 66, 20: 56, 22: 52, 23: 49, 24: 43})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17637062072753906  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17637062072753906  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 5.577394008636475  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 5.579156875610352  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1781482696533203  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 4 input nodes size: 55658
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1763296127319336  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1763296127319336  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2036733627319336  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20375776290893555  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18590259552001953  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2009, 2: 1681, 3: 1271, 4: 1036, 5: 870, 6: 672, 25: 538, 7: 533, 8: 450, 9: 398, 10: 298, 11: 234, 12: 212, 13: 188, 14: 167, 15: 131, 16: 106, 17: 95, 18: 92, 19: 70, 20: 58, 21: 51, 22: 45, 24: 41, 23: 39})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18824052810668945  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18824052810668945  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 5.965567588806152  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 5.967441082000732  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18993902206420898  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 5 input nodes size: 68141
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18740272521972656  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18740272521972656  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.22060585021972656  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2206892967224121  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19326114654541016  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2133, 2: 1719, 3: 1246, 4: 941, 5: 796, 25: 757, 6: 595, 7: 460, 8: 429, 9: 314, 10: 269, 11: 239, 12: 201, 13: 150, 15: 126, 14: 116, 16: 110, 17: 96, 18: 90, 19: 82, 20: 67, 21: 56, 24: 52, 22: 50, 23: 43})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19609355926513672  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19609355926513672  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.606376647949219  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.608093738555908  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19867324829101562  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 6 input nodes size: 67293
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19519758224487305  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19519758224487305  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.22728538513183594  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2273702621459961  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19408369064331055  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2973, 1: 1216, 2: 995, 3: 790, 4: 637, 5: 557, 6: 463, 7: 348, 9: 331, 8: 312, 10: 284, 11: 270, 12: 263, 13: 226, 14: 192, 16: 180, 15: 175, 17: 167, 18: 162, 19: 156, 20: 154, 21: 152, 23: 116, 24: 109, 22: 104})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1992931365966797  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1992931365966797  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 11.197347164154053  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 11.199041366577148  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20375442504882812  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 7 input nodes size: 83420
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19725561141967773  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19725561141967773  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.23703336715698242  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.23711585998535156  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20494318008422852  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2174, 1: 1380, 2: 1287, 3: 953, 4: 750, 5: 668, 6: 466, 7: 440, 8: 330, 9: 299, 10: 290, 11: 249, 12: 213, 13: 184, 14: 169, 15: 160, 18: 152, 16: 151, 19: 129, 20: 129, 17: 119, 21: 111, 22: 86, 24: 84, 23: 64})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20992231369018555  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20992231369018555  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 10.100456237792969  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 10.102150440216064  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2145400047302246  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2145400047302246  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18148565292358398  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08727821707725525 |0.004914343357086182 |0.17345279455184937 |0.00013574957847595215 |0.3463325500488281 |0.002192974090576172 |
----------------------------------------------------------pseudo_mini_loss sum 3.344057559967041
Total (block generation + training)time/epoch 48.144374158647324
Training time/epoch 5.064573526382446
Training time without block to device /epoch 5.025258779525757
Training time without total dataloading part /epoch 4.161561727523804
load block tensor time/epoch 0.698225736618042
block to device time/epoch 0.03931474685668945
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  654946
Number of first layer input nodes during this epoch:  421258
Number of first layer output nodes during this epoch:  233688
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.16639328002929688  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.512 seconds, peak memory: 40.653 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.653 GB
Metis partitioning: 5.128 seconds, peak memory: 40.653 GB
Split the graph: 7.638 seconds
Construct subgraphs: 0.013 seconds
REG metis partition end ----................................
REG construction  time spent:  23.8902690410614
pure dgl.metis_partition the time spent:  14.320735454559326
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7572581768035889

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.572761058807373

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.16639328002929688  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

connection checking time:  1.5263981819152832
block generation total time  2.330019235610962
average batch blocks generation time:  0.29125240445137024
block dataloader generation time/epoch 43.04760284172861
pseudo mini batch 0 input nodes size: 43648
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.15973520278930664  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.15973520278930664  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18054819107055664  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1806349754333496  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.14077472686767578  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1579, 2: 1443, 3: 1200, 4: 998, 25: 839, 5: 825, 6: 655, 7: 602, 8: 518, 9: 430, 10: 378, 11: 309, 12: 294, 13: 249, 15: 204, 14: 204, 16: 162, 17: 133, 19: 115, 18: 112, 20: 105, 22: 89, 21: 75, 24: 59, 23: 58})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.14326715469360352  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.14326715469360352  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.8433074951171875  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.845047950744629  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17537736892700195  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 1 input nodes size: 37910
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17309284210205078  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17309284210205078  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19116973876953125  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19125699996948242  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17035722732543945  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1971, 2: 1747, 3: 1374, 4: 1097, 5: 930, 6: 696, 7: 578, 8: 485, 25: 479, 9: 385, 10: 314, 11: 239, 12: 214, 14: 183, 13: 179, 15: 150, 16: 114, 17: 100, 18: 89, 19: 77, 21: 61, 22: 58, 23: 55, 20: 55, 24: 48})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17241334915161133  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17241334915161133  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 5.7569732666015625  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 5.759178638458252  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17412233352661133  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 2 input nodes size: 32808
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17223262786865234  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17223262786865234  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18787670135498047  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18796205520629883  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1697978973388672  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1741, 2: 1443, 3: 1197, 25: 970, 4: 912, 5: 781, 6: 599, 7: 536, 8: 458, 9: 388, 10: 330, 11: 292, 12: 243, 13: 221, 14: 200, 15: 178, 17: 162, 16: 135, 20: 116, 18: 109, 19: 99, 21: 99, 23: 71, 24: 64, 22: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17212390899658203  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17212390899658203  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.659022808074951  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.660850524902344  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1738109588623047  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 3 input nodes size: 33745
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17184925079345703  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17184925079345703  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18794012069702148  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18802499771118164  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17229557037353516  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1406, 2: 1374, 3: 1215, 4: 975, 5: 790, 25: 767, 6: 713, 7: 553, 8: 490, 9: 430, 10: 399, 11: 356, 12: 286, 13: 254, 14: 216, 16: 165, 15: 161, 17: 145, 18: 139, 20: 119, 19: 106, 21: 99, 22: 79, 23: 72, 24: 68})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17459344863891602  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17459344863891602  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.624903202056885  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.626650810241699  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17644834518432617  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 4 input nodes size: 62853
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1745452880859375  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1745452880859375  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20451593399047852  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20459938049316406  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18842363357543945  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2111, 2: 1730, 3: 1328, 4: 987, 5: 849, 6: 657, 7: 516, 25: 463, 8: 415, 9: 367, 10: 305, 11: 232, 12: 192, 13: 183, 14: 151, 15: 121, 16: 109, 17: 94, 18: 81, 20: 74, 19: 59, 21: 48, 24: 39, 22: 31, 23: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19078874588012695  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19078874588012695  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 5.857863426208496  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 5.8597331047058105  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19275903701782227  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 5 input nodes size: 70329
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1900482177734375  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1900482177734375  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.22358369827270508  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.22366666793823242  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19361257553100586  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2024, 2: 1693, 3: 1226, 4: 957, 5: 818, 25: 779, 6: 624, 7: 457, 8: 422, 9: 319, 10: 273, 11: 243, 12: 212, 13: 153, 14: 125, 15: 117, 16: 103, 18: 97, 17: 92, 19: 92, 21: 78, 20: 63, 24: 58, 22: 52, 23: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1965036392211914  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1965036392211914  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.724888324737549  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.726590156555176  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19892215728759766  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 6 input nodes size: 81647
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19536733627319336  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19536733627319336  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2342996597290039  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.23438215255737305  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20076370239257812  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2136, 1: 1420, 2: 1276, 3: 892, 4: 702, 5: 643, 6: 475, 7: 430, 8: 357, 9: 318, 10: 292, 11: 271, 12: 226, 13: 193, 15: 179, 14: 175, 18: 157, 16: 149, 17: 142, 19: 126, 20: 117, 21: 107, 22: 90, 23: 85, 24: 77})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2057032585144043  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2057032585144043  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 10.027212619781494  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 10.028914451599121  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.21034765243530273  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 7 input nodes size: 67713
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20373821258544922  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20373821258544922  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.23694133758544922  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.23702764511108398  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1980128288269043  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3027, 1: 1176, 2: 1000, 3: 845, 4: 692, 5: 586, 6: 449, 7: 373, 9: 339, 8: 327, 10: 308, 12: 270, 11: 261, 13: 224, 14: 180, 15: 179, 16: 174, 18: 164, 17: 162, 19: 162, 20: 158, 21: 150, 24: 112, 23: 112, 22: 97})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20327234268188477  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20327234268188477  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 11.39495038986206  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 11.397113800048828  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20772790908813477  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20772790908813477  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17467355728149414  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08860304951667786 |0.0040538012981414795 |0.1665632724761963 |0.0001163184642791748 |0.34725117683410645 |0.0047948360443115234 |
----------------------------------------------------------pseudo_mini_loss sum 3.2737131118774414
Total (block generation + training)time/epoch 48.12553344274822
Training time/epoch 5.008229732513428
Training time without block to device /epoch 4.975799322128296
Training time without total dataloading part /epoch 4.116240978240967
load block tensor time/epoch 0.7088243961334229
block to device time/epoch 0.032430410385131836
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  666312
Number of first layer input nodes during this epoch:  430653
Number of first layer output nodes during this epoch:  235659
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1601543426513672  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.439 seconds, peak memory: 40.653 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.653 GB
Metis partitioning: 5.042 seconds, peak memory: 40.653 GB
Split the graph: 6.978 seconds
Construct subgraphs: 0.022 seconds
REG metis partition end ----................................
REG construction  time spent:  23.144651889801025
pure dgl.metis_partition the time spent:  13.511824131011963
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7700834274291992

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.594799518585205

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1601543426513672  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

connection checking time:  1.5403335094451904
block generation total time  2.3648829460144043
average batch blocks generation time:  0.29561036825180054
block dataloader generation time/epoch 42.957069003582
pseudo mini batch 0 input nodes size: 35393
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.15363454818725586  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.15363454818725586  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17121267318725586  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17129945755004883  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.13801002502441406  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1534, 2: 1415, 3: 1174, 4: 996, 5: 799, 25: 789, 6: 704, 7: 573, 8: 502, 9: 444, 10: 392, 11: 352, 12: 296, 13: 251, 14: 226, 15: 159, 16: 154, 17: 152, 18: 141, 20: 111, 19: 103, 21: 97, 22: 88, 23: 73, 24: 69})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.14035844802856445  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.14035844802856445  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.72735071182251  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.729455471038818  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1721644401550293  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 1 input nodes size: 33118
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17019414901733398  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17019414901733398  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18598604202270508  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.18607282638549805  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.16840791702270508  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1553, 2: 1374, 3: 1154, 25: 1050, 4: 913, 5: 802, 6: 634, 7: 572, 8: 473, 9: 421, 10: 365, 11: 314, 12: 272, 13: 236, 14: 223, 15: 199, 17: 171, 16: 160, 20: 132, 18: 122, 21: 119, 19: 115, 23: 75, 24: 74, 22: 67})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17087841033935547  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17087841033935547  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 7.0840654373168945  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 7.086141109466553  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1727123260498047  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 2 input nodes size: 42371
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17065954208374023  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17065954208374023  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19086360931396484  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1909503936767578  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17507171630859375  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1568, 2: 1493, 3: 1226, 4: 1066, 5: 846, 25: 749, 6: 683, 7: 596, 8: 521, 9: 433, 10: 386, 11: 323, 12: 270, 13: 240, 14: 205, 15: 196, 16: 157, 17: 119, 18: 108, 19: 102, 20: 100, 21: 81, 22: 63, 24: 54, 23: 52})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1774907112121582  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1774907112121582  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.66311502456665  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.665102958679199  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17920541763305664  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 3 input nodes size: 35711
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1769728660583496  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1769728660583496  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1945509910583496  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19463777542114258  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.174346923828125  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2091, 2: 1796, 3: 1396, 4: 1072, 5: 908, 6: 685, 7: 556, 8: 465, 25: 428, 9: 343, 10: 312, 11: 247, 12: 211, 13: 164, 14: 148, 15: 144, 17: 107, 16: 103, 18: 88, 19: 71, 21: 59, 20: 56, 22: 51, 23: 45, 24: 44})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17629384994506836  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17629384994506836  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 5.465312480926514  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 5.467124938964844  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17777490615844727  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 4 input nodes size: 69350
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17600679397583008  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.17600679397583008  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20920991897583008  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20929241180419922  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19162750244140625  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2064, 2: 1692, 3: 1256, 4: 937, 5: 817, 25: 726, 6: 624, 7: 483, 8: 428, 9: 325, 10: 264, 11: 240, 12: 186, 13: 161, 14: 122, 15: 109, 16: 93, 18: 93, 20: 87, 17: 86, 19: 84, 24: 54, 21: 53, 22: 51, 23: 37})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1944260597229004  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1944260597229004  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.545267581939697  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.547080039978027  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19690942764282227  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 5 input nodes size: 64713
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19347858428955078  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19347858428955078  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2243361473083496  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.22441959381103516  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19113397598266602  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2044, 2: 1705, 3: 1353, 4: 1024, 5: 850, 6: 603, 25: 527, 7: 477, 8: 438, 9: 370, 10: 296, 12: 216, 11: 212, 13: 184, 14: 145, 15: 126, 16: 109, 17: 95, 18: 85, 19: 74, 20: 59, 21: 48, 22: 44, 23: 42, 24: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19360113143920898  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19360113143920898  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.031611442565918  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 6.033458232879639  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19554662704467773  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 6 input nodes size: 83679
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19268417358398438  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.19268417358398438  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.23258543014526367  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2326679229736328  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20172691345214844  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2328, 1: 1379, 2: 1241, 3: 904, 4: 681, 5: 624, 6: 487, 7: 416, 8: 324, 9: 315, 10: 276, 11: 244, 12: 219, 13: 198, 15: 184, 14: 164, 18: 156, 16: 149, 17: 146, 19: 131, 21: 111, 20: 104, 22: 95, 24: 81, 23: 79})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20678281784057617  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20678281784057617  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 10.37656545639038  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 10.378236770629883  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.21136045455932617  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

pseudo mini batch 7 input nodes size: 67417
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20468378067016602  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20468378067016602  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.2368307113647461  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.23691463470458984  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1969308853149414  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2863, 1: 1195, 2: 990, 3: 814, 4: 631, 5: 576, 6: 448, 7: 372, 9: 325, 8: 321, 10: 308, 11: 271, 12: 267, 13: 222, 14: 201, 16: 186, 15: 172, 20: 158, 19: 156, 18: 155, 17: 154, 21: 149, 23: 116, 24: 113, 22: 97})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20209741592407227  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20209741592407227  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 11.043028354644775  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 11.044798851013184  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20673131942749023  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.20673131942749023  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.84716796875 GB
    Memory Allocated: 0.1736769676208496  GigaBytes
Max Memory Allocated: 12.239295959472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08909863233566284 |0.004070490598678589 |0.1664140820503235 |0.00011733174324035645 |0.34744682908058167 |0.004735231399536133 |
----------------------------------------------------------pseudo_mini_loss sum 3.174234628677368
Total (block generation + training)time/epoch 48.03156380653381
Training time/epoch 5.00881290435791
Training time without block to device /epoch 4.9762489795684814
Training time without total dataloading part /epoch 4.1165611743927
load block tensor time/epoch 0.7127890586853027
block to device time/epoch 0.03256392478942871
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  668688
Number of first layer input nodes during this epoch:  431752
Number of first layer output nodes during this epoch:  236936
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=1024, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=1024, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(1024, 1024, batch_first=True)
      (fc_self): Linear(in_features=1024, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=1024, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  8872960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([1024, 128])
layers.0.fc_neigh.weight, torch.Size([1024, 128])
layers.1.lstm.weight_ih_l0, torch.Size([4096, 1024])
layers.1.lstm.weight_hh_l0, torch.Size([4096, 1024])
layers.1.lstm.bias_ih_l0, torch.Size([4096])
layers.1.lstm.bias_hh_l0, torch.Size([4096])
layers.1.fc_self.weight, torch.Size([40, 1024])
layers.1.fc_neigh.weight, torch.Size([40, 1024])
----------------------------------------
un-trainable parameters
