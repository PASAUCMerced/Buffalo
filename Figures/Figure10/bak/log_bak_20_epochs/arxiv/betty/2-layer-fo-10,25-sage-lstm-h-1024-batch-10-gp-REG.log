main start at this time 1733106335.778515
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.55029296875 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.443 seconds, peak memory: 17.047 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 17.047 GB
Metis partitioning: 5.166 seconds, peak memory: 17.649 GB
Split the graph: 6.717 seconds
Construct subgraphs: 0.025 seconds
REG metis partition end ----................................
REG construction  time spent:  25.723752737045288
pure dgl.metis_partition the time spent:  13.381910800933838
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.782968282699585

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.712695598602295

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

connection checking time:  1.7175216674804688
block generation total time  2.49566388130188
average batch blocks generation time:  0.249566388130188
block dataloader generation time/epoch 43.95796751976013
pseudo mini batch 0 input nodes size: 28431
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.56591796875 GB
    Memory Allocated: 0.046726226806640625  GigaBytes
Max Memory Allocated: 0.046726226806640625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.56591796875 GB
    Memory Allocated: 0.04679536819458008  GigaBytes
Max Memory Allocated: 0.04679536819458008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.56591796875 GB
    Memory Allocated: 0.04679536819458008  GigaBytes
Max Memory Allocated: 0.04679536819458008  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1499, 2: 1340, 3: 1100, 4: 875, 5: 719, 6: 557, 7: 486, 8: 406, 9: 325, 25: 318, 10: 282, 11: 224, 12: 185, 13: 173, 14: 135, 15: 121, 16: 105, 17: 75, 18: 73, 19: 67, 20: 57, 21: 39, 22: 36, 23: 29, 24: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.56787109375 GB
    Memory Allocated: 0.048392295837402344  GigaBytes
Max Memory Allocated: 0.048392295837402344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.56787109375 GB
    Memory Allocated: 0.048392295837402344  GigaBytes
Max Memory Allocated: 0.048392295837402344  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.32568359375 GB
    Memory Allocated: 4.419223308563232  GigaBytes
Max Memory Allocated: 4.712681770324707  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.32568359375 GB
    Memory Allocated: 4.421036243438721  GigaBytes
Max Memory Allocated: 4.712681770324707  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.55810546875 GB
    Memory Allocated: 0.10011672973632812  GigaBytes
Max Memory Allocated: 4.712681770324707  GigaBytes

pseudo mini batch 1 input nodes size: 32600
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.55810546875 GB
    Memory Allocated: 0.09867668151855469  GigaBytes
Max Memory Allocated: 4.712681770324707  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.55810546875 GB
    Memory Allocated: 0.09867668151855469  GigaBytes
Max Memory Allocated: 4.712681770324707  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.55810546875 GB
    Memory Allocated: 0.11430168151855469  GigaBytes
Max Memory Allocated: 4.712681770324707  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.55810546875 GB
    Memory Allocated: 0.11437129974365234  GigaBytes
Max Memory Allocated: 4.712681770324707  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.55810546875 GB
    Memory Allocated: 0.10063028335571289  GigaBytes
Max Memory Allocated: 4.712681770324707  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1560, 2: 1396, 3: 1089, 4: 845, 5: 712, 6: 562, 7: 436, 8: 377, 25: 375, 9: 305, 10: 260, 11: 206, 12: 191, 13: 151, 14: 136, 15: 127, 17: 90, 16: 81, 18: 72, 19: 66, 21: 57, 20: 52, 22: 48, 23: 48, 24: 40})

----------------------------------------after blocks to device 
 Nvidia-smi: 5.55810546875 GB
    Memory Allocated: 0.10231208801269531  GigaBytes
Max Memory Allocated: 4.712681770324707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.55810546875 GB
    Memory Allocated: 0.10231208801269531  GigaBytes
Max Memory Allocated: 4.712681770324707  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.87841796875 GB
    Memory Allocated: 4.621856689453125  GigaBytes
Max Memory Allocated: 4.923384189605713  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.87841796875 GB
    Memory Allocated: 4.623314380645752  GigaBytes
Max Memory Allocated: 4.923384189605713  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.10693359375 GB
    Memory Allocated: 0.10353660583496094  GigaBytes
Max Memory Allocated: 4.923384189605713  GigaBytes

pseudo mini batch 2 input nodes size: 38308
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.10693359375 GB
    Memory Allocated: 0.10196065902709961  GigaBytes
Max Memory Allocated: 4.923384189605713  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.10693359375 GB
    Memory Allocated: 0.10196065902709961  GigaBytes
Max Memory Allocated: 4.923384189605713  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.10693359375 GB
    Memory Allocated: 0.12022733688354492  GigaBytes
Max Memory Allocated: 4.923384189605713  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.10693359375 GB
    Memory Allocated: 0.12029647827148438  GigaBytes
Max Memory Allocated: 4.923384189605713  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.10693359375 GB
    Memory Allocated: 0.10460186004638672  GigaBytes
Max Memory Allocated: 4.923384189605713  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1448, 2: 1300, 3: 1032, 4: 850, 5: 648, 25: 579, 6: 500, 7: 405, 8: 380, 9: 332, 10: 289, 11: 221, 12: 203, 13: 181, 14: 151, 15: 134, 17: 96, 16: 86, 19: 80, 18: 79, 20: 68, 21: 60, 22: 55, 24: 47, 23: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 6.10693359375 GB
    Memory Allocated: 0.10645914077758789  GigaBytes
Max Memory Allocated: 4.923384189605713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.10693359375 GB
    Memory Allocated: 0.10645914077758789  GigaBytes
Max Memory Allocated: 4.923384189605713  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.36083984375 GB
    Memory Allocated: 5.05897855758667  GigaBytes
Max Memory Allocated: 5.382840156555176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.36083984375 GB
    Memory Allocated: 5.060417175292969  GigaBytes
Max Memory Allocated: 5.382840156555176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.61474609375 GB
    Memory Allocated: 0.10793924331665039  GigaBytes
Max Memory Allocated: 5.382840156555176  GigaBytes

pseudo mini batch 3 input nodes size: 27234
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.61474609375 GB
    Memory Allocated: 0.10619688034057617  GigaBytes
Max Memory Allocated: 5.382840156555176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.61474609375 GB
    Memory Allocated: 0.10619688034057617  GigaBytes
Max Memory Allocated: 5.382840156555176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.61474609375 GB
    Memory Allocated: 0.11986875534057617  GigaBytes
Max Memory Allocated: 5.382840156555176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.61474609375 GB
    Memory Allocated: 0.11993789672851562  GigaBytes
Max Memory Allocated: 5.382840156555176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.61474609375 GB
    Memory Allocated: 0.10160207748413086  GigaBytes
Max Memory Allocated: 5.382840156555176  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 1005, 1: 1005, 3: 927, 4: 751, 25: 751, 5: 632, 6: 574, 7: 486, 8: 397, 9: 358, 10: 321, 11: 308, 12: 237, 13: 217, 14: 197, 17: 161, 16: 152, 15: 150, 18: 125, 20: 111, 21: 103, 19: 102, 22: 71, 23: 68, 24: 62})

----------------------------------------after blocks to device 
 Nvidia-smi: 6.61474609375 GB
    Memory Allocated: 0.10361862182617188  GigaBytes
Max Memory Allocated: 5.382840156555176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.61474609375 GB
    Memory Allocated: 0.10361862182617188  GigaBytes
Max Memory Allocated: 5.382840156555176  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.91943359375 GB
    Memory Allocated: 5.765195369720459  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.91943359375 GB
    Memory Allocated: 5.766645431518555  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.1051931381225586  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

pseudo mini batch 4 input nodes size: 30879
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.10354185104370117  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.10354185104370117  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.11916685104370117  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.11923408508300781  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.10549306869506836  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1309, 2: 1126, 3: 934, 25: 763, 4: 748, 5: 627, 6: 479, 7: 427, 8: 361, 9: 314, 10: 277, 11: 231, 12: 196, 13: 163, 14: 159, 15: 136, 17: 116, 16: 106, 20: 89, 18: 85, 19: 77, 21: 74, 23: 63, 24: 53, 22: 50})

----------------------------------------after blocks to device 
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.10743045806884766  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.10743045806884766  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 5.329933166503906  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 5.331448078155518  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.10891246795654297  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

pseudo mini batch 5 input nodes size: 49877
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.10715532302856445  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.10715532302856445  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.13093852996826172  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.13100814819335938  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.11531591415405273  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1479, 2: 1289, 3: 997, 4: 769, 5: 703, 25: 629, 6: 511, 7: 447, 8: 398, 9: 317, 10: 272, 11: 204, 12: 203, 13: 162, 14: 150, 16: 129, 15: 129, 17: 96, 18: 93, 20: 67, 19: 63, 22: 50, 21: 49, 24: 42, 23: 39})

----------------------------------------after blocks to device 
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.11748695373535156  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.22412109375 GB
    Memory Allocated: 0.11748695373535156  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 5.463299751281738  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 5.464818477630615  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.11927318572998047  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

pseudo mini batch 6 input nodes size: 55368
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.11691474914550781  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.11691474914550781  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.14331626892089844  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.14338302612304688  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.11953020095825195  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1666, 2: 1360, 3: 966, 4: 758, 5: 672, 25: 561, 6: 491, 7: 416, 8: 345, 9: 275, 10: 224, 11: 199, 12: 166, 13: 116, 14: 99, 15: 94, 16: 78, 18: 74, 19: 73, 17: 67, 20: 57, 24: 43, 21: 39, 22: 38, 23: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.12173223495483398  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.12173223495483398  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 5.173130035400391  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 5.174457550048828  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.1237039566040039  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

pseudo mini batch 7 input nodes size: 72369
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.1210322380065918  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.1210322380065918  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.15554046630859375  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.1556072235107422  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.12913894653320312  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1666, 1: 1186, 2: 1088, 3: 775, 4: 566, 5: 538, 6: 407, 7: 333, 8: 266, 9: 257, 10: 220, 11: 213, 12: 175, 13: 154, 14: 142, 15: 139, 16: 120, 18: 119, 19: 100, 21: 100, 17: 94, 20: 89, 24: 69, 22: 68, 23: 52})

----------------------------------------after blocks to device 
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.1331162452697754  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.22998046875 GB
    Memory Allocated: 0.1331162452697754  GigaBytes
Max Memory Allocated: 6.140720367431641  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.48388671875 GB
    Memory Allocated: 7.9194416999816895  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.48388671875 GB
    Memory Allocated: 7.920953273773193  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.1361522674560547  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

pseudo mini batch 8 input nodes size: 77652
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.13123369216918945  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.13123369216918945  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.16834306716918945  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.16840887069702148  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.1338338851928711  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1475, 1: 1282, 2: 1068, 3: 818, 4: 663, 5: 536, 6: 422, 7: 316, 8: 292, 9: 230, 10: 224, 12: 181, 11: 180, 13: 148, 15: 121, 16: 118, 14: 108, 17: 107, 18: 102, 19: 88, 20: 87, 21: 79, 23: 69, 22: 64, 24: 50})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.13745832443237305  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.13745832443237305  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 7.73111629486084  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 7.733142375946045  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.14130353927612305  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

pseudo mini batch 9 input nodes size: 63124
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.1360769271850586  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.1360769271850586  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.16617679595947266  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.1662435531616211  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.12906837463378906  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2343, 1: 994, 2: 734, 3: 639, 4: 495, 5: 435, 6: 365, 7: 293, 9: 263, 8: 250, 10: 230, 11: 217, 12: 200, 13: 191, 14: 157, 15: 138, 16: 136, 20: 130, 17: 128, 18: 126, 19: 120, 21: 117, 24: 92, 23: 88, 22: 76})

----------------------------------------after blocks to device 
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.13299942016601562  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.82763671875 GB
    Memory Allocated: 0.13299942016601562  GigaBytes
Max Memory Allocated: 8.402959823608398  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.32568359375 GB
    Memory Allocated: 9.077130794525146  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.32568359375 GB
    Memory Allocated: 9.078489303588867  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.13614940643310547  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.20273113250732422  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.1696767807006836  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07103273868560792 |0.004958939552307129 |0.3847057580947876 |0.0015185356140136718 |0.30323190689086915 |0.11336851119995117 |
----------------------------------------------------------pseudo_mini_loss sum 3.7772603034973145
Total (block generation + training)time/epoch 51.792794704437256
Training time/epoch 7.834463834762573
Training time without block to device /epoch 7.784874439239502
Training time without total dataloading part /epoch 7.007930517196655
load block tensor time/epoch 0.7103273868560791
block to device time/epoch 0.04958939552307129
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  726236
Number of first layer input nodes during this epoch:  475842
Number of first layer output nodes during this epoch:  250394
----------------------------------------before generate dataloader block 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.15436315536499023  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.422 seconds, peak memory: 33.127 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 33.127 GB
Metis partitioning: 5.254 seconds, peak memory: 33.763 GB
Split the graph: 6.692 seconds
Construct subgraphs: 0.091 seconds
REG metis partition end ----................................
REG construction  time spent:  24.308993816375732
pure dgl.metis_partition the time spent:  13.485805034637451
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7517220973968506

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.6080260276794434

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.15436315536499023  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

connection checking time:  1.606673240661621
block generation total time  2.359748125076294
average batch blocks generation time:  0.2359748125076294
block dataloader generation time/epoch 43.17650890350342
pseudo mini batch 0 input nodes size: 30617
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.1496443748474121  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.1496443748474121  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.1642436981201172  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.16431236267089844  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.13414573669433594  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1412, 2: 1319, 3: 1017, 4: 827, 5: 667, 6: 516, 7: 476, 25: 452, 8: 410, 9: 328, 10: 278, 11: 237, 12: 193, 13: 171, 15: 156, 14: 144, 16: 118, 17: 89, 20: 75, 19: 75, 18: 69, 21: 51, 22: 47, 23: 38, 24: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.13588237762451172  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.13588237762451172  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 4.841723442077637  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 4.843204498291016  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.16780519485473633  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

pseudo mini batch 1 input nodes size: 30622
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.1662273406982422  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.1662273406982422  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.18082904815673828  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.18089818954467773  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.1662302017211914  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1483, 2: 1381, 3: 1060, 4: 835, 5: 723, 6: 562, 7: 453, 8: 389, 25: 379, 9: 303, 10: 268, 11: 203, 12: 191, 13: 151, 14: 150, 15: 124, 18: 90, 16: 89, 17: 89, 19: 68, 21: 53, 20: 49, 22: 48, 23: 42, 24: 40})

----------------------------------------after blocks to device 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.16788339614868164  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.16788339614868164  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 4.6711812019348145  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 4.672661781311035  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.16914701461791992  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

pseudo mini batch 2 input nodes size: 37496
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.16764593124389648  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.16764593124389648  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.18552541732788086  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.1855945587158203  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.17092370986938477  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1522, 2: 1302, 3: 1066, 4: 845, 5: 658, 25: 545, 6: 524, 7: 413, 8: 358, 9: 318, 10: 266, 11: 220, 12: 202, 13: 167, 14: 132, 15: 117, 17: 97, 16: 90, 19: 75, 18: 67, 20: 59, 21: 55, 22: 54, 24: 42, 23: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.1727151870727539  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.1727151870727539  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 4.952681541442871  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 4.954257488250732  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.17426204681396484  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

pseudo mini batch 3 input nodes size: 27046
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.17258071899414062  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.17258071899414062  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.18625259399414062  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.18632125854492188  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.16837263107299805  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1249, 2: 1061, 3: 933, 25: 828, 4: 745, 5: 643, 6: 505, 7: 451, 8: 376, 9: 327, 10: 287, 11: 256, 12: 208, 13: 193, 14: 179, 15: 164, 17: 135, 16: 116, 20: 108, 18: 95, 19: 85, 21: 85, 24: 58, 22: 55, 23: 53})

----------------------------------------after blocks to device 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.17034673690795898  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.17034673690795898  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 5.63633918762207  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 5.637915134429932  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.1717057228088379  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

pseudo mini batch 4 input nodes size: 27506
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.17003202438354492  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.17003202438354492  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.18370389938354492  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.18377304077148438  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.17003250122070312  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 1015, 1: 1000, 3: 881, 25: 762, 4: 757, 5: 627, 6: 571, 7: 478, 8: 415, 9: 366, 10: 331, 11: 306, 12: 253, 13: 214, 14: 191, 16: 154, 15: 146, 17: 144, 18: 130, 20: 105, 19: 98, 21: 96, 22: 72, 23: 72, 24: 61})

----------------------------------------after blocks to device 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.17203760147094727  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.17203760147094727  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 5.831418037414551  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 5.832852840423584  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.17349672317504883  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

pseudo mini batch 5 input nodes size: 49619
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.17186880111694336  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.17186880111694336  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.19552898406982422  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.19559621810913086  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.1818552017211914  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1710, 2: 1366, 3: 1065, 4: 811, 5: 731, 6: 508, 25: 447, 7: 392, 8: 364, 9: 282, 10: 224, 12: 156, 11: 152, 13: 140, 14: 120, 15: 87, 16: 69, 17: 66, 18: 63, 20: 57, 19: 56, 22: 38, 24: 34, 21: 34, 23: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.18377065658569336  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.74365234375 GB
    Memory Allocated: 0.18377065658569336  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 4.821444034576416  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 4.822840690612793  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.18539762496948242  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

pseudo mini batch 6 input nodes size: 52915
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.18322324752807617  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.18322324752807617  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.20845508575439453  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.20852231979370117  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.18479490280151367  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1539, 2: 1378, 3: 1076, 4: 805, 5: 667, 25: 512, 6: 492, 7: 402, 8: 338, 9: 292, 10: 253, 11: 204, 13: 158, 12: 156, 14: 117, 15: 100, 16: 99, 18: 77, 17: 74, 19: 62, 21: 52, 20: 49, 22: 37, 23: 35, 24: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.1868743896484375  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.1868743896484375  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 5.1013007164001465  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 5.102689743041992  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.18895721435546875  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

pseudo mini batch 7 input nodes size: 67266
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.18655776977539062  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.18655776977539062  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.21863269805908203  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.21869897842407227  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.19339990615844727  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1595, 1: 1273, 2: 1022, 3: 759, 4: 565, 5: 564, 6: 423, 7: 328, 8: 275, 9: 257, 10: 222, 11: 216, 12: 180, 13: 135, 14: 128, 18: 119, 15: 116, 16: 111, 19: 100, 17: 97, 20: 89, 21: 84, 24: 68, 22: 62, 23: 54})

----------------------------------------after blocks to device 
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.1986403465270996  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.1986403465270996  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 7.656142234802246  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 7.657834529876709  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.20185136795043945  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

pseudo mini batch 8 input nodes size: 60958
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.19578313827514648  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.19578313827514648  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.22485017776489258  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.22491884231567383  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.1927776336669922  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2460, 1: 939, 2: 748, 3: 633, 4: 493, 5: 427, 6: 350, 7: 302, 8: 270, 9: 267, 11: 244, 10: 240, 12: 223, 13: 180, 16: 154, 15: 154, 18: 151, 14: 150, 17: 145, 20: 128, 19: 125, 21: 110, 24: 102, 23: 96, 22: 81})

----------------------------------------after blocks to device 
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.19835662841796875  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.77099609375 GB
    Memory Allocated: 0.19835662841796875  GigaBytes
Max Memory Allocated: 9.703772068023682  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.34326171875 GB
    Memory Allocated: 9.384042263031006  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.34326171875 GB
    Memory Allocated: 9.385568618774414  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.2020864486694336  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 9 input nodes size: 79784
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1950697898864746  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1950697898864746  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.23311376571655273  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.23317956924438477  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.20404386520385742  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1480, 1: 1301, 2: 1114, 3: 787, 4: 637, 5: 515, 6: 417, 7: 350, 8: 277, 9: 236, 10: 230, 12: 175, 11: 165, 13: 147, 15: 125, 14: 123, 16: 111, 21: 97, 17: 94, 19: 92, 20: 88, 18: 87, 23: 65, 22: 62, 24: 53})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.2092304229736328  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.2092304229736328  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 7.882117748260498  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 7.884082794189453  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.2129678726196289  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.2129678726196289  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17991352081298828  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0777127742767334 |0.004422283172607422 |0.13935518264770508 |0.00011882781982421874 |0.2925770998001099 |0.002109050750732422 |
----------------------------------------------------------pseudo_mini_loss sum 18.452125549316406
Total (block generation + training)time/epoch 49.7373389005661
Training time/epoch 5.286558151245117
Training time without block to device /epoch 5.242335319519043
Training time without total dataloading part /epoch 4.322620153427124
load block tensor time/epoch 0.777127742767334
block to device time/epoch 0.04422283172607422
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  707649
Number of first layer input nodes during this epoch:  463829
Number of first layer output nodes during this epoch:  243820
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.16406536102294922  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.547 seconds, peak memory: 35.822 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 35.822 GB
Metis partitioning: 5.126 seconds, peak memory: 36.400 GB
Split the graph: 7.097 seconds
Construct subgraphs: 0.100 seconds
REG metis partition end ----................................
REG construction  time spent:  23.012829542160034
pure dgl.metis_partition the time spent:  13.89810585975647
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7478153705596924

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.6511473655700684

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.16406536102294922  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

connection checking time:  1.6310827732086182
block generation total time  2.3989627361297607
average batch blocks generation time:  0.23989627361297608
block dataloader generation time/epoch 42.65304168065389
pseudo mini batch 0 input nodes size: 29386
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1575942039489746  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1575942039489746  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17160654067993164  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1716761589050293  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.13356637954711914  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1327, 2: 1200, 3: 1010, 4: 813, 5: 676, 6: 541, 25: 517, 7: 470, 8: 446, 9: 356, 10: 305, 11: 257, 12: 205, 13: 201, 14: 149, 15: 147, 16: 129, 19: 100, 17: 98, 20: 86, 18: 85, 21: 64, 22: 59, 23: 56, 24: 40})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.13541507720947266  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.13541507720947266  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 5.184627532958984  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 5.18612003326416  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.16741704940795898  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 1 input nodes size: 26892
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.165771484375  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.165771484375  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.179443359375  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17951250076293945  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.16543054580688477  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1764, 2: 1592, 3: 1217, 4: 898, 5: 765, 6: 557, 7: 416, 8: 358, 9: 293, 10: 237, 25: 179, 11: 176, 12: 146, 13: 119, 14: 110, 15: 98, 16: 73, 17: 66, 18: 56, 19: 38, 21: 31, 20: 26, 22: 22, 24: 21, 23: 18})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.16680049896240234  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.16680049896240234  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 3.909480571746826  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 3.9109725952148438  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.16789531707763672  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 2 input nodes size: 42126
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1666407585144043  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1666407585144043  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.18672800064086914  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1867976188659668  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17305660247802734  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1274, 2: 1194, 3: 924, 4: 795, 25: 727, 5: 631, 6: 511, 7: 476, 8: 385, 9: 348, 10: 290, 11: 247, 12: 243, 13: 206, 14: 187, 15: 150, 17: 112, 16: 104, 18: 89, 19: 84, 20: 77, 22: 71, 21: 69, 24: 57, 23: 41})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17513513565063477  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17513513565063477  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 5.649214744567871  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 5.65071439743042  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17694330215454102  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 3 input nodes size: 28824
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17496824264526367  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17496824264526367  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.18871259689331055  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.18878173828125  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1686248779296875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1242, 2: 1060, 3: 932, 25: 837, 4: 739, 5: 644, 6: 496, 7: 454, 8: 395, 9: 322, 10: 306, 11: 257, 12: 222, 14: 186, 13: 182, 15: 163, 17: 135, 16: 119, 20: 102, 18: 96, 21: 87, 19: 85, 23: 63, 24: 56, 22: 54})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17063665390014648  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17063665390014648  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 5.710232734680176  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 5.7118964195251465  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17201566696166992  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 4 input nodes size: 28396
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1702885627746582  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1702885627746582  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1839604377746582  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.18402862548828125  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17021512985229492  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1057, 2: 1055, 3: 888, 4: 736, 25: 711, 5: 641, 6: 573, 7: 470, 8: 380, 9: 352, 10: 317, 11: 283, 12: 231, 13: 203, 14: 172, 17: 151, 16: 149, 15: 133, 18: 124, 20: 107, 21: 100, 19: 98, 22: 67, 23: 65, 24: 63})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17217493057250977  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17217493057250977  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 5.63690185546875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 5.63840913772583  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.17359304428100586  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 5 input nodes size: 51763
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.171966552734375  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.171966552734375  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.19664907455444336  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1967158317565918  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.18297576904296875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1694, 2: 1350, 3: 1072, 4: 812, 5: 715, 6: 503, 25: 409, 7: 390, 8: 354, 9: 289, 10: 238, 12: 167, 11: 157, 13: 132, 14: 110, 15: 97, 16: 79, 17: 65, 18: 61, 19: 57, 20: 51, 24: 33, 21: 32, 23: 31, 22: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1849040985107422  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.1849040985107422  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 4.785914897918701  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 4.787364959716797  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.18674373626708984  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 6 input nodes size: 58997
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.18451166152954102  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.18451166152954102  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.21264362335205078  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.21270990371704102  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.18796062469482422  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1619, 2: 1334, 3: 1022, 4: 818, 5: 624, 25: 542, 6: 496, 7: 400, 8: 330, 9: 256, 10: 214, 11: 198, 12: 156, 13: 137, 15: 105, 14: 101, 16: 92, 18: 89, 17: 74, 20: 60, 19: 50, 21: 47, 23: 45, 22: 41, 24: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.19012832641601562  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.78076171875 GB
    Memory Allocated: 0.19012832641601562  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 5.233989715576172  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 5.235352993011475  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19170379638671875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 7 input nodes size: 66550
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.18910551071166992  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.18910551071166992  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.2208390235900879  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.22090482711791992  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19270658493041992  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1371, 25: 1331, 2: 1161, 3: 840, 4: 604, 5: 528, 6: 450, 7: 367, 8: 276, 9: 257, 10: 221, 11: 211, 12: 170, 13: 129, 14: 116, 15: 106, 16: 102, 18: 96, 17: 92, 19: 89, 20: 78, 21: 72, 24: 64, 22: 53, 23: 44})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19578933715820312  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19578933715820312  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 7.010869026184082  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 7.012435436248779  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19855594635009766  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 8 input nodes size: 77718
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19469451904296875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19469451904296875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.23180389404296875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.23186969757080078  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.20007038116455078  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1899, 1: 1111, 2: 965, 3: 729, 4: 541, 5: 495, 6: 365, 8: 289, 7: 285, 9: 235, 10: 224, 11: 194, 12: 183, 13: 165, 14: 149, 15: 137, 18: 124, 16: 123, 19: 109, 17: 106, 21: 97, 20: 87, 23: 80, 22: 71, 24: 65})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.20543622970581055  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.20543622970581055  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 8.782090187072754  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 8.783475399017334  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.2097306251525879  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 9 input nodes size: 60031
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.2024097442626953  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.2024097442626953  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.2310347557067871  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.23110342025756836  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19392824172973633  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2308, 1: 969, 2: 795, 3: 643, 4: 564, 5: 503, 6: 376, 7: 317, 9: 268, 8: 259, 10: 247, 11: 223, 12: 214, 13: 182, 14: 154, 15: 153, 16: 141, 20: 133, 17: 131, 18: 128, 19: 126, 21: 118, 24: 93, 22: 88, 23: 76})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19951486587524414  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19951486587524414  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 9.075995922088623  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 9.077388763427734  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.20275545120239258  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.20275545120239258  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.16970109939575195  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07715489864349365 |0.004713582992553711 |0.13984327316284179 |0.00012259483337402345 |0.2953676462173462 |0.0037314891815185547 |
----------------------------------------------------------pseudo_mini_loss sum 8.487645149230957
Total (block generation + training)time/epoch 48.795629024505615
Training time/epoch 5.305847883224487
Training time without block to device /epoch 5.25871205329895
Training time without total dataloading part /epoch 4.357066631317139
load block tensor time/epoch 0.7715489864349365
block to device time/epoch 0.04713582992553711
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  716981
Number of first layer input nodes during this epoch:  470683
Number of first layer output nodes during this epoch:  246298
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.1544189453125  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.451 seconds, peak memory: 36.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.476 GB
Metis partitioning: 5.110 seconds, peak memory: 36.476 GB
Split the graph: 6.920 seconds
Construct subgraphs: 0.096 seconds
REG metis partition end ----................................
REG construction  time spent:  23.309251070022583
pure dgl.metis_partition the time spent:  13.60485577583313
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.809117317199707

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.6953942775726318

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.1544189453125  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

connection checking time:  1.628225326538086
block generation total time  2.504511594772339
average batch blocks generation time:  0.2504511594772339
block dataloader generation time/epoch 42.421942830085754
pseudo mini batch 0 input nodes size: 42442
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.14826583862304688  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.14826583862304688  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.1685037612915039  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.16857290267944336  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.1398792266845703  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1717, 2: 1466, 3: 1134, 4: 892, 5: 762, 6: 563, 7: 405, 8: 363, 25: 300, 9: 298, 10: 241, 11: 170, 13: 153, 12: 148, 14: 103, 15: 97, 16: 84, 18: 71, 17: 67, 19: 50, 20: 42, 21: 30, 24: 24, 23: 23, 22: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.14156293869018555  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.14156293869018555  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 4.379776954650879  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 4.38121223449707  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.17333698272705078  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 1 input nodes size: 53015
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.17155838012695312  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.17155838012695312  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.1968379020690918  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19690465927124023  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.17659759521484375  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1678, 2: 1413, 3: 1039, 4: 764, 5: 665, 25: 539, 6: 450, 7: 393, 8: 358, 9: 259, 10: 223, 11: 197, 12: 145, 13: 120, 14: 103, 15: 92, 16: 78, 18: 74, 19: 72, 17: 67, 20: 61, 24: 46, 21: 45, 22: 40, 23: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.17873668670654297  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.17873668670654297  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 5.125105857849121  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 5.126491069793701  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.18074893951416016  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 2 input nodes size: 73362
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.17819452285766602  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.17819452285766602  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.21317625045776367  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.2132420539855957  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.1878957748413086  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1801, 1: 1098, 2: 983, 3: 734, 4: 560, 5: 517, 6: 382, 7: 319, 9: 268, 8: 262, 10: 228, 11: 196, 12: 188, 13: 147, 14: 146, 15: 133, 16: 127, 18: 121, 17: 117, 19: 107, 20: 97, 21: 94, 22: 74, 24: 73, 23: 56})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19323110580444336  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19323110580444336  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 8.291436195373535  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 8.292977809906006  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.1970076560974121  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 3 input nodes size: 60958
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19067049026489258  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19067049026489258  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.21973752975463867  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.21980571746826172  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.18475818634033203  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2392, 1: 987, 2: 769, 3: 646, 4: 483, 5: 468, 6: 361, 7: 298, 9: 263, 8: 251, 10: 242, 11: 227, 12: 213, 13: 198, 14: 145, 16: 138, 15: 138, 19: 132, 17: 132, 18: 128, 20: 124, 21: 121, 24: 86, 23: 86, 22: 80})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19036006927490234  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19036006927490234  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 9.19319772720337  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 9.19498348236084  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19321918487548828  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 4 input nodes size: 79379
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.18699932098388672  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.18699932098388672  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.22485017776489258  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.2249159812927246  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19578075408935547  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1404, 25: 1355, 2: 1144, 3: 846, 4: 647, 5: 521, 6: 417, 7: 333, 8: 286, 9: 236, 10: 211, 11: 177, 12: 174, 13: 132, 15: 123, 14: 118, 16: 108, 18: 104, 17: 90, 19: 80, 20: 77, 21: 72, 23: 65, 22: 59, 24: 49})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.200164794921875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.200164794921875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 7.556478023529053  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 7.557977676391602  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.2044663429260254  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 5 input nodes size: 28764
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19761276245117188  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.19761276245117188  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.21132850646972656  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.21139764785766602  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.17348098754882812  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1545, 2: 1355, 3: 1131, 4: 868, 5: 703, 6: 540, 7: 477, 8: 375, 25: 372, 9: 299, 10: 267, 11: 222, 12: 185, 13: 164, 15: 127, 14: 127, 16: 103, 17: 73, 19: 64, 20: 62, 18: 60, 21: 39, 22: 39, 24: 33, 23: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.17508745193481445  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.79443359375 GB
    Memory Allocated: 0.17508745193481445  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.80615234375 GB
    Memory Allocated: 4.560482025146484  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.80615234375 GB
    Memory Allocated: 4.561901569366455  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.80615234375 GB
    Memory Allocated: 0.17624998092651367  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 6 input nodes size: 31916
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.80615234375 GB
    Memory Allocated: 0.17480230331420898  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.80615234375 GB
    Memory Allocated: 0.17480230331420898  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.80615234375 GB
    Memory Allocated: 0.19002103805541992  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.80615234375 GB
    Memory Allocated: 0.19009065628051758  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.80615234375 GB
    Memory Allocated: 0.17630577087402344  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1569, 2: 1415, 3: 1053, 4: 845, 5: 682, 6: 557, 7: 446, 25: 402, 8: 392, 9: 315, 10: 254, 11: 208, 12: 195, 13: 148, 14: 143, 15: 112, 16: 94, 17: 88, 18: 73, 19: 62, 21: 56, 23: 47, 22: 47, 20: 43, 24: 39})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.80615234375 GB
    Memory Allocated: 0.17798471450805664  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.80615234375 GB
    Memory Allocated: 0.17798471450805664  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 4.692500591278076  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 4.693904876708984  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.17940378189086914  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 7 input nodes size: 42625
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.17784595489501953  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.17784595489501953  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.19817113876342773  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.1982402801513672  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.1829519271850586  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1183, 2: 1097, 3: 904, 4: 791, 25: 754, 5: 661, 6: 529, 7: 444, 8: 413, 9: 349, 10: 314, 11: 259, 12: 243, 13: 209, 14: 190, 15: 176, 17: 118, 16: 115, 18: 95, 20: 95, 19: 91, 22: 73, 21: 72, 24: 55, 23: 49})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.18512296676635742  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.18512296676635742  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 5.870022296905518  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 5.8714799880981445  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.18680810928344727  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 8 input nodes size: 28522
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.1847214698791504  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.1847214698791504  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.1983933448791504  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.19846248626708984  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.1780681610107422  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1215, 2: 1041, 3: 917, 25: 842, 4: 728, 5: 645, 6: 522, 7: 469, 8: 402, 9: 351, 10: 303, 11: 264, 12: 220, 13: 181, 14: 178, 15: 168, 17: 139, 16: 121, 18: 100, 20: 99, 21: 96, 19: 86, 24: 61, 23: 58, 22: 57})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.18009424209594727  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.18009424209594727  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 5.771017551422119  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 5.772665977478027  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.18182802200317383  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 9 input nodes size: 27666
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.1800990104675293  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.1800990104675293  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.1937708854675293  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.19383764266967773  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.18009662628173828  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1032, 2: 1023, 3: 873, 4: 742, 25: 703, 5: 598, 6: 547, 7: 461, 8: 370, 9: 338, 10: 316, 11: 283, 12: 226, 13: 204, 14: 181, 16: 143, 17: 139, 15: 123, 18: 122, 20: 107, 19: 92, 21: 92, 23: 67, 22: 65, 24: 59})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.1820058822631836  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.1820058822631836  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 5.53090238571167  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 5.532382965087891  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.18320465087890625  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.18320465087890625  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.15015029907226562  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07742211818695069 |0.0033913373947143553 |0.13911900520324708 |0.00011637210845947266 |0.29481730461120603 |0.0020220279693603516 |
----------------------------------------------------------pseudo_mini_loss sum 4.820817470550537
Total (block generation + training)time/epoch 48.34976315498352
Training time/epoch 5.283333778381348
Training time without block to device /epoch 5.249420404434204
Training time without total dataloading part /epoch 4.342548847198486
load block tensor time/epoch 0.7742211818695068
block to device time/epoch 0.033913373947143555
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  715758
Number of first layer input nodes during this epoch:  468649
Number of first layer output nodes during this epoch:  247109
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.13400030136108398  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.503 seconds, peak memory: 36.518 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.518 GB
Metis partitioning: 5.259 seconds, peak memory: 36.518 GB
Split the graph: 6.223 seconds
Construct subgraphs: 0.101 seconds
REG metis partition end ----................................
REG construction  time spent:  25.112090349197388
pure dgl.metis_partition the time spent:  13.113189458847046
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.788856029510498

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.5758898258209229

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.13400030136108398  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

connection checking time:  1.6304585933685303
block generation total time  2.364745855331421
average batch blocks generation time:  0.2364745855331421
block dataloader generation time/epoch 42.5087272644043
pseudo mini batch 0 input nodes size: 29595
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.13242101669311523  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.13242101669311523  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.14653301239013672  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.14660215377807617  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.13286352157592773  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1469, 2: 1301, 3: 1080, 4: 884, 5: 682, 6: 549, 7: 475, 8: 425, 25: 371, 9: 352, 10: 275, 11: 225, 12: 188, 13: 170, 14: 129, 15: 128, 16: 114, 18: 84, 17: 74, 19: 74, 20: 68, 21: 45, 22: 42, 23: 36, 24: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.13451766967773438  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.13451766967773438  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 4.6653642654418945  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 4.666776657104492  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.16738462448120117  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 1 input nodes size: 32871
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.16590213775634766  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.16590213775634766  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.18157625198364258  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.18164587020874023  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.1674647331237793  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1526, 2: 1413, 3: 1061, 4: 814, 5: 734, 6: 555, 7: 463, 25: 401, 8: 384, 9: 302, 10: 255, 11: 224, 12: 185, 13: 154, 15: 130, 14: 129, 17: 94, 16: 85, 18: 66, 19: 62, 20: 57, 21: 56, 22: 48, 23: 47, 24: 37})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.16915512084960938  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.81787109375 GB
    Memory Allocated: 0.16915512084960938  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.706557750701904  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.7080230712890625  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17018604278564453  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 2 input nodes size: 36765
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16861248016357422  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16861248016357422  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18619060516357422  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18625879287719727  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1705150604248047  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1466, 2: 1267, 3: 1043, 4: 860, 5: 643, 6: 521, 25: 517, 7: 391, 8: 377, 9: 319, 10: 293, 11: 226, 12: 202, 13: 180, 15: 139, 14: 136, 17: 83, 16: 75, 18: 72, 19: 72, 20: 57, 21: 51, 22: 48, 24: 36, 23: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17226886749267578  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17226886749267578  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.8573994636535645  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.858790397644043  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17391014099121094  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 3 input nodes size: 27284
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17227792739868164  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17227792739868164  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18594980239868164  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18601655960083008  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16837024688720703  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1098, 2: 1059, 3: 917, 4: 729, 25: 686, 5: 611, 6: 546, 7: 447, 8: 371, 9: 328, 10: 301, 11: 267, 12: 219, 13: 189, 14: 164, 16: 143, 17: 139, 15: 122, 18: 121, 20: 97, 21: 92, 19: 87, 23: 66, 22: 65, 24: 59})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17023754119873047  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17023754119873047  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.408905506134033  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.410515785217285  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17140865325927734  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 4 input nodes size: 27719
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16986846923828125  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16986846923828125  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18354034423828125  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1836094856262207  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16987085342407227  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1221, 2: 1064, 3: 911, 25: 838, 4: 746, 5: 653, 6: 506, 7: 468, 8: 388, 9: 336, 10: 302, 11: 267, 12: 218, 13: 190, 14: 188, 15: 162, 17: 135, 16: 117, 20: 106, 18: 99, 21: 90, 19: 89, 24: 58, 23: 58, 22: 53})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1718730926513672  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1718730926513672  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.723914623260498  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.725330352783203  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17356491088867188  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 5 input nodes size: 51643
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1718730926513672  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1718730926513672  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19649839401245117  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1965656280517578  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18282461166381836  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1456, 2: 1247, 3: 989, 4: 788, 5: 651, 25: 623, 6: 507, 7: 425, 8: 364, 9: 286, 10: 249, 12: 188, 11: 182, 14: 152, 13: 144, 15: 120, 16: 113, 17: 95, 18: 73, 19: 68, 21: 61, 20: 52, 24: 46, 22: 45, 23: 43})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18496131896972656  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18496131896972656  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.375335216522217  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.376922607421875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18703651428222656  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 6 input nodes size: 43906
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1846609115600586  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1846609115600586  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.2061452865600586  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.20621299743652344  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1815204620361328  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1702, 2: 1439, 3: 1066, 4: 820, 5: 752, 6: 491, 7: 414, 25: 362, 8: 336, 9: 283, 10: 241, 12: 169, 11: 159, 13: 145, 14: 122, 15: 89, 16: 84, 18: 77, 17: 72, 20: 55, 19: 55, 22: 34, 24: 31, 23: 29, 21: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1832585334777832  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1832585334777832  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.546268939971924  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.547848701477051  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18442296981811523  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 7 input nodes size: 64222
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18257522583007812  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18257522583007812  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.21382522583007812  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.21389102935791016  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1923389434814453  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1394, 25: 1351, 2: 1176, 3: 799, 4: 613, 5: 527, 6: 421, 7: 335, 8: 296, 9: 243, 11: 223, 10: 217, 12: 170, 13: 132, 14: 110, 16: 108, 15: 104, 18: 98, 19: 95, 17: 90, 20: 83, 21: 74, 24: 63, 22: 63, 23: 44})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19538640975952148  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19538640975952148  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 7.007371425628662  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 7.008947372436523  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1980423927307129  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 8 input nodes size: 60236
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1942734718322754  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1942734718322754  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.22299623489379883  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.2230663299560547  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19175052642822266  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2352, 1: 994, 2: 796, 3: 691, 4: 525, 5: 493, 6: 388, 7: 334, 9: 294, 8: 263, 10: 251, 11: 230, 12: 210, 13: 192, 14: 154, 15: 147, 16: 147, 18: 134, 17: 134, 19: 131, 20: 129, 21: 121, 24: 94, 23: 84, 22: 79})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19736862182617188  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19736862182617188  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 9.204320907592773  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 9.205801486968994  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.2004833221435547  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 9 input nodes size: 71932
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1943202018737793  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1943202018737793  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.22862005233764648  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.22868633270263672  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19989347457885742  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1959, 1: 1102, 2: 944, 3: 720, 4: 541, 5: 476, 6: 384, 7: 293, 8: 268, 9: 233, 10: 215, 11: 200, 12: 188, 13: 160, 14: 150, 15: 148, 16: 125, 18: 124, 17: 114, 21: 104, 20: 103, 19: 103, 23: 81, 22: 79, 24: 68})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.2052922248840332  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.2052922248840332  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 8.77366828918457  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 8.775133609771729  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.2090287208557129  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.2090287208557129  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17597436904907227  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07463908195495605 |0.004269957542419434 |0.14448986053466797 |0.000135040283203125 |0.29439435005187986 |0.0035767555236816406 |
----------------------------------------------------------pseudo_mini_loss sum 4.378406524658203
Total (block generation + training)time/epoch 48.31629648208618
Training time/epoch 5.326221704483032
Training time without block to device /epoch 5.283522129058838
Training time without total dataloading part /epoch 4.393769264221191
load block tensor time/epoch 0.7463908195495605
block to device time/epoch 0.042699575424194336
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  683538
Number of first layer input nodes during this epoch:  446173
Number of first layer output nodes during this epoch:  237365
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16047191619873047  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.441 seconds, peak memory: 36.751 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.751 GB
Metis partitioning: 5.040 seconds, peak memory: 36.751 GB
Split the graph: 6.443 seconds
Construct subgraphs: 0.091 seconds
REG metis partition end ----................................
REG construction  time spent:  23.817911624908447
pure dgl.metis_partition the time spent:  13.04369068145752
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7898626327514648

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.705141305923462

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16047191619873047  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

connection checking time:  1.7055120468139648
block generation total time  2.4950039386749268
average batch blocks generation time:  0.24950039386749268
block dataloader generation time/epoch 42.37466033299764
pseudo mini batch 0 input nodes size: 55417
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.15360355377197266  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.15360355377197266  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18094730377197266  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1810135841369629  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.14664745330810547  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1612, 2: 1416, 3: 1062, 4: 843, 5: 710, 6: 483, 25: 401, 7: 374, 8: 334, 9: 281, 10: 232, 11: 167, 12: 142, 13: 137, 14: 117, 16: 90, 15: 86, 18: 71, 17: 66, 19: 49, 20: 45, 21: 42, 23: 33, 22: 30, 24: 29})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.14862060546875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.14862060546875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.752276420593262  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.753875732421875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18125200271606445  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 1 input nodes size: 57633
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17891263961791992  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17891263961791992  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.20639419555664062  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.20646047592163086  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17905044555664062  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1739, 2: 1404, 3: 1063, 4: 823, 5: 676, 6: 473, 7: 403, 25: 390, 8: 352, 9: 263, 10: 208, 11: 159, 12: 151, 13: 122, 14: 97, 15: 84, 18: 72, 16: 72, 17: 63, 19: 59, 20: 54, 21: 37, 24: 32, 23: 30, 22: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.181060791015625  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.181060791015625  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.781279563903809  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.7827677726745605  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18256759643554688  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 2 input nodes size: 71595
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1801161766052246  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1801161766052246  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.21425533294677734  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.21432113647460938  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18677330017089844  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1558, 1: 1226, 2: 1078, 3: 761, 4: 585, 5: 523, 6: 419, 7: 346, 8: 271, 9: 249, 10: 239, 11: 230, 12: 186, 13: 147, 14: 127, 15: 119, 19: 107, 18: 104, 16: 98, 17: 96, 20: 93, 21: 79, 24: 68, 22: 62, 23: 57})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1920018196105957  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1920018196105957  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 7.660923957824707  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 7.662374019622803  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19510889053344727  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 3 input nodes size: 79560
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1889810562133789  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1889810562133789  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.22691822052001953  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.22698402404785156  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1927790641784668  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1682, 1: 1185, 2: 999, 3: 777, 4: 550, 5: 508, 6: 405, 7: 321, 8: 277, 9: 251, 10: 241, 11: 197, 12: 185, 13: 152, 15: 139, 14: 128, 16: 118, 18: 113, 17: 106, 21: 95, 20: 94, 19: 89, 23: 77, 24: 70, 22: 69})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19806480407714844  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19806480407714844  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 8.369872570037842  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 8.371440887451172  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.2025289535522461  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 4 input nodes size: 61504
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19503355026245117  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19503355026245117  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.22436094284057617  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.22442865371704102  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18642568588256836  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2363, 1: 993, 2: 786, 3: 638, 4: 495, 5: 458, 6: 369, 7: 300, 9: 263, 8: 247, 10: 225, 11: 212, 12: 210, 13: 169, 14: 152, 15: 152, 16: 143, 18: 133, 17: 132, 19: 131, 20: 117, 21: 116, 22: 87, 24: 84, 23: 82})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19197750091552734  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19197750091552734  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 9.145748138427734  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 9.147243976593018  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19626665115356445  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 5 input nodes size: 32082
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18906402587890625  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18906402587890625  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.2043619155883789  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.20443105697631836  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17503595352172852  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1618, 2: 1406, 3: 1101, 4: 878, 5: 730, 6: 573, 7: 447, 8: 385, 25: 341, 9: 286, 10: 252, 11: 203, 12: 182, 13: 131, 14: 127, 15: 116, 16: 81, 18: 77, 17: 76, 19: 56, 21: 53, 20: 45, 22: 43, 24: 35, 23: 34})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17665672302246094  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17665672302246094  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.509674549102783  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.511178016662598  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17814922332763672  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 6 input nodes size: 41265
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17662382125854492  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17662382125854492  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19630050659179688  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19637060165405273  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18100357055664062  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1341, 2: 1212, 3: 985, 4: 807, 5: 713, 25: 639, 6: 532, 7: 469, 8: 424, 9: 326, 10: 284, 11: 231, 12: 218, 13: 197, 14: 165, 15: 147, 16: 132, 17: 109, 20: 86, 19: 79, 18: 74, 22: 60, 21: 53, 24: 42, 23: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1830730438232422  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1830730438232422  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.538277626037598  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.53998327255249  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18465232849121094  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 7 input nodes size: 37175
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1826033592224121  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1826033592224121  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.20032978057861328  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.20039939880371094  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18065261840820312  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1280, 2: 1229, 3: 996, 4: 859, 5: 634, 25: 542, 6: 540, 7: 464, 8: 408, 9: 373, 10: 302, 11: 264, 12: 230, 13: 204, 14: 160, 15: 152, 16: 108, 17: 99, 18: 89, 19: 82, 20: 73, 22: 61, 21: 57, 24: 47, 23: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18255186080932617  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18255186080932617  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.267376899719238  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.26886510848999  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18384885787963867  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 8 input nodes size: 30494
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18208885192871094  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18208885192871094  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19662952423095703  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1966991424560547  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17890310287475586  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1170, 2: 1112, 3: 955, 4: 742, 25: 716, 5: 631, 6: 554, 7: 461, 8: 392, 9: 340, 10: 323, 11: 276, 12: 216, 13: 211, 14: 180, 17: 148, 16: 143, 15: 128, 18: 119, 20: 98, 19: 95, 21: 87, 23: 70, 22: 59, 24: 57})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1808786392211914  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1808786392211914  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.647256851196289  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.648680210113525  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18254756927490234  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 9 input nodes size: 27552
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1808633804321289  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1808633804321289  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1945352554321289  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19460487365722656  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1799945831298828  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1264, 2: 1064, 3: 939, 25: 828, 4: 738, 5: 639, 6: 520, 7: 460, 8: 382, 9: 344, 10: 293, 11: 264, 12: 217, 13: 186, 14: 181, 15: 166, 17: 135, 16: 126, 20: 102, 21: 98, 18: 96, 19: 89, 24: 61, 23: 59, 22: 58})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18200254440307617  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18200254440307617  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.737452030181885  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.739039421081543  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18353986740112305  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18353986740112305  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.15048551559448242  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07691984176635742 |0.003963851928710937 |0.1391986846923828 |0.0001142263412475586 |0.2962313175201416 |0.004807233810424805 |
----------------------------------------------------------pseudo_mini_loss sum 4.71476411819458
Total (block generation + training)time/epoch 48.09684570630392
Training time/epoch 5.295010566711426
Training time without block to device /epoch 5.255372047424316
Training time without total dataloading part /epoch 4.3602495193481445
load block tensor time/epoch 0.7691984176635742
block to device time/epoch 0.039638519287109375
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  747885
Number of first layer input nodes during this epoch:  494277
Number of first layer output nodes during this epoch:  253608
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.13437938690185547  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.453 seconds, peak memory: 36.751 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.751 GB
Metis partitioning: 5.129 seconds, peak memory: 36.751 GB
Split the graph: 6.457 seconds
Construct subgraphs: 0.096 seconds
REG metis partition end ----................................
REG construction  time spent:  24.9504337310791
pure dgl.metis_partition the time spent:  13.16320252418518
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7529699802398682

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.681384563446045

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.13437938690185547  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

connection checking time:  1.646101951599121
block generation total time  2.434354543685913
average batch blocks generation time:  0.24343545436859132
block dataloader generation time/epoch 42.43964620998928
pseudo mini batch 0 input nodes size: 29484
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1326756477355957  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1326756477355957  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.14673471450805664  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1468043327331543  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.13306283950805664  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1444, 2: 1309, 3: 1094, 4: 859, 5: 709, 6: 587, 7: 501, 8: 382, 25: 367, 9: 359, 10: 279, 11: 240, 12: 185, 13: 170, 15: 128, 14: 125, 16: 102, 17: 80, 18: 73, 19: 72, 20: 68, 22: 45, 21: 45, 23: 36, 24: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1347188949584961  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1347188949584961  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.651902675628662  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.653501987457275  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16730642318725586  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 1 input nodes size: 45425
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1658163070678711  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1658163070678711  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18747663497924805  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1875467300415039  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1734180450439453  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1242, 2: 1110, 3: 908, 25: 857, 4: 762, 5: 662, 6: 513, 8: 440, 7: 435, 9: 315, 10: 306, 11: 234, 12: 229, 13: 193, 14: 185, 15: 173, 16: 122, 17: 122, 18: 101, 19: 87, 22: 85, 20: 84, 21: 79, 23: 64, 24: 59})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17571067810058594  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17571067810058594  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 6.097477436065674  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 6.099480628967285  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17733192443847656  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 2 input nodes size: 28353
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1750659942626953  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1750659942626953  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1887378692626953  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18880701065063477  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16707658767700195  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1574, 2: 1459, 3: 1083, 4: 874, 5: 705, 6: 547, 7: 428, 8: 385, 25: 333, 9: 311, 10: 245, 11: 204, 12: 194, 13: 159, 14: 135, 15: 119, 16: 88, 17: 78, 18: 71, 19: 59, 20: 46, 21: 45, 22: 38, 24: 34, 23: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16861915588378906  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16861915588378906  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.426319599151611  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.427769660949707  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16984081268310547  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 3 input nodes size: 29169
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16847658157348633  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16847658157348633  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18238544464111328  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18245506286621094  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.16871404647827148  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1104, 2: 1051, 3: 941, 4: 770, 25: 723, 5: 631, 6: 586, 7: 477, 8: 394, 9: 350, 10: 324, 11: 286, 12: 229, 13: 211, 14: 182, 17: 150, 16: 147, 15: 130, 18: 120, 20: 101, 19: 100, 21: 96, 23: 71, 22: 66, 24: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17069721221923828  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17069721221923828  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.703902244567871  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.705371379852295  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1722259521484375  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 4 input nodes size: 28740
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17057561874389648  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17057561874389648  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18513250350952148  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18520164489746094  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17122316360473633  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1306, 2: 1123, 3: 966, 25: 819, 4: 747, 5: 646, 6: 491, 7: 446, 8: 374, 9: 329, 10: 297, 11: 249, 12: 203, 14: 177, 13: 172, 15: 154, 17: 126, 16: 119, 20: 100, 18: 95, 21: 83, 19: 80, 23: 56, 24: 56, 22: 52})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17319965362548828  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17319965362548828  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.609269142150879  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 5.610715389251709  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17461395263671875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 5 input nodes size: 50929
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17290401458740234  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.17290401458740234  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1971888542175293  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19725513458251953  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18262910842895508  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1638, 2: 1450, 3: 1081, 4: 805, 5: 698, 6: 467, 7: 396, 25: 368, 8: 335, 9: 274, 10: 241, 11: 199, 12: 157, 13: 133, 14: 104, 15: 97, 16: 77, 17: 66, 18: 61, 19: 58, 20: 50, 21: 44, 24: 30, 22: 22, 23: 18})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18446016311645508  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18446016311645508  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.580641269683838  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.582045555114746  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18598461151123047  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 6 input nodes size: 50402
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18390560150146484  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18390560150146484  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.20793914794921875  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.20800542831420898  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1836543083190918  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1722, 2: 1392, 3: 1064, 4: 797, 5: 684, 6: 489, 25: 422, 7: 380, 8: 335, 9: 259, 10: 218, 11: 169, 12: 162, 13: 137, 14: 100, 15: 80, 16: 74, 17: 68, 18: 59, 19: 57, 20: 57, 24: 36, 21: 31, 22: 31, 23: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18555116653442383  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18555116653442383  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.692946910858154  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 4.6943135261535645  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1874217987060547  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 7 input nodes size: 66784
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18523168563842773  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.18523168563842773  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.21707677841186523  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.21714258193969727  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19304275512695312  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1710, 1: 1107, 2: 969, 3: 740, 4: 565, 5: 526, 6: 433, 7: 364, 8: 278, 9: 243, 10: 225, 11: 213, 12: 179, 14: 148, 13: 146, 15: 132, 18: 124, 16: 121, 17: 115, 19: 115, 21: 85, 20: 82, 22: 76, 24: 72, 23: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19821977615356445  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19821977615356445  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 7.97820520401001  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 7.979815483093262  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.20229005813598633  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 8 input nodes size: 79264
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1950383186340332  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1950383186340332  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.2328343391418457  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.23290014266967773  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.2009892463684082  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1429, 25: 1373, 2: 1101, 3: 769, 4: 649, 5: 491, 6: 413, 7: 313, 8: 308, 9: 266, 10: 234, 11: 191, 12: 175, 13: 149, 15: 145, 14: 115, 16: 106, 18: 103, 17: 89, 20: 85, 21: 82, 19: 80, 23: 59, 22: 58, 24: 45})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.20511913299560547  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.20511913299560547  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 7.64289665222168  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 7.644285678863525  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.21028804779052734  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

pseudo mini batch 9 input nodes size: 60343
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.20334148406982422  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.20334148406982422  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.2321152687072754  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.23218345642089844  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.1943216323852539  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2488, 1: 862, 2: 742, 3: 631, 4: 492, 5: 470, 6: 342, 7: 305, 9: 270, 8: 241, 10: 230, 12: 224, 11: 218, 13: 186, 14: 163, 16: 155, 18: 141, 17: 136, 20: 134, 15: 131, 19: 128, 21: 127, 24: 101, 23: 94, 22: 83})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19997501373291016  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.83154296875 GB
    Memory Allocated: 0.19997501373291016  GigaBytes
Max Memory Allocated: 10.041085243225098  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.27099609375 GB
    Memory Allocated: 9.399774551391602  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.27099609375 GB
    Memory Allocated: 9.40185022354126  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.2036128044128418  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.2036128044128418  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17055845260620117  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07655763626098633 |0.00354921817779541 |0.13908610343933106 |0.00012001991271972656 |0.29375898838043213 |0.004179239273071289 |
----------------------------------------------------------pseudo_mini_loss sum 5.124884128570557
Total (block generation + training)time/epoch 48.096574136189055
Training time/epoch 5.265124320983887
Training time without block to device /epoch 5.229632139205933
Training time without total dataloading part /epoch 4.3338303565979
load block tensor time/epoch 0.7655763626098633
block to device time/epoch 0.0354921817779541
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  713647
Number of first layer input nodes during this epoch:  468893
Number of first layer output nodes during this epoch:  244754
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.15538978576660156  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.546 seconds, peak memory: 36.829 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.829 GB
Metis partitioning: 5.588 seconds, peak memory: 37.432 GB
Split the graph: 6.404 seconds
Construct subgraphs: 0.119 seconds
REG metis partition end ----................................
REG construction  time spent:  24.238317728042603
pure dgl.metis_partition the time spent:  13.689225912094116
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.9294764995574951

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.8676109313964844

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.15538978576660156  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

connection checking time:  1.8866453170776367
block generation total time  2.7970874309539795
average batch blocks generation time:  0.27970874309539795
block dataloader generation time/epoch 42.55374640226364
pseudo mini batch 0 input nodes size: 29810
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.14887523651123047  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.14887523651123047  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16321849822998047  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16328811645507812  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1344461441040039  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1461, 2: 1307, 3: 1029, 4: 873, 5: 687, 6: 532, 7: 487, 25: 412, 8: 388, 9: 334, 10: 294, 11: 228, 12: 189, 13: 181, 14: 147, 15: 133, 16: 115, 19: 85, 18: 81, 17: 77, 20: 72, 21: 49, 22: 49, 23: 44, 24: 39})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.13615751266479492  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.13615751266479492  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 4.808662414550781  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 4.8102006912231445  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16750192642211914  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 1 input nodes size: 29213
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16596078872680664  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16596078872680664  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17989063262939453  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17995977401733398  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16554689407348633  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1688, 2: 1458, 3: 1125, 4: 844, 5: 726, 6: 549, 7: 449, 8: 388, 25: 335, 9: 284, 10: 254, 11: 190, 12: 171, 13: 124, 14: 117, 15: 105, 16: 81, 17: 79, 18: 69, 19: 50, 21: 48, 23: 38, 22: 36, 24: 31, 20: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16709041595458984  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16709041595458984  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 4.345004081726074  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 4.346484661102295  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16830825805664062  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 2 input nodes size: 42067
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16689491271972656  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16689491271972656  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18695402145385742  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18702316284179688  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17302417755126953  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1268, 2: 1158, 3: 1011, 4: 790, 25: 704, 5: 651, 6: 553, 7: 428, 8: 383, 9: 331, 10: 301, 11: 242, 12: 239, 13: 187, 14: 174, 15: 148, 17: 111, 16: 108, 18: 86, 20: 86, 19: 84, 22: 67, 21: 63, 24: 50, 23: 43})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17509698867797852  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17509698867797852  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.611611366271973  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.613091945648193  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17689943313598633  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 3 input nodes size: 30342
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17490005493164062  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17490005493164062  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18936824798583984  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1894359588623047  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16930770874023438  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1246, 2: 1105, 25: 910, 3: 900, 4: 706, 5: 589, 6: 467, 7: 429, 8: 361, 9: 325, 10: 265, 11: 250, 12: 210, 13: 171, 14: 167, 15: 148, 17: 129, 16: 115, 18: 101, 20: 99, 21: 92, 19: 83, 23: 75, 24: 62, 22: 61})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17136049270629883  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17136049270629883  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.770317554473877  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.771950721740723  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17294645309448242  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 4 input nodes size: 26035
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17113304138183594  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17113304138183594  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18422508239746094  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1842942237854004  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16975831985473633  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1037, 2: 976, 3: 900, 4: 776, 25: 677, 5: 648, 6: 589, 7: 492, 8: 420, 9: 357, 10: 345, 11: 321, 12: 235, 13: 226, 14: 199, 15: 167, 16: 155, 17: 146, 18: 123, 20: 107, 19: 95, 21: 95, 22: 66, 24: 57, 23: 52})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1717243194580078  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1717243194580078  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.696535587310791  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.698054313659668  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17302417755126953  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 5 input nodes size: 53459
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1714177131652832  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1714177131652832  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1972966194152832  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.19736385345458984  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1842026710510254  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1723, 2: 1413, 3: 1093, 4: 821, 5: 652, 6: 510, 25: 400, 7: 398, 8: 360, 9: 293, 10: 223, 11: 170, 12: 157, 13: 140, 14: 89, 16: 84, 17: 80, 15: 78, 19: 70, 18: 66, 20: 53, 21: 37, 22: 36, 24: 30, 23: 21})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18613624572753906  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18613624572753906  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 4.769548416137695  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 4.7710137367248535  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18785858154296875  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 6 input nodes size: 59408
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18561363220214844  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18561363220214844  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.2139415740966797  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.21400785446166992  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18806171417236328  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1577, 2: 1336, 3: 1036, 4: 813, 5: 729, 25: 490, 6: 485, 7: 377, 8: 350, 9: 283, 10: 218, 11: 169, 12: 155, 13: 154, 14: 136, 15: 111, 16: 74, 18: 73, 17: 66, 20: 57, 19: 50, 21: 40, 23: 39, 22: 36, 24: 34})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1902027130126953  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1902027130126953  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.151357650756836  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.152884006500244  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1919851303100586  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 7 input nodes size: 70469
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18940067291259766  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18940067291259766  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.22300291061401367  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.2230687141418457  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.19467449188232422  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1584, 1: 1198, 2: 1065, 3: 756, 4: 565, 5: 542, 6: 419, 7: 352, 8: 288, 9: 262, 10: 223, 11: 218, 12: 176, 13: 134, 15: 132, 14: 123, 16: 112, 18: 112, 19: 102, 17: 99, 20: 86, 21: 81, 24: 73, 22: 68, 23: 58})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.19991636276245117  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.19991636276245117  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 7.7644524574279785  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 7.765856742858887  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.20290040969848633  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 8 input nodes size: 60714
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1967611312866211  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1967611312866211  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.22571182250976562  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.22578096389770508  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.19211292266845703  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2413, 1: 931, 2: 776, 3: 638, 4: 535, 5: 466, 6: 362, 7: 310, 9: 281, 8: 265, 10: 241, 12: 228, 11: 220, 13: 187, 16: 152, 15: 152, 14: 145, 18: 141, 17: 138, 21: 131, 19: 127, 20: 126, 23: 99, 24: 93, 22: 87})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.19775152206420898  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.19775152206420898  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 9.358255386352539  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 9.359659671783447  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.2011408805847168  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 9 input nodes size: 77611
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.19480323791503906  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.19480323791503906  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.23191261291503906  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.2319784164428711  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.2029585838317871  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1535, 1: 1299, 2: 1112, 3: 789, 4: 597, 5: 532, 6: 402, 7: 323, 8: 269, 10: 235, 9: 226, 11: 195, 12: 177, 13: 152, 14: 137, 16: 115, 15: 115, 17: 105, 18: 96, 19: 90, 20: 90, 21: 81, 24: 56, 23: 50, 22: 50})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.20778465270996094  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.20778465270996094  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 7.885046005249023  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 7.886427402496338  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.21143722534179688  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.21143722534179688  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17838287353515625  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07706561088562011 |0.003746962547302246 |0.1469045400619507 |0.00011878013610839843 |0.2944356679916382 |0.0036988258361816406 |
----------------------------------------------------------pseudo_mini_loss sum 4.80460262298584
Total (block generation + training)time/epoch 48.17559951543808
Training time/epoch 5.375994443893433
Training time without block to device /epoch 5.33852481842041
Training time without total dataloading part /epoch 4.418288707733154
load block tensor time/epoch 0.7706561088562012
block to device time/epoch 0.03746962547302246
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  728110
Number of first layer input nodes during this epoch:  479128
Number of first layer output nodes during this epoch:  248982
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16254043579101562  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.458 seconds, peak memory: 37.516 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 37.516 GB
Metis partitioning: 5.195 seconds, peak memory: 37.516 GB
Split the graph: 7.528 seconds
Construct subgraphs: 0.106 seconds
REG metis partition end ----................................
REG construction  time spent:  23.15288472175598
pure dgl.metis_partition the time spent:  14.314104080200195
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7703549861907959

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.682513952255249

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16254043579101562  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

connection checking time:  1.6351268291473389
block generation total time  2.452868938446045
average batch blocks generation time:  0.2452868938446045
block dataloader generation time/epoch 42.516395542356705
pseudo mini batch 0 input nodes size: 29720
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.15648651123046875  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.15648651123046875  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17065811157226562  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17072725296020508  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.13355207443237305  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1331, 2: 1272, 3: 996, 4: 867, 5: 674, 6: 535, 7: 501, 25: 444, 8: 413, 9: 355, 10: 289, 11: 241, 12: 203, 13: 188, 14: 158, 15: 137, 16: 116, 17: 94, 19: 81, 18: 81, 20: 70, 22: 51, 21: 47, 23: 46, 24: 40})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1352977752685547  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1352977752685547  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 4.902690410614014  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 4.904385089874268  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1674795150756836  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 1 input nodes size: 33009
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1659235954284668  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1659235954284668  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18166351318359375  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1817331314086914  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16749238967895508  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1602, 2: 1408, 3: 1118, 4: 835, 5: 732, 6: 568, 7: 444, 8: 397, 25: 384, 9: 280, 10: 244, 11: 201, 12: 190, 13: 126, 14: 124, 15: 121, 16: 83, 18: 79, 17: 79, 19: 65, 21: 54, 20: 44, 23: 42, 24: 35, 22: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1691579818725586  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1691579818725586  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 4.613641262054443  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 4.615217208862305  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17037677764892578  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 2 input nodes size: 41124
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1687946319580078  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1687946319580078  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18840408325195312  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18847322463989258  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17266368865966797  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1378, 2: 1221, 3: 1004, 4: 795, 25: 654, 5: 641, 6: 516, 7: 412, 8: 383, 9: 325, 10: 289, 11: 235, 12: 216, 13: 192, 15: 163, 14: 161, 17: 108, 16: 102, 18: 83, 19: 77, 20: 77, 22: 67, 21: 57, 24: 48, 23: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17466211318969727  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17466211318969727  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.422915458679199  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.424380779266357  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17624998092651367  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 3 input nodes size: 27253
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17432117462158203  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17432117462158203  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18799304962158203  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18806219100952148  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.16838359832763672  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1003, 2: 987, 3: 915, 4: 772, 25: 749, 5: 641, 6: 578, 7: 486, 8: 404, 9: 348, 10: 336, 11: 300, 12: 243, 13: 213, 14: 194, 16: 158, 17: 149, 15: 148, 18: 126, 20: 112, 21: 106, 19: 102, 22: 71, 23: 65, 24: 62})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17040491104125977  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17040491104125977  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.82432746887207  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.825788974761963  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17200040817260742  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 4 input nodes size: 29675
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17033910751342773  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17033910751342773  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18448925018310547  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1845564842224121  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17081546783447266  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1311, 2: 1106, 3: 938, 25: 769, 4: 714, 5: 616, 6: 483, 7: 445, 8: 360, 9: 325, 10: 271, 11: 240, 12: 188, 13: 169, 14: 163, 15: 139, 17: 123, 16: 116, 20: 96, 18: 93, 21: 80, 19: 74, 23: 60, 24: 55, 22: 51})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17277002334594727  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17277002334594727  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.481772422790527  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.483314037322998  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17412042617797852  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 5 input nodes size: 48157
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17235612869262695  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.17235612869262695  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.19567155838012695  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1957387924194336  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18152141571044922  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1737, 2: 1448, 3: 1067, 4: 860, 5: 742, 6: 511, 7: 376, 8: 352, 25: 304, 9: 288, 10: 238, 11: 178, 12: 151, 13: 138, 14: 109, 15: 94, 16: 81, 17: 69, 18: 54, 19: 49, 20: 47, 21: 28, 23: 27, 24: 23, 22: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18327856063842773  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18327856063842773  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 4.477137565612793  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 4.478511333465576  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18535089492797852  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 6 input nodes size: 53721
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18337631225585938  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18337631225585938  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.20899248123168945  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.2090597152709961  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18567705154418945  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1637, 2: 1360, 3: 999, 4: 751, 5: 667, 25: 562, 6: 506, 7: 391, 8: 338, 9: 281, 10: 243, 11: 202, 12: 176, 13: 145, 14: 112, 16: 95, 15: 89, 17: 80, 18: 74, 19: 69, 20: 59, 21: 54, 24: 51, 22: 42, 23: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1878662109375  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1878662109375  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.292437553405762  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 5.294124126434326  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1891489028930664  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 7 input nodes size: 70682
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18656349182128906  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.18656349182128906  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.22026729583740234  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.22033309936523438  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.19464969635009766  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1702, 1: 1187, 2: 1036, 3: 751, 4: 583, 5: 525, 6: 399, 7: 320, 8: 286, 9: 256, 10: 227, 11: 190, 12: 172, 13: 151, 15: 135, 14: 130, 18: 125, 16: 111, 19: 101, 17: 89, 21: 86, 20: 82, 22: 72, 24: 61, 23: 51})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.19992589950561523  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.19992589950561523  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 7.90452241897583  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 7.905896186828613  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.20304441452026367  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 8 input nodes size: 78884
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1968555450439453  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.1968555450439453  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.23447036743164062  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.23453617095947266  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.20076656341552734  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1394, 25: 1376, 2: 1119, 3: 861, 4: 640, 5: 535, 6: 412, 7: 348, 8: 277, 9: 233, 10: 217, 11: 192, 12: 159, 14: 134, 13: 132, 15: 106, 16: 103, 17: 91, 20: 90, 18: 83, 19: 78, 23: 75, 21: 67, 22: 56, 24: 50})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.20539236068725586  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.20539236068725586  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 7.537370681762695  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 7.539003849029541  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.2093362808227539  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

pseudo mini batch 9 input nodes size: 62119
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.20268869400024414  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.20268869400024414  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.23230934143066406  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.23237848281860352  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.19469785690307617  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2516, 1: 848, 2: 749, 3: 628, 4: 503, 5: 449, 6: 360, 7: 322, 9: 285, 8: 262, 10: 245, 12: 239, 11: 224, 13: 202, 15: 157, 18: 150, 14: 149, 17: 148, 16: 146, 19: 140, 21: 138, 20: 130, 24: 100, 22: 91, 23: 87})

----------------------------------------after blocks to device 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.20006608963012695  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.71044921875 GB
    Memory Allocated: 0.20006608963012695  GigaBytes
Max Memory Allocated: 10.062036991119385  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.15966796875 GB
    Memory Allocated: 9.637193202972412  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.15966796875 GB
    Memory Allocated: 9.638849258422852  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20462560653686523  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20462560653686523  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1715712547302246  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07606272697448731 |0.003576064109802246 |0.14677283763885499 |0.00011439323425292969 |0.2939460754394531 |0.004758596420288086 |
----------------------------------------------------------pseudo_mini_loss sum 5.076799392700195
Total (block generation + training)time/epoch 48.10855094591776
Training time/epoch 5.35425877571106
Training time without block to device /epoch 5.318498134613037
Training time without total dataloading part /epoch 4.413091659545898
load block tensor time/epoch 0.760627269744873
block to device time/epoch 0.03576064109802246
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  722589
Number of first layer input nodes during this epoch:  474344
Number of first layer output nodes during this epoch:  248245
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.15645074844360352  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.409 seconds, peak memory: 37.807 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 37.807 GB
Metis partitioning: 5.148 seconds, peak memory: 38.615 GB
Split the graph: 6.766 seconds
Construct subgraphs: 0.105 seconds
REG metis partition end ----................................
REG construction  time spent:  22.96476912498474
pure dgl.metis_partition the time spent:  13.45558500289917
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.9706628322601318

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.8451666831970215

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.15645074844360352  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

connection checking time:  1.9919395446777344
block generation total time  2.8158295154571533
average batch blocks generation time:  0.28158295154571533
block dataloader generation time/epoch 42.453264117240906
pseudo mini batch 0 input nodes size: 27914
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.14964771270751953  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.14964771270751953  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16331958770751953  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16338872909545898  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1336989402770996  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1511, 2: 1374, 3: 1101, 4: 916, 5: 700, 6: 561, 7: 492, 8: 393, 9: 320, 25: 307, 10: 264, 11: 209, 12: 176, 13: 171, 14: 130, 15: 122, 16: 94, 17: 74, 18: 73, 19: 70, 20: 51, 22: 40, 21: 37, 23: 32, 24: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.13526058197021484  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.13526058197021484  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.432619094848633  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.434195518493652  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16658306121826172  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 1 input nodes size: 34274
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16518783569335938  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16518783569335938  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18153095245361328  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18160009384155273  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16785907745361328  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1398, 2: 1286, 3: 1017, 4: 810, 5: 700, 6: 542, 25: 495, 7: 456, 8: 411, 9: 320, 10: 272, 11: 210, 12: 199, 13: 155, 14: 153, 15: 142, 16: 106, 17: 102, 18: 84, 19: 76, 20: 67, 21: 63, 22: 56, 23: 55, 24: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16967153549194336  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16967153549194336  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.0629472732543945  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.064446926116943  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17117071151733398  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 2 input nodes size: 38835
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16948461532592773  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16948461532592773  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1880025863647461  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18807077407836914  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17165851593017578  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1558, 2: 1350, 3: 1070, 4: 814, 5: 662, 6: 524, 25: 518, 7: 382, 8: 362, 9: 294, 10: 270, 11: 212, 12: 193, 13: 168, 14: 124, 15: 119, 17: 82, 16: 75, 18: 67, 19: 64, 21: 54, 20: 53, 22: 46, 24: 37, 23: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17341327667236328  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17341327667236328  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.798834323883057  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.800383567810059  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17462921142578125  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 3 input nodes size: 27036
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1729426383972168  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1729426383972168  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1866145133972168  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18668222427368164  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16809606552124023  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1244, 2: 1066, 3: 918, 25: 805, 4: 730, 5: 626, 6: 497, 7: 448, 8: 361, 9: 316, 10: 283, 11: 250, 12: 201, 13: 180, 14: 176, 15: 160, 17: 126, 16: 118, 20: 101, 18: 95, 21: 88, 19: 82, 23: 59, 24: 57, 22: 55})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1700267791748047  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1700267791748047  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.530762672424316  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.532144069671631  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17148971557617188  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 4 input nodes size: 28432
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16985368728637695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16985368728637695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18352556228637695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1835942268371582  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16985464096069336  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1059, 2: 1051, 3: 913, 4: 757, 25: 712, 5: 616, 6: 568, 7: 477, 8: 388, 9: 350, 10: 319, 11: 284, 12: 235, 13: 204, 14: 189, 16: 147, 17: 146, 18: 125, 15: 125, 20: 105, 19: 95, 21: 92, 23: 73, 22: 65, 24: 58})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17180204391479492  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17180204391479492  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.643640518188477  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.645018100738525  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17361211776733398  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 5 input nodes size: 47753
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17200708389282227  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17200708389282227  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.19532251358032227  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1953892707824707  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18164873123168945  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1710, 2: 1392, 3: 1035, 4: 739, 5: 683, 25: 488, 6: 481, 7: 383, 8: 338, 9: 266, 10: 222, 11: 196, 12: 156, 13: 131, 14: 106, 15: 90, 16: 85, 18: 74, 17: 71, 19: 63, 20: 51, 21: 45, 22: 42, 24: 42, 23: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1836380958557129  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1836380958557129  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.942728042602539  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.94445276260376  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18547773361206055  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 6 input nodes size: 47992
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18318462371826172  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18318462371826172  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2060689926147461  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20613765716552734  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1827554702758789  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1500, 2: 1220, 3: 998, 4: 784, 5: 704, 25: 591, 6: 518, 7: 453, 8: 394, 9: 325, 10: 249, 11: 208, 12: 199, 13: 170, 14: 148, 15: 118, 16: 107, 17: 89, 18: 74, 20: 73, 19: 69, 21: 46, 24: 44, 22: 42, 23: 40})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18480491638183594  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18480491638183594  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.345397472381592  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.346900939941406  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18613433837890625  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 7 input nodes size: 71532
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18396282196044922  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18396282196044922  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.21807193756103516  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2181386947631836  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.19518566131591797  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1673, 1: 1142, 2: 1008, 3: 770, 4: 595, 5: 537, 6: 402, 7: 333, 8: 281, 9: 268, 10: 244, 11: 221, 12: 185, 13: 147, 14: 141, 15: 137, 16: 125, 18: 116, 17: 112, 19: 101, 20: 99, 21: 94, 24: 72, 22: 67, 23: 52})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2004833221435547  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2004833221435547  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 8.01361608505249  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 8.015111923217773  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2044849395751953  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 8 input nodes size: 77691
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.19744205474853516  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.19744205474853516  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.23455142974853516  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2346172332763672  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2004413604736328  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1419, 1: 1394, 2: 1171, 3: 805, 4: 646, 5: 534, 6: 387, 7: 321, 8: 273, 9: 253, 10: 224, 11: 189, 12: 164, 13: 143, 15: 112, 14: 110, 16: 108, 17: 90, 18: 89, 19: 87, 20: 81, 21: 70, 22: 60, 23: 56, 24: 42})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2055802345275879  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2055802345275879  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 7.582479953765869  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 7.5840253829956055  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2088761329650879  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 9 input nodes size: 62041
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20253849029541016  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20253849029541016  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.23212194442749023  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2321915626525879  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.19501638412475586  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2452, 1: 912, 2: 788, 3: 650, 4: 529, 5: 460, 6: 388, 7: 300, 8: 271, 9: 264, 10: 252, 12: 229, 11: 224, 13: 187, 15: 164, 14: 157, 18: 151, 16: 146, 17: 138, 19: 129, 21: 128, 20: 126, 24: 101, 23: 100, 22: 83})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2003931999206543  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2003931999206543  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 9.49314022064209  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 9.494662761688232  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20452165603637695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20452165603637695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17146730422973633  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07506096363067627 |0.003383636474609375 |0.14872021675109864 |0.00013010501861572267 |0.29295711517333983 |0.005065441131591797 |
----------------------------------------------------------pseudo_mini_loss sum 3.9620201587677
Total (block generation + training)time/epoch 48.02250068187713
Training time/epoch 5.362647294998169
Training time without block to device /epoch 5.328810930252075
Training time without total dataloading part /epoch 4.423139810562134
load block tensor time/epoch 0.7506096363067627
block to device time/epoch 0.03383636474609375
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  707046
Number of first layer input nodes during this epoch:  463500
Number of first layer output nodes during this epoch:  243546
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1563272476196289  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.559 seconds, peak memory: 38.615 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.615 GB
Metis partitioning: 5.708 seconds, peak memory: 38.615 GB
Split the graph: 7.667 seconds
Construct subgraphs: 0.169 seconds
REG metis partition end ----................................
REG construction  time spent:  27.711437463760376
pure dgl.metis_partition the time spent:  15.132932662963867
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.863997220993042

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  3.566293716430664

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1563272476196289  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

connection checking time:  1.7827794551849365
block generation total time  4.430290937423706
average batch blocks generation time:  0.4430290937423706
block dataloader generation time/epoch 43.12071514129639
pseudo mini batch 0 input nodes size: 24149
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.14943408966064453  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.14943408966064453  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16115283966064453  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1612224578857422  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.13156938552856445  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1652, 2: 1480, 3: 1178, 4: 914, 5: 757, 6: 583, 7: 479, 8: 377, 9: 303, 10: 250, 11: 194, 25: 183, 12: 170, 13: 140, 15: 123, 14: 121, 16: 78, 17: 67, 18: 58, 19: 38, 20: 30, 22: 28, 24: 28, 21: 27, 23: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.13295459747314453  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.13295459747314453  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 3.978520393371582  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 3.980043411254883  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16436147689819336  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 1 input nodes size: 35024
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16315174102783203  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16315174102783203  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18072986602783203  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18079900741577148  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16901063919067383  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1383, 2: 1197, 3: 942, 4: 803, 5: 677, 25: 612, 6: 520, 7: 452, 8: 415, 9: 317, 10: 290, 11: 260, 12: 200, 13: 185, 14: 149, 15: 143, 16: 122, 17: 100, 18: 93, 20: 91, 19: 86, 21: 70, 23: 59, 22: 55, 24: 41})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17095947265625  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17095947265625  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.358890533447266  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.360439777374268  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17236804962158203  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 2 input nodes size: 26229
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17054367065429688  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17054367065429688  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18305063247680664  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1831202507019043  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16547298431396484  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 967, 1: 957, 3: 872, 25: 781, 4: 759, 5: 638, 6: 578, 7: 479, 8: 427, 9: 390, 10: 336, 11: 332, 12: 264, 13: 229, 14: 196, 17: 157, 15: 154, 16: 154, 18: 130, 20: 108, 19: 106, 21: 100, 22: 78, 23: 77, 24: 67})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16750288009643555  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16750288009643555  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.967583179473877  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.969002723693848  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16907167434692383  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 3 input nodes size: 27181
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16747188568115234  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16747188568115234  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1808614730834961  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18093061447143555  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16835403442382812  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1228, 2: 1052, 3: 937, 25: 849, 4: 743, 5: 631, 6: 513, 7: 457, 8: 382, 9: 331, 10: 300, 11: 256, 12: 218, 13: 187, 14: 182, 15: 163, 17: 136, 16: 120, 20: 107, 18: 102, 21: 91, 19: 86, 24: 60, 23: 57, 22: 51})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1703505516052246  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1703505516052246  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.7141852378845215  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.715620040893555  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17181062698364258  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 4 input nodes size: 39786
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17012739181518555  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17012739181518555  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18965864181518555  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18972539901733398  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17626667022705078  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1505, 2: 1273, 3: 976, 4: 778, 5: 608, 25: 606, 6: 463, 7: 399, 8: 353, 9: 297, 10: 266, 12: 191, 11: 182, 13: 166, 14: 157, 15: 124, 16: 97, 17: 96, 18: 71, 19: 70, 20: 62, 22: 60, 21: 53, 24: 46, 23: 36})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1781148910522461  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1781148910522461  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.0239763259887695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.025411128997803  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17950725555419922  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 5 input nodes size: 55645
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17771387100219727  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17771387100219727  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20505762100219727  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2051243782043457  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18552637100219727  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1648, 2: 1496, 3: 1076, 4: 824, 5: 666, 6: 483, 7: 386, 25: 381, 8: 346, 9: 279, 10: 233, 11: 183, 12: 150, 13: 127, 14: 113, 16: 93, 15: 84, 17: 73, 18: 64, 19: 57, 20: 50, 21: 41, 22: 34, 23: 29, 24: 21})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18747186660766602  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18747186660766602  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.76517915725708  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.766526222229004  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18966150283813477  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 6 input nodes size: 47709
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18736982345581055  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18736982345581055  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.21068525314331055  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2107529640197754  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18334245681762695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1684, 2: 1373, 3: 1019, 4: 780, 5: 705, 6: 512, 25: 468, 7: 408, 8: 367, 9: 282, 10: 227, 11: 192, 12: 175, 13: 133, 14: 111, 15: 93, 16: 83, 18: 75, 17: 71, 19: 64, 20: 63, 22: 40, 21: 38, 24: 35, 23: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1853160858154297  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1853160858154297  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.934241771697998  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.935642242431641  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18653392791748047  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 7 input nodes size: 70354
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1842975616455078  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1842975616455078  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.21784496307373047  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2179107666015625  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.19452762603759766  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1703, 1: 1110, 2: 1015, 3: 783, 4: 569, 5: 524, 6: 413, 7: 329, 9: 267, 8: 264, 10: 218, 11: 203, 12: 180, 13: 155, 14: 137, 15: 129, 18: 122, 16: 116, 19: 107, 17: 104, 21: 95, 20: 82, 22: 76, 24: 74, 23: 53})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.19982099533081055  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.19982099533081055  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 8.006064414978027  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 8.007422924041748  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20288896560668945  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 8 input nodes size: 79552
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.19669437408447266  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.19669437408447266  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.23462772369384766  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2346935272216797  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.201080322265625  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1443, 1: 1340, 2: 1076, 3: 812, 4: 623, 5: 541, 6: 450, 7: 341, 8: 271, 9: 245, 10: 235, 11: 179, 12: 179, 13: 152, 15: 119, 14: 115, 17: 98, 16: 98, 19: 94, 18: 91, 20: 84, 21: 74, 23: 64, 22: 56, 24: 48})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20624589920043945  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20624589920043945  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 7.740830421447754  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 7.7421464920043945  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.21024417877197266  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 9 input nodes size: 61132
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2034611701965332  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2034611701965332  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.23261117935180664  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2326803207397461  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.19468116760253906  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2434, 1: 921, 2: 777, 3: 682, 4: 527, 5: 475, 6: 353, 7: 315, 8: 270, 9: 265, 10: 244, 11: 222, 12: 210, 13: 182, 15: 157, 14: 153, 16: 150, 18: 142, 20: 130, 21: 128, 17: 128, 19: 128, 24: 105, 23: 90, 22: 78})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20032358169555664  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20032358169555664  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 9.36421537399292  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 9.36593246459961  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20429706573486328  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.20429706573486328  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17124271392822266  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0717247724533081 |0.003367185592651367 |0.14925737380981446 |0.00015032291412353516 |0.29368650913238525 |0.007742881774902344 |
----------------------------------------------------------pseudo_mini_loss sum 4.883175373077393
Total (block generation + training)time/epoch 48.66944035616788
Training time/epoch 5.343215227127075
Training time without block to device /epoch 5.3095433712005615
Training time without total dataloading part /epoch 4.438684940338135
load block tensor time/epoch 0.717247724533081
block to device time/epoch 0.03367185592651367
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  711899
Number of first layer input nodes during this epoch:  466761
Number of first layer output nodes during this epoch:  245138
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.15605735778808594  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.532 seconds, peak memory: 38.615 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.615 GB
Metis partitioning: 5.467 seconds, peak memory: 38.615 GB
Split the graph: 8.391 seconds
Construct subgraphs: 0.100 seconds
REG metis partition end ----................................
REG construction  time spent:  25.98963713645935
pure dgl.metis_partition the time spent:  15.51873254776001
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.851799488067627

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.826178789138794

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.15605735778808594  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

connection checking time:  1.8604235649108887
block generation total time  2.677978277206421
average batch blocks generation time:  0.2677978277206421
block dataloader generation time/epoch 43.42283562819163
pseudo mini batch 0 input nodes size: 28876
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.14920616149902344  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.14920616149902344  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16297531127929688  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16304492950439453  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.13382577896118164  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1493, 2: 1283, 3: 1067, 4: 886, 5: 721, 6: 567, 7: 481, 8: 404, 25: 370, 9: 337, 10: 268, 11: 240, 12: 181, 13: 172, 14: 138, 15: 125, 16: 104, 17: 77, 18: 75, 20: 69, 19: 66, 22: 44, 21: 40, 23: 38, 24: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.13547134399414062  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.13547134399414062  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.621387004852295  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.622921466827393  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16674089431762695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 1 input nodes size: 44273
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1652679443359375  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1652679443359375  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1867523193359375  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18682146072387695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17298269271850586  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1285, 2: 1188, 3: 953, 4: 784, 25: 740, 5: 640, 6: 523, 7: 438, 8: 407, 9: 314, 10: 291, 11: 222, 12: 208, 13: 192, 14: 167, 15: 162, 17: 122, 16: 112, 18: 91, 20: 85, 19: 78, 22: 62, 21: 61, 23: 51, 24: 50})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17512798309326172  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17512798309326172  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.71407413482666  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.7154860496521  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17699813842773438  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 2 input nodes size: 29971
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17486047744750977  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17486047744750977  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18915176391601562  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18922090530395508  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16766738891601562  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1662, 2: 1378, 3: 1085, 4: 864, 5: 741, 6: 519, 7: 415, 8: 402, 25: 338, 9: 299, 10: 271, 12: 188, 11: 182, 13: 137, 14: 131, 15: 107, 16: 98, 17: 85, 18: 68, 19: 65, 21: 48, 20: 38, 23: 35, 22: 34, 24: 30})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16922330856323242  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16922330856323242  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.4134907722473145  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.415024757385254  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17037343978881836  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 3 input nodes size: 28026
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16896581649780273  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16896581649780273  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18263769149780273  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1827068328857422  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.16834640502929688  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1169, 2: 1049, 3: 924, 25: 923, 4: 713, 5: 621, 6: 496, 7: 451, 8: 382, 9: 335, 10: 297, 11: 263, 12: 216, 13: 188, 14: 182, 15: 161, 17: 142, 16: 124, 20: 112, 18: 102, 19: 93, 21: 92, 23: 67, 24: 62, 22: 58})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17040300369262695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17040300369262695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.874331951141357  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.875789642333984  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17188501358032227  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 4 input nodes size: 25317
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1701493263244629  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1701493263244629  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1822214126586914  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18229007720947266  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1685490608215332  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 1057, 1: 1021, 3: 904, 4: 765, 25: 677, 5: 635, 6: 588, 7: 476, 8: 407, 9: 351, 10: 325, 11: 324, 12: 250, 13: 210, 14: 185, 15: 144, 17: 139, 16: 135, 18: 119, 20: 100, 21: 94, 19: 89, 22: 68, 24: 64, 23: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17045831680297852  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17045831680297852  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.581775188446045  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 5.583179473876953  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17199277877807617  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 5 input nodes size: 47036
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17046308517456055  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.17046308517456055  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.19377851486206055  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1938471794128418  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18170642852783203  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1619, 2: 1410, 3: 1163, 4: 839, 5: 714, 6: 534, 7: 415, 25: 394, 8: 349, 9: 306, 10: 231, 11: 165, 12: 161, 13: 156, 14: 126, 16: 95, 15: 95, 18: 76, 17: 70, 19: 58, 20: 49, 21: 40, 22: 32, 24: 29, 23: 28})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18356037139892578  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18356037139892578  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.766941070556641  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 4.768429279327393  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1850299835205078  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 6 input nodes size: 57149
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1829986572265625  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1829986572265625  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.2103424072265625  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.21040916442871094  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.1870250701904297  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1775, 2: 1458, 3: 1037, 4: 797, 5: 682, 25: 478, 6: 475, 7: 393, 8: 325, 9: 249, 10: 202, 11: 194, 12: 163, 13: 116, 14: 88, 16: 75, 15: 71, 19: 63, 18: 59, 20: 56, 17: 53, 21: 47, 22: 36, 24: 31, 23: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18913555145263672  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.60888671875 GB
    Memory Allocated: 0.18913555145263672  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 4.964991092681885  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 4.966418266296387  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.19106292724609375  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 7 input nodes size: 72387
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.18846511840820312  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.18846511840820312  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.22298192977905273  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.22304773330688477  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.19563722610473633  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1760, 1: 1116, 2: 963, 3: 736, 4: 555, 5: 525, 6: 383, 7: 317, 9: 271, 8: 266, 10: 237, 11: 210, 12: 182, 13: 158, 14: 142, 15: 141, 18: 128, 16: 124, 17: 118, 19: 100, 20: 92, 21: 89, 22: 78, 24: 73, 23: 64})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.20096302032470703  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.20096302032470703  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 8.275057315826416  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 8.276400566101074  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.2043766975402832  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 8 input nodes size: 79424
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.19773578643798828  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.19773578643798828  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.23560810089111328  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.2356739044189453  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.20109128952026367  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1395, 1: 1322, 2: 1131, 3: 773, 4: 627, 5: 506, 6: 429, 7: 348, 8: 303, 9: 257, 10: 246, 11: 181, 12: 177, 13: 137, 14: 134, 15: 130, 16: 103, 18: 97, 19: 94, 17: 88, 20: 83, 21: 79, 23: 70, 22: 67, 24: 51})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.2054901123046875  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.2054901123046875  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 7.762855529785156  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 7.764492511749268  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.2095184326171875  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 9 input nodes size: 61450
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.2030925750732422  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.2030925750732422  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.23239421844482422  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.23246192932128906  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.19452381134033203  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2385, 1: 966, 2: 789, 3: 635, 4: 490, 5: 437, 6: 354, 7: 311, 9: 257, 10: 231, 8: 227, 11: 222, 12: 211, 13: 190, 15: 153, 16: 141, 14: 141, 17: 136, 18: 133, 19: 130, 21: 127, 20: 123, 24: 100, 23: 79, 22: 77})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.20011663436889648  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.20011663436889648  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 9.24036979675293  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 9.242037296295166  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.20428848266601562  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.20428848266601562  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.171234130859375  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07448992729187012 |0.005181527137756348 |0.14814908504486085 |0.0001293182373046875 |0.2945000886917114 |0.004938840866088867 |
----------------------------------------------------------pseudo_mini_loss sum 4.941635608673096
Total (block generation + training)time/epoch 48.95845232407252
Training time/epoch 5.3910627365112305
Training time without block to device /epoch 5.339247465133667
Training time without total dataloading part /epoch 4.432723760604858
load block tensor time/epoch 0.7448992729187012
block to device time/epoch 0.05181527137756348
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  723122
Number of first layer input nodes during this epoch:  473909
Number of first layer output nodes during this epoch:  249213
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.15596723556518555  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.509 seconds, peak memory: 38.615 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.615 GB
Metis partitioning: 5.512 seconds, peak memory: 38.615 GB
Split the graph: 6.557 seconds
Construct subgraphs: 0.095 seconds
REG metis partition end ----................................
REG construction  time spent:  26.388156175613403
pure dgl.metis_partition the time spent:  13.704103946685791
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8332867622375488

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.9771921634674072

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.15596723556518555  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

connection checking time:  1.7635467052459717
block generation total time  2.810478925704956
average batch blocks generation time:  0.2810478925704956
block dataloader generation time/epoch 43.57370116160466
pseudo mini batch 0 input nodes size: 51616
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.1488785743713379  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.1488785743713379  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.1734910011291504  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.17355823516845703  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.14418888092041016  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1807, 2: 1438, 3: 1067, 4: 811, 5: 718, 6: 485, 7: 381, 25: 372, 8: 355, 9: 260, 10: 205, 11: 176, 12: 142, 13: 137, 14: 105, 15: 85, 18: 64, 16: 59, 17: 59, 19: 54, 20: 51, 22: 40, 24: 36, 23: 31, 21: 31})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.14605379104614258  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.61865234375 GB
    Memory Allocated: 0.14605379104614258  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.574474811553955  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.575826168060303  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17806339263916016  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 1 input nodes size: 51935
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1759033203125  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1759033203125  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.2006678581237793  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20073604583740234  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1760563850402832  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1447, 2: 1244, 3: 988, 4: 799, 5: 676, 25: 626, 6: 509, 7: 425, 8: 382, 9: 314, 10: 259, 12: 198, 11: 187, 13: 156, 14: 146, 16: 126, 15: 124, 17: 96, 18: 86, 19: 71, 20: 65, 21: 55, 24: 48, 22: 47, 23: 40})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17824029922485352  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17824029922485352  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.506429195404053  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.5083160400390625  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18017053604125977  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 2 input nodes size: 66960
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17775440216064453  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17775440216064453  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20968341827392578  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20975065231323242  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18491792678833008  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1694, 1: 1133, 2: 1034, 3: 755, 4: 579, 5: 527, 6: 434, 7: 360, 8: 293, 9: 272, 10: 249, 11: 227, 12: 193, 13: 156, 14: 129, 18: 123, 15: 122, 16: 115, 17: 114, 19: 106, 20: 96, 21: 90, 22: 79, 24: 70, 23: 55})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1902313232421875  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1902313232421875  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 7.976541042327881  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 7.977991104125977  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1932973861694336  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 3 input nodes size: 79302
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18718910217285156  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18718910217285156  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.22500324249267578  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.2250690460205078  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19307279586791992  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1511, 1: 1293, 2: 1084, 3: 801, 4: 608, 5: 545, 6: 398, 7: 352, 8: 274, 9: 229, 10: 228, 11: 186, 12: 170, 13: 139, 15: 129, 14: 125, 16: 119, 19: 105, 18: 98, 17: 89, 20: 85, 21: 84, 23: 73, 22: 56, 24: 47})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19756603240966797  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19756603240966797  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 7.918559551239014  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 7.920665740966797  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20252418518066406  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 4 input nodes size: 59561
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1957225799560547  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1957225799560547  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.22412347793579102  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.22419118881225586  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1863112449645996  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2404, 1: 977, 2: 801, 3: 631, 4: 499, 5: 429, 6: 345, 7: 284, 9: 271, 8: 237, 11: 221, 12: 215, 10: 214, 13: 166, 14: 153, 15: 143, 16: 143, 17: 140, 18: 135, 21: 123, 20: 122, 19: 118, 24: 101, 23: 78, 22: 75})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19190502166748047  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19190502166748047  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 9.124927043914795  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 9.126611709594727  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19539642333984375  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 5 input nodes size: 33386
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18851947784423828  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18851947784423828  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.2044391632080078  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20450830459594727  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1760396957397461  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1356, 2: 1241, 3: 976, 4: 823, 5: 685, 25: 577, 6: 528, 7: 458, 8: 433, 9: 327, 10: 300, 11: 254, 12: 189, 13: 177, 15: 145, 14: 144, 16: 107, 17: 87, 19: 85, 20: 78, 18: 78, 21: 64, 22: 55, 23: 54, 24: 40})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17792558670043945  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17792558670043945  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.249029636383057  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.250666618347168  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17920541763305664  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 6 input nodes size: 24474
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17745494842529297  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17745494842529297  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18917369842529297  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18924283981323242  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17325401306152344  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1576, 2: 1445, 3: 1127, 4: 872, 5: 729, 6: 575, 7: 491, 8: 381, 9: 312, 10: 248, 25: 227, 11: 202, 12: 184, 13: 159, 14: 134, 15: 120, 16: 95, 17: 79, 18: 66, 19: 53, 20: 41, 21: 36, 22: 33, 23: 30, 24: 26})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17470216751098633  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17470216751098633  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.206197261810303  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.20805549621582  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17625093460083008  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 7 input nodes size: 38255
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17499876022338867  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17499876022338867  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19324016571044922  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19330883026123047  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18152093887329102  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1508, 2: 1318, 3: 1088, 4: 848, 5: 651, 6: 531, 25: 518, 7: 391, 8: 353, 9: 310, 10: 282, 11: 207, 12: 199, 13: 174, 14: 140, 15: 128, 16: 88, 17: 87, 18: 79, 19: 68, 20: 61, 21: 50, 22: 50, 24: 39, 23: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18330907821655273  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18330907821655273  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.916219711303711  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.91787576675415  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18453073501586914  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 8 input nodes size: 27141
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18282699584960938  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18282699584960938  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19649887084960938  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19656705856323242  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17825698852539062  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1089, 2: 1038, 3: 905, 4: 750, 25: 704, 5: 623, 6: 562, 7: 462, 8: 388, 9: 350, 10: 320, 11: 285, 12: 227, 13: 202, 14: 173, 17: 147, 16: 142, 15: 125, 18: 122, 20: 101, 21: 94, 19: 92, 23: 66, 22: 66, 24: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18016529083251953  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18016529083251953  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.5544819831848145  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.556138038635254  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18141746520996094  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 9 input nodes size: 27964
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17986536026000977  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17986536026000977  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19353723526000977  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19360589981079102  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17986583709716797  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1242, 2: 1063, 3: 939, 25: 827, 4: 731, 5: 639, 6: 501, 7: 441, 8: 376, 9: 331, 10: 294, 11: 258, 12: 220, 13: 190, 14: 185, 15: 168, 17: 132, 16: 117, 20: 107, 18: 97, 21: 90, 19: 84, 23: 60, 24: 58, 22: 55})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18184757232666016  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18184757232666016  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.68515157699585  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.68663215637207  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18355464935302734  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18355464935302734  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.15050029754638672  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07147257328033448 |0.0034761667251586915 |0.14687871932983398 |0.00011713504791259766 |0.2940647125244141 |0.004695415496826172 |
----------------------------------------------------------pseudo_mini_loss sum 4.788811206817627
Total (block generation + training)time/epoch 49.09267170612629
Training time/epoch 5.318944215774536
Training time without block to device /epoch 5.284182548522949
Training time without total dataloading part /epoch 4.415301084518433
load block tensor time/epoch 0.7147257328033447
block to device time/epoch 0.034761667251586914
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  703489
Number of first layer input nodes during this epoch:  460594
Number of first layer output nodes during this epoch:  242895
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1344151496887207  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.536 seconds, peak memory: 38.615 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.615 GB
Metis partitioning: 5.459 seconds, peak memory: 38.615 GB
Split the graph: 7.394 seconds
Construct subgraphs: 0.083 seconds
REG metis partition end ----................................
REG construction  time spent:  24.555386543273926
pure dgl.metis_partition the time spent:  14.499070644378662
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.6204781532287598

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.3773045539855957

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1344151496887207  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

connection checking time:  1.9456489086151123
block generation total time  3.9977827072143555
average batch blocks generation time:  0.39977827072143557
block dataloader generation time/epoch 43.72749200889042
pseudo mini batch 0 input nodes size: 24685
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1327371597290039  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1327371597290039  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.14450788497924805  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1445760726928711  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.13083553314208984  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1531, 2: 1445, 3: 1100, 4: 871, 5: 714, 6: 570, 7: 494, 8: 390, 9: 319, 10: 231, 25: 228, 11: 212, 12: 189, 13: 156, 14: 129, 15: 125, 16: 91, 17: 66, 18: 65, 19: 49, 20: 46, 21: 38, 22: 37, 24: 29, 23: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.13229846954345703  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.13229846954345703  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.15400505065918  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.1554975509643555  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1644906997680664  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 1 input nodes size: 41400
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.16319942474365234  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.16319942474365234  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18294048309326172  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18301057815551758  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1711716651916504  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1224, 2: 1152, 3: 897, 4: 787, 25: 734, 5: 643, 6: 533, 8: 455, 7: 440, 9: 332, 10: 324, 11: 268, 12: 234, 14: 191, 13: 178, 15: 160, 16: 142, 17: 121, 18: 103, 19: 99, 20: 89, 21: 72, 23: 72, 22: 68, 24: 49})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17335939407348633  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17335939407348633  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.888684272766113  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.890172481536865  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17505311965942383  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 2 input nodes size: 37082
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17293548583984375  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17293548583984375  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19102859497070312  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19109582901000977  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17128467559814453  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1480, 2: 1263, 3: 1034, 4: 794, 5: 644, 25: 607, 6: 504, 7: 372, 9: 319, 8: 315, 10: 248, 12: 198, 11: 192, 13: 159, 14: 142, 15: 114, 17: 87, 18: 81, 16: 75, 19: 74, 21: 67, 20: 61, 22: 54, 24: 46, 23: 40})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17308664321899414  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17308664321899414  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.964056491851807  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.9654951095581055  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17450475692749023  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 3 input nodes size: 28086
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17280340194702148  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17280340194702148  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18647527694702148  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18654441833496094  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.16838407516479492  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1253, 2: 1055, 3: 942, 25: 838, 4: 742, 5: 650, 6: 515, 7: 455, 8: 393, 9: 332, 10: 300, 11: 259, 12: 213, 13: 184, 14: 178, 15: 162, 17: 135, 16: 120, 20: 104, 18: 94, 21: 88, 19: 84, 24: 58, 23: 58, 22: 53})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.170379638671875  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.170379638671875  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.6894450187683105  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.6908721923828125  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17196941375732422  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 4 input nodes size: 27008
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17027568817138672  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17027568817138672  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18394756317138672  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18401527404785156  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1702742576599121  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1183, 2: 1079, 3: 936, 4: 764, 5: 632, 25: 609, 6: 537, 7: 460, 8: 386, 9: 339, 10: 320, 11: 279, 12: 212, 13: 201, 14: 162, 16: 141, 17: 131, 15: 130, 18: 110, 20: 93, 19: 80, 21: 77, 22: 61, 23: 55, 24: 52})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1721019744873047  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1721019744873047  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.2698798179626465  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.271379470825195  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17340946197509766  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 5 input nodes size: 47417
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17188453674316406  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17188453674316406  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19519996643066406  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1952672004699707  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18152761459350586  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1726, 2: 1395, 3: 1063, 4: 797, 5: 730, 6: 515, 7: 413, 25: 381, 8: 364, 9: 286, 10: 216, 11: 163, 12: 162, 13: 139, 14: 106, 15: 86, 16: 68, 18: 68, 17: 66, 19: 59, 20: 54, 22: 32, 21: 31, 24: 28, 23: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.183380126953125  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.183380126953125  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.652352333068848  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.65377950668335  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18498611450195312  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 6 input nodes size: 50022
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18288373947143555  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18288373947143555  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20673608779907227  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.2068037986755371  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18342113494873047  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1555, 2: 1431, 3: 1120, 4: 846, 5: 706, 6: 505, 7: 413, 25: 387, 8: 351, 9: 310, 10: 257, 11: 189, 12: 158, 13: 150, 15: 106, 14: 105, 16: 83, 17: 82, 18: 69, 19: 68, 20: 47, 21: 46, 24: 36, 22: 28, 23: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18533754348754883  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18533754348754883  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.835251808166504  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.836705684661865  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18698453903198242  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 7 input nodes size: 66820
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18482542037963867  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18482542037963867  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.21668767929077148  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.21675443649291992  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19283437728881836  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1793, 1: 1111, 2: 976, 3: 733, 4: 552, 5: 529, 6: 426, 7: 355, 8: 276, 9: 237, 10: 226, 11: 225, 12: 176, 14: 152, 13: 149, 15: 148, 16: 133, 18: 120, 17: 113, 19: 102, 20: 93, 21: 89, 22: 75, 24: 74, 23: 58})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19817781448364258  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19817781448364258  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 8.129605770111084  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 8.131078720092773  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20113897323608398  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 8 input nodes size: 78483
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19498825073242188  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19498825073242188  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.23241186141967773  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.23247766494750977  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20054864883422852  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1425, 25: 1372, 2: 1162, 3: 794, 4: 638, 5: 492, 6: 396, 7: 331, 8: 278, 10: 236, 9: 209, 11: 193, 12: 171, 13: 150, 14: 119, 15: 113, 16: 107, 19: 105, 18: 96, 20: 93, 17: 89, 21: 71, 22: 65, 23: 63, 24: 60})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20537710189819336  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20537710189819336  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 7.608258247375488  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 7.609612941741943  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20986557006835938  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 9 input nodes size: 61503
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20258426666259766  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20258426666259766  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.23191118240356445  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.2319812774658203  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19449186325073242  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2511, 1: 940, 2: 748, 3: 658, 4: 529, 5: 482, 6: 367, 7: 312, 9: 293, 8: 264, 10: 241, 12: 224, 11: 223, 13: 190, 16: 151, 14: 150, 15: 145, 18: 142, 17: 140, 21: 138, 20: 127, 19: 116, 23: 98, 24: 93, 22: 83})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20013904571533203  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20013904571533203  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 9.572874546051025  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 9.574278831481934  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.2045750617980957  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.2045750617980957  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17152070999145508  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07166330814361573 |0.003080296516418457 |0.1511362075805664 |0.0001230478286743164 |0.2936774015426636 |0.005263566970825195 |
----------------------------------------------------------pseudo_mini_loss sum 5.315230846405029
Total (block generation + training)time/epoch 49.235554218292236
Training time/epoch 5.365998983383179
Training time without block to device /epoch 5.335196018218994
Training time without total dataloading part /epoch 4.454630136489868
load block tensor time/epoch 0.7166330814361572
block to device time/epoch 0.03080296516418457
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  706978
Number of first layer input nodes during this epoch:  462506
Number of first layer output nodes during this epoch:  244472
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.15638971328735352  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.533 seconds, peak memory: 38.615 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.615 GB
Metis partitioning: 5.415 seconds, peak memory: 38.615 GB
Split the graph: 7.205 seconds
Construct subgraphs: 0.098 seconds
REG metis partition end ----................................
REG construction  time spent:  27.275113344192505
pure dgl.metis_partition the time spent:  14.278796672821045
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.816521167755127

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.7772631645202637

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.15638971328735352  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

connection checking time:  1.6931536197662354
block generation total time  2.5937843322753906
average batch blocks generation time:  0.25937843322753906
block dataloader generation time/epoch 43.91257036526998
pseudo mini batch 0 input nodes size: 56590
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.14929485321044922  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.14929485321044922  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17663860321044922  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17670536041259766  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.147308349609375  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1637, 2: 1330, 3: 1071, 4: 829, 5: 726, 6: 517, 7: 399, 25: 394, 8: 347, 9: 294, 10: 259, 11: 171, 13: 157, 12: 151, 14: 126, 15: 90, 16: 78, 17: 72, 18: 59, 19: 52, 20: 51, 21: 37, 23: 27, 24: 27, 22: 24})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.14929485321044922  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.14929485321044922  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.790613651275635  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.792109966278076  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1811656951904297  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 1 input nodes size: 56013
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1788177490234375  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1788177490234375  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.2061614990234375  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20622777938842773  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1788172721862793  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1667, 2: 1396, 3: 1056, 4: 792, 5: 673, 6: 459, 25: 451, 7: 392, 8: 332, 9: 254, 11: 188, 10: 184, 12: 162, 13: 135, 14: 105, 15: 86, 16: 80, 17: 71, 18: 68, 19: 68, 20: 57, 21: 47, 23: 41, 22: 39, 24: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1808629035949707  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1808629035949707  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.921760082244873  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.923194885253906  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18249177932739258  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 2 input nodes size: 67312
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18004655838012695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18004655838012695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.2121434211730957  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.21220922470092773  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1847991943359375  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 1689, 1: 1203, 2: 1013, 3: 723, 4: 546, 5: 522, 6: 407, 7: 336, 8: 300, 9: 251, 10: 246, 11: 197, 12: 176, 13: 145, 15: 133, 14: 129, 18: 119, 16: 115, 19: 105, 17: 101, 20: 92, 21: 83, 22: 74, 24: 69, 23: 54})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19008111953735352  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19008111953735352  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 7.859118938446045  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 7.8604583740234375  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19331789016723633  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 3 input nodes size: 79583
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18719244003295898  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18719244003295898  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.22514057159423828  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.2252063751220703  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19304370880126953  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1349, 25: 1333, 2: 1154, 3: 855, 4: 646, 5: 518, 6: 410, 7: 324, 9: 262, 8: 261, 10: 230, 11: 218, 12: 181, 14: 126, 15: 122, 13: 114, 18: 106, 16: 106, 17: 89, 20: 84, 21: 82, 19: 82, 23: 65, 22: 61, 24: 50})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19817495346069336  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19817495346069336  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 7.549173355102539  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 7.550726413726807  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20135068893432617  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 4 input nodes size: 61681
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19500017166137695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19500017166137695  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.2244119644165039  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.22448110580444336  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18646717071533203  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 2537, 1: 908, 2: 749, 3: 632, 4: 504, 5: 461, 6: 354, 7: 299, 9: 278, 8: 259, 10: 226, 12: 213, 11: 210, 13: 197, 16: 156, 15: 150, 14: 146, 18: 142, 17: 139, 19: 134, 20: 129, 21: 128, 24: 104, 22: 84, 23: 82})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19202709197998047  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19202709197998047  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 9.53929090499878  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 9.54083251953125  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1966843605041504  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 5 input nodes size: 29260
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18963098526000977  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18963098526000977  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.2035832405090332  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.20365238189697266  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17417144775390625  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1559, 2: 1314, 3: 1038, 4: 848, 5: 700, 6: 516, 7: 450, 25: 400, 8: 397, 9: 330, 10: 288, 11: 237, 13: 200, 12: 193, 14: 132, 15: 130, 16: 99, 17: 79, 19: 77, 20: 70, 18: 66, 21: 41, 22: 40, 24: 39, 23: 37})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17583036422729492  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17583036422729492  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.723845481872559  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.725249767303467  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17659521102905273  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 6 input nodes size: 31140
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1751103401184082  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1751103401184082  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18995904922485352  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19002866744995117  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17600727081298828  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1626, 2: 1506, 3: 1120, 4: 862, 5: 712, 6: 580, 7: 452, 8: 388, 25: 353, 9: 280, 10: 239, 11: 182, 12: 167, 13: 129, 14: 123, 15: 113, 16: 82, 17: 81, 18: 73, 19: 52, 21: 49, 23: 42, 22: 41, 20: 39, 24: 35})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17760896682739258  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17760896682739258  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.488299369812012  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 4.48970365524292  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17895841598510742  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 7 input nodes size: 40581
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17746353149414062  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17746353149414062  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19699478149414062  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19706249237060547  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1821441650390625  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1270, 2: 1158, 3: 949, 4: 783, 25: 702, 5: 617, 6: 514, 7: 441, 8: 397, 9: 327, 10: 283, 11: 231, 12: 223, 14: 173, 13: 170, 15: 144, 16: 119, 17: 114, 18: 85, 19: 83, 20: 82, 21: 65, 22: 63, 24: 49, 23: 38})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18415307998657227  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18415307998657227  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.488124370574951  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.489604949951172  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18577909469604492  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 8 input nodes size: 26905
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1838665008544922  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1838665008544922  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1975383758544922  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19760751724243164  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1780085563659668  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 1025, 1: 979, 3: 894, 4: 761, 25: 703, 5: 655, 6: 593, 7: 494, 8: 414, 9: 362, 10: 340, 11: 308, 12: 252, 13: 222, 14: 195, 15: 154, 16: 148, 17: 146, 18: 126, 20: 101, 21: 98, 19: 92, 22: 72, 23: 67, 24: 59})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17998218536376953  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17998218536376953  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.768991947174072  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.770506858825684  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1813211441040039  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

pseudo mini batch 9 input nodes size: 28498
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17972278594970703  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17972278594970703  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.19339466094970703  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1934647560119629  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.17972373962402344  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 1230, 2: 1061, 3: 939, 25: 898, 4: 749, 5: 638, 6: 518, 7: 458, 8: 377, 9: 338, 10: 304, 11: 261, 12: 219, 13: 187, 14: 179, 15: 167, 17: 138, 16: 128, 18: 104, 20: 102, 19: 91, 21: 87, 23: 66, 24: 60, 22: 58})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1817779541015625  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.1817779541015625  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.8725905418396  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 5.874006271362305  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18337154388427734  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.18337154388427734  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.62060546875 GB
    Memory Allocated: 0.15031719207763672  GigaBytes
Max Memory Allocated: 10.309792518615723  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07176475524902344 |0.0035497426986694338 |0.14811267852783203 |0.00012154579162597657 |0.29330034255981446 |0.005013227462768555 |
----------------------------------------------------------pseudo_mini_loss sum 5.974896430969238
Total (block generation + training)time/epoch 49.40856540997823
Training time/epoch 5.326716423034668
Training time without block to device /epoch 5.291218996047974
Training time without total dataloading part /epoch 4.420358896255493
load block tensor time/epoch 0.7176475524902344
block to device time/epoch 0.035497426986694336
input features size transfer per epoch 1.4901161193847656e-06
blocks size to device per epoch 8.195638656616211e-07
