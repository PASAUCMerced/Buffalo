main start at this time 1733102176.3470004
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.55029296875 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.474 seconds, peak memory: 17.052 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 17.052 GB
Metis partitioning: 4.879 seconds, peak memory: 17.830 GB
Split the graph: 13.374 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  23.680983066558838
pure dgl.metis_partition the time spent:  19.773681640625
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.6874747276306152

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.1405019760131836

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

connection checking time:  1.192718267440796
block generation total time  1.8279767036437988
average batch blocks generation time:  0.4569941759109497
block dataloader generation time/epoch 47.11740803718567
pseudo mini batch 0 input nodes size: 93295
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.59716796875 GB
    Memory Allocated: 0.07797622680664062  GigaBytes
Max Memory Allocated: 0.07797622680664062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.59912109375 GB
    Memory Allocated: 0.07814931869506836  GigaBytes
Max Memory Allocated: 0.07814931869506836  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.59912109375 GB
    Memory Allocated: 0.07814931869506836  GigaBytes
Max Memory Allocated: 0.07814931869506836  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5319, 1: 2644, 2: 2293, 3: 1778, 4: 1399, 5: 1264, 6: 1014, 7: 849, 8: 689, 9: 670, 10: 617, 11: 536, 12: 516, 13: 432, 15: 366, 14: 360, 16: 341, 18: 329, 17: 308, 19: 293, 20: 281, 21: 262, 24: 209, 23: 204, 22: 198})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.61865234375 GB
    Memory Allocated: 0.08613157272338867  GigaBytes
Max Memory Allocated: 0.08613157272338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.61865234375 GB
    Memory Allocated: 0.08613157272338867  GigaBytes
Max Memory Allocated: 0.08613157272338867  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.31787109375 GB
    Memory Allocated: 20.154067039489746  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.31787109375 GB
    Memory Allocated: 20.15752077102661  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.32958984375 GB
    Memory Allocated: 0.14630794525146484  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

pseudo mini batch 1 input nodes size: 93301
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.32958984375 GB
    Memory Allocated: 0.1380939483642578  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.32958984375 GB
    Memory Allocated: 0.1380939483642578  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.32958984375 GB
    Memory Allocated: 0.18258333206176758  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.32958984375 GB
    Memory Allocated: 0.18275070190429688  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.32958984375 GB
    Memory Allocated: 0.13765573501586914  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4103, 2: 3398, 3: 2531, 4: 1952, 5: 1676, 25: 1368, 6: 1204, 7: 974, 8: 872, 9: 692, 10: 564, 11: 474, 12: 423, 13: 353, 14: 300, 15: 252, 16: 237, 17: 190, 18: 178, 19: 157, 20: 151, 21: 121, 22: 99, 24: 87, 23: 71})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.32958984375 GB
    Memory Allocated: 0.1424717903137207  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.32958984375 GB
    Memory Allocated: 0.1424717903137207  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.45263671875 GB
    Memory Allocated: 12.055096626281738  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.45263671875 GB
    Memory Allocated: 12.05896520614624  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.45263671875 GB
    Memory Allocated: 0.1465287208557129  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

pseudo mini batch 2 input nodes size: 48044
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.45263671875 GB
    Memory Allocated: 0.14110040664672852  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.45263671875 GB
    Memory Allocated: 0.14110040664672852  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.45263671875 GB
    Memory Allocated: 0.16453790664672852  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.45263671875 GB
    Memory Allocated: 0.1647038459777832  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.45263671875 GB
    Memory Allocated: 0.12004709243774414  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2814, 2: 2626, 3: 2255, 25: 1875, 4: 1832, 5: 1526, 6: 1256, 7: 1101, 8: 948, 9: 815, 10: 746, 11: 662, 12: 542, 13: 482, 14: 426, 15: 363, 17: 319, 16: 301, 18: 256, 20: 241, 19: 213, 21: 212, 22: 157, 23: 145, 24: 139})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.45263671875 GB
    Memory Allocated: 0.12442541122436523  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.45263671875 GB
    Memory Allocated: 0.12442541122436523  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 12.851369380950928  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 12.855062484741211  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.12752676010131836  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

pseudo mini batch 3 input nodes size: 56675
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.12429475784301758  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.12429475784301758  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.15163850784301758  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1518106460571289  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.12820720672607422  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3867, 2: 3389, 3: 2713, 4: 2137, 5: 1756, 6: 1394, 7: 1121, 8: 963, 25: 898, 9: 799, 10: 672, 11: 531, 12: 456, 13: 389, 14: 348, 15: 308, 16: 232, 17: 213, 18: 185, 19: 173, 20: 134, 21: 122, 22: 102, 23: 99, 24: 90})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.13205957412719727  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.13205957412719727  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 10.85805606842041  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 10.86167287826538  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.13504838943481445  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.2011570930480957  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.16810274124145508  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10041040182113647 |0.007701873779296875 |0.8817704916000366 |0.0034149885177612305 |0.6189433336257935 |0.2066197395324707 |
----------------------------------------------------------pseudo_mini_loss sum 3.7766737937927246
Total (block generation + training)time/epoch 53.80844068527222
Training time/epoch 6.6904919147491455
Training time without block to device /epoch 6.659684419631958
Training time without total dataloading part /epoch 6.223134994506836
load block tensor time/epoch 0.4016416072845459
block to device time/epoch 0.0308074951171875
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  486206
Number of first layer input nodes during this epoch:  291315
Number of first layer output nodes during this epoch:  194891
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.15381860733032227  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.502 seconds, peak memory: 46.126 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.126 GB
Metis partitioning: 5.165 seconds, peak memory: 46.929 GB
Split the graph: 14.446 seconds
Construct subgraphs: 0.025 seconds
REG metis partition end ----................................
REG construction  time spent:  27.48037552833557
pure dgl.metis_partition the time spent:  21.168765544891357
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8557560443878174

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.2273149490356445

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.15381860733032227  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

connection checking time:  1.2846505641937256
block generation total time  2.083070993423462
average batch blocks generation time:  0.5207677483558655
block dataloader generation time/epoch 49.94414508342743
pseudo mini batch 0 input nodes size: 48528
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1505589485168457  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1505589485168457  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1739964485168457  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1741647720336914  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.14664888381958008  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3055, 2: 2731, 3: 2313, 4: 1850, 25: 1778, 5: 1537, 6: 1293, 7: 1092, 8: 922, 9: 828, 10: 727, 11: 668, 12: 547, 13: 478, 14: 423, 15: 345, 17: 316, 16: 304, 18: 258, 20: 241, 19: 210, 21: 210, 22: 146, 23: 144, 24: 134})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1509847640991211  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1509847640991211  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 12.762392044067383  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 12.766047477722168  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.18351459503173828  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

pseudo mini batch 1 input nodes size: 54071
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1802959442138672  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1802959442138672  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.20607900619506836  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.20624828338623047  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.18264245986938477  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3819, 2: 3444, 3: 2694, 4: 2097, 5: 1718, 6: 1347, 7: 1116, 8: 943, 25: 888, 9: 765, 10: 655, 11: 511, 12: 444, 13: 369, 14: 310, 15: 303, 16: 230, 17: 206, 19: 168, 18: 167, 20: 131, 21: 112, 22: 101, 23: 94, 24: 84})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1863694190979004  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1863694190979004  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 10.62467098236084  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 10.628188610076904  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.18929433822631836  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

pseudo mini batch 2 input nodes size: 93511
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1861705780029297  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1861705780029297  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.2310924530029297  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.2312626838684082  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.20531034469604492  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3953, 2: 3285, 3: 2515, 4: 1980, 5: 1753, 25: 1521, 6: 1250, 7: 1011, 8: 915, 9: 737, 10: 623, 11: 489, 12: 429, 13: 381, 14: 333, 15: 293, 16: 239, 17: 199, 18: 197, 20: 163, 19: 161, 21: 126, 22: 114, 24: 97, 23: 83})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.21056890487670898  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.21056890487670898  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 12.685494899749756  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 12.689092636108398  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.21467971801757812  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

pseudo mini batch 3 input nodes size: 92089
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.2090311050415039  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.2090311050415039  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.2529425621032715  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.25311279296875  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.20802068710327148  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5273, 1: 2601, 2: 2246, 3: 1755, 4: 1393, 5: 1214, 6: 978, 7: 826, 8: 692, 9: 646, 10: 594, 11: 535, 12: 517, 13: 428, 14: 368, 15: 348, 16: 338, 18: 326, 17: 309, 19: 297, 20: 272, 21: 269, 24: 210, 23: 198, 22: 195})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.21602916717529297  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.21602916717529297  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 19.997865676879883  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 20.001356601715088  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.2227039337158203  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.2227039337158203  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1896495819091797  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13141590356826782 |0.009584784507751465 |0.26432138681411743 |0.0001818537712097168 |0.614672839641571 |0.008270025253295898 |
----------------------------------------------------------pseudo_mini_loss sum 18.43080711364746
Total (block generation + training)time/epoch 55.43433225154877
Training time/epoch 4.288838624954224
Training time without block to device /epoch 4.250499486923218
Training time without total dataloading part /epoch 3.5249743461608887
load block tensor time/epoch 0.5256636142730713
block to device time/epoch 0.03833913803100586
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  481325
Number of first layer input nodes during this epoch:  288199
Number of first layer output nodes during this epoch:  193126
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1781005859375  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.541 seconds, peak memory: 47.617 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.617 GB
Metis partitioning: 5.198 seconds, peak memory: 47.617 GB
Split the graph: 15.059 seconds
Construct subgraphs: 0.005 seconds
REG metis partition end ----................................
REG construction  time spent:  26.978169202804565
pure dgl.metis_partition the time spent:  21.8304500579834
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.9649100303649902

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.655733108520508

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1781005859375  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

connection checking time:  2.086994171142578
block generation total time  4.620643138885498
average batch blocks generation time:  1.1551607847213745
block dataloader generation time/epoch 52.04381140073141
pseudo mini batch 0 input nodes size: 48894
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.16985464096069336  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.16985464096069336  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.19329214096069336  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.19345951080322266  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.14937782287597656  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2976, 2: 2722, 3: 2297, 4: 1868, 25: 1752, 5: 1577, 6: 1302, 7: 1086, 8: 938, 9: 814, 10: 728, 11: 660, 12: 551, 13: 472, 14: 416, 15: 351, 17: 311, 16: 304, 18: 253, 20: 237, 19: 214, 21: 203, 23: 146, 22: 140, 24: 134})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.15371036529541016  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.15371036529541016  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 12.70605993270874  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 12.709837436676025  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.18346357345581055  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

pseudo mini batch 1 input nodes size: 64884
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.18021917343139648  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.18021917343139648  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.21115827560424805  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.21133136749267578  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.18772649765014648  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3564, 2: 3225, 3: 2591, 4: 2070, 5: 1724, 6: 1352, 25: 1275, 7: 1186, 8: 995, 9: 800, 10: 705, 11: 567, 12: 490, 13: 425, 14: 364, 15: 344, 16: 263, 17: 240, 18: 198, 19: 177, 20: 164, 21: 139, 22: 134, 23: 105, 24: 100})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1920027732849121  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.1920027732849121  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 11.995889663696289  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 11.999353885650635  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.19530534744262695  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

pseudo mini batch 2 input nodes size: 95295
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.19160985946655273  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.19160985946655273  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.23705005645751953  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.2372145652770996  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.2061023712158203  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4265, 2: 3500, 3: 2624, 4: 1957, 5: 1677, 6: 1192, 25: 1099, 7: 929, 8: 823, 9: 678, 10: 539, 11: 421, 12: 376, 13: 318, 14: 280, 15: 233, 16: 206, 18: 173, 17: 173, 19: 149, 20: 127, 21: 99, 24: 86, 22: 76, 23: 71})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.21071863174438477  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.21071863174438477  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 11.395923614501953  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 11.399403095245361  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.21551942825317383  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

pseudo mini batch 3 input nodes size: 93265
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.21017074584960938  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.21017074584960938  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.2550926208496094  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.2552657127380371  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.20966100692749023  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5334, 1: 2623, 2: 2259, 3: 1765, 4: 1425, 5: 1244, 6: 1022, 7: 844, 8: 716, 9: 684, 10: 627, 11: 555, 12: 520, 13: 441, 14: 374, 15: 361, 16: 338, 18: 324, 17: 306, 19: 296, 20: 279, 21: 276, 22: 206, 24: 205, 23: 197})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.2195277214050293  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.50927734375 GB
    Memory Allocated: 0.2195277214050293  GigaBytes
Max Memory Allocated: 21.6163330078125  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 20.358091354370117  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 20.362284183502197  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.55029296875 GB
    Memory Allocated: 0.22583293914794922  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.55029296875 GB
    Memory Allocated: 0.22583293914794922  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.55029296875 GB
    Memory Allocated: 0.1927785873413086  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13445258140563965 |0.0058460235595703125 |0.3624311089515686 |0.00014209747314453125 |0.6057902574539185 |0.00483250617980957 |
----------------------------------------------------------pseudo_mini_loss sum 8.389913558959961
Total (block generation + training)time/epoch 57.253036975860596
Training time/epoch 4.647040843963623
Training time without block to device /epoch 4.623656749725342
Training time without total dataloading part /epoch 3.878286361694336
load block tensor time/epoch 0.5378103256225586
block to device time/epoch 0.02338409423828125
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  501074
Number of first layer input nodes during this epoch:  302338
Number of first layer output nodes during this epoch:  198736
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.55029296875 GB
    Memory Allocated: 0.1813044548034668  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.488 seconds, peak memory: 47.899 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.899 GB
Metis partitioning: 5.116 seconds, peak memory: 47.899 GB
Split the graph: 13.176 seconds
Construct subgraphs: 0.007 seconds
REG metis partition end ----................................
REG construction  time spent:  29.17908024787903
pure dgl.metis_partition the time spent:  19.8141667842865
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.5509495735168457

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.299208641052246

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.55029296875 GB
    Memory Allocated: 0.1813044548034668  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

connection checking time:  1.7861990928649902
block generation total time  2.850158214569092
average batch blocks generation time:  0.712539553642273
block dataloader generation time/epoch 52.60877698659897
pseudo mini batch 0 input nodes size: 88869
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.55029296875 GB
    Memory Allocated: 0.17298030853271484  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.55029296875 GB
    Memory Allocated: 0.17298030853271484  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.55029296875 GB
    Memory Allocated: 0.21535634994506836  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.55029296875 GB
    Memory Allocated: 0.21552419662475586  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.55029296875 GB
    Memory Allocated: 0.17042922973632812  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3977, 2: 3379, 3: 2529, 4: 1967, 5: 1696, 25: 1302, 6: 1236, 7: 964, 8: 887, 9: 726, 10: 601, 11: 505, 12: 417, 13: 375, 14: 307, 15: 252, 16: 220, 18: 197, 17: 190, 19: 173, 20: 157, 21: 126, 22: 108, 23: 101, 24: 101})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.55029296875 GB
    Memory Allocated: 0.17606306076049805  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.55029296875 GB
    Memory Allocated: 0.17606306076049805  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 12.068044662475586  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 12.071616172790527  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.20445823669433594  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 1 input nodes size: 93794
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.19854021072387695  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.19854021072387695  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.24346208572387695  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.24363327026367188  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.20108938217163086  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5258, 1: 2695, 2: 2295, 3: 1806, 4: 1397, 5: 1243, 6: 990, 7: 826, 8: 669, 9: 655, 10: 581, 11: 522, 12: 502, 13: 416, 14: 357, 15: 354, 16: 330, 18: 310, 17: 305, 19: 289, 20: 271, 21: 271, 22: 195, 24: 191, 23: 186})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.20896577835083008  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.20896577835083008  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 19.931962966918945  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 19.935408115386963  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.21551275253295898  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 2 input nodes size: 64093
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.20725727081298828  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.20725727081298828  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.23781919479370117  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.2379918098449707  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.19289875030517578  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3597, 2: 3240, 3: 2592, 4: 2087, 5: 1740, 6: 1348, 25: 1228, 7: 1176, 8: 985, 9: 800, 10: 697, 11: 565, 12: 512, 13: 428, 14: 361, 15: 346, 16: 263, 17: 224, 18: 192, 19: 170, 20: 155, 22: 125, 21: 118, 24: 102, 23: 87})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.19707632064819336  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.19707632064819336  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 11.873862743377686  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 11.877830505371094  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.2005324363708496  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 3 input nodes size: 52374
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.1969609260559082  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.1969609260559082  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.2223515510559082  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.2225184440612793  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.19178390502929688  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3159, 2: 2792, 3: 2350, 4: 1869, 25: 1672, 5: 1543, 6: 1294, 7: 1079, 8: 931, 9: 795, 10: 720, 11: 611, 12: 506, 13: 437, 14: 409, 15: 337, 17: 311, 16: 298, 18: 249, 20: 224, 19: 204, 21: 202, 23: 145, 24: 131, 22: 128})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.19608068466186523  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.66748046875 GB
    Memory Allocated: 0.19608068466186523  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 12.577139854431152  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 12.580691814422607  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.19887304306030273  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.19887304306030273  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.1658186912536621  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13518691062927246 |0.005997955799102783 |0.25881946086883545 |0.0001322627067565918 |0.6149784326553345 |0.004857778549194336 |
----------------------------------------------------------pseudo_mini_loss sum 4.317773818969727
Total (block generation + training)time/epoch 57.58111768960953
Training time/epoch 4.261274814605713
Training time without block to device /epoch 4.237282991409302
Training time without total dataloading part /epoch 3.5005784034729004
load block tensor time/epoch 0.5407476425170898
block to device time/epoch 0.023991823196411133
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  495566
Number of first layer input nodes during this epoch:  299130
Number of first layer output nodes during this epoch:  196436
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.15224933624267578  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.447 seconds, peak memory: 47.899 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.899 GB
Metis partitioning: 4.805 seconds, peak memory: 47.899 GB
Split the graph: 13.063 seconds
Construct subgraphs: 0.034 seconds
REG metis partition end ----................................
REG construction  time spent:  26.74376940727234
pure dgl.metis_partition the time spent:  19.375540256500244
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.787297248840332

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.2315568923950195

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.15224933624267578  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

connection checking time:  1.3794126510620117
block generation total time  2.0188541412353516
average batch blocks generation time:  0.5047135353088379
block dataloader generation time/epoch 52.141067838668825
pseudo mini batch 0 input nodes size: 91595
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.14892148971557617  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.14892148971557617  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.1925973892211914  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.1927633285522461  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.167205810546875  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4225, 2: 3541, 3: 2612, 4: 2010, 5: 1707, 6: 1225, 25: 1072, 7: 969, 8: 821, 9: 677, 10: 568, 11: 440, 12: 377, 13: 335, 14: 269, 15: 236, 16: 192, 18: 181, 17: 176, 20: 137, 19: 132, 21: 107, 22: 84, 24: 84, 23: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.17178106307983398  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.17178106307983398  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 11.300432682037354  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 11.303809642791748  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.20523357391357422  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 1 input nodes size: 92970
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.19980573654174805  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.19980573654174805  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.24413728713989258  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.2443099021911621  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.2004680633544922  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5359, 1: 2644, 2: 2228, 3: 1733, 4: 1383, 5: 1257, 6: 1029, 7: 839, 8: 703, 9: 678, 10: 614, 11: 540, 12: 518, 13: 429, 14: 383, 15: 358, 16: 342, 18: 321, 17: 312, 19: 305, 20: 270, 21: 266, 24: 207, 23: 200, 22: 200})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.21039867401123047  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70849609375 GB
    Memory Allocated: 0.21039867401123047  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.54443359375 GB
    Memory Allocated: 20.291558265686035  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.54443359375 GB
    Memory Allocated: 20.295255184173584  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.54443359375 GB
    Memory Allocated: 0.21758604049682617  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 2 input nodes size: 63121
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.54443359375 GB
    Memory Allocated: 0.20896196365356445  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.54443359375 GB
    Memory Allocated: 0.20896196365356445  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.54443359375 GB
    Memory Allocated: 0.2390604019165039  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.54443359375 GB
    Memory Allocated: 0.23923349380493164  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.54443359375 GB
    Memory Allocated: 0.19472932815551758  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3510, 2: 3210, 3: 2602, 4: 2083, 5: 1710, 6: 1330, 25: 1291, 7: 1179, 8: 1023, 9: 821, 10: 704, 11: 577, 12: 505, 13: 428, 14: 366, 15: 354, 16: 278, 17: 230, 18: 199, 19: 182, 20: 168, 21: 139, 22: 132, 24: 103, 23: 103})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.54443359375 GB
    Memory Allocated: 0.19899797439575195  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.54443359375 GB
    Memory Allocated: 0.19899797439575195  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.65185546875 GB
    Memory Allocated: 12.029185771942139  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.65185546875 GB
    Memory Allocated: 12.033016204833984  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.65185546875 GB
    Memory Allocated: 0.20230627059936523  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 3 input nodes size: 49716
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.65185546875 GB
    Memory Allocated: 0.19866609573364258  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.65185546875 GB
    Memory Allocated: 0.19866609573364258  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.65185546875 GB
    Memory Allocated: 0.22237253189086914  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.65185546875 GB
    Memory Allocated: 0.22253942489624023  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.65185546875 GB
    Memory Allocated: 0.19226789474487305  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3049, 2: 2727, 3: 2330, 4: 1844, 25: 1738, 5: 1548, 6: 1284, 7: 1058, 8: 925, 9: 800, 10: 713, 11: 646, 12: 537, 13: 464, 14: 416, 15: 341, 17: 312, 16: 299, 18: 247, 20: 232, 19: 217, 21: 205, 23: 144, 22: 140, 24: 131})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.65185546875 GB
    Memory Allocated: 0.1965770721435547  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.65185546875 GB
    Memory Allocated: 0.1965770721435547  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 12.674555778503418  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 12.67808485031128  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.1992807388305664  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.1992807388305664  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.16622638702392578  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1402510404586792 |0.009277522563934326 |0.32202059030532837 |0.0001946091651916504 |0.5677421689033508 |0.005906820297241211 |
----------------------------------------------------------pseudo_mini_loss sum 4.96041202545166
Total (block generation + training)time/epoch 56.99006609916687
Training time/epoch 4.355229616165161
Training time without block to device /epoch 4.318119525909424
Training time without total dataloading part /epoch 3.5657362937927246
load block tensor time/epoch 0.5610041618347168
block to device time/epoch 0.037110090255737305
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  493893
Number of first layer input nodes during this epoch:  297402
Number of first layer output nodes during this epoch:  196491
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.1506032943725586  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.549 seconds, peak memory: 47.899 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.899 GB
Metis partitioning: 5.277 seconds, peak memory: 47.899 GB
Split the graph: 13.634 seconds
Construct subgraphs: 0.030 seconds
REG metis partition end ----................................
REG construction  time spent:  26.884212970733643
pure dgl.metis_partition the time spent:  20.520113468170166
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7935717105865479

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.275036334991455

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.1506032943725586  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

connection checking time:  1.300269603729248
block generation total time  2.068608045578003
average batch blocks generation time:  0.5171520113945007
block dataloader generation time/epoch 52.04598490397135
pseudo mini batch 0 input nodes size: 50988
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.14734172821044922  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.14734172821044922  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.17165470123291016  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.17182254791259766  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.14794921875  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3094, 2: 2794, 3: 2369, 4: 1815, 25: 1737, 5: 1552, 6: 1286, 7: 1095, 8: 936, 9: 801, 10: 707, 11: 641, 12: 525, 13: 468, 14: 405, 15: 343, 17: 313, 16: 300, 18: 248, 20: 226, 21: 207, 19: 201, 23: 142, 22: 142, 24: 132})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.15228939056396484  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.15228939056396484  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 12.646120548248291  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 12.649539470672607  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.18448543548583984  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 1 input nodes size: 63189
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.18116044998168945  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.18116044998168945  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21129131317138672  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21146440505981445  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.18698358535766602  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3542, 2: 3159, 3: 2566, 4: 2124, 5: 1760, 6: 1358, 25: 1255, 7: 1129, 8: 1000, 9: 805, 10: 731, 11: 574, 12: 504, 13: 432, 14: 376, 15: 348, 16: 267, 17: 243, 18: 206, 19: 187, 20: 174, 21: 136, 22: 129, 23: 107, 24: 105})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19125890731811523  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19125890731811523  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 12.108994007110596  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 12.112565040588379  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.1945328712463379  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 2 input nodes size: 93841
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19086694717407227  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19086694717407227  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.23561382293701172  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.23578357696533203  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.20547962188720703  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5327, 1: 2564, 2: 2235, 3: 1778, 4: 1349, 5: 1202, 6: 993, 7: 807, 9: 668, 8: 652, 10: 602, 11: 525, 12: 518, 13: 420, 14: 374, 15: 359, 16: 326, 18: 321, 19: 294, 17: 293, 20: 278, 21: 265, 24: 204, 22: 201, 23: 187})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21341609954833984  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21341609954833984  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 20.069766521453857  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 20.073333740234375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.22000503540039062  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 3 input nodes size: 93181
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21172142028808594  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21172142028808594  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.25664329528808594  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.25681114196777344  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21189451217651367  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4228, 2: 3518, 3: 2564, 4: 2032, 5: 1708, 6: 1231, 25: 1141, 7: 1014, 8: 884, 9: 702, 10: 559, 11: 463, 12: 390, 13: 336, 14: 279, 15: 239, 16: 218, 17: 181, 18: 173, 19: 154, 20: 129, 21: 109, 22: 84, 24: 84, 23: 83})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.2165846824645996  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.2165846824645996  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 11.66917085647583  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 11.672821998596191  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.2209315299987793  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.2209315299987793  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.18787717819213867  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12966257333755493 |0.005881786346435547 |0.2631065249443054 |0.00014203786849975586 |0.6130974292755127 |0.005130767822265625 |
----------------------------------------------------------pseudo_mini_loss sum 4.067562580108643
Total (block generation + training)time/epoch 56.796024799346924
Training time/epoch 4.254897832870483
Training time without block to device /epoch 4.231370687484741
Training time without total dataloading part /epoch 3.510514736175537
load block tensor time/epoch 0.5186502933502197
block to device time/epoch 0.023527145385742188
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  499726
Number of first layer input nodes during this epoch:  301199
Number of first layer output nodes during this epoch:  198527
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.17362260818481445  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.575 seconds, peak memory: 47.899 GB
Construct multi-constraint weights: 0.001 seconds, peak memory: 47.899 GB
Metis partitioning: 4.902 seconds, peak memory: 47.899 GB
Split the graph: 13.058 seconds
Construct subgraphs: 0.028 seconds
REG metis partition end ----................................
REG construction  time spent:  25.23031783103943
pure dgl.metis_partition the time spent:  19.59395146369934
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.9652268886566162

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.250920057296753

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.17362260818481445  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

connection checking time:  1.3164806365966797
block generation total time  2.216146945953369
average batch blocks generation time:  0.5540367364883423
block dataloader generation time/epoch 51.61951150212969
pseudo mini batch 0 input nodes size: 51912
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.16846179962158203  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.16846179962158203  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19385242462158203  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19402170181274414  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.14893198013305664  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3067, 2: 2752, 3: 2326, 4: 1890, 25: 1839, 5: 1583, 6: 1296, 7: 1118, 8: 945, 9: 814, 10: 755, 11: 649, 12: 534, 13: 477, 14: 422, 15: 353, 17: 307, 16: 290, 20: 242, 18: 239, 19: 208, 21: 193, 22: 148, 24: 132, 23: 128})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.15335607528686523  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.15335607528686523  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 12.90186071395874  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 12.9054856300354  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.18573522567749023  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 1 input nodes size: 63595
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.1823596954345703  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.1823596954345703  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21268415451049805  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21285724639892578  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.18729734420776367  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3591, 2: 3213, 3: 2615, 4: 2096, 5: 1724, 6: 1388, 25: 1177, 7: 1145, 8: 993, 9: 823, 10: 676, 11: 557, 12: 501, 13: 413, 14: 369, 15: 336, 16: 273, 17: 234, 18: 220, 19: 194, 20: 155, 21: 146, 22: 128, 23: 123, 24: 104})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19154787063598633  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19154787063598633  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 11.959304332733154  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 11.96282958984375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19474077224731445  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 2 input nodes size: 94026
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19105100631713867  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19105100631713867  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.2358860969543457  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.2360539436340332  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.20555639266967773  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4208, 2: 3552, 3: 2597, 4: 1972, 5: 1705, 6: 1241, 25: 1168, 7: 979, 8: 890, 9: 704, 10: 570, 11: 484, 12: 402, 13: 342, 14: 280, 15: 245, 16: 202, 17: 179, 18: 162, 19: 150, 20: 136, 21: 108, 24: 86, 23: 80, 22: 80})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21025800704956055  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21025800704956055  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 11.718942165374756  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 11.722467422485352  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21425580978393555  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 3 input nodes size: 92435
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.2089080810546875  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.2089080810546875  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.2538299560546875  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.253997802734375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.20899486541748047  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5276, 1: 2562, 2: 2189, 3: 1739, 4: 1362, 5: 1210, 6: 943, 7: 803, 8: 644, 9: 635, 10: 598, 11: 513, 12: 500, 13: 424, 14: 363, 15: 355, 16: 346, 18: 327, 17: 310, 19: 284, 20: 274, 21: 270, 24: 203, 22: 200, 23: 188})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.2168722152709961  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.2168722152709961  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 19.872891902923584  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 19.87628746032715  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.22333526611328125  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.22333526611328125  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19028091430664062  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13228470087051392 |0.006288290023803711 |0.2637879252433777 |0.00014162063598632812 |0.6157159805297852 |0.0052089691162109375 |
----------------------------------------------------------pseudo_mini_loss sum 3.817718267440796
Total (block generation + training)time/epoch 56.30158175740923
Training time/epoch 4.273899555206299
Training time without block to device /epoch 4.248746395111084
Training time without total dataloading part /epoch 3.5237910747528076
load block tensor time/epoch 0.5291388034820557
block to device time/epoch 0.025153160095214844
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  500417
Number of first layer input nodes during this epoch:  301968
Number of first layer output nodes during this epoch:  198449
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.17867040634155273  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.490 seconds, peak memory: 47.899 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.899 GB
Metis partitioning: 5.270 seconds, peak memory: 47.899 GB
Split the graph: 13.227 seconds
Construct subgraphs: 0.017 seconds
REG metis partition end ----................................
REG construction  time spent:  24.7026686668396
pure dgl.metis_partition the time spent:  20.032819032669067
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.942779541015625

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3767743110656738

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.17867040634155273  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

connection checking time:  1.4867987632751465
block generation total time  2.319553852081299
average batch blocks generation time:  0.5798884630203247
block dataloader generation time/epoch 51.32771295309067
pseudo mini batch 0 input nodes size: 92539
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.17041587829589844  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.17041587829589844  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21454191207885742  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21471166610717773  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.16962194442749023  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5315, 1: 2606, 2: 2272, 3: 1765, 4: 1363, 5: 1210, 6: 966, 7: 802, 8: 673, 9: 659, 10: 592, 11: 532, 12: 504, 13: 430, 14: 366, 15: 360, 16: 324, 18: 316, 17: 300, 19: 294, 20: 268, 21: 257, 22: 202, 24: 202, 23: 194})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.1776280403137207  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.1776280403137207  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 19.982593536376953  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 19.986313819885254  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21126317977905273  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 1 input nodes size: 90707
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.20302295684814453  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.20302295684814453  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.2462754249572754  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.2464432716369629  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.2021474838256836  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4192, 2: 3541, 3: 2662, 4: 2018, 5: 1754, 6: 1265, 25: 1077, 7: 985, 8: 873, 9: 703, 10: 566, 11: 456, 12: 380, 13: 338, 14: 270, 15: 238, 16: 205, 17: 180, 18: 177, 19: 144, 20: 133, 21: 110, 24: 83, 22: 78, 23: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.20717954635620117  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.20717954635620117  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 11.423561096191406  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 11.426914691925049  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21146059036254883  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 2 input nodes size: 63462
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.20561504364013672  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.20561504364013672  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.23587608337402344  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.23604965209960938  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19262933731079102  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3533, 2: 3181, 3: 2551, 4: 2087, 5: 1701, 6: 1347, 25: 1303, 7: 1163, 8: 997, 9: 818, 10: 723, 11: 565, 12: 513, 13: 425, 14: 392, 15: 356, 16: 279, 17: 239, 18: 208, 19: 194, 20: 175, 21: 149, 22: 128, 23: 114, 24: 105})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19692659378051758  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19692659378051758  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 12.15697431564331  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 12.160541534423828  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.20003843307495117  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 3 input nodes size: 48485
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19638681411743164  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19638681411743164  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21982431411743164  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.21999168395996094  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.18955707550048828  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3097, 2: 2712, 3: 2299, 4: 1852, 25: 1765, 5: 1557, 6: 1290, 7: 1095, 8: 929, 9: 796, 10: 718, 11: 650, 12: 540, 13: 463, 14: 406, 15: 335, 17: 311, 16: 303, 18: 247, 20: 231, 19: 204, 21: 201, 22: 148, 23: 139, 24: 135})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19385242462158203  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.70458984375 GB
    Memory Allocated: 0.19385242462158203  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.667670249938965  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.671847820281982  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1969623565673828  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1969623565673828  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1639080047607422  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13275939226150513 |0.008193254470825195 |0.26556408405303955 |0.00013566017150878906 |0.6148104667663574 |0.0049550533294677734 |
----------------------------------------------------------pseudo_mini_loss sum 3.716552972793579
Total (block generation + training)time/epoch 55.959535360336304
Training time/epoch 4.279606580734253
Training time without block to device /epoch 4.246833562850952
Training time without total dataloading part /epoch 3.526995897293091
load block tensor time/epoch 0.5310375690460205
block to device time/epoch 0.03277301788330078
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  490046
Number of first layer input nodes during this epoch:  295193
Number of first layer output nodes during this epoch:  194853
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1504220962524414  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.520 seconds, peak memory: 47.899 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.899 GB
Metis partitioning: 5.196 seconds, peak memory: 47.899 GB
Split the graph: 13.044 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  24.050041437149048
pure dgl.metis_partition the time spent:  19.807480573654175
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7846372127532959

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.2199437618255615

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1504220962524414  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

connection checking time:  1.2864570617675781
block generation total time  2.0045809745788574
average batch blocks generation time:  0.5011452436447144
block dataloader generation time/epoch 50.94150710105896
pseudo mini batch 0 input nodes size: 92817
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.14721441268920898  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.14721441268920898  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19213628768920898  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19230413436889648  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1686992645263672  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4290, 2: 3501, 3: 2598, 4: 2003, 5: 1702, 6: 1265, 25: 1132, 7: 989, 8: 860, 9: 715, 10: 601, 11: 464, 12: 391, 13: 340, 14: 270, 15: 251, 16: 207, 17: 178, 18: 163, 19: 148, 20: 131, 21: 102, 24: 91, 22: 71, 23: 64})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1739349365234375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1739349365234375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.541975021362305  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.545519828796387  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20723724365234375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 1 input nodes size: 93165
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20154285430908203  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20154285430908203  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.24596738815307617  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.24613618850708008  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20104646682739258  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5304, 1: 2542, 2: 2232, 3: 1757, 4: 1365, 5: 1227, 6: 956, 7: 803, 8: 677, 9: 654, 10: 581, 11: 522, 12: 516, 13: 426, 14: 361, 15: 343, 16: 325, 18: 319, 17: 297, 19: 290, 20: 269, 21: 267, 22: 206, 23: 195, 24: 195})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20894527435302734  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20894527435302734  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 19.94291114807129  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 19.946558475494385  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2147064208984375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 2 input nodes size: 63577
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20643949508666992  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20643949508666992  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.23675537109375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.23692893981933594  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1923356056213379  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3528, 2: 3230, 3: 2600, 4: 2081, 5: 1727, 6: 1373, 25: 1285, 7: 1149, 8: 1016, 9: 800, 10: 693, 11: 570, 12: 511, 13: 429, 14: 387, 15: 356, 16: 265, 17: 235, 18: 212, 19: 190, 20: 167, 21: 140, 22: 130, 23: 117, 24: 99})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19665002822875977  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19665002822875977  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.13202428817749  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.135625839233398  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20019292831420898  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 3 input nodes size: 49373
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1964735984802246  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1964735984802246  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2200164794921875  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.220184326171875  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18969488143920898  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3068, 2: 2743, 3: 2322, 4: 1871, 25: 1739, 5: 1566, 6: 1274, 7: 1104, 8: 919, 9: 807, 10: 724, 11: 647, 12: 519, 13: 461, 14: 416, 15: 339, 17: 320, 16: 314, 18: 254, 20: 240, 21: 208, 19: 208, 22: 149, 23: 143, 24: 140})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19402074813842773  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19402074813842773  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.73270034790039  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.736713886260986  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19708681106567383  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19708681106567383  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1640324592590332  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1330593228340149 |0.006300032138824463 |0.2612432837486267 |0.00013679265975952148 |0.613826334476471 |0.00504302978515625 |
----------------------------------------------------------pseudo_mini_loss sum 3.8650660514831543
Total (block generation + training)time/epoch 55.531602488623726
Training time/epoch 4.255929231643677
Training time without block to device /epoch 4.230729103088379
Training time without total dataloading part /epoch 3.505868673324585
load block tensor time/epoch 0.5322372913360596
block to device time/epoch 0.02520012855529785
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  496709
Number of first layer input nodes during this epoch:  298932
Number of first layer output nodes during this epoch:  197777
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15054893493652344  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.481 seconds, peak memory: 47.899 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.899 GB
Metis partitioning: 4.861 seconds, peak memory: 47.899 GB
Split the graph: 12.846 seconds
Construct subgraphs: 0.015 seconds
REG metis partition end ----................................
REG construction  time spent:  23.394733905792236
pure dgl.metis_partition the time spent:  19.231082916259766
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8340682983398438

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.463554859161377

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15054893493652344  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

connection checking time:  1.6001460552215576
block generation total time  2.2976231575012207
average batch blocks generation time:  0.5744057893753052
block dataloader generation time/epoch 50.567126107215884
pseudo mini batch 0 input nodes size: 49577
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.14729785919189453  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.14729785919189453  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17093801498413086  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17110633850097656  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.14739561080932617  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2951, 2: 2719, 3: 2327, 4: 1872, 25: 1776, 5: 1584, 6: 1325, 7: 1115, 8: 936, 9: 826, 10: 723, 11: 648, 12: 543, 13: 479, 14: 438, 15: 347, 17: 317, 16: 312, 18: 258, 20: 242, 19: 215, 21: 209, 23: 148, 22: 143, 24: 139})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1517801284790039  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1517801284790039  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.88993501663208  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.893441677093506  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18386507034301758  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 1 input nodes size: 63465
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1805739402770996  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1805739402770996  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21083641052246094  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21100950241088867  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18720102310180664  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3634, 2: 3269, 3: 2627, 4: 2068, 5: 1716, 6: 1360, 25: 1236, 7: 1134, 8: 992, 9: 802, 10: 712, 11: 558, 12: 488, 13: 416, 15: 358, 14: 357, 16: 255, 17: 231, 18: 195, 19: 176, 20: 161, 21: 130, 22: 129, 23: 107, 24: 95})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19143152236938477  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19143152236938477  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.9375638961792  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.941134929656982  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1949601173400879  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 2 input nodes size: 92928
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1912999153137207  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1912999153137207  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2356114387512207  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.23577880859375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20534324645996094  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4317, 2: 3509, 3: 2612, 4: 1961, 5: 1708, 6: 1205, 25: 1139, 7: 989, 8: 862, 9: 685, 10: 584, 11: 461, 12: 393, 13: 325, 14: 271, 15: 226, 16: 212, 18: 179, 17: 172, 19: 152, 20: 133, 21: 105, 24: 93, 22: 83, 23: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21062088012695312  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21062088012695312  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.566795825958252  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.57064151763916  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.215179443359375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 3 input nodes size: 93299
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2092142105102539  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2092142105102539  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2541360855102539  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.254305362701416  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20982646942138672  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5309, 1: 2526, 2: 2209, 3: 1711, 4: 1419, 5: 1214, 6: 978, 7: 807, 8: 682, 9: 663, 10: 580, 11: 536, 12: 513, 13: 436, 14: 368, 15: 358, 16: 332, 18: 316, 17: 310, 19: 293, 21: 273, 20: 271, 22: 201, 24: 198, 23: 192})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21774768829345703  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21774768829345703  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 20.04180097579956  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 20.046077728271484  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2233576774597168  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2233576774597168  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19030332565307617  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13052362203598022 |0.006284952163696289 |0.2628140449523926 |0.00013595819473266602 |0.6129870414733887 |0.005051374435424805 |
----------------------------------------------------------pseudo_mini_loss sum 3.7247138023376465
Total (block generation + training)time/epoch 55.12369532585144
Training time/epoch 4.254505395889282
Training time without block to device /epoch 4.229365587234497
Training time without total dataloading part /epoch 3.5087995529174805
load block tensor time/epoch 0.5220944881439209
block to device time/epoch 0.025139808654785156
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  496771
Number of first layer input nodes during this epoch:  299269
Number of first layer output nodes during this epoch:  197502
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17874383926391602  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.441 seconds, peak memory: 47.911 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.911 GB
Metis partitioning: 4.905 seconds, peak memory: 47.911 GB
Split the graph: 14.064 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  22.630221605300903
pure dgl.metis_partition the time spent:  20.456920623779297
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7773995399475098

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.2065131664276123

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17874383926391602  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

connection checking time:  1.2808420658111572
block generation total time  1.983912706375122
average batch blocks generation time:  0.4959781765937805
block dataloader generation time/epoch 50.2473569133065
pseudo mini batch 0 input nodes size: 65189
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17047548294067383  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17047548294067383  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20156002044677734  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20173311233520508  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15664196014404297  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3467, 2: 3147, 3: 2521, 4: 2047, 5: 1708, 25: 1359, 6: 1330, 7: 1175, 8: 996, 9: 828, 10: 707, 11: 565, 12: 522, 13: 439, 14: 385, 15: 373, 16: 270, 17: 251, 18: 222, 19: 190, 20: 179, 21: 140, 22: 137, 23: 111, 24: 108})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.16103649139404297  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.16103649139404297  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.288264751434326  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.29224443435669  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19190692901611328  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 1 input nodes size: 49446
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18810653686523438  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18810653686523438  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2116842269897461  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21185302734375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18059539794921875  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3157, 2: 2795, 3: 2355, 4: 1915, 25: 1693, 5: 1567, 6: 1325, 7: 1097, 8: 935, 9: 803, 10: 725, 11: 642, 12: 522, 13: 458, 14: 405, 15: 341, 17: 308, 16: 306, 18: 248, 20: 224, 21: 204, 19: 199, 23: 144, 22: 139, 24: 131})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1848759651184082  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1848759651184082  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.600928783416748  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.604907989501953  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18759393692016602  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 2 input nodes size: 93707
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18437767028808594  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18437767028808594  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22929954528808594  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22946786880493164  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20572137832641602  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4250, 2: 3580, 3: 2670, 4: 2007, 5: 1756, 6: 1242, 25: 1099, 7: 986, 8: 873, 9: 700, 10: 580, 11: 460, 12: 397, 13: 331, 14: 276, 15: 216, 16: 203, 17: 165, 18: 158, 19: 142, 20: 136, 21: 106, 24: 85, 22: 81, 23: 69})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21036624908447266  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21036624908447266  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.520895004272461  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.524462223052979  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2149038314819336  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 3 input nodes size: 92899
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20976877212524414  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20976877212524414  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.25406646728515625  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.25423479080200195  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20914459228515625  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5309, 1: 2554, 2: 2184, 3: 1731, 4: 1351, 5: 1191, 6: 971, 7: 787, 8: 668, 9: 645, 10: 587, 11: 536, 12: 496, 13: 428, 14: 368, 15: 359, 16: 332, 18: 320, 17: 306, 19: 305, 20: 268, 21: 267, 24: 201, 22: 199, 23: 195})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21703672409057617  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21703672409057617  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 19.987513542175293  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 19.991218090057373  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22295522689819336  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22295522689819336  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18990087509155273  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12994766235351562 |0.0061296820640563965 |0.2640194892883301 |0.00012940168380737305 |0.6147132515907288 |0.0048177242279052734 |
----------------------------------------------------------pseudo_mini_loss sum 4.436779975891113
Total (block generation + training)time/epoch 54.777192462574355
Training time/epoch 4.262200832366943
Training time without block to device /epoch 4.237682104110718
Training time without total dataloading part /epoch 3.52026629447937
load block tensor time/epoch 0.5197906494140625
block to device time/epoch 0.024518728256225586
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  499391
Number of first layer input nodes during this epoch:  301241
Number of first layer output nodes during this epoch:  198150
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.178314208984375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.412 seconds, peak memory: 47.911 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.911 GB
Metis partitioning: 4.797 seconds, peak memory: 47.911 GB
Split the graph: 12.815 seconds
Construct subgraphs: 0.030 seconds
REG metis partition end ----................................
REG construction  time spent:  25.335764169692993
pure dgl.metis_partition the time spent:  19.082210779190063
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7387456893920898

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.215937852859497

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.178314208984375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

connection checking time:  1.2439727783203125
block generation total time  1.954683542251587
average batch blocks generation time:  0.48867088556289673
block dataloader generation time/epoch 50.084049701690674
pseudo mini batch 0 input nodes size: 49429
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17006254196166992  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17006254196166992  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1936321258544922  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1937999725341797  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.14933395385742188  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2879, 2: 2696, 3: 2282, 4: 1868, 25: 1790, 5: 1560, 6: 1308, 7: 1104, 8: 944, 9: 836, 10: 745, 11: 671, 12: 560, 13: 483, 14: 434, 15: 358, 17: 323, 16: 318, 18: 263, 20: 239, 19: 220, 21: 211, 22: 148, 23: 148, 24: 140})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15375280380249023  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15375280380249023  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.984343528747559  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.987945556640625  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18387126922607422  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 1 input nodes size: 66147
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18054819107055664  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18054819107055664  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21208953857421875  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21226215362548828  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18852472305297852  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3587, 2: 3163, 3: 2596, 4: 2095, 5: 1747, 6: 1335, 25: 1302, 7: 1147, 8: 1017, 9: 813, 10: 682, 11: 553, 12: 489, 13: 424, 14: 367, 15: 350, 16: 252, 17: 239, 18: 193, 19: 174, 20: 165, 21: 133, 22: 130, 23: 111, 24: 99})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19281005859375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19281005859375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.030311107635498  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.033897399902344  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1960468292236328  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 2 input nodes size: 93976
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19233179092407227  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19233179092407227  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.23714303970336914  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.23731327056884766  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20559930801391602  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5238, 1: 2643, 2: 2280, 3: 1736, 4: 1397, 5: 1211, 6: 979, 7: 816, 8: 676, 9: 648, 10: 620, 11: 531, 12: 494, 13: 442, 15: 372, 14: 363, 16: 329, 18: 324, 17: 302, 19: 295, 20: 269, 21: 266, 22: 194, 23: 194, 24: 193})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21349620819091797  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21349620819091797  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 19.882123470306396  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 19.88558006286621  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21992111206054688  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 3 input nodes size: 90043
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21164989471435547  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21164989471435547  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.25458574295043945  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.25475311279296875  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20977163314819336  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4319, 2: 3567, 3: 2663, 4: 1960, 5: 1704, 6: 1246, 25: 1130, 7: 978, 8: 835, 9: 679, 10: 552, 11: 448, 12: 394, 13: 307, 14: 270, 16: 212, 15: 209, 18: 168, 17: 166, 19: 147, 20: 134, 21: 107, 24: 93, 22: 84, 23: 66})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21512317657470703  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21512317657470703  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.457767009735107  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.461111068725586  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22011375427246094  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22011375427246094  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1870594024658203  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12893986701965332 |0.00591045618057251 |0.26148200035095215 |0.00012826919555664062 |0.6116195321083069 |0.0048902034759521484 |
----------------------------------------------------------pseudo_mini_loss sum 4.230475902557373
Total (block generation + training)time/epoch 54.589560409386955
Training time/epoch 4.237546443939209
Training time without block to device /epoch 4.213904619216919
Training time without total dataloading part /epoch 3.497809410095215
load block tensor time/epoch 0.5157594680786133
block to device time/epoch 0.02364182472229004
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  496755
Number of first layer input nodes during this epoch:  299595
Number of first layer output nodes during this epoch:  197160
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1727466583251953  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.438 seconds, peak memory: 47.911 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.911 GB
Metis partitioning: 4.805 seconds, peak memory: 47.911 GB
Split the graph: 12.811 seconds
Construct subgraphs: 0.029 seconds
REG metis partition end ----................................
REG construction  time spent:  22.103532791137695
pure dgl.metis_partition the time spent:  19.111738443374634
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7808876037597656

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.222341537475586

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1727466583251953  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

connection checking time:  1.2776882648468018
block generation total time  2.0032291412353516
average batch blocks generation time:  0.5008072853088379
block dataloader generation time/epoch 49.706333087040825
pseudo mini batch 0 input nodes size: 62843
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.16666173934936523  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.16666173934936523  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19662761688232422  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19680070877075195  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15369749069213867  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3590, 2: 3251, 3: 2587, 4: 2103, 5: 1731, 6: 1346, 25: 1237, 7: 1177, 8: 995, 9: 789, 10: 698, 11: 545, 12: 507, 13: 421, 14: 376, 15: 354, 16: 260, 17: 231, 18: 203, 19: 182, 20: 160, 21: 135, 22: 125, 23: 104, 24: 101})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15791749954223633  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15791749954223633  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.91943359375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.923745155334473  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19028854370117188  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 1 input nodes size: 50749
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1866741180419922  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1866741180419922  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21087312698364258  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2110447883605957  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18090581893920898  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3140, 2: 2790, 3: 2372, 4: 1893, 25: 1803, 5: 1586, 6: 1325, 7: 1098, 8: 954, 9: 842, 10: 749, 11: 674, 12: 547, 13: 482, 14: 414, 15: 346, 17: 324, 16: 310, 18: 253, 20: 241, 19: 212, 21: 210, 23: 147, 22: 147, 24: 135})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18534612655639648  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18534612655639648  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 13.06109619140625  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 13.064892292022705  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18844079971313477  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 2 input nodes size: 91692
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18508672714233398  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18508672714233398  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22880887985229492  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22897577285766602  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2046051025390625  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5274, 1: 2587, 2: 2202, 3: 1762, 4: 1310, 5: 1171, 6: 933, 7: 771, 8: 648, 9: 646, 10: 585, 11: 528, 12: 494, 13: 414, 15: 359, 14: 352, 16: 331, 18: 316, 17: 298, 19: 290, 21: 272, 20: 260, 22: 199, 24: 194, 23: 185})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21256208419799805  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21256208419799805  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 19.75175905227661  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 19.755398750305176  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21961545944213867  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 3 input nodes size: 93681
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21059131622314453  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21059131622314453  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2552618980407715  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2554287910461426  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21153974533081055  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4111, 2: 3463, 3: 2556, 4: 2014, 5: 1734, 6: 1264, 25: 1146, 7: 999, 8: 875, 9: 699, 10: 567, 11: 456, 12: 389, 13: 339, 14: 292, 15: 230, 16: 210, 17: 177, 18: 176, 19: 152, 20: 146, 21: 100, 24: 95, 22: 85, 23: 83})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21623516082763672  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21623516082763672  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.702119827270508  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.705679416656494  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22142553329467773  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22142553329467773  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1883711814880371  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13239383697509766 |0.005921304225921631 |0.26218247413635254 |0.0001430511474609375 |0.6111420392990112 |0.004912137985229492 |
----------------------------------------------------------pseudo_mini_loss sum 4.414927005767822
Total (block generation + training)time/epoch 54.19261273970971
Training time/epoch 4.255187034606934
Training time without block to device /epoch 4.231501817703247
Training time without total dataloading part /epoch 3.4987823963165283
load block tensor time/epoch 0.5295753479003906
block to device time/epoch 0.023685216903686523
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  495912
Number of first layer input nodes during this epoch:  298965
Number of first layer output nodes during this epoch:  196947
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17412757873535156  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.479 seconds, peak memory: 47.911 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.911 GB
Metis partitioning: 4.862 seconds, peak memory: 47.911 GB
Split the graph: 13.710 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  26.894161462783813
pure dgl.metis_partition the time spent:  20.098884105682373
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7384514808654785

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.2407073974609375

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17412757873535156  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

connection checking time:  1.2696566581726074
block generation total time  1.979158878326416
average batch blocks generation time:  0.494789719581604
block dataloader generation time/epoch 49.793267829077585
pseudo mini batch 0 input nodes size: 61874
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1677417755126953  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1677417755126953  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19724559783935547  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1974186897277832  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15258121490478516  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3719, 2: 3328, 3: 2635, 4: 2059, 5: 1726, 6: 1390, 25: 1143, 7: 1135, 8: 992, 9: 780, 10: 686, 11: 543, 12: 501, 13: 400, 14: 361, 15: 331, 16: 268, 17: 226, 18: 205, 19: 178, 20: 151, 21: 127, 22: 115, 23: 105, 24: 96})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1567230224609375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1567230224609375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.609927654266357  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.613514423370361  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18995046615600586  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 1 input nodes size: 50420
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1863727569580078  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1863727569580078  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21041488647460938  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2105879783630371  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18091106414794922  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3044, 2: 2748, 3: 2375, 4: 1908, 25: 1905, 5: 1610, 6: 1322, 7: 1141, 8: 975, 9: 851, 10: 764, 11: 688, 12: 560, 13: 494, 14: 439, 15: 375, 17: 322, 16: 309, 18: 260, 20: 243, 19: 219, 21: 215, 22: 162, 24: 143, 23: 142})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18543624877929688  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18543624877929688  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 13.376049995422363  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 13.379769802093506  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18834400177001953  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 2 input nodes size: 93648
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18497991561889648  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18497991561889648  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22990179061889648  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.23006820678710938  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20585298538208008  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4099, 2: 3448, 3: 2558, 4: 2008, 5: 1716, 6: 1213, 25: 1172, 7: 968, 8: 854, 9: 697, 10: 583, 11: 468, 12: 394, 13: 350, 14: 282, 15: 223, 16: 215, 17: 185, 18: 180, 19: 158, 20: 143, 21: 120, 24: 90, 23: 86, 22: 83})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21059036254882812  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21059036254882812  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.744447231292725  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.748106002807617  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21515607833862305  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 3 input nodes size: 90970
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20964622497558594  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20964622497558594  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2530241012573242  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2531900405883789  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20810174942016602  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5240, 1: 2566, 2: 2182, 3: 1709, 4: 1345, 5: 1170, 6: 943, 7: 801, 8: 651, 9: 648, 10: 566, 11: 504, 12: 482, 13: 412, 15: 360, 14: 352, 16: 319, 18: 303, 17: 297, 19: 281, 20: 270, 21: 255, 22: 196, 24: 196, 23: 186})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21602773666381836  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21602773666381836  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 19.57811212539673  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 19.58156108856201  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2217397689819336  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2217397689819336  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18868541717529297  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13179588317871094 |0.006187915802001953 |0.2608805298805237 |0.00013238191604614258 |0.6143332719802856 |0.004962444305419922 |
----------------------------------------------------------pseudo_mini_loss sum 5.294825553894043
Total (block generation + training)time/epoch 54.263059258461
Training time/epoch 4.2551186084747314
Training time without block to device /epoch 4.230366945266724
Training time without total dataloading part /epoch 3.506347179412842
load block tensor time/epoch 0.5271835327148438
block to device time/epoch 0.024751663208007812
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  493570
Number of first layer input nodes during this epoch:  296912
Number of first layer output nodes during this epoch:  196658
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17698907852172852  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.551 seconds, peak memory: 47.911 GB
Construct multi-constraint weights: 0.001 seconds, peak memory: 47.911 GB
Metis partitioning: 5.270 seconds, peak memory: 47.911 GB
Split the graph: 13.449 seconds
Construct subgraphs: 0.031 seconds
REG metis partition end ----................................
REG construction  time spent:  27.944531202316284
pure dgl.metis_partition the time spent:  20.33239459991455
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.8310365676879883

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.3059306144714355

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17698907852172852  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

connection checking time:  1.8402132987976074
block generation total time  4.136967182159424
average batch blocks generation time:  1.034241795539856
block dataloader generation time/epoch 50.14949091275533
pseudo mini batch 0 input nodes size: 57207
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1688089370727539  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1688089370727539  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1961526870727539  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19632530212402344  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15278148651123047  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3842, 2: 3434, 3: 2696, 4: 2138, 5: 1753, 6: 1369, 7: 1118, 25: 981, 8: 953, 9: 792, 10: 653, 11: 524, 12: 461, 13: 407, 14: 334, 15: 304, 16: 233, 17: 217, 18: 200, 19: 167, 20: 134, 21: 133, 22: 116, 23: 112, 24: 92})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15669488906860352  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15669488906860352  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.130785942077637  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.135051727294922  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18695974349975586  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 1 input nodes size: 50331
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1836538314819336  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1836538314819336  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20765352249145508  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20781993865966797  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18030357360839844  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2907, 2: 2670, 3: 2321, 4: 1873, 25: 1741, 5: 1570, 6: 1312, 7: 1099, 8: 937, 9: 813, 10: 758, 11: 658, 12: 532, 13: 470, 14: 422, 15: 364, 17: 308, 16: 294, 18: 245, 20: 237, 19: 204, 21: 196, 22: 142, 24: 133, 23: 130})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18463563919067383  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18463563919067383  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.724170207977295  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.727745056152344  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1875920295715332  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 2 input nodes size: 92702
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18431711196899414  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18431711196899414  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22923898696899414  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22940969467163086  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20524358749389648  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5331, 1: 2553, 2: 2255, 3: 1755, 4: 1386, 5: 1214, 6: 985, 7: 799, 8: 676, 9: 667, 10: 607, 11: 549, 12: 519, 13: 435, 14: 377, 15: 358, 16: 336, 18: 327, 17: 312, 19: 301, 20: 276, 21: 274, 24: 206, 22: 198, 23: 190})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2132863998413086  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2132863998413086  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 20.1685528755188  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 20.171975135803223  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21968364715576172  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 3 input nodes size: 92903
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21142959594726562  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21142959594726562  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.25572919845581055  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.25589752197265625  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21080493927001953  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4126, 2: 3347, 3: 2505, 4: 1923, 5: 1685, 25: 1407, 6: 1202, 7: 1029, 8: 906, 9: 704, 10: 581, 11: 472, 12: 425, 13: 344, 14: 301, 15: 263, 16: 248, 17: 193, 18: 176, 19: 164, 20: 160, 21: 114, 22: 100, 24: 94, 23: 87})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2160496711730957  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2160496711730957  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.2181978225708  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.221608638763428  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2203984260559082  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2203984260559082  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18734407424926758  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13575971126556396 |0.009654760360717773 |0.2650699019432068 |0.00018519163131713867 |0.6142547130584717 |0.008545160293579102 |
----------------------------------------------------------pseudo_mini_loss sum 5.458538055419922
Total (block generation + training)time/epoch 54.60872629483541
Training time/epoch 4.311020612716675
Training time without block to device /epoch 4.272401571273804
Training time without total dataloading part /epoch 3.5265843868255615
load block tensor time/epoch 0.5430388450622559
block to device time/epoch 0.038619041442871094
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  488151
Number of first layer input nodes during this epoch:  293143
Number of first layer output nodes during this epoch:  195008
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17331695556640625  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.470 seconds, peak memory: 48.026 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.026 GB
Metis partitioning: 5.210 seconds, peak memory: 48.026 GB
Split the graph: 13.531 seconds
Construct subgraphs: 0.015 seconds
REG metis partition end ----................................
REG construction  time spent:  25.44778275489807
pure dgl.metis_partition the time spent:  20.26777672767639
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.246490478515625

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4254310131072998

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17331695556640625  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

connection checking time:  1.9025321006774902
block generation total time  3.671921491622925
average batch blocks generation time:  0.9179803729057312
block dataloader generation time/epoch 50.27033472061157
pseudo mini batch 0 input nodes size: 49467
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.16742229461669922  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.16742229461669922  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1910099983215332  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19118118286132812  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1467132568359375  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3068, 2: 2766, 3: 2367, 4: 1938, 25: 1793, 5: 1602, 6: 1329, 7: 1116, 8: 957, 9: 840, 10: 742, 11: 671, 12: 558, 13: 478, 14: 428, 15: 342, 16: 312, 17: 311, 18: 259, 20: 239, 19: 210, 21: 205, 23: 146, 22: 146, 24: 134})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15111446380615234  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15111446380615234  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.9647855758667  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.968215942382812  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18377685546875  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 1 input nodes size: 66320
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1804966926574707  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1804966926574707  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21212053298950195  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21229314804077148  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18853425979614258  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3457, 2: 3133, 3: 2543, 4: 2050, 5: 1712, 6: 1358, 25: 1334, 7: 1162, 8: 994, 9: 814, 10: 702, 11: 567, 12: 501, 13: 426, 14: 381, 15: 358, 16: 287, 17: 248, 18: 216, 19: 189, 20: 181, 21: 141, 22: 141, 23: 115, 24: 108})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19291400909423828  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19291400909423828  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.275745391845703  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.279255390167236  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1965656280517578  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 2 input nodes size: 91169
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1927633285522461  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1927633285522461  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2362360954284668  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2364034652709961  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2046070098876953  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4266, 2: 3578, 3: 2640, 4: 1978, 5: 1694, 6: 1256, 25: 1157, 7: 983, 8: 850, 9: 689, 10: 565, 11: 437, 12: 374, 13: 340, 14: 260, 15: 235, 16: 178, 18: 164, 17: 161, 19: 143, 20: 123, 21: 110, 24: 84, 22: 83, 23: 70})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2092151641845703  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2092151641845703  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.495786190032959  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.499578475952148  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2129192352294922  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 3 input nodes size: 92859
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20759963989257812  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20759963989257812  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2525215148925781  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.2526888847351074  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20904874801635742  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5176, 1: 2637, 2: 2229, 3: 1727, 4: 1354, 5: 1214, 6: 925, 7: 784, 8: 671, 9: 633, 10: 590, 11: 528, 12: 504, 13: 412, 14: 365, 15: 354, 16: 334, 17: 310, 18: 309, 19: 294, 20: 264, 21: 261, 24: 199, 23: 188, 22: 186})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21684694290161133  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21684694290161133  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 19.669196605682373  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 19.67279815673828  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22346067428588867  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.22346067428588867  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19040632247924805  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13889235258102417 |0.008394718170166016 |0.2685157060623169 |0.0001431107521057129 |0.6152631044387817 |0.0071811676025390625 |
----------------------------------------------------------pseudo_mini_loss sum 4.902052402496338
Total (block generation + training)time/epoch 54.72177179157734
Training time/epoch 4.333974361419678
Training time without block to device /epoch 4.300395488739014
Training time without total dataloading part /epoch 3.5428688526153564
load block tensor time/epoch 0.5555694103240967
block to device time/epoch 0.03357887268066406
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  496936
Number of first layer input nodes during this epoch:  299815
Number of first layer output nodes during this epoch:  197121
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17871856689453125  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.542 seconds, peak memory: 48.026 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.026 GB
Metis partitioning: 5.251 seconds, peak memory: 48.026 GB
Split the graph: 14.980 seconds
Construct subgraphs: 0.006 seconds
REG metis partition end ----................................
REG construction  time spent:  29.36699342727661
pure dgl.metis_partition the time spent:  21.807275533676147
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.458418369293213

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4061086177825928

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17871856689453125  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

connection checking time:  1.5818769931793213
block generation total time  2.8645269870758057
average batch blocks generation time:  0.7161317467689514
block dataloader generation time/epoch 50.63000228825737
pseudo mini batch 0 input nodes size: 60436
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17049074172973633  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.17049074172973633  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1993088722229004  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.19948053359985352  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.15439128875732422  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3544, 2: 3213, 3: 2631, 4: 2078, 5: 1718, 6: 1330, 7: 1166, 25: 1150, 8: 956, 9: 802, 10: 696, 11: 554, 12: 497, 13: 419, 14: 367, 15: 342, 16: 260, 17: 237, 18: 209, 19: 184, 20: 149, 21: 142, 22: 127, 23: 118, 24: 99})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1585063934326172  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1585063934326172  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.60325288772583  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 11.60678243637085  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18879222869873047  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 1 input nodes size: 51265
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18531370162963867  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18531370162963867  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21070432662963867  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21087265014648438  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.1818828582763672  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3276, 2: 2889, 3: 2413, 4: 1927, 5: 1589, 25: 1563, 6: 1327, 7: 1099, 8: 917, 9: 799, 10: 712, 11: 634, 12: 500, 13: 443, 14: 383, 15: 324, 17: 290, 16: 276, 18: 228, 20: 224, 19: 191, 21: 180, 24: 127, 22: 127, 23: 125})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18607473373413086  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18607473373413086  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.236599922180176  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 12.240247249603271  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18902349472045898  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

pseudo mini batch 2 input nodes size: 93057
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18578290939331055  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.18578290939331055  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.23070478439331055  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.23087692260742188  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.20531797409057617  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5395, 1: 2524, 2: 2265, 3: 1728, 4: 1391, 5: 1254, 6: 1003, 7: 822, 8: 712, 9: 664, 10: 607, 11: 551, 12: 519, 13: 442, 14: 382, 15: 362, 16: 351, 18: 333, 17: 312, 19: 302, 20: 275, 21: 267, 24: 212, 22: 202, 23: 201})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21430397033691406  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.71630859375 GB
    Memory Allocated: 0.21430397033691406  GigaBytes
Max Memory Allocated: 21.828930377960205  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.64599609375 GB
    Memory Allocated: 20.357357501983643  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.64599609375 GB
    Memory Allocated: 20.36085605621338  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.65771484375 GB
    Memory Allocated: 0.2215123176574707  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

pseudo mini batch 3 input nodes size: 91005
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.65771484375 GB
    Memory Allocated: 0.2132272720336914  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.65771484375 GB
    Memory Allocated: 0.2132272720336914  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.65771484375 GB
    Memory Allocated: 0.2566218376159668  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.65771484375 GB
    Memory Allocated: 0.2567882537841797  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.65771484375 GB
    Memory Allocated: 0.21169424057006836  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4084, 2: 3339, 3: 2505, 4: 1924, 5: 1661, 25: 1352, 6: 1208, 7: 958, 8: 887, 9: 711, 10: 584, 11: 464, 12: 421, 13: 352, 14: 302, 15: 261, 16: 224, 17: 191, 18: 178, 19: 159, 20: 159, 21: 128, 22: 100, 24: 87, 23: 75})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.65771484375 GB
    Memory Allocated: 0.2172541618347168  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.65771484375 GB
    Memory Allocated: 0.2172541618347168  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.74951171875 GB
    Memory Allocated: 11.994741439819336  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.74951171875 GB
    Memory Allocated: 11.998396396636963  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.74951171875 GB
    Memory Allocated: 0.22228384017944336  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.74951171875 GB
    Memory Allocated: 0.22228384017944336  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.74951171875 GB
    Memory Allocated: 0.18922948837280273  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.14043229818344116 |0.009834647178649902 |0.3743098974227905 |0.00014716386795043945 |0.602541446685791 |0.005326032638549805 |
----------------------------------------------------------pseudo_mini_loss sum 4.7103681564331055
Total (block generation + training)time/epoch 55.09721552624422
Training time/epoch 4.719296932220459
Training time without block to device /epoch 4.679958343505859
Training time without total dataloading part /epoch 3.9133200645446777
load block tensor time/epoch 0.5617291927337646
block to device time/epoch 0.03933858871459961
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  490687
Number of first layer input nodes during this epoch:  295763
Number of first layer output nodes during this epoch:  194924
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.74951171875 GB
    Memory Allocated: 0.17382192611694336  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.550 seconds, peak memory: 48.026 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.026 GB
Metis partitioning: 5.251 seconds, peak memory: 48.026 GB
Split the graph: 14.014 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  25.133114099502563
pure dgl.metis_partition the time spent:  20.86388611793518
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.8430912494659424

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4281904697418213

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.74951171875 GB
    Memory Allocated: 0.17382192611694336  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

connection checking time:  1.6597645282745361
block generation total time  3.2712817192077637
average batch blocks generation time:  0.8178204298019409
block dataloader generation time/epoch 50.68875291612413
pseudo mini batch 0 input nodes size: 50711
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.74951171875 GB
    Memory Allocated: 0.16639947891235352  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.74951171875 GB
    Memory Allocated: 0.16639947891235352  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.74951171875 GB
    Memory Allocated: 0.1905803680419922  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.74951171875 GB
    Memory Allocated: 0.19075250625610352  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.74951171875 GB
    Memory Allocated: 0.14719152450561523  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3135, 2: 2802, 3: 2394, 4: 1929, 25: 1747, 5: 1618, 6: 1341, 7: 1120, 8: 961, 9: 827, 10: 751, 11: 668, 12: 549, 13: 480, 14: 419, 15: 350, 17: 318, 16: 315, 18: 250, 20: 236, 19: 214, 21: 206, 23: 144, 22: 142, 24: 137})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.74951171875 GB
    Memory Allocated: 0.1515941619873047  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.74951171875 GB
    Memory Allocated: 0.1515941619873047  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 12.935090065002441  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 12.938848495483398  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1845402717590332  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

pseudo mini batch 1 input nodes size: 63407
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1812295913696289  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1812295913696289  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21146440505981445  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.2116374969482422  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1872844696044922  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3483, 2: 3195, 3: 2564, 4: 2065, 5: 1723, 6: 1346, 25: 1299, 7: 1180, 8: 1011, 9: 815, 10: 712, 11: 571, 12: 501, 13: 428, 14: 380, 15: 356, 16: 266, 17: 241, 18: 211, 19: 192, 20: 169, 21: 141, 22: 137, 23: 113, 24: 104})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1915740966796875  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1915740966796875  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 12.114444255828857  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 12.118110656738281  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.19525432586669922  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

pseudo mini batch 2 input nodes size: 92752
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1916027069091797  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1916027069091797  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.23583030700683594  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.23599720001220703  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.20558929443359375  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5260, 1: 2602, 2: 2264, 3: 1720, 4: 1339, 5: 1194, 6: 931, 7: 760, 9: 635, 8: 624, 10: 558, 11: 505, 12: 492, 13: 418, 14: 368, 15: 347, 16: 319, 18: 309, 17: 288, 19: 287, 20: 274, 21: 267, 22: 200, 24: 199, 23: 185})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21339941024780273  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21339941024780273  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 19.671337127685547  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 19.674709796905518  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21916723251342773  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

pseudo mini batch 3 input nodes size: 92107
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21093463897705078  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21093463897705078  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.254854679107666  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.2550215721130371  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21062707901000977  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4208, 2: 3445, 3: 2599, 4: 1987, 5: 1687, 6: 1250, 25: 1154, 7: 985, 8: 876, 9: 699, 10: 578, 11: 459, 12: 395, 13: 330, 14: 267, 15: 236, 16: 211, 17: 183, 18: 178, 19: 143, 20: 128, 21: 103, 24: 85, 23: 77, 22: 77})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.2152719497680664  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.2152719497680664  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 11.589239597320557  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 11.59289836883545  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21937036514282227  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21937036514282227  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.18631601333618164  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13534092903137207 |0.006468415260314941 |0.26743167638778687 |0.0001277327537536621 |0.6119882464408875 |0.0021140575408935547 |
----------------------------------------------------------pseudo_mini_loss sum 4.48069429397583
Total (block generation + training)time/epoch 55.145776457256744
Training time/epoch 4.283528566360474
Training time without block to device /epoch 4.257654905319214
Training time without total dataloading part /epoch 3.5203046798706055
load block tensor time/epoch 0.5413637161254883
block to device time/epoch 0.025873661041259766
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  495958
Number of first layer input nodes during this epoch:  298977
Number of first layer output nodes during this epoch:  196981
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.17204761505126953  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.579 seconds, peak memory: 48.026 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.026 GB
Metis partitioning: 5.170 seconds, peak memory: 48.026 GB
Split the graph: 14.296 seconds
Construct subgraphs: 0.011 seconds
REG metis partition end ----................................
REG construction  time spent:  23.985291481018066
pure dgl.metis_partition the time spent:  21.08417773246765
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8000044822692871

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.2459509372711182

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.17204761505126953  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

connection checking time:  1.2810544967651367
block generation total time  2.0459554195404053
average batch blocks generation time:  0.5114888548851013
block dataloader generation time/epoch 50.6035216733029
pseudo mini batch 0 input nodes size: 49333
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.16671991348266602  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.16671991348266602  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.19024372100830078  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.19041156768798828  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.14632463455200195  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2859, 2: 2650, 3: 2301, 25: 1830, 4: 1824, 5: 1549, 6: 1311, 7: 1117, 8: 931, 9: 842, 10: 741, 11: 668, 12: 549, 13: 488, 14: 447, 15: 347, 17: 322, 16: 313, 18: 265, 20: 246, 19: 222, 21: 211, 22: 154, 23: 148, 24: 140})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.15074491500854492  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.15074491500854492  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 13.050727367401123  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 13.054199695587158  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.18367338180541992  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

pseudo mini batch 1 input nodes size: 64636
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1803750991821289  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1803750991821289  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.2111959457397461  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21136856079101562  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.18767690658569336  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3664, 2: 3233, 3: 2584, 4: 2109, 5: 1748, 6: 1356, 25: 1219, 7: 1126, 8: 1007, 9: 790, 10: 681, 11: 555, 12: 491, 13: 423, 14: 353, 15: 353, 16: 266, 17: 228, 18: 193, 19: 172, 20: 156, 21: 132, 22: 124, 23: 102, 24: 98})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.19190597534179688  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.19190597534179688  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 11.945121765136719  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 11.94928789138794  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.19581317901611328  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

pseudo mini batch 2 input nodes size: 95901
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.19212675094604492  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.19212675094604492  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.2378559112548828  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.2380228042602539  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.2070293426513672  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4363, 2: 3561, 3: 2663, 4: 1998, 5: 1690, 6: 1232, 25: 1078, 7: 974, 8: 835, 9: 683, 10: 563, 11: 446, 12: 381, 13: 325, 14: 257, 15: 225, 16: 186, 17: 167, 18: 155, 19: 140, 20: 126, 21: 104, 24: 82, 22: 77, 23: 67})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21166753768920898  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21166753768920898  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 11.45973014831543  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 11.463816165924072  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21526861190795898  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

pseudo mini batch 3 input nodes size: 93078
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.20990705490112305  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.20990705490112305  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.25482892990112305  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.25500011444091797  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.20910406112670898  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5333, 1: 2542, 2: 2262, 3: 1729, 4: 1389, 5: 1235, 6: 969, 7: 828, 8: 699, 9: 661, 10: 614, 11: 534, 12: 516, 13: 420, 14: 377, 15: 364, 16: 346, 18: 335, 17: 313, 19: 302, 20: 279, 21: 270, 24: 205, 23: 202, 22: 201})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21896028518676758  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21896028518676758  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 20.163676738739014  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 20.167282104492188  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.2257246971130371  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.2257246971130371  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.19267034530639648  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13524502515792847 |0.006723344326019287 |0.2688855528831482 |0.00012916326522827148 |0.6100025773048401 |0.0047223567962646484 |
----------------------------------------------------------pseudo_mini_loss sum 4.689054489135742
Total (block generation + training)time/epoch 55.051590969688014
Training time/epoch 4.286642551422119
Training time without block to device /epoch 4.259749174118042
Training time without total dataloading part /epoch 3.520791530609131
load block tensor time/epoch 0.5409801006317139
block to device time/epoch 0.02689337730407715
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  502293
Number of first layer input nodes during this epoch:  302948
Number of first layer output nodes during this epoch:  199345
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.18116378784179688  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.503 seconds, peak memory: 48.026 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.026 GB
Metis partitioning: 5.143 seconds, peak memory: 48.026 GB
Split the graph: 13.172 seconds
Construct subgraphs: 0.014 seconds
REG metis partition end ----................................
REG construction  time spent:  24.888578414916992
pure dgl.metis_partition the time spent:  19.861132621765137
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.822260856628418

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3281750679016113

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.18116378784179688  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

connection checking time:  1.3903782367706299
block generation total time  2.1504359245300293
average batch blocks generation time:  0.5376089811325073
block dataloader generation time/epoch 50.52213171720505
pseudo mini batch 0 input nodes size: 91428
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.17284011840820312  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.17284011840820312  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21643638610839844  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21660280227661133  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1715097427368164  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 5236, 1: 2605, 2: 2216, 3: 1692, 4: 1289, 5: 1167, 6: 927, 7: 773, 8: 636, 9: 636, 10: 590, 11: 521, 12: 503, 13: 424, 14: 366, 15: 350, 16: 318, 18: 311, 17: 308, 19: 297, 20: 267, 21: 266, 24: 198, 22: 197, 23: 191})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1794447898864746  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1794447898864746  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 19.606753826141357  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 19.61021852493286  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21037006378173828  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

pseudo mini batch 1 input nodes size: 96271
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.20216941833496094  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.20216941833496094  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.24807500839233398  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.24824142456054688  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.20447874069213867  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4089, 2: 3419, 3: 2613, 4: 2019, 5: 1741, 6: 1215, 25: 1193, 7: 977, 8: 870, 9: 689, 10: 564, 11: 463, 12: 402, 13: 330, 14: 267, 15: 245, 16: 212, 18: 171, 17: 167, 19: 146, 20: 137, 21: 107, 24: 89, 22: 83, 23: 81})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.20925617218017578  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.20925617218017578  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 11.782026290893555  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 11.785348415374756  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.21320629119873047  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

pseudo mini batch 2 input nodes size: 50432
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.20781517028808594  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.20781517028808594  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.23186302185058594  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.23203563690185547  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.18596363067626953  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3212, 2: 2839, 3: 2441, 4: 1958, 25: 1719, 5: 1606, 6: 1373, 7: 1106, 8: 950, 9: 836, 10: 744, 11: 651, 12: 532, 13: 468, 14: 426, 15: 344, 17: 311, 16: 306, 18: 255, 20: 230, 19: 210, 21: 210, 23: 145, 22: 144, 24: 141})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1903386116027832  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81201171875 GB
    Memory Allocated: 0.1903386116027832  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 12.876710891723633  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 12.880335330963135  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 0.1938014030456543  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

pseudo mini batch 3 input nodes size: 64287
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 0.19051551818847656  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 0.19051551818847656  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 0.22116994857788086  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 0.2213430404663086  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 0.19712257385253906  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3522, 2: 3232, 3: 2531, 4: 2054, 5: 1708, 6: 1353, 25: 1312, 7: 1189, 8: 1016, 9: 815, 10: 701, 11: 568, 12: 500, 13: 434, 14: 375, 15: 350, 16: 275, 17: 244, 18: 211, 19: 183, 20: 173, 21: 134, 22: 132, 23: 102, 24: 97})

----------------------------------------after blocks to device 
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 0.20142173767089844  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 0.20142173767089844  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 12.115782260894775  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 12.119368553161621  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 0.20503616333007812  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 0.20503616333007812  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.81982421875 GB
    Memory Allocated: 0.1719818115234375  GigaBytes
Max Memory Allocated: 21.841665744781494  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13575869798660278 |0.006949722766876221 |0.2671685814857483 |0.00012814998626708984 |0.611694872379303 |0.003912687301635742 |
----------------------------------------------------------pseudo_mini_loss sum 4.633594036102295
Total (block generation + training)time/epoch 54.96293745040894
Training time/epoch 4.302487373352051
Training time without block to device /epoch 4.274688482284546
Training time without total dataloading part /epoch 3.519879102706909
load block tensor time/epoch 0.5430347919464111
block to device time/epoch 0.027798891067504883
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  500743
Number of first layer input nodes during this epoch:  302418
Number of first layer output nodes during this epoch:  198325
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=1024, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=1024, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(1024, 1024, batch_first=True)
      (fc_self): Linear(in_features=1024, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=1024, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  8872960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([1024, 128])
layers.0.fc_neigh.weight, torch.Size([1024, 128])
layers.1.lstm.weight_ih_l0, torch.Size([4096, 1024])
layers.1.lstm.weight_hh_l0, torch.Size([4096, 1024])
layers.1.lstm.bias_ih_l0, torch.Size([4096])
layers.1.lstm.bias_hh_l0, torch.Size([4096])
layers.1.fc_self.weight, torch.Size([40, 1024])
layers.1.fc_neigh.weight, torch.Size([40, 1024])
----------------------------------------
un-trainable parameters
