main start at this time 1733010502.8984807
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.41553544998168945
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.000911712646484375
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008780479431152344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4167656898498535
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.3153305053710938
self.buckets_partition() spend  sec:  0.4255647659301758
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.58935546875 GB
    Memory Allocated: 0.06853818893432617  GigaBytes
Max Memory Allocated: 0.06853818893432617  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.43505859375 GB
    Memory Allocated: 3.6764426231384277  GigaBytes
Max Memory Allocated: 3.8241305351257324  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.43505859375 GB
    Memory Allocated: 3.6766481399536133  GigaBytes
Max Memory Allocated: 3.8241305351257324  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.56396484375 GB
    Memory Allocated: 0.12995243072509766  GigaBytes
Max Memory Allocated: 3.8241305351257324  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.48779296875 GB
    Memory Allocated: 4.494480609893799  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.48779296875 GB
    Memory Allocated: 4.495452404022217  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.63623046875 GB
    Memory Allocated: 0.13169240951538086  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.77880859375 GB
    Memory Allocated: 4.319200038909912  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.77880859375 GB
    Memory Allocated: 4.320335388183594  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.77880859375 GB
    Memory Allocated: 0.13142728805541992  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.78271484375 GB
    Memory Allocated: 4.312255382537842  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.78271484375 GB
    Memory Allocated: 4.31302547454834  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.78271484375 GB
    Memory Allocated: 0.13359689712524414  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.20068359375 GB
    Memory Allocated: 4.16991662979126  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.20068359375 GB
    Memory Allocated: 4.171860694885254  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.20068359375 GB
    Memory Allocated: 0.13181018829345703  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.20263671875 GB
    Memory Allocated: 4.2253923416137695  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.20263671875 GB
    Memory Allocated: 4.226039886474609  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.20263671875 GB
    Memory Allocated: 0.13094472885131836  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.20263671875 GB
    Memory Allocated: 4.165272235870361  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.20263671875 GB
    Memory Allocated: 4.165834426879883  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.20263671875 GB
    Memory Allocated: 0.1307220458984375  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.20263671875 GB
    Memory Allocated: 4.053153991699219  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.20263671875 GB
    Memory Allocated: 4.053642272949219  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.20263671875 GB
    Memory Allocated: 0.13578176498413086  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.28076171875 GB
    Memory Allocated: 3.735111713409424  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.28076171875 GB
    Memory Allocated: 3.736900806427002  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.46044921875 GB
    Memory Allocated: 0.13264989852905273  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 3.9954400062561035  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 3.9958720207214355  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 0.13007497787475586  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 3.765603542327881  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 3.7659764289855957  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 0.13068342208862305  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 3.66123104095459  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 3.661564350128174  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 0.1304159164428711  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 3.4743080139160156  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 3.4745993614196777  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 0.12975454330444336  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 3.3249897956848145  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 3.3252482414245605  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.46240234375 GB
    Memory Allocated: 0.1351914405822754  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.07763671875 GB
    Memory Allocated: 2.812690258026123  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.07763671875 GB
    Memory Allocated: 2.8156089782714844  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 0.1330122947692871  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 3.2395200729370117  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 3.2397570610046387  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 0.1292552947998047  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 3.075015068054199  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 3.075225353240967  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 0.1295943260192871  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 3.0598745346069336  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 3.060072898864746  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 0.13018083572387695  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 2.9922733306884766  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 2.992459297180176  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 0.1296100616455078  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 2.8727316856384277  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 2.87290096282959  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 0.12955713272094727  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 2.8898072242736816  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 2.88997220993042  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 0.12943553924560547  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 2.7613391876220703  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 2.761490821838379  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.28271484375 GB
    Memory Allocated: 0.1278057098388672  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.4917140007019043  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.4918370246887207  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.11587190628051758  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.0774555206298828  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.077500343322754  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.11570596694946289  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.084958553314209  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.08500337600708  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.11621332168579102  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.089536190032959  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.08958101272583  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.11574506759643555  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.0584039688110352  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.0584487915039062  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.11681127548217773  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.0884366035461426  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.0884814262390137  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.11663341522216797  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.0697789192199707  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.0698237419128418  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.11701679229736328  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.0717196464538574  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.0717644691467285  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.11700439453125  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.0748958587646484  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.0749406814575195  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.11655759811401367  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.0445318222045898  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.0445747375488281  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14970874786376953  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7765064239501953
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.25591206550598145
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0005831718444824219
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007077217102050781
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.2567300796508789
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.0642929077148438
self.buckets_partition() spend  sec:  0.26383066177368164
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1507859230041504  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.756626605987549  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.756645679473877  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19536590576171875  GigaBytes
Max Memory Allocated: 4.691610336303711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.556125640869141  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.557097434997559  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1971726417541504  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.379790782928467  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.380926132202148  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19652175903320312  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.359811782836914  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.360581874847412  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1993570327758789  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.243135929107666  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.244563102722168  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19762468338012695  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.294950485229492  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.295598030090332  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19659900665283203  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.240635395050049  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.24119758605957  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1964116096496582  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.133305072784424  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.133793354034424  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20140600204467773  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.795823097229004  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.797612190246582  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19854497909545898  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.049450397491455  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.049882411956787  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19578075408935547  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8364481925964355  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.8368210792541504  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19645166397094727  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7557549476623535  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7560882568359375  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19602537155151367  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.553316116333008  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.55360746383667  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19532537460327148  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.398306369781494  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.3985648155212402  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20095109939575195  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.887576103210449  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.8902316093444824  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19835615158081055  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.306678295135498  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.306915283203125  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19463729858398438  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1336398124694824  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.13385009765625  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19545793533325195  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.127638816833496  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1278371810913086  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19485759735107422  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.0494861602783203  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.0496721267700195  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19505548477172852  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.933034896850586  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.933204174041748  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1952352523803711  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.95843505859375  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.9586000442504883  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19516754150390625  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.8352274894714355  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.835379123687744  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1937093734741211  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.5736517906188965  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.573774814605713  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18137598037719727  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.133798599243164  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.1338434219360352  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1815624237060547  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.1435465812683105  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.1435914039611816  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18148136138916016  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.132103443145752  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.132148265838623  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1818094253540039  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.137336254119873  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.1373810768127441  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18169450759887695  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.1318254470825195  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.1318702697753906  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18236494064331055  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.1364679336547852  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.1365127563476562  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18241453170776367  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.1349234580993652  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.1349682807922363  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1824650764465332  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.1499543190002441  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.1499991416931152  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.18227005004882812  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.1148672103881836  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 1.1149101257324219  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.14982271194458008  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.1907992362976074
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.44420695304870605
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0007901191711425781
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008017778396606445
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.445220947265625
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.2626993656158447
self.buckets_partition() spend  sec:  0.4532620906829834
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.15113067626953125  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.759965419769287  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.759984016418457  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19535112380981445  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.554905891418457  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.555877685546875  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19721603393554688  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.384556770324707  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.386022090911865  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19641399383544922  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.381464004516602  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.3822340965271  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19932889938354492  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.229132652282715  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.230597972869873  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1973705291748047  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.304193496704102  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.304841041564941  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19680118560791016  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.24616813659668  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.246730327606201  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19607257843017578  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.124526500701904  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.125014781951904  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.2014307975769043  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7961106300354004  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.7978997230529785  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1983346939086914  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.0503363609313965  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 4.0507683753967285  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1960921287536621  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.837888717651367  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.838261604309082  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19638776779174805  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.752958297729492  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.753291606903076  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19600772857666016  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.531169891357422  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.531461238861084  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19536447525024414  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.3959908485412598  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.396249294281006  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.20084095001220703  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.880167007446289  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.882753849029541  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19829082489013672  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.3089957237243652  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.309232711791992  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19483470916748047  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1369824409484863  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.137192726135254  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19530725479125977  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.128978729248047  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.1291770935058594  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19507837295532227  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.0562610626220703  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 3.0564470291137695  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.1950540542602539  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.933462619781494  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.9336318969726562  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19511985778808594  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.96345853805542  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.963623523712158  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19483232498168945  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.826493740081787  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 2.8266453742980957  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34326171875 GB
    Memory Allocated: 0.19368362426757812  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.572889804840088  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.5730128288269043  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1811223030090332  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1329035758972168  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.132948398590088  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18146371841430664  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1355619430541992  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1356067657470703  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18146657943725586  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1346216201782227  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1346664428710938  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1819305419921875  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1505236625671387  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1505684852600098  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18197965621948242  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1457533836364746  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1457982063293457  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1819157600402832  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.132568359375  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.132613182067871  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18364286422729492  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1421265602111816  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1421713829040527  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18250036239624023  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.147592544555664  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1476373672485352  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18253660202026367  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1157660484313965  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1158089637756348  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.15009403228759766  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.60361385345459
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.45081043243408203
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0007808208465576172
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.00797128677368164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.451831579208374
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.2528200149536133
self.buckets_partition() spend  sec:  0.45982789993286133
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.15060186386108398  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7396621704101562  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.739680767059326  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1952195167541504  GigaBytes
Max Memory Allocated: 4.75288724899292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.565330982208252  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.56630277633667  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19722938537597656  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.383544921875  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.384680271148682  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19758987426757812  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.369051456451416  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.369821548461914  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1991591453552246  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.234001636505127  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.235466957092285  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19764423370361328  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.3030314445495605  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.3036789894104  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19660425186157227  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.234644412994385  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.235206604003906  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1960439682006836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.119070529937744  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.119558811187744  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20136404037475586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.80881404876709  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.810603141784668  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1987767219543457  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.054783821105957  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.055215835571289  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19593191146850586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8373379707336426  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8377108573913574  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19617605209350586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.731086254119873  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.731419563293457  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1960163116455078  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.5374584197998047  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.537749767303467  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1952500343322754  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3884029388427734  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3886613845825195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20110559463500977  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.885305881500244  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8877267837524414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19811105728149414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.306337356567383  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3065743446350098  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1945638656616211  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.132082939147949  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.132293224334717  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19503164291381836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1026363372802734  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.102834701538086  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19478607177734375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.039670467376709  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.039856433868408  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19544267654418945  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.946608066558838  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.94677734375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19519519805908203  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.961851119995117  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.9620161056518555  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19513368606567383  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.820010185241699  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.820161819458008  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19376182556152344  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.5692739486694336  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.56939697265625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18111419677734375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1429615020751953  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1430063247680664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18134450912475586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1495203971862793  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1495652198791504  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18179941177368164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.150968074798584  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.151012897491455  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18175077438354492  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1351079940795898  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.135152816772461  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1820816993713379  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1383094787597656  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1383543014526367  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18204879760742188  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1450152397155762  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1450600624084473  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18233537673950195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1483821868896484  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1484270095825195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18252944946289062  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1510815620422363  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1511263847351074  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18229389190673828  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1146764755249023  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1147193908691406  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.14985132217407227  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0821638107299805
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.4508645534515381
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0008590221405029297
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.00785207748413086
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4519655704498291
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.2353675365447998
self.buckets_partition() spend  sec:  0.45984435081481934
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.15063953399658203  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7452096939086914  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7452282905578613  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19544267654418945  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.5557427406311035  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.5567145347595215  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1969318389892578  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.376696586608887  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.377866268157959  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19648313522338867  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.37774133682251  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.378511428833008  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19934940338134766  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.2340617179870605  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.2359724044799805  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1975717544555664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.306570529937744  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.307218074798584  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19676733016967773  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.241079330444336  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.241641521453857  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1960749626159668  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.119894504547119  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.120382785797119  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.2014904022216797  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8008341789245605  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8026232719421387  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19830942153930664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.054554462432861  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.054986476898193  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19608354568481445  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8370628356933594  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.837435722351074  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19623804092407227  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.757293224334717  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.757626533508301  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19601917266845703  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.5441813468933105  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.5444726943969727  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19517898559570312  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3895130157470703  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3897714614868164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20110750198364258  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.886935234069824  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.889575481414795  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19838333129882812  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.322953224182129  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.323190212249756  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1948709487915039  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1398720741271973  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.140082359313965  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1953568458557129  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.128413677215576  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1286120414733887  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19504642486572266  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.055349349975586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.055535316467285  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19527053833007812  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.94073486328125  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.940904140472412  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19541549682617188  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.965837001800537  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.9660019874572754  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19524049758911133  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.834190845489502  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8343424797058105  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19337749481201172  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.557499885559082  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.5576229095458984  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18097782135009766  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1351099014282227  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1351547241210938  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18147516250610352  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1325006484985352  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1325454711914062  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18171977996826172  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1335058212280273  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1335506439208984  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18159723281860352  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1456904411315918  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.145735263824463  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1832571029663086  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1461296081542969  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.146174430847168  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18226146697998047  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1392426490783691  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1392874717712402  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.182525634765625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1491484642028809  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.149193286895752  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18268251419067383  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1485710144042969  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.148615837097168  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1826481819152832  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1129980087280273  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1130409240722656  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1502084732055664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.067197561264038
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.2725036144256592
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0008027553558349609
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009942054748535156
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.27357983589172363
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.184166669845581
self.buckets_partition() spend  sec:  0.28354620933532715
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.15070486068725586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7441864013671875  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7442049980163574  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1954936981201172  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.555164813995361  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.556136608123779  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1972355842590332  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.3824944496154785  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.383959770202637  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19663095474243164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.376344203948975  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.377114295959473  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1993556022644043  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.2387614250183105  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.240455150604248  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19751834869384766  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.295873165130615  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.296520709991455  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19663286209106445  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.232921123504639  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.23348331451416  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19621706008911133  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.115715503692627  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.116203784942627  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20135498046875  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.799306869506836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.801095962524414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1983809471130371  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.0624895095825195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.062921524047852  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19605398178100586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.837216377258301  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8375892639160156  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1963181495666504  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7319207191467285  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7322540283203125  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1960139274597168  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.5370121002197266  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.5373034477233887  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19518804550170898  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3941731452941895  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3944315910339355  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20093774795532227  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8791112899780273  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8818297386169434  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1984243392944336  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3156142234802246  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3158512115478516  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1947784423828125  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1370596885681152  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.137269973754883  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1952838897705078  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.128396511077881  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1285948753356934  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19513368606567383  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.0610861778259277  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.061272144317627  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19504404067993164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.936859130859375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.937028408050537  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19528675079345703  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.9615697860717773  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.9617347717285156  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1947650909423828  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8270678520202637  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8272194862365723  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19348764419555664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.5582804679870605  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.558403491973877  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18127202987670898  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1461610794067383  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1462059020996094  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18155336380004883  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1470327377319336  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1470775604248047  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18174266815185547  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1330413818359375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1330862045288086  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1817483901977539  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.135432243347168  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.135477066040039  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1822504997253418  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1503467559814453  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1503915786743164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18242406845092773  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1380038261413574  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1380486488342285  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18228721618652344  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1463508605957031  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1463956832885742  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18244123458862305  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1434211730957031  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1434659957885742  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18220233917236328  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1129875183105469  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1130304336547852  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.14975404739379883  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.06543231010437
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.44267916679382324
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0006096363067626953
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007599353790283203
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4435114860534668
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.2768580913543701
self.buckets_partition() spend  sec:  0.45113325119018555
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.15080833435058594  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.757619857788086  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.757638931274414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1951594352722168  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.555323123931885  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.556294918060303  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19736576080322266  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.389082908630371  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.390218257904053  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1968684196472168  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.381027698516846  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.381797790527344  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19934654235839844  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.243168354034424  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.244595527648926  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1975078582763672  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.293731689453125  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.294379234313965  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19653749465942383  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.237462997436523  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.238025188446045  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19618558883666992  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.118772029876709  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.119260311126709  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20143795013427734  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8132362365722656  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8150253295898438  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1987752914428711  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.06207799911499  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.062510013580322  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19585275650024414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8335189819335938  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8338918685913086  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19649028778076172  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7319889068603516  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7323222160339355  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19601774215698242  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.5403008460998535  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.5405921936035156  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19542598724365234  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.4088029861450195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.4090614318847656  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20106172561645508  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8874197006225586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.889939785003662  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19821596145629883  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3092246055603027  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3094615936279297  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1948695182800293  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1366682052612305  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.136878490447998  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19522714614868164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.127209186553955  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1274075508117676  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19497108459472656  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.0531177520751953  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.0533037185668945  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1951909065246582  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.937547206878662  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.937716484069824  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19520330429077148  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.962495803833008  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.962660789489746  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19490671157836914  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.833977699279785  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8341293334960938  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19364261627197266  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.5631766319274902  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.5632996559143066  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1813831329345703  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1472864151000977  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1473312377929688  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18167543411254883  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.14976167678833  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1498064994812012  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18184804916381836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1493830680847168  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.149427890777588  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18180513381958008  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1366982460021973  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1367430686950684  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18181276321411133  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1412982940673828  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.141343116760254  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18227100372314453  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1506843566894531  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1507291793823242  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18247509002685547  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1329083442687988  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.13295316696167  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1824359893798828  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1440110206604004  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1440558433532715  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18224716186523438  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1117229461669922  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1117658615112305  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.14979791641235352  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0276875495910645
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.44506239891052246
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0006589889526367188
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.00696873664855957
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4459519386291504
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.235612154006958
self.buckets_partition() spend  sec:  0.45294904708862305
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.15082693099975586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.751244068145752  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.75126314163208  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19537115097045898  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.5554304122924805  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.556402206420898  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19712400436401367  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.381111145019531  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.3825764656066895  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1962871551513672  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.365133285522461  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.365903377532959  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.199462890625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.239808082580566  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.241554260253906  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19753503799438477  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.296054840087891  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.2967023849487305  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1965489387512207  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.2386579513549805  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.239220142364502  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19643402099609375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.12315034866333  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.12363862991333  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20165586471557617  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.814629077911377  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.816418170928955  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19847965240478516  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.053609371185303  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.054041385650635  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.195892333984375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8336291313171387  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8340020179748535  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19634103775024414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7558465003967285  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7561798095703125  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19602108001708984  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.542165756225586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.542457103729248  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19510364532470703  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.387200355529785  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3874588012695312  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20104074478149414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8818798065185547  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.884582996368408  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19840383529663086  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3096323013305664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3098692893981934  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19482040405273438  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1396307945251465  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.139841079711914  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19539356231689453  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1299381256103516  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.130136489868164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19501352310180664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.053373336791992  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.0535593032836914  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1951918601989746  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.9410901069641113  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.9412593841552734  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19523286819458008  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.96303129196167  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.963196277618408  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19510698318481445  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.834092140197754  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8342437744140625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19345903396606445  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.563488006591797  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.5636110305786133  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1813950538635254  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.148533821105957  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1485786437988281  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18159770965576172  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1432161331176758  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1432609558105469  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18163394927978516  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.146864414215088  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.146909236907959  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18203020095825195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1532106399536133  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1532554626464844  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18173599243164062  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1336770057678223  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1337218284606934  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18210601806640625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1350722312927246  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1351170539855957  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18258047103881836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.149303913116455  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1493487358093262  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18291187286376953  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.143589973449707  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1436347961425781  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18249273300170898  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1174850463867188  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.117527961730957  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1500539779663086  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9582881927490234
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.26543116569519043
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0006268024444580078
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008106231689453125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.2662773132324219
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.1516578197479248
self.buckets_partition() spend  sec:  0.27440547943115234
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1507587432861328  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.749715805053711  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7497339248657227  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19543933868408203  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.5572404861450195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.5582122802734375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19719743728637695  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.382452964782715  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.383918285369873  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1964716911315918  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.361489295959473  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.362259387969971  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19927072525024414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.234180927276611  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.2356462478637695  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19738006591796875  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.2911810874938965  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.291828632354736  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1966414451599121  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.2391676902771  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.239729881286621  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1963481903076172  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.129001140594482  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.129489421844482  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20144271850585938  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.81278657913208  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.815007209777832  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19874143600463867  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.055544853210449  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.055976867675781  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19577312469482422  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8280086517333984  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8283815383911133  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.196319580078125  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7332520484924316  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7335853576660156  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1960139274597168  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.5395898818969727  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.5398812294006348  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19517278671264648  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3919458389282227  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3922042846679688  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20092344284057617  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8877906799316406  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.890566349029541  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19847440719604492  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.306730270385742  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.306967258453369  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19475412368774414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.134377956390381  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1345882415771484  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19518613815307617  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.123709201812744  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1239075660705566  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19505786895751953  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.0529866218566895  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.0531725883483887  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19508695602416992  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.9176440238952637  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.917813301086426  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19529199600219727  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.973296642303467  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.973461627960205  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1953892707824707  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8351197242736816  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8352713584899902  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19339847564697266  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.5566515922546387  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.556774616241455  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18156099319458008  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.139127254486084  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.139172077178955  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18138837814331055  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.150937557220459  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.15098237991333  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18140125274658203  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1284174919128418  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.128462314605713  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1816110610961914  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1465401649475098  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1465849876403809  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1818981170654297  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1472973823547363  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1473422050476074  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18220233917236328  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.135716438293457  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1357612609863281  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1821451187133789  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.148979663848877  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.149024486541748  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1826162338256836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1376891136169434  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1377339363098145  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18260860443115234  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1154403686523438  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.115483283996582  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.15016889572143555  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8668739795684814
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.38590145111083984
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0006072521209716797
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0076062679290771484
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3867306709289551
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.2700679302215576
self.buckets_partition() spend  sec:  0.3943603038787842
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1507859230041504  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.742558002471924  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7425765991210938  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1955857276916504  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.563992500305176  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.564964294433594  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1971588134765625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.38373327255249  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.385198593139648  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1963486671447754  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.362370491027832  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.36314058303833  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19938421249389648  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.238709449768066  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.240329265594482  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19744014739990234  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.2970871925354  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.29773473739624  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1966686248779297  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.232088565826416  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.2326507568359375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19645357131958008  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.127775192260742  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.128263473510742  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20138978958129883  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.806945323944092  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.80873441696167  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19875669479370117  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.0593342781066895  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.0597662925720215  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19597768783569336  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8362655639648438  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8366384506225586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1962413787841797  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.729802131652832  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.730135440826416  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19602060317993164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.5417680740356445  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.5420594215393066  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19539928436279297  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3946380615234375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3948965072631836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20106840133666992  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8816113471984863  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.884140968322754  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19822216033935547  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3032026290893555  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3034396171569824  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1949167251586914  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.138765335083008  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1389756202697754  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19531583786010742  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.101492404937744  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1016907691955566  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19501066207885742  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.052023410797119  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.0522093772888184  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19534587860107422  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.942685604095459  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.942854881286621  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19527673721313477  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.9603214263916016  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.96048641204834  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1947612762451172  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.827195167541504  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8273468017578125  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19353055953979492  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.573192596435547  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.5733156204223633  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18114709854125977  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1313190460205078  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.131363868713379  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18143939971923828  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1469364166259766  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1469812393188477  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1815500259399414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1470880508422852  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1471328735351562  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18195629119873047  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.136385440826416  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.136430263519287  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18190431594848633  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.139256477355957  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1393013000488281  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18246793746948242  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1376471519470215  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1376919746398926  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.18238496780395508  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1509552001953125  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1510000228881836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1826310157775879  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1481175422668457  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1481623649597168  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1822371482849121  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.1125903129577637  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 1.112633228302002  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.14978408813476562  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7662200927734375
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.38922929763793945
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0008933544158935547
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008100748062133789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.39036059379577637
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.2852799892425537
self.buckets_partition() spend  sec:  0.39850282669067383
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.15086078643798828  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.750901699066162  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7509207725524902  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19531965255737305  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.556848526000977  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.5578203201293945  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1968832015991211  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.379002094268799  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.3801374435424805  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19644403457641602  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.367766857147217  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.368536949157715  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19921636581420898  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.2345051765441895  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.236039638519287  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1973133087158203  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.293491840362549  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.294139385223389  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1965475082397461  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.236358642578125  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.2369208335876465  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19639825820922852  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.121753215789795  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.122241497039795  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20128679275512695  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.797880172729492  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7997751235961914  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19826936721801758  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.053046703338623  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 4.053478717803955  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19578981399536133  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8370137214660645  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.8373866081237793  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.1963496208190918  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7546119689941406  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.7549452781677246  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19601917266845703  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.5420494079589844  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.5423407554626465  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19519424438476562  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.389540195465088  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.389798641204834  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.20103073120117188  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.887777328491211  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.890333652496338  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19824934005737305  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3143887519836426  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.3146257400512695  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19484710693359375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.13446044921875  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1346707344055176  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19533491134643555  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1245017051696777  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.1247000694274902  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19511032104492188  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.060667037963867  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 3.0608530044555664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19506168365478516  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.9388537406921387  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.939023017883301  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19510316848754883  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.9626479148864746  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.962812900543213  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19481468200683594  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8328733444213867  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 2.8330249786376953  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.34912109375 GB
    Memory Allocated: 0.19357967376708984  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.5592355728149414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.559358596801758  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18107938766479492  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.13193941116333  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1319842338562012  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18170928955078125  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.140174388885498  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1402192115783691  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18287372589111328  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1530189514160156  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1530637741088867  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18213510513305664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1422338485717773  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1422786712646484  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18219280242919922  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.141754150390625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.141798973083496  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18201780319213867  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.148453712463379  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.14849853515625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1823725700378418  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1326241493225098  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1326689720153809  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18258190155029297  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1471047401428223  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1471495628356934  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1823887825012207  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1156506538391113  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1156935691833496  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.14994049072265625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6707961559295654
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.2662777900695801
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0006899833679199219
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008505821228027344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.2672297954559326
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.153940200805664
self.buckets_partition() spend  sec:  0.2757599353790283
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1508173942565918  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7508039474487305  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7508225440979004  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1954503059387207  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.558506011962891  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.559477806091309  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19700002670288086  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.377532005310059  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.378997325897217  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19668912887573242  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.412124156951904  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.412894248962402  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19924116134643555  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.23989725112915  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.241324424743652  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19746112823486328  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.294081211090088  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.294728755950928  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1966543197631836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.246364593505859  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.246926784515381  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19617223739624023  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.12069034576416  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.12117862701416  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.20131731033325195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.8127026557922363  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.8144917488098145  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1981058120727539  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.053445816040039  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.053877830505371  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19571399688720703  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.827148914337158  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.827521800994873  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19634437561035156  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.730233669281006  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.73056697845459  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19602012634277344  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.5417284965515137  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.542019844055176  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19512653350830078  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.388162136077881  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.388420581817627  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.20107698440551758  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.886233329772949  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.888671398162842  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1981501579284668  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.309539318084717  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.3097763061523438  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19470882415771484  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1353883743286133  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.135598659515381  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.195037841796875  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1251916885375977  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.12539005279541  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19495248794555664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.0551280975341797  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.055314064025879  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1950383186340332  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.912285804748535  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9124550819396973  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19512414932250977  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9602694511413574  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9604344367980957  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19509315490722656  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.834214210510254  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8343658447265625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19376707077026367  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.5682363510131836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.568359375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18147706985473633  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.13645601272583  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1365008354187012  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18149852752685547  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1503114700317383  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1503562927246094  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18168115615844727  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1405572891235352  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1406021118164062  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18223237991333008  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1620454788208008  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1620903015136719  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18209075927734375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.137528896331787  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1375737190246582  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1822643280029297  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1462979316711426  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1463427543640137  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1821460723876953  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1349406242370605  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1349854469299316  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18264293670654297  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1294336318969727  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1294784545898438  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18259096145629883  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1169195175170898  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1169624328613281  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.15014362335205078  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6043617725372314
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.4456298351287842
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0006394386291503906
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008271455764770508
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4465219974517822
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.3317596912384033
self.buckets_partition() spend  sec:  0.4548187255859375
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.15119647979736328  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7625298500061035  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7625484466552734  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1954503059387207  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.563051700592041  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.564023494720459  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19688892364501953  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.381593227386475  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.382728576660156  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1968674659729004  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.365567207336426  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.366337299346924  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19925498962402344  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.235629558563232  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.237452030181885  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19742441177368164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.291639804840088  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.292287349700928  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19669294357299805  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.239887714385986  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.240449905395508  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19639253616333008  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.126682758331299  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.127171039581299  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.2012925148010254  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.798490524291992  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.8002796173095703  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19829893112182617  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.0540008544921875  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.0544328689575195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1961050033569336  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.840446949005127  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.840819835662842  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1963496208190918  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.72660493850708  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.726938247680664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19601917266845703  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.5418529510498047  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.542144298553467  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19536209106445312  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.396670341491699  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.3969287872314453  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.20110225677490234  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8881397247314453  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8907666206359863  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19832468032836914  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.315387725830078  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.315624713897705  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1947321891784668  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1376242637634277  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1378345489501953  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19538545608520508  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1253371238708496  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.125535488128662  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19490480422973633  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.04945707321167  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.049643039703369  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1953287124633789  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9412407875061035  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9414100646972656  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19539642333984375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9628381729125977  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.963003158569336  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19517135620117188  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.836925983428955  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8370776176452637  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19357824325561523  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.5629868507385254  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.563109874725342  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18112611770629883  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1378655433654785  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1379103660583496  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1816272735595703  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1449198722839355  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1449646949768066  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18179655075073242  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.152078628540039  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1521234512329102  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1818833351135254  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.148780345916748  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1488251686096191  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1821279525756836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1501026153564453  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1501474380493164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1820979118347168  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1348233222961426  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1348681449890137  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18240022659301758  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1468496322631836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1468944549560547  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1825699806213379  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1386685371398926  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1387133598327637  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18230772018432617  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.111680507659912  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1117234230041504  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1498546600341797  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.556713581085205
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.4463651180267334
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0006582736968994141
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009693384170532227
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.44732141494750977
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.3278088569641113
self.buckets_partition() spend  sec:  0.4570446014404297
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1507563591003418  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.754131317138672  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.754150390625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19530439376831055  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.557318210601807  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.558290004730225  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1970510482788086  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.385472297668457  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.386937618255615  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19643831253051758  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.365859031677246  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.366629123687744  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19936084747314453  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.241634845733643  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.2433881759643555  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19746971130371094  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.294959545135498  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.295607089996338  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19673824310302734  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.236850738525391  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.237412929534912  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1962904930114746  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.129663467407227  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.130151748657227  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.2014017105102539  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7961831092834473  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7979722023010254  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1984853744506836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.055516242980957  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.055948257446289  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19605588912963867  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.8363089561462402  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.836681842803955  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19618701934814453  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.72885799407959  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.729191303253174  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19602298736572266  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.5548043251037598  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.555095672607422  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1953296661376953  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.3993124961853027  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.399570941925049  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.20093059539794922  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8885388374328613  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.891362190246582  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1985306739807129  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.3101272583007812  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.310364246368408  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19485139846801758  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1364598274230957  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1366701126098633  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19510364532470703  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1023640632629395  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.102562427520752  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1949787139892578  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.055148124694824  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.0553340911865234  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19516229629516602  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9383316040039062  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9385008811950684  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1949172019958496  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.95277738571167  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.952942371368408  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19498443603515625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.828695297241211  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8288469314575195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19371891021728516  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.562612533569336  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.5627355575561523  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18137216567993164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1304817199707031  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1305265426635742  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18117380142211914  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1307482719421387  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1307930946350098  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18168973922729492  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1487517356872559  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.148796558380127  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1815185546875  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.14332914352417  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.143373966217041  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18227910995483398  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1380653381347656  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1381101608276367  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1823892593383789  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1368317604064941  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1368765830993652  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18245697021484375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1403322219848633  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1403770446777344  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18256711959838867  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1394543647766113  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1394991874694824  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18282222747802734  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.117441177368164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1174840927124023  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1503739356994629  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.472072124481201
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.26711320877075195
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0006947517395019531
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009879112243652344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.26812100410461426
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.1665997505187988
self.buckets_partition() spend  sec:  0.2780277729034424
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1506485939025879  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7402596473693848  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7402782440185547  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19559001922607422  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.560610771179199  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.561582565307617  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19699907302856445  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.3838090896606445  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.385274410247803  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19671916961669922  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.380059719085693  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.380829811096191  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19919586181640625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.239056587219238  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.2405219078063965  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19759321212768555  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.305171966552734  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.305819511413574  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19657564163208008  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.234652519226074  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.235214710235596  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19633769989013672  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.132462978363037  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.132951259613037  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.20151185989379883  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.792067527770996  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.79388427734375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1983475685119629  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.055725574493408  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.05615758895874  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19609880447387695  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.8358712196350098  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.8362441062927246  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1964588165283203  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7559022903442383  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7562355995178223  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1960129737854004  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.535177230834961  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.535468578338623  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19517898559570312  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.393420696258545  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.393679141998291  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.20100784301757812  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8877172470092773  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.89021635055542  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19818687438964844  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.296989917755127  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.297226905822754  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19478845596313477  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1390790939331055  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.139289379119873  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19521808624267578  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1236205101013184  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.123818874359131  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19501113891601562  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.0539636611938477  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.054149627685547  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1948862075805664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.91383695602417  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.914006233215332  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1953730583190918  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.962376594543457  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9625415802001953  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19507741928100586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.837303638458252  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8374552726745605  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19376134872436523  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.5651044845581055  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.565227508544922  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18256664276123047  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1557621955871582  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1558070182800293  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1813058853149414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.146224021911621  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1462688446044922  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18163585662841797  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1403517723083496  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1403965950012207  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18195438385009766  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.14890718460083  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1489520072937012  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18326091766357422  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.155423641204834  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.155468463897705  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18233013153076172  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1507973670959473  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1508421897888184  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1822805404663086  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.147028923034668  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.147073745727539  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18256616592407227  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1480612754821777  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1481060981750488  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1820216178894043  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1079497337341309  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1079926490783691  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.14956188201904297  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3958823680877686
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.4419879913330078
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0005991458892822266
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009167909622192383
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4428713321685791
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.338306188583374
self.buckets_partition() spend  sec:  0.45215582847595215
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.15073728561401367  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7475452423095703  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7475643157958984  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19550657272338867  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.557616233825684  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.558588027954102  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1968669891357422  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.378242492675781  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.3797078132629395  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19663524627685547  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.41285514831543  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.413625240325928  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1992478370666504  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.225681781768799  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.227678298950195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19727325439453125  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.295400142669678  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.296047687530518  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1967630386352539  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.239393711090088  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.239955902099609  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1960434913635254  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.11324405670166  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.11373233795166  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.20145654678344727  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.804004669189453  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.8057937622070312  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.198974609375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.057021617889404  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.057453632354736  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1960582733154297  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.835498809814453  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.835871696472168  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1963181495666504  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7290611267089844  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7293944358825684  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1960139274597168  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.5365219116210938  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.536813259124756  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19499874114990234  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.3847298622131348  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.384988307952881  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.2008509635925293  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8819661140441895  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8845338821411133  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19827795028686523  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.318371295928955  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.318608283996582  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19490337371826172  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1366963386535645  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.136906623840332  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19523906707763672  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1263322830200195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.126530647277832  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19497013092041016  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.0551915168762207  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.05537748336792  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19520235061645508  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.941871166229248  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.94204044342041  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19512033462524414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.954206943511963  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.954371929168701  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19517278671264648  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.831447124481201  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8315987586975098  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19407033920288086  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.58433198928833  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.5844550132751465  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1810293197631836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.128833293914795  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.128878116607666  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18157339096069336  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.149634838104248  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1496796607971191  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1817188262939453  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1409235000610352  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1409683227539062  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1821441650390625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1523170471191406  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1523618698120117  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18208885192871094  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1355838775634766  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1356287002563477  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1821765899658203  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1363587379455566  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1364035606384277  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1825423240661621  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.134291172027588  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.134335994720459  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18281793594360352  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1390910148620605  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1391358375549316  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18232107162475586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1133008003234863  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1133437156677246  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.149871826171875  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.319631814956665
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.4125666618347168
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0008919239044189453
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009229183197021484
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4137537479400635
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.1995627880096436
self.buckets_partition() spend  sec:  0.42301464080810547
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.15091276168823242  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7503609657287598  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.750380039215088  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19526100158691406  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.55549430847168  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.556466102600098  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1971263885498047  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.384615898132324  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.386081218719482  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1965341567993164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.355442523956299  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.356212615966797  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19909048080444336  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.220545768737793  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.222640037536621  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1973886489868164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.302545070648193  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.303192615509033  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1967310905456543  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.242481708526611  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.243043899536133  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1963357925415039  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.127400875091553  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.127889156341553  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.20135259628295898  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.810798168182373  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.8129196166992188  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1988239288330078  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.059567451477051  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.059999465942383  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1961050033569336  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.8385729789733887  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.8389458656311035  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19643735885620117  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7328104972839355  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7331438064575195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19602251052856445  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.546849250793457  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.547140598297119  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19513273239135742  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.3900399208068848  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.390298366546631  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.2012619972229004  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8888049125671387  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8914871215820312  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19796276092529297  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.3187994956970215  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.3190364837646484  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19475364685058594  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.135077476501465  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1352877616882324  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19513750076293945  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1265835762023926  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.126781940460205  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19474267959594727  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.0389676094055176  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.039153575897217  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19526100158691406  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.940458297729492  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9406275749206543  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1952357292175293  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9579310417175293  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9580960273742676  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19533681869506836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8401365280151367  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8402881622314453  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19347095489501953  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.5638742446899414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.563997268676758  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1811695098876953  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1331830024719238  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.133227825164795  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18127822875976562  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1320734024047852  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1321182250976562  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18161535263061523  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.133244514465332  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1332893371582031  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1817946434020996  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.146982192993164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1470270156860352  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18326234817504883  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1552786827087402  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1553235054016113  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18209123611450195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1311044692993164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1311492919921875  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18240118026733398  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1353473663330078  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.135392189025879  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1826152801513672  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1492424011230469  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.149287223815918  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18252229690551758  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1161198616027832  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1161627769470215  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.15007305145263672  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2468655109405518
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.27312493324279785
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0008640289306640625
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008640050888061523
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.27425432205200195
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.088667869567871
self.buckets_partition() spend  sec:  0.2829172611236572
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.15075349807739258  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7475881576538086  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7476067543029785  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19539403915405273  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.555895805358887  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.556867599487305  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19717168807983398  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.390635967254639  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.39177131652832  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19712066650390625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.404480457305908  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.405250549316406  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1993694305419922  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.2363433837890625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.238163471221924  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1973252296447754  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.294284820556641  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.2949323654174805  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1962428092956543  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.227638244628906  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.228200435638428  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19642019271850586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.123023986816406  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.123512268066406  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.20122051239013672  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.79355525970459  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.795358657836914  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19811534881591797  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.047919750213623  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.048351764678955  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19606590270996094  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.8389029502868652  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.83927583694458  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19654035568237305  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.764458656311035  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.764791965484619  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19601011276245117  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.531872272491455  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.532163619995117  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1951737403869629  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.3969616889953613  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.3972201347351074  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.2011852264404297  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.890390396118164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8929715156555176  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19828224182128906  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.308579921722412  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.308816909790039  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19488763809204102  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1362080574035645  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.136418342590332  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19532346725463867  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1276307106018066  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.127829074859619  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19499778747558594  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.0539255142211914  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.0541114807128906  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19524383544921875  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9400219917297363  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9401912689208984  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19527196884155273  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9741339683532715  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9742989540100098  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19527482986450195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.834238052368164  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8343896865844727  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19370365142822266  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.563594341278076  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.5637173652648926  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18145370483398438  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1480484008789062  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1480932235717773  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1816420555114746  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1371798515319824  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1372246742248535  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18166446685791016  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.148585319519043  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.148630142211914  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18181753158569336  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1358599662780762  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1359047889709473  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1819911003112793  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1372151374816895  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1372599601745605  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18214702606201172  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1373519897460938  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1373968124389648  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18266057968139648  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.145308494567871  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1453533172607422  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18263959884643555  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1476860046386719  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.147730827331543  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18253421783447266  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1177754402160645  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1178183555603027  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.15008974075317383  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.1947896480560303
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.45407724380493164
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0009067058563232422
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007998228073120117
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4552421569824219
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.3443100452423096
self.buckets_partition() spend  sec:  0.46326661109924316
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.15077495574951172  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7478437423706055  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7478623390197754  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19540023803710938  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.563747882843018  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.5647196769714355  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19696617126464844  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.379351615905762  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.380486965179443  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19633054733276367  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.366364479064941  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.3671345710754395  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19934940338134766  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.237059116363525  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.23876953125  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1975545883178711  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.29783296585083  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.29848051071167  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1966872215270996  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.2430315017700195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.243593692779541  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19628286361694336  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.128942012786865  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.129430294036865  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.20142459869384766  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.809650421142578  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.8114395141601562  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19832515716552734  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.0589470863342285  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.0593791007995605  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19559431076049805  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.829601287841797  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.8299741744995117  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1963028907775879  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7582240104675293  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7585573196411133  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19600725173950195  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.534562587738037  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.534853935241699  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19516324996948242  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.389341354370117  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.3895998001098633  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.2009754180908203  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8809618949890137  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.883758544921875  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1984877586364746  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.310880661010742  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.311117649078369  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19475603103637695  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.134942054748535  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1351523399353027  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19529342651367188  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1255106925964355  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.125709056854248  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19474315643310547  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.0544753074645996  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.054661273956299  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1951298713684082  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9376511573791504  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9378204345703125  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19507646560668945  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.958519458770752  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9586844444274902  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19500398635864258  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8371572494506836  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.837308883666992  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1936182975769043  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.567357063293457  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.5674800872802734  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18141937255859375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1517391204833984  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1517839431762695  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18132925033569336  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1391386985778809  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.139183521270752  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18150854110717773  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1275534629821777  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1275982856750488  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18175315856933594  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.137819766998291  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.137864589691162  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18199539184570312  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1397638320922852  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1398086547851562  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1821274757385254  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.146636962890625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.146681785583496  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18210744857788086  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1462178230285645  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1462626457214355  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1828761100769043  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1527318954467773  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1527767181396484  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18258333206176758  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1170401573181152  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1170830726623535  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.15014266967773438  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.1444969177246094
the output layer 
self.num_batch (get_in_degree_bucketing) 32
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
G_BUCKET_ID_list [[22, 21], [4], [3], [5], [2], [6], [7], [8], [1], [9], [10], [11], [12], [13], [0], [14], [15], [16], [17], [18], [19], [20], [23]]
Groups_mem_list  [[1148, 1144], [1966], [1929], [1921], [1901], [1881], [1853], [1805], [1785], [1779], [1685], [1683], [1591], [1544], [1514], [1508], [1418], [1415], [1370], [1351], [1326], [1281], [1159], [1159]]
G_BUCKET_ID_list length 23
backpack scheduling spend time (sec) 0.4091320037841797
len(g_bucket_nids_list)  23
len(local_split_batches_nid_list)  32
current group_mem  2.2931425386058164
current group_mem  1.9669195038203218
current group_mem  1.9297789253393096
current group_mem  1.921985481395105
current group_mem  1.901324981675421
current group_mem  1.881197258937281
current group_mem  1.8538925018013557
current group_mem  1.805831173882189
current group_mem  1.785964615099556
current group_mem  1.7793247420813727
current group_mem  1.6850354397066607
current group_mem  1.6838659180332751
current group_mem  1.591327720061368
current group_mem  1.5443436002578126
current group_mem  1.514777095089809
current group_mem  1.5083810439923644
current group_mem  1.4188459722252713
current group_mem  1.4156729754798756
current group_mem  1.3708978947265238
current group_mem  1.3511124559792935
current group_mem  1.3267450699133723
current group_mem  1.2810063667065785
current group_mem  1.1592614167928696
batches output list generation spend  0.0007827281951904297
self.weights_list  [0.015075708426342354, 0.0716728428321659, 0.08374660494166547, 0.05678406879185406, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.13197567653753534, 0.03183382632695924, 0.027479354746483983, 0.024554381412124345, 0.021464465972443673, 0.019023322813692393, 0.15091103022838984, 0.017428882462255747, 0.015471569479112832, 0.014580882110379258, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.009027831231237836, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009615421295166016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.41015625
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  1.3077008724212646
self.buckets_partition() spend  sec:  0.4197986125946045
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.15084314346313477  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7533483505249023  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7533669471740723  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1952672004699707  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.554202079772949  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.555173873901367  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19722366333007812  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.382650375366211  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.383785724639893  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1969447135925293  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.367258071899414  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.368028163909912  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19937944412231445  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.236006259918213  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.237642765045166  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1974630355834961  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.291405200958252  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.292052745819092  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1967005729675293  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.243492126464844  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.244054317474365  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1962580680847168  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.127029895782471  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.127518177032471  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.20132160186767578  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.793612003326416  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.795401096343994  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19838380813598633  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.053312301635742  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 4.053744316101074  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19585943222045898  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.836650848388672  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.8370237350463867  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19609355926513672  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7238049507141113  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.7241382598876953  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1960153579711914  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.5388693809509277  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.53916072845459  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19531488418579102  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.3915414810180664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.3917999267578125  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.20090246200561523  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8855223655700684  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8880252838134766  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19820356369018555  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.309450626373291  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.309687614440918  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19453859329223633  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.133479595184326  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1336898803710938  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19512271881103516  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.125159740447998  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.1253581047058105  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19536542892456055  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.062943458557129  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 3.063129425048828  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19507932662963867  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9398813247680664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9400506019592285  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.195281982421875  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9643125534057617  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.9644775390625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1951589584350586  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8335213661193848  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.8336730003356934  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.19345426559448242  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.562222957611084  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 2.5623459815979004  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18126916885375977  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1308884620666504  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1309332847595215  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18149948120117188  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.136913776397705  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1369585990905762  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18149757385253906  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1355600357055664  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1356048583984375  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18191051483154297  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1408042907714844  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1408491134643555  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18216705322265625  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1503515243530273  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1503963470458984  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18243122100830078  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.140465259552002  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.140510082244873  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.18228673934936523  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1509509086608887  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1509957313537598  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1827235221862793  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1461124420166016  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1461572647094727  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.1822652816772461  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.112210750579834  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 1.1122536659240723  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 0.14981794357299805  GigaBytes
Max Memory Allocated: 4.761394500732422  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.083765983581543
epoch_time_list  [8.506531715393066, 7.176235675811768, 7.416281700134277, 7.314777135848999, 7.401763200759888, 7.241343021392822, 7.346624135971069, 7.34669041633606, 7.126983642578125, 7.222487688064575, 7.375901222229004, 7.171585559844971, 7.378490924835205, 7.460954189300537, 7.254607677459717, 7.596772193908691, 7.5111329555511475, 7.261163234710693, 7.526210308074951, 7.578796148300171]

loading_time list   [0.023749589920043945, 0.06175518035888672, 0.03665804862976074, 0.03722786903381348, 0.03498220443725586, 0.04446840286254883, 0.021640300750732422, 0.03822517395019531, 0.02267742156982422, 0.02288365364074707, 0.023308515548706055, 0.028422117233276367, 0.03928780555725098, 0.03505754470825195, 0.03975176811218262, 0.04353523254394531, 0.03983950614929199, 0.024714231491088867, 0.04943084716796875, 0.046614646911621094]

 data loader gen time  [2.2573952674865723, 2.0178604125976562, 2.2846226692199707, 2.1874847412109375, 2.3008177280426025, 2.183701753616333, 2.3455543518066406, 2.2426259517669678, 2.0531628131866455, 2.146287202835083, 2.277670383453369, 2.0750396251678467, 2.2651026248931885, 2.316345691680908, 2.14985990524292, 2.454688549041748, 2.2869198322296143, 2.0901644229888916, 2.37066650390625, 2.3955039978027344]
	---backpack schedule time  [1.3296866416931152, 1.0777313709259033, 1.2744615077972412, 1.2676236629486084, 1.2469537258148193, 1.1983342170715332, 1.2858788967132568, 1.249246597290039, 1.1611731052398682, 1.27919340133667, 1.2963109016418457, 1.165579080581665, 1.3446757793426514, 1.3414618968963623, 1.1799235343933105, 1.3510708808898926, 1.2107570171356201, 1.09928297996521, 1.3583412170410156, 1.3189995288848877]
	---connection_check_time_list  [0.49530696868896484, 0.5337822437286377, 0.5373034477233887, 0.5252664089202881, 0.59855055809021, 0.5804612636566162, 0.5893285274505615, 0.5869028568267822, 0.5297961235046387, 0.5169327259063721, 0.5457239151000977, 0.54046630859375, 0.5272421836853027, 0.5315001010894775, 0.5307037830352783, 0.5954771041870117, 0.5941770076751709, 0.5779745578765869, 0.5861108303070068, 0.5499215126037598]
	---block_gen_time_list  [0.3729715347290039, 0.3485994338989258, 0.4157564640045166, 0.3371407985687256, 0.39727354049682617, 0.34340381622314453, 0.40894436836242676, 0.3486940860748291, 0.30222034454345703, 0.2898292541503906, 0.37166547775268555, 0.30660438537597656, 0.32912778854370117, 0.37934398651123047, 0.374497652053833, 0.44506072998046875, 0.42252469062805176, 0.3515777587890625, 0.36823415756225586, 0.46374011039733887]
training time  [6.22538161277771, 5.0888097286224365, 5.084797143936157, 5.079827070236206, 5.055448532104492, 5.002541542053223, 4.969315052032471, 5.055577754974365, 5.04004430770874, 5.042888879776001, 5.063081741333008, 5.05789852142334, 5.063515901565552, 5.098970174789429, 5.054035902023315, 5.0885009765625, 5.173193693161011, 5.135302782058716, 5.095388412475586, 5.126015663146973]
---feature block loading time  [2.361039638519287, 2.7493131160736084, 2.758392095565796, 2.691459894180298, 2.612598180770874, 2.7136518955230713, 2.681640386581421, 2.323557138442993, 2.294766426086426, 2.2253034114837646, 2.4496512413024902, 2.39589786529541, 2.230088710784912, 2.457406520843506, 2.766928195953369, 2.5441863536834717, 2.5458412170410156, 2.6396446228027344, 2.645707845687866, 2.6300222873687744]


epoch_time avg   7.362594157457352
loading_time avg   0.03467746078968048
 data loader gen time avg 2.247131958603859
	---backpack schedule time avg 1.2554489225149155
	---connection_check_time avg  0.5613293349742889
	---block_gen_time avg  0.3689213842153549
training time  5.070107489824295
---feature block loading time  2.5098057687282562
pure train time per /epoch  [3.841982841491699, 2.291114568710327, 2.28062105178833, 2.3425989151000977, 2.397982120513916, 2.2394180297851562, 2.243795156478882, 2.698509693145752, 2.7063567638397217, 2.783773422241211, 2.569766044616699, 2.6226162910461426, 2.7928531169891357, 2.586822986602783, 2.237377405166626, 2.5063388347625732, 2.5829155445098877, 2.4609389305114746, 2.405921697616577, 2.452082395553589]
pure train time average  2.507651020498837
