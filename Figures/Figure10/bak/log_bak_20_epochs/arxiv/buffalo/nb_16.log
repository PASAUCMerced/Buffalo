main start at this time 1733010357.9608636
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.4201817512512207
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0007536411285400391
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.00840139389038086
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4211997985839844
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.8784880638122559
self.buckets_partition() spend  sec:  0.42962098121643066
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.62451171875 GB
    Memory Allocated: 0.08566522598266602  GigaBytes
Max Memory Allocated: 0.08566522598266602  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.92919921875 GB
    Memory Allocated: 6.7520623207092285  GigaBytes
Max Memory Allocated: 7.032785415649414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.92919921875 GB
    Memory Allocated: 6.752882957458496  GigaBytes
Max Memory Allocated: 7.032785415649414  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.17724609375 GB
    Memory Allocated: 0.13635730743408203  GigaBytes
Max Memory Allocated: 7.032785415649414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.06005859375 GB
    Memory Allocated: 6.80317497253418  GigaBytes
Max Memory Allocated: 7.085336685180664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.06005859375 GB
    Memory Allocated: 6.803954124450684  GigaBytes
Max Memory Allocated: 7.085336685180664  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.30224609375 GB
    Memory Allocated: 0.14557552337646484  GigaBytes
Max Memory Allocated: 7.085336685180664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.71240234375 GB
    Memory Allocated: 6.540607929229736  GigaBytes
Max Memory Allocated: 7.085336685180664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.71240234375 GB
    Memory Allocated: 6.543300628662109  GigaBytes
Max Memory Allocated: 7.085336685180664  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.71240234375 GB
    Memory Allocated: 0.14594268798828125  GigaBytes
Max Memory Allocated: 7.085336685180664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.26708984375 GB
    Memory Allocated: 6.959083557128906  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.26708984375 GB
    Memory Allocated: 6.960376739501953  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.51123046875 GB
    Memory Allocated: 0.14020681381225586  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.54248046875 GB
    Memory Allocated: 6.69244384765625  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.54248046875 GB
    Memory Allocated: 6.693149566650391  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.54248046875 GB
    Memory Allocated: 0.14710569381713867  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.54248046875 GB
    Memory Allocated: 6.760313510894775  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.54248046875 GB
    Memory Allocated: 6.761683464050293  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.54248046875 GB
    Memory Allocated: 0.1505107879638672  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.72216796875 GB
    Memory Allocated: 6.48009729385376  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.72216796875 GB
    Memory Allocated: 6.482207298278809  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.94287109375 GB
    Memory Allocated: 0.14899826049804688  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.94287109375 GB
    Memory Allocated: 6.7124552726745605  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.94287109375 GB
    Memory Allocated: 6.7134108543396  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.94287109375 GB
    Memory Allocated: 0.15322303771972656  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.94287109375 GB
    Memory Allocated: 6.548402786254883  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.94287109375 GB
    Memory Allocated: 6.5501580238342285  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.94287109375 GB
    Memory Allocated: 0.14703130722045898  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.97216796875 GB
    Memory Allocated: 6.267350673675537  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.97216796875 GB
    Memory Allocated: 6.267947196960449  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.97216796875 GB
    Memory Allocated: 0.13880205154418945  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.97216796875 GB
    Memory Allocated: 4.818027496337891  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.97216796875 GB
    Memory Allocated: 4.818301677703857  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.97216796875 GB
    Memory Allocated: 0.13785696029663086  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.97216796875 GB
    Memory Allocated: 4.45659875869751  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.97216796875 GB
    Memory Allocated: 4.456847667694092  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.97216796875 GB
    Memory Allocated: 0.12426614761352539  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.97216796875 GB
    Memory Allocated: 1.9455609321594238  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.97216796875 GB
    Memory Allocated: 1.9456496238708496  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.97216796875 GB
    Memory Allocated: 0.12447881698608398  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.98388671875 GB
    Memory Allocated: 1.9437756538391113  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.98388671875 GB
    Memory Allocated: 1.943864345550537  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.98388671875 GB
    Memory Allocated: 0.12486791610717773  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 1.9508719444274902  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 1.950960636138916  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.12398195266723633  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 1.92189359664917  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 1.921980857849121  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.15819311141967773  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.776094436645508
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.4157836437225342
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0003762245178222656
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007578849792480469
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.41634035110473633
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.868645191192627
self.buckets_partition() spend  sec:  0.4239475727081299
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.16873693466186523  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.818402290344238  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.81884765625  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.20309925079345703  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.871153831481934  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.8719329833984375  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.21242332458496094  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.615069389343262  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.617762088775635  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.21166467666625977  GigaBytes
Max Memory Allocated: 7.2644877433776855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 7.036223411560059  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 7.0377960205078125  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.20698785781860352  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.7583231925964355  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.759028911590576  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.21388006210327148  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.879105091094971  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.880529403686523  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.21735572814941406  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.558493137359619  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.560545921325684  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.21572017669677734  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.775198936462402  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.776154518127441  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.2200489044189453  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.627457618713379  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.62936544418335  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.21358299255371094  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.299135684967041  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 6.299732208251953  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.2048192024230957  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 4.8820037841796875  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 4.882277965545654  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.20400047302246094  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 4.524781703948975  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 4.525030612945557  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.1903705596923828  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 2.019300937652588  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 2.0193896293640137  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.19058990478515625  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 2.0100607872009277  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 2.0101494789123535  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 0.19097566604614258  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 2.0185303688049316  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 2.0186190605163574  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.19020652770996094  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 1.9923014640808105  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 1.9923887252807617  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.15831470489501953  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.191363573074341
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.3954315185546875
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0004456043243408203
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0079498291015625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3960542678833008
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.8529477119445801
self.buckets_partition() spend  sec:  0.40402913093566895
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.16873693466186523  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.828945636749268  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.829391002655029  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.20309877395629883  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.873658180236816  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.87443733215332  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.21242284774780273  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.61311674118042  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.615809440612793  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.2115955352783203  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 7.031972408294678  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 7.033264636993408  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.20698213577270508  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.761809349060059  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.762515068054199  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.21388006210327148  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.883204936981201  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.884670257568359  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.21735334396362305  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.550660610198975  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.552820205688477  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.21577882766723633  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.8076701164245605  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.8086256980896  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.22004938125610352  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.631474018096924  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.633376121520996  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.2137923240661621  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.3303327560424805  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 6.330929279327393  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.20469236373901367  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 4.877020359039307  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 4.877294540405273  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.20388174057006836  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 4.522663593292236  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 4.522912502288818  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.19037485122680664  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 2.019415855407715  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 2.0195045471191406  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.19059371948242188  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 2.007197380065918  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 2.0072860717773438  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99560546875 GB
    Memory Allocated: 0.19097518920898438  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.020987033843994  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.02107572555542  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19018888473510742  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9867262840270996  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9868135452270508  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.15829706192016602  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.606537103652954
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.26139140129089355
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0004062652587890625
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007415056228637695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.2619755268096924
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7275238037109375
self.buckets_partition() spend  sec:  0.26941728591918945
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873693466186523  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.810483455657959  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.810928821563721  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20310306549072266  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.879694938659668  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.880474090576172  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21242284774780273  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.612596035003662  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.615288734436035  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21157598495483398  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.027344226837158  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.028599739074707  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2069711685180664  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.766676425933838  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.7673821449279785  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21387910842895508  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.887238025665283  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.888703346252441  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21735477447509766  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.555875778198242  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.55797815322876  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21576881408691406  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.776384353637695  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.777339935302734  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2188582420349121  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.606921672821045  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.608829498291016  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21378564834594727  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.311374187469482  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.3119707107543945  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20480871200561523  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.884679794311523  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.88495397567749  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20395374298095703  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.521439552307129  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.521688461303711  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19037914276123047  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0141043663024902  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.014193058013916  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19058656692504883  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.014512062072754  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0146007537841797  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.18992376327514648  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.008718967437744  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.00880765914917  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1901535987854004  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9902071952819824  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9902944564819336  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1582655906677246  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.081979513168335
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.4343695640563965
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.00040650367736816406
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0076580047607421875
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4349710941314697
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.89223313331604
self.buckets_partition() spend  sec:  0.44265270233154297
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873693466186523  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.829411506652832  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.829856872558594  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2030930519104004  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.859747409820557  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8605265617370605  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21242046356201172  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.6114091873168945  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.614101886749268  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21267223358154297  GigaBytes
Max Memory Allocated: 7.341617584228516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.039507865905762  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.040766716003418  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2070145606994629  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.7715301513671875  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.772235870361328  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21387958526611328  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.877532482147217  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.878913879394531  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21735286712646484  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.55211067199707  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.554968357086182  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21578025817871094  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.784153461456299  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.785109043121338  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2200465202331543  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.622092247009277  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.624000072479248  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21381855010986328  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.33245325088501  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.333049774169922  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20507049560546875  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.892177581787109  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.892451763153076  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20386457443237305  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.517808437347412  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.518057346343994  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19036531448364258  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.013394355773926  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0134830474853516  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1905989646911621  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0164594650268555  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0165481567382812  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19097137451171875  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0114426612854004  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.011531352996826  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19134807586669922  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9928321838378906  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9929194450378418  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.15946197509765625  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.066061019897461
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.42295050621032715
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0003941059112548828
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007615566253662109
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.42351818084716797
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.883359432220459
self.buckets_partition() spend  sec:  0.43115854263305664
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873741149902344  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.826973915100098  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.827418804168701  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20310211181640625  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.875912189483643  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8766913414001465  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2124195098876953  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.605716228485107  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.6084089279174805  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2116374969482422  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.0320234298706055  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.0333170890808105  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2069840431213379  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.7592878341674805  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.759993553161621  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21387958526611328  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8933281898498535  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.894885063171387  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2173480987548828  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.544343948364258  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.54642915725708  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21575307846069336  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.779116153717041  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.78007173538208  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21898221969604492  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.625324726104736  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.6272430419921875  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21379899978637695  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.33151388168335  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.332110404968262  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20476627349853516  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.888375759124756  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.888649940490723  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2038588523864746  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.517875671386719  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.518124580383301  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1903691291809082  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0119199752807617  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0120086669921875  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1905961036682129  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0173888206481934  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.017477512359619  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19097566604614258  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0171923637390137  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0172810554504395  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.18989086151123047  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9843063354492188  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.98439359664917  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1579904556274414  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0661823749542236
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.39725565910339355
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0004291534423828125
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007390499114990234
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3978698253631592
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.854407548904419
self.buckets_partition() spend  sec:  0.40528345108032227
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873645782470703  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.814527988433838  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.814973831176758  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20310354232788086  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8863372802734375  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.887116432189941  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21242189407348633  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.606517314910889  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.609210014343262  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21153879165649414  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.01885461807251  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.0202226638793945  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20699691772460938  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.761325359344482  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.762031078338623  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21388006210327148  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.879766464233398  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8811421394348145  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21735668182373047  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.560323715209961  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.562483310699463  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21577978134155273  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.782320022583008  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.783275604248047  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2189640998840332  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.629251480102539  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.631147861480713  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2136850357055664  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.328711986541748  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.32930850982666  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20476531982421875  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.8872294425964355  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.887503623962402  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2040386199951172  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.519551753997803  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.519800662994385  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19038057327270508  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.014883518218994  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.01497220993042  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1905975341796875  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0174641609191895  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0175528526306152  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19097232818603516  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0158329010009766  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0159215927124023  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.18991756439208984  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9837450981140137  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9838323593139648  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.15801620483398438  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0288326740264893
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.3805251121520996
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0004284381866455078
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007524728775024414
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.38111162185668945
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.8383758068084717
self.buckets_partition() spend  sec:  0.3886594772338867
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873645782470703  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.820190906524658  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.820636749267578  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20308876037597656  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.850903034210205  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.851682186126709  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21242046356201172  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.610019207000732  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.6127119064331055  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21267271041870117  GigaBytes
Max Memory Allocated: 7.3449249267578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.04860258102417  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.049948692321777  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20701169967651367  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.774898529052734  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.775604248046875  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21388006210327148  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.852667808532715  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8540520668029785  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21735048294067383  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.549647808074951  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.551704406738281  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21571636199951172  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.7758026123046875  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.776758193969727  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.22004318237304688  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.6164069175720215  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.618314743041992  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21363115310668945  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.302640438079834  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.303236961364746  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20493793487548828  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.88690710067749  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.887181282043457  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2038407325744629  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.517848968505859  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.518097877502441  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19037485122680664  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.013700485229492  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.013789176940918  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.18959283828735352  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.004427909851074  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0045166015625  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19097232818603516  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0130200386047363  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.013108730316162  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19135093688964844  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.003641128540039  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0037283897399902  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1594715118408203  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9589529037475586
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.26134610176086426
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.00041365623474121094
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0072383880615234375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.2619168758392334
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7224199771881104
self.buckets_partition() spend  sec:  0.26917600631713867
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873788833618164  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8291192054748535  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.829563617706299  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20383119583129883  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.875424861907959  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.876204013824463  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21315479278564453  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.613414764404297  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.61610746383667  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21233844757080078  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.033144950866699  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.034752368927002  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2077183723449707  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.757546901702881  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.7582526206970215  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21461200714111328  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.882122039794922  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.88358736038208  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21808290481567383  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.54448127746582  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.546635150909424  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2165069580078125  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.782171249389648  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.7831268310546875  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2207779884338379  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.627491474151611  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.6292619705200195  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21452808380126953  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.311751842498779  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.312348365783691  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20575428009033203  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.896599292755127  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.896873474121094  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2048020362854004  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.52462911605835  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.524878025054932  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19000768661499023  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.002504825592041  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.002593517303467  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1913304328918457  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0146350860595703  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.014723777770996  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.190673828125  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0112876892089844  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.01137638092041  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1920781135559082  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9999594688415527  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.000046730041504  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.15945959091186523  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.869016408920288
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.43520665168762207
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0006108283996582031
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007942676544189453
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4360356330871582
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.8921656608581543
self.buckets_partition() spend  sec:  0.4440004825592041
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873741149902344  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.830996990203857  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.831441879272461  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2030935287475586  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.856742858886719  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.857522010803223  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21242237091064453  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.612256050109863  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.614948749542236  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21267318725585938  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.040788173675537  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.042270660400391  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2070779800415039  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.759484767913818  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.760190486907959  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21388006210327148  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8538899421691895  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.855446815490723  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21735668182373047  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.557027816772461  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.55913782119751  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21573925018310547  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.772789001464844  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.773744583129883  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.22004461288452148  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.613945484161377  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.615853309631348  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21359586715698242  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.30712890625  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.307725429534912  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20464277267456055  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.872020721435547  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.872294902801514  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20373916625976562  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.520684242248535  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.520933151245117  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1893939971923828  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0069289207458496  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0070176124572754  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1905956268310547  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.015636444091797  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0157251358032227  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19097375869750977  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.014462471008301  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0145511627197266  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19014787673950195  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.985522747039795  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.985610008239746  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.15824651718139648  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.767040729522705
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.38091015815734863
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0004162788391113281
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007632017135620117
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.38149142265319824
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.837805986404419
self.buckets_partition() spend  sec:  0.3891456127166748
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873693466186523  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.823627471923828  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.82407283782959  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2030963897705078  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.862505912780762  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.863285064697266  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2124195098876953  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.612185001373291  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.614877700805664  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21267271041870117  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.0433220863342285  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.044691562652588  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.207000732421875  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.759628772735596  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.760334491729736  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21387958526611328  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8916239738464355  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.893180847167969  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2173466682434082  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.541672706604004  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.543797969818115  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2157878875732422  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.779170036315918  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.780125617980957  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.22004461288452148  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.623581409454346  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.6253767013549805  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21376848220825195  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.332115650177002  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.332712173461914  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20457220077514648  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.885335445404053  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.8856096267700195  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2038884162902832  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.518966197967529  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.519215106964111  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19038105010986328  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.020847797393799  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0209364891052246  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19059467315673828  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0148983001708984  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.014986991882324  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1909785270690918  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.009995937347412  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.010084629058838  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1902623176574707  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9896349906921387  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9897222518920898  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.15836572647094727  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6712591648101807
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.3827087879180908
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0004298686981201172
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.00777888298034668
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3832969665527344
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.8325800895690918
self.buckets_partition() spend  sec:  0.3910989761352539
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873693466186523  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.833254814147949  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.833700180053711  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2030963897705078  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.868392467498779  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.869171619415283  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2124166488647461  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.601153373718262  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.603846073150635  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21267318725585938  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.0398993492126465  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.041162490844727  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20697879791259766  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.754226207733154  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.754931926727295  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21388006210327148  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.855269908905029  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8567352294921875  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21735286712646484  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.551882266998291  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.554001808166504  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21577739715576172  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.777799129486084  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.778754711151123  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2189483642578125  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.617531776428223  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.619386672973633  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21348333358764648  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.305212020874023  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.3058085441589355  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20467519760131836  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.882559299468994  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.882833480834961  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20397710800170898  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.5206804275512695  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.520929336547852  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1903820037841797  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.017366886138916  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.017455577850342  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19060468673706055  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0226826667785645  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0227713584899902  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.18975305557250977  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.002408981323242  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.002497673034668  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19032812118530273  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9925174713134766  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9926047325134277  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.15842485427856445  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6051759719848633
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.26143407821655273
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0003876686096191406
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007349491119384766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.26204681396484375
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7108259201049805
self.buckets_partition() spend  sec:  0.26941704750061035
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873931884765625  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.841589450836182  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.842034816741943  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20309734344482422  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.869198322296143  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8699774742126465  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2124161720275879  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.601298809051514  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.603991508483887  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21267318725585938  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.03520393371582  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.036579132080078  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20699739456176758  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.757888317108154  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.758594036102295  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21387958526611328  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.880063533782959  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.881458282470703  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21735572814941406  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.5590691566467285  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.561179161071777  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2157740592956543  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.789447784423828  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.790403366088867  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21902990341186523  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.615818500518799  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.617822170257568  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21383380889892578  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.32930850982666  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.329905033111572  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20495223999023438  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.888175010681152  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.888449192047119  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2038288116455078  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.514177322387695  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.514426231384277  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19037199020385742  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.009772777557373  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.009861469268799  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1905989646911621  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.013298511505127  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0133872032165527  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1909775733947754  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0176634788513184  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.017752170562744  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1901097297668457  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9843153953552246  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9844026565551758  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1582016944885254  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5568108558654785
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.2622654438018799
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0004513263702392578
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008085966110229492
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.2629232406616211
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7115681171417236
self.buckets_partition() spend  sec:  0.27105116844177246
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873645782470703  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.84135103225708  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.841796875  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2030963897705078  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.862673282623291  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.863452434539795  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2124190330505371  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.608459949493408  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.611152648925781  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21154117584228516  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.031671524047852  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.03294563293457  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20698833465576172  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.765664100646973  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.766369819641113  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2138805389404297  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.895331382751465  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.896888256072998  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21735620498657227  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.555963516235352  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.558085918426514  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21577930450439453  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.7788848876953125  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.779840469360352  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2189311981201172  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.60739278793335  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.60930061340332  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21378278732299805  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.305994033813477  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.306590557098389  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20453834533691406  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.87042236328125  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.870696544647217  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2039017677307129  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.520205497741699  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.520454406738281  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19037389755249023  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.010406970977783  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.010495662689209  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19059038162231445  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.009589672088623  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.009678363800049  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19097089767456055  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.00956392288208  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.009652614593506  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19031524658203125  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9967737197875977  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9968609809875488  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.15842151641845703  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4722232818603516
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.43749189376831055
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0005347728729248047
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007863283157348633
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4382169246673584
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.8902993202209473
self.buckets_partition() spend  sec:  0.4461028575897217
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873741149902344  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.826652526855469  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.827097415924072  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2030949592590332  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.863596439361572  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.864375591278076  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21242189407348633  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.6035380363464355  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.606230735778809  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21161270141601562  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.031889915466309  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.033180236816406  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2069716453552246  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.755585670471191  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.756291389465332  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21387958526611328  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8879218101501465  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.889280319213867  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2173457145690918  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.550654411315918  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.553512096405029  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2158970832824707  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.772739887237549  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.773695468902588  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2200460433959961  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.625059127807617  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.62673807144165  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21340084075927734  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.299032688140869  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.299629211425781  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2048797607421875  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.886529922485352  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.886804103851318  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20419740676879883  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.523255825042725  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.523504734039307  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19037246704101562  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0044121742248535  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0045008659362793  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19060277938842773  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0165762901306152  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.016664981842041  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19097423553466797  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.007950782775879  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0080394744873047  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1900634765625  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.990898609161377  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9909858703613281  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.15816307067871094  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3967466354370117
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.44475817680358887
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0004627704620361328
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008450031280517578
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4454159736633301
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.8964095115661621
self.buckets_partition() spend  sec:  0.4538908004760742
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873693466186523  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.82814359664917  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.828588962554932  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2030949592590332  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8694586753845215  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.870237827301025  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2124171257019043  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.5899434089660645  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.5926361083984375  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21166324615478516  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.026503562927246  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.027883052825928  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2070155143737793  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.768479824066162  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.769185543060303  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21387910842895508  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.887806415557861  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8892717361450195  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21735572814941406  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.558216571807861  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.5603837966918945  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21578311920166016  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.812161445617676  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.813117027282715  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21892833709716797  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.606881141662598  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.608788967132568  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2135624885559082  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.304775714874268  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.30537223815918  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2047257423400879  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.882540702819824  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.882814884185791  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20423078536987305  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.527906894683838  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.52815580368042  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19037294387817383  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0133161544799805  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0134048461914062  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19060182571411133  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0157899856567383  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.015878677368164  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19097328186035156  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.015352249145508  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0154409408569336  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19133996963500977  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9940366744995117  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.994123935699463  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.15944528579711914  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.318430185317993
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.383512020111084
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0004482269287109375
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007532596588134766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3841221332550049
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.835101842880249
self.buckets_partition() spend  sec:  0.3916771411895752
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873693466186523  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.839780807495117  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.840226173400879  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2030954360961914  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.86450719833374  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.865286350250244  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2124161720275879  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.582828521728516  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.586118221282959  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21267318725585938  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.03974723815918  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.041043281555176  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2069845199584961  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.757114410400391  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.757820129394531  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21388006210327148  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.892138957977295  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.893695831298828  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21735763549804688  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.55744743347168  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.559515476226807  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2157435417175293  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.810968399047852  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.811923980712891  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21901178359985352  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.625668048858643  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.627575874328613  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21363592147827148  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.300511360168457  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.301107883453369  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20499181747436523  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.886203289031982  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.886477470397949  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20371675491333008  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.517297744750977  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.517546653747559  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19036388397216797  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.011603832244873  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.011692523956299  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19060420989990234  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.017185688018799  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0172743797302246  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19096994400024414  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.01473331451416  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.014822006225586  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1913466453552246  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.997124195098877  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9972114562988281  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.15945959091186523  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2476866245269775
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.4437434673309326
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0005185604095458984
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009074211120605469
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.44449782371520996
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.9007778167724609
self.buckets_partition() spend  sec:  0.4535984992980957
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873741149902344  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8243794441223145  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.824824333190918  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20310163497924805  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.875051975250244  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.875831127166748  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21242046356201172  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.610825538635254  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.613518238067627  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21155071258544922  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.012650012969971  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.014207363128662  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2071981430053711  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.75626277923584  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.7569684982299805  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21387910842895508  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8969902992248535  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.898362636566162  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21735525131225586  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.5538010597229  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.556658744812012  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21586227416992188  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.795126438140869  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.796082019805908  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.22004985809326172  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.633879661560059  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.635730266571045  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21404457092285156  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.331561088562012  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.332157611846924  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2049717903137207  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.906947135925293  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.90722131729126  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20388460159301758  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.516539096832275  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.516788005828857  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19038057327270508  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.013132095336914  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.01322078704834  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1905965805053711  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0192198753356934  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.019308567047119  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19098615646362305  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0215067863464355  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0215954780578613  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19134950637817383  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9965767860412598  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.996664047241211  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.15946245193481445  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.194824695587158
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.2625253200531006
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0004305839538574219
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008155107498168945
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.26315855979919434
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7145607471466064
self.buckets_partition() spend  sec:  0.27133703231811523
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873741149902344  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.823013782501221  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.823458671569824  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2030954360961914  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.867022514343262  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.867801666259766  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21242284774780273  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.613080024719238  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.615772724151611  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21164178848266602  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.039416790008545  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.041014194488525  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20721673965454102  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.764011859893799  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.7647175788879395  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21388006210327148  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.839240074157715  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8407063484191895  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2173442840576172  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.541828632354736  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.54390811920166  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21573734283447266  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.778066635131836  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.779022216796875  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2200474739074707  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.631282806396484  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.633030414581299  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21362876892089844  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.332005500793457  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.332602024078369  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2047557830810547  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.881956577301025  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.882230758666992  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2039809226989746  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.512333869934082  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.512582778930664  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19036865234375  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0115227699279785  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0116114616394043  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1905965805053711  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.019771099090576  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.019859790802002  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1898050308227539  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.000410556793213  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0004992485046387  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19134998321533203  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9983644485473633  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9984517097473145  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1594686508178711  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.144087553024292
the output layer 
self.num_batch (get_in_degree_bucketing) 16
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
G_BUCKET_ID_list [[7, 13], [8, 12], [6, 0], [4, 15], [10, 11], [3, 16], [1, 14], [5, 17], [2, 18], [9, 19], [20, 23], [22, 21]]
Groups_mem_list  [[1853, 1544], [1805, 1591], [1881, 1514], [1966, 1418], [1685, 1683], [1929, 1415], [1785, 1508], [1921, 1370], [1901, 1351], [1779, 1326], [1281, 1159], [1148, 1144]]
G_BUCKET_ID_list length 12
backpack scheduling spend time (sec) 0.4354372024536133
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  16
current group_mem  3.398236102059168
current group_mem  3.397158893943557
current group_mem  3.39597435402709
current group_mem  3.3857654760455933
current group_mem  3.3689013577399356
current group_mem  3.345451900819185
current group_mem  3.2943456590919205
current group_mem  3.2928833761216287
current group_mem  3.2524374376547147
current group_mem  3.106069811994745
current group_mem  2.440267783499448
current group_mem  2.2931425386058164
batches output list generation spend  0.0004057884216308594
self.weights_list  [0.06045677967033571, 0.057443837213138185, 0.19864527550829658, 0.08714441231127874, 0.05203373615860833, 0.09832748705204473, 0.14940455899979108, 0.07046326739314501, 0.11771368249744339, 0.04396256913823248, 0.020166921410584886, 0.018330565971344057, 0.0065097150900034085, 0.0065097150900034085, 0.0065097150900034085, 0.006377761405746583]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007501125335693359
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4360084533691406
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.8848357200622559
self.buckets_partition() spend  sec:  0.443530797958374
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.16873741149902344  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.814233303070068  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.814678192138672  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20309925079345703  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.875734806060791  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.876513957977295  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2124176025390625  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.597380638122559  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.600073337554932  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21267223358154297  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.034390449523926  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 7.035654067993164  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20695257186889648  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.758020401000977  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.758726119995117  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21387910842895508  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.8403449058532715  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.84174919128418  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21735191345214844  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.552162170410156  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.554253101348877  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2157588005065918  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.780407428741455  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.781363010406494  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21893310546875  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.626358509063721  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.6282548904418945  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.21404790878295898  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.339971542358398  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 6.3405680656433105  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.20502710342407227  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.896684169769287  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.896958351135254  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.2038102149963379  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.515254497528076  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 4.515503406524658  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19037628173828125  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.018573760986328  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.018662452697754  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.1905961036682129  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0145950317382812  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.014683723449707  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19097423553466797  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0122294425964355  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 2.0123181343078613  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.19031333923339844  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.994105339050293  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 1.9941926002502441  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.99755859375 GB
    Memory Allocated: 0.15842342376708984  GigaBytes
Max Memory Allocated: 7.353972434997559  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.0836732387542725
epoch_time_list  [8.765908002853394, 6.405233383178711, 6.3698601722717285, 6.137704610824585, 6.430388450622559, 6.4244606494903564, 6.335768461227417, 6.36522650718689, 6.148964166641235, 6.335028886795044, 6.240021705627441, 6.31251335144043, 6.301060438156128, 6.322847604751587, 6.530879735946655, 6.462572813034058, 6.247786045074463, 6.551077127456665, 6.277770757675171, 6.299638986587524]

loading_time list   [0.023137331008911133, 0.06085658073425293, 0.030100345611572266, 0.036421775817871094, 0.024045705795288086, 0.03648853302001953, 0.024977445602416992, 0.035446882247924805, 0.027527809143066406, 0.024465084075927734, 0.022724390029907227, 0.03415346145629883, 0.03622317314147949, 0.04138827323913574, 0.041167497634887695, 0.040971994400024414, 0.027315378189086914, 0.045340538024902344, 0.02733778953552246, 0.024127960205078125]

 data loader gen time  [1.9012446403503418, 1.8922929763793945, 1.8645966053009033, 1.642219066619873, 1.9175174236297607, 1.8995704650878906, 1.8327562808990479, 1.8451123237609863, 1.6600370407104492, 1.8388051986694336, 1.7455084323883057, 1.77504563331604, 1.569059133529663, 1.7169721126556396, 1.9191856384277344, 1.8851189613342285, 1.6485590934753418, 1.9579880237579346, 1.7218422889709473, 1.712942361831665]
	---backpack schedule time  [0.8923661708831787, 0.8825581073760986, 0.8642270565032959, 0.7410802841186523, 0.9028205871582031, 0.8950729370117188, 0.8643772602081299, 0.8485491275787354, 0.7334306240081787, 0.9024434089660645, 0.8478152751922607, 0.842421293258667, 0.7224276065826416, 0.7246227264404297, 0.900428295135498, 0.9073832035064697, 0.8460805416107178, 0.9122910499572754, 0.725433349609375, 0.8946783542633057]
	---connection_check_time_list  [0.4850316047668457, 0.4920785427093506, 0.4874744415283203, 0.4768061637878418, 0.4965023994445801, 0.5051109790802002, 0.4798154830932617, 0.49400877952575684, 0.487576961517334, 0.48801565170288086, 0.4782905578613281, 0.48173046112060547, 0.4768335819244385, 0.49346303939819336, 0.49013566970825195, 0.49068355560302734, 0.49112844467163086, 0.5088224411010742, 0.5009362697601318, 0.4776332378387451]
	---block_gen_time_list  [0.4643113613128662, 0.4584825038909912, 0.4539165496826172, 0.3660926818847656, 0.45687270164489746, 0.44029855728149414, 0.42769527435302734, 0.4429471492767334, 0.37981247901916504, 0.38802051544189453, 0.36100172996520996, 0.3921809196472168, 0.31034064292907715, 0.4389982223510742, 0.46628284454345703, 0.4273703098297119, 0.252086877822876, 0.4756636619567871, 0.4365222454071045, 0.28003859519958496]
training time  [6.841516733169556, 4.447826862335205, 4.469213008880615, 4.45376992225647, 4.48317289352417, 4.4829816818237305, 4.472526788711548, 4.479209899902344, 4.45571494102478, 4.466137886047363, 4.466086149215698, 4.497689247131348, 4.690209150314331, 4.5586793422698975, 4.564980506896973, 4.530694961547852, 4.566410064697266, 4.54205322265625, 4.523043155670166, 4.55691933631897]
---feature block loading time  [2.0581655502319336, 2.1928622722625732, 2.1990561485290527, 2.216212511062622, 2.218930959701538, 2.2348971366882324, 2.229949951171875, 2.2251710891723633, 2.220377206802368, 2.204775333404541, 2.218853235244751, 2.231567144393921, 2.24770450592041, 2.2412943840026855, 2.2399985790252686, 2.2073051929473877, 2.246899127960205, 2.1983284950256348, 2.2243988513946533, 2.2432985305786133]


epoch_time avg   6.349125355482101
loading_time avg   0.032106369733810425
 data loader gen time avg 1.7903762757778168
	---backpack schedule time avg 0.8418922275304794
	---connection_check_time avg  0.490042969584465
	---block_gen_time avg  0.39850829541683197
training time  4.521031826734543
---feature block loading time  2.227109357714653
pure train time per /epoch  [4.7712562084198, 2.1979269981384277, 2.2114202976226807, 2.1736738681793213, 2.2019224166870117, 2.179696798324585, 2.173529863357544, 2.1814377307891846, 2.165248155593872, 2.1911630630493164, 2.17606782913208, 2.2025582790374756, 2.382636785507202, 2.2552361488342285, 2.259683609008789, 2.262174129486084, 2.2561819553375244, 2.287092685699463, 2.232945680618286, 2.2516000270843506]
pure train time average  2.2254617073956657
